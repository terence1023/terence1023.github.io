<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>Reading Remember</title>
      <link href="2021/04/21/reading-remember/"/>
      <url>2021/04/21/reading-remember/</url>
      
        <content type="html"><![CDATA[<h1 id="Link"><a href="#Link" class="headerlink" title="Link"></a>Link</h1><h2 id="Machine-Learning"><a href="#Machine-Learning" class="headerlink" title="Machine Learning"></a>Machine Learning</h2><h3 id="How-to-Run-30-Machine-Learning-Models-with-a-Few-Lines-of-Code"><a href="#How-to-Run-30-Machine-Learning-Models-with-a-Few-Lines-of-Code" class="headerlink" title="How to Run 30 Machine Learning Models with a Few Lines of Code"></a><a href="https://towardsdatascience.com/how-to-run-30-machine-learning-models-with-2-lines-of-code-d0f94a537e52">How to Run 30 Machine Learning Models with a Few Lines of Code</a></h3><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> lazypredict<span class="token keyword">from</span> lazypredict<span class="token punctuation">.</span>Supervised <span class="token keyword">import</span> LazyClassifier<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>Finally, let’s run the models and see how it goes.</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">clf <span class="token operator">=</span> LazyClassifier<span class="token punctuation">(</span>verbose<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>ignore_warnings<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>models<span class="token punctuation">,</span> predictions <span class="token operator">=</span> clf<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X_train<span class="token punctuation">,</span> X_test<span class="token punctuation">,</span> y_train<span class="token punctuation">,</span> y_test<span class="token punctuation">)</span>models<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p><img src="https://miro.medium.com/max/3025/1*N_f0qaldxYwnAPO__yPL5Q.png" alt="img"></p><h3 id="Downloadable-Cheat-Sheets-for-AI-Neural-Networks-Machine-Learning-Deep-Learning-amp-Data-Science-PDF"><a href="#Downloadable-Cheat-Sheets-for-AI-Neural-Networks-Machine-Learning-Deep-Learning-amp-Data-Science-PDF" class="headerlink" title="Downloadable: Cheat Sheets for AI, Neural Networks, Machine Learning, Deep Learning &amp; Data Science PDF"></a><a href="https://becominghuman.ai/cheat-sheets-for-ai-neural-networks-machine-learning-deep-learning-big-data-science-pdf-f22dc900d2d7">Downloadable: Cheat Sheets for AI, Neural Networks, Machine Learning, Deep Learning &amp; Data Science PDF</a></h3><p><img src="https://miro.medium.com/max/5560/1*vrDC8I0PL84ZLCtw_0s_eA.png" alt="img"></p><p><img src="https://miro.medium.com/max/4575/1*QpiyXBMkWIj3Y7SusTKfww.png" alt="img"></p><h2 id="Web-Application"><a href="#Web-Application" class="headerlink" title="Web Application"></a>Web Application</h2><h3 id="Streamlit"><a href="#Streamlit" class="headerlink" title="Streamlit"></a>Streamlit</h3><ul><li><a href="https://sspai.com/post/58474">如何用 Python 和 Streamlit 做交互式数据分析产品？</a></li></ul><h3 id="FastAPI"><a href="#FastAPI" class="headerlink" title="FastAPI"></a>FastAPI</h3><ul><li><a href="https://towardsdatascience.com/how-to-deploy-machine-learning-models-as-a-microservice-using-fastapi-b3a6002768af">How to deploy Machine Learning models as a Microservice using FastAPI</a></li></ul><p><img src="https://miro.medium.com/max/2700/1*CYPe_LHkbm4Gqtc7gmoxUA.png" alt="img"></p><ul><li><p><a href="https://towardsdatascience.com/create-your-first-rest-api-in-fastapi-e728ae649a60">Create your first REST API in FastAPI</a></p></li><li><p><a href="https://www.jianshu.com/p/ef4802c6edc5">Python开发NLP应用新思路：Streamlit与FastAPI双剑合璧</a></p></li></ul><h2 id="Analysis"><a href="#Analysis" class="headerlink" title="Analysis"></a>Analysis</h2><ul><li><a href="https://medium.com/free-code-camp/understanding-my-browsing-pattern-using-pandas-and-seaborn-162b97e33e51">Understanding my browsing pattern using Pandas and Seaborn</a></li></ul><h2 id="Debug"><a href="#Debug" class="headerlink" title="Debug"></a>Debug</h2><ul><li><p><a href="https://www.cnblogs.com/mengyu/p/6638975.html">python 读取文件时报错UnicodeDecodeError: ‘gbk’ codec can’t decode byte 0x80 in position 205: illegal multibyte sequence</a></p></li><li><p><a href="https://kanoki.org/2020/03/09/how-to-use-pandas-count-and-value_counts/"><strong>Pandas Count Groupby</strong></a></p></li><li><p><a href="https://segmentfault.com/a/1190000021417257">python pandas根据多列内容去重</a></p></li><li><p><a href="https://blog.csdn.net/xiaodongxiexie/article/details/65646239">Python如何忽略warning的输出</a></p></li><li><p><a href="https://blog.csdn.net/qq1483661204/article/details/79824381">pandas 根据某一列排序（sort_values）</a></p></li></ul><h2 id="Waiting-to-read"><a href="#Waiting-to-read" class="headerlink" title="Waiting to read"></a>Waiting to read</h2><ul><li><a href="https://medium.com/jovianml/3-must-have-projects-for-your-data-science-portfolio-9cbd1264edb4">3 must-have projects for your data science portfolio</a></li></ul>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Task5 Docker Compose</title>
      <link href="2021/04/21/task5-docker-compose/"/>
      <url>2021/04/21/task5-docker-compose/</url>
      
        <content type="html"><![CDATA[<h1 id="Docker-Compose"><a href="#Docker-Compose" class="headerlink" title="Docker Compose"></a>Docker Compose</h1><p>记录下实验问题</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">PS D:<span class="token punctuation">\</span>Desktop<span class="token punctuation">\</span><span class="token number">2021</span><span class="token punctuation">\</span>April<span class="token punctuation">\</span>Docker<span class="token punctuation">\</span>Docker_Compose<span class="token operator">&gt;</span> docker-compose upDocker Compose is now <span class="token keyword">in</span> the Docker CLI, try <span class="token variable"><span class="token variable">`</span>docker compose up<span class="token variable">`</span></span>Starting docker_compose_web_1   <span class="token punctuation">..</span>. <span class="token keyword">done</span>Attaching to docker_compose_redis_1, docker_compose_web_1redis_1  <span class="token operator">|</span> <span class="token number">1</span>:C <span class="token number">21</span> Apr <span class="token number">2021</span> <span class="token number">14</span>:33:58.965 <span class="token comment"># oO0OoO0OoO0Oo Redis is starting oO0OoO0OoO0Oo</span>redis_1  <span class="token operator">|</span> <span class="token number">1</span>:C <span class="token number">21</span> Apr <span class="token number">2021</span> <span class="token number">14</span>:33:58.965 <span class="token comment"># Redis version=6.2.2, bits=64, commit=00000000, modified=0, pid=1, just startedfy a config file use redis-server /path/to/redis.conf</span>redis_1  <span class="token operator">|</span> <span class="token number">1</span>:M <span class="token number">21</span> Apr <span class="token number">2021</span> <span class="token number">14</span>:33:58.966 * monotonic clock: POSIX clock_gettimeredis_1  <span class="token operator">|</span> <span class="token number">1</span>:M <span class="token number">21</span> Apr <span class="token number">2021</span> <span class="token number">14</span>:33:58.966 * Running <span class="token assign-left variable">mode</span><span class="token operator">=</span>standalone, <span class="token assign-left variable">port</span><span class="token operator">=</span><span class="token number">6379</span>.redis_1  <span class="token operator">|</span> <span class="token number">1</span>:M <span class="token number">21</span> Apr <span class="token number">2021</span> <span class="token number">14</span>:33:58.966 <span class="token comment"># WARNING: The TCP backlog setting of 511 cannot be enforced because /proc/sys/net/core/somaxconn is set to the lower value of 128.</span>redis_1  <span class="token operator">|</span> <span class="token number">1</span>:M <span class="token number">21</span> Apr <span class="token number">2021</span> <span class="token number">14</span>:33:58.966 <span class="token comment"># Server initialized</span>redis_1  <span class="token operator">|</span> <span class="token number">1</span>:M <span class="token number">21</span> Apr <span class="token number">2021</span> <span class="token number">14</span>:33:58.966 <span class="token comment"># WARNING overcommit_memory is set to 0! Background save may fail under low memory condition. To fix this issue add 'vm.overcommit_memory = 1' to /etc/sysctl.conf and then reboot or run the command 'sysctl vm.overcommit_memory=1' for this to take effect.</span>redis_1  <span class="token operator">|</span> <span class="token number">1</span>:M <span class="token number">21</span> Apr <span class="token number">2021</span> <span class="token number">14</span>:33:58.966 * Loading RDB produced by version <span class="token number">6.2</span>.2redis_1  <span class="token operator">|</span> <span class="token number">1</span>:M <span class="token number">21</span> Apr <span class="token number">2021</span> <span class="token number">14</span>:33:58.966 * RDB age <span class="token number">2</span> secondsredis_1  <span class="token operator">|</span> <span class="token number">1</span>:M <span class="token number">21</span> Apr <span class="token number">2021</span> <span class="token number">14</span>:33:58.966 * RDB memory usage when created <span class="token number">0.77</span> Mbredis_1  <span class="token operator">|</span> <span class="token number">1</span>:M <span class="token number">21</span> Apr <span class="token number">2021</span> <span class="token number">14</span>:33:58.966 * DB loaded from disk: <span class="token number">0.000</span> secondsredis_1  <span class="token operator">|</span> <span class="token number">1</span>:M <span class="token number">21</span> Apr <span class="token number">2021</span> <span class="token number">14</span>:33:58.966 * Ready to accept connectionsweb_1    <span class="token operator">|</span>   File <span class="token string">"app.py"</span>, line <span class="token number">13</span>web_1    <span class="token operator">|</span>     <span class="token builtin class-name">return</span> <span class="token string">'Hello Container World! I have been seen %s times and my hostname is %s.<span class="token entity" title="\n">\n</span>'</span> % <span class="token punctuation">(</span>redis.get<span class="token punctuation">(</span><span class="token string">'hits'</span><span class="token punctuation">)</span>,socket.gethostname<span class="token punctuation">(</span><span class="token punctuation">))</span>web_1    <span class="token operator">|</span>     ^web_1    <span class="token operator">|</span> IndentationError: unexpected indentdocker_compose_web_1 exited with code <span class="token number">1</span>Gracefully stopping<span class="token punctuation">..</span>. <span class="token punctuation">(</span>press Ctrl+C again to force<span class="token punctuation">)</span>Stopping docker_compose_redis_1 <span class="token punctuation">..</span>. <span class="token keyword">done</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="实例-：artipub——使用-docker-compose-代替-docker-run"><a href="#实例-：artipub——使用-docker-compose-代替-docker-run" class="headerlink" title="实例 ：artipub——使用 docker-compose 代替 docker run"></a>实例 ：artipub——使用 docker-compose 代替 docker run</h2><p>项目链接：<a href="https://github.com/crawlab-team/artipub">https://github.com/crawlab-team/artipub</a></p><ul><li><p>通过创建 <code>docker-compose.yaml</code> 文件，内容配置见下文</p></li><li><p>然后在命令行中输入如下命令</p><pre class="line-numbers language-none"><code class="language-none">docker-compose up<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li><li>然后在浏览器中输入 <code>http://localhost:8000</code> 可以看到界面。</li></ul><p><img src="/2021/04/21/task5-docker-compose/QQ截图20210111222839.png" alt=""></p><h3 id="Docker-Compose-1"><a href="#Docker-Compose-1" class="headerlink" title="Docker Compose"></a>Docker Compose</h3><h4 id="Compose-简介"><a href="#Compose-简介" class="headerlink" title="Compose 简介"></a>Compose 简介</h4><p>Compose 是用于定义和运行多容器 Docker 应用程序的工具。通过 Compose，我们可以使用 YML 文件来配置应用程序需要的所有服务。然后，使用一个命令，就可以从 YML 文件配置中创建并启动所有服务。如果还不了解 YML 文件配置，可以先阅读<a href="https://www.runoob.com/w3cnote/yaml-intro.html"> YAML 入门教程</a>。</p><p>Compose 使用的三个步骤：</p><ul><li>使用 Dockerfile 定义应用程序的环境。</li><li>使用 docker-compose.yml 定义构成应用程序的服务，这样它们可以在隔离环境中一起运行。</li><li>最后，执行 docker-compose up 命令来启动并运行整个应用程序。</li></ul><h4 id="Compose-安装"><a href="#Compose-安装" class="headerlink" title="Compose 安装"></a>Compose 安装</h4><p>Windows 的 Docker 桌面版和 Docker Toolbox 已经包括 Compose 和其他 Docker 应用程序，因此 Windows 用户不需要单独安装 Compose。Docker 安装说明可以参阅<a href="https://www.runoob.com/docker/windows-docker-install.html"> Windows Docker 安装</a>。</p><p>该项目的 docker-compose.yml 文件</p><pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"><span class="token key atrule">version</span><span class="token punctuation">:</span> <span class="token string">'3.3'</span><span class="token key atrule">services</span><span class="token punctuation">:</span>  <span class="token key atrule">app</span><span class="token punctuation">:</span>    <span class="token key atrule">image</span><span class="token punctuation">:</span> <span class="token string">"tikazyq/artipub:latest"</span>    <span class="token key atrule">environment</span><span class="token punctuation">:</span>      <span class="token key atrule">MONGO_HOST</span><span class="token punctuation">:</span> <span class="token string">"mongo"</span>      <span class="token key atrule">ARTIPUB_API_ADDRESS</span><span class="token punctuation">:</span> <span class="token string">"http://localhost:3000"</span> <span class="token comment"># 后端 API 地址，如果安装地址不在本机，请修改为协议 + 服务器 IP 地址 + 端口号（默认为 3000）</span>    <span class="token key atrule">ports</span><span class="token punctuation">:</span>      <span class="token punctuation">-</span> <span class="token string">"8000:8000"</span> <span class="token comment"># frontend</span>      <span class="token punctuation">-</span> <span class="token string">"3000:3000"</span> <span class="token comment"># backend</span>    <span class="token key atrule">depends_on</span><span class="token punctuation">:</span>      <span class="token punctuation">-</span> mongo  <span class="token key atrule">mongo</span><span class="token punctuation">:</span>    <span class="token key atrule">image</span><span class="token punctuation">:</span> mongo<span class="token punctuation">:</span>latest    <span class="token key atrule">restart</span><span class="token punctuation">:</span> always    <span class="token key atrule">ports</span><span class="token punctuation">:</span>      <span class="token punctuation">-</span> <span class="token string">"27017:27017"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>这里需要格外注意 yml 文件的格式、缩进、是否有空置、数据格式是否符合等问题，如果出现报错（因为已经遇到错误了，源文件是有个值为空），根据报错信息检查对应的问题。</p><p>打开 120.0.0.1:8000</p><p><img src="/2021/04/21/task5-docker-compose/QQ截图20210111221618.png" alt=""></p><h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><ul><li><a href="https://vuepress.mirror.docker-practice.com/compose/">Docker Compose项目</a></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> Docker </tag>
            
            <tag> DataWhale </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Task4 网络</title>
      <link href="2021/04/19/task4-wang-luo/"/>
      <url>2021/04/19/task4-wang-luo/</url>
      
        <content type="html"><![CDATA[<h1 id="Docker-网络"><a href="#Docker-网络" class="headerlink" title="Docker 网络"></a>Docker 网络</h1><p>安装Docker时，它会自动创建三个网络，bridge（创建容器默认连接到此网络）、 none 、host</p><div class="table-container"><table><thead><tr><th>网络模式</th><th>简介</th></tr></thead><tbody><tr><td>Host</td><td>容器将不会虚拟出自己的网卡，配置自己的IP等，而是使用宿主机的IP和端口。</td></tr><tr><td>Bridge</td><td>此模式会为每一个容器分配、设置IP等，并将容器连接到一个docker0虚拟网桥，通过docker0网桥以及Iptables nat表配置与宿主机通信。</td></tr><tr><td>None</td><td>该模式关闭了容器的网络功能。</td></tr><tr><td>Container</td><td>创建的容器不会创建自己的网卡，配置自己的IP，而是和一个指定的容器共享IP、端口范围。</td></tr></tbody></table></div><h2 id="1-默认网络"><a href="#1-默认网络" class="headerlink" title="1. 默认网络"></a>1. 默认网络</h2><p>当你安装Docker时，它会自动创建三个网络。你可以使用以下docker network ls命令列出这些网络：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">[</span>root@server1 ~<span class="token punctuation">]</span><span class="token comment"># docker network ls</span>NETWORK ID          NAME                DRIVER              SCOPE0147b8d16c64        bridge              bridge              <span class="token builtin class-name">local</span>2da931af3f0b        <span class="token function">host</span>                <span class="token function">host</span>                <span class="token builtin class-name">local</span>63d31338bcd9        none                null                <span class="token builtin class-name">local</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>Docker内置这三个网络，运行容器时，你可以使用该<code>--network</code>标志来指定容器应连接到哪些网络。</p><p>该bridge网络代表docker0所有Docker安装中存在的网络。除非你使用该<code>docker run --network=选项</code>指定，否则Docker守护程序默认将容器连接到此网络。</p><p>我们在使用docker run创建Docker容器时，可以用 <code>--net</code> 选项指定容器的网络模式，Docker可以有以下4种网络模式：</p><ul><li>host模式：使用 —net=host 指定。</li><li>none模式：使用 —net=none 指定。</li><li>bridge模式：使用 —net=bridge 指定，默认设置。</li><li>container模式：使用 —net=container:NAME_or_ID 指定。</li></ul><p>下面分别介绍一下Docker的各个网络模式。</p><h3 id="1-1-Host模式"><a href="#1-1-Host模式" class="headerlink" title="1.1 Host模式"></a>1.1 Host模式</h3><p>相当于Vmware中的桥接模式，与宿主机在同一个网络中，但没有独立IP地址。</p><p>众所周知，Docker使用了Linux的Namespaces技术来进行资源隔离，如PID Namespace隔离进程，Mount Namespace隔离文件系统，Network Namespace隔离网络等。</p><p>一个Network Namespace提供了一份独立的网络环境，包括网卡、路由、Iptable规则等都与其他的Network Namespace隔离。一个Docker容器一般会分配一个独立的Network Namespace。但如果启动容器的时候使用host模式，那么这个容器将不会获得一个独立的Network Namespace，而是和宿主机共用一个Network Namespace。容器将不会虚拟出自己的网卡，配置自己的IP等，而是使用宿主机的IP和端口。</p><p>例如，我们在172.25.6.1/24的机器上用host模式启动一个ubuntu容器</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">[</span>root@server1 ~<span class="token punctuation">]</span><span class="token comment"># docker run -it --network=host ubuntu</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>可以看到，容器的网络使用的时宿主机的网络，但是，容器的其他方面，如文件系统、进程列表等还是和宿主机隔离的。</p><h3 id="1-2-Container模式"><a href="#1-2-Container模式" class="headerlink" title="1.2 Container模式"></a>1.2 Container模式</h3><p>在理解了host模式后，这个模式也就好理解了。这个模式指定新创建的容器和已经存在的一个容器共享一个Network Namespace，而不是和宿主机共享。新创建的容器不会创建自己的网卡，配置自己的IP，而是和一个指定的容器共享IP、端口范围等。同样，两个容器除了网络方面，其他的如文件系统、进程列表等还是隔离的。两个容器的进程可以通过lo网卡设备通信。</p><h3 id="1-3-None模式"><a href="#1-3-None模式" class="headerlink" title="1.3 None模式"></a>1.3 None模式</h3><p>该模式将容器放置在它自己的网络栈中，但是并不进行任何配置。实际上，该模式关闭了容器的网络功能，在以下两种情况下是有用的：容器并不需要网络（例如只需要写磁盘卷的批处理任务）。</p><p>overlay</p><p>在docker1.7代码进行了重构，单独把网络部分独立出来编写，所以在docker1.8新加入的一个overlay网络模式。Docker对于网络访问的控制也是在逐渐完善的。</p><h3 id="1-4-Bridge模式"><a href="#1-4-Bridge模式" class="headerlink" title="1.4 Bridge模式"></a>1.4 Bridge模式</h3><p>相当于Vmware中的Nat模式，容器使用独立network Namespace，并连接到docker0虚拟网卡（默认模式）。通过docker0网桥以及Iptables nat表配置与宿主机通信；bridge模式是Docker默认的网络设置，此模式会为每一个容器分配Network Namespace、设置IP等，并将一个主机上的Docker容器连接到一个虚拟网桥上。</p><h2 id="实例：创建一个点到点连接"><a href="#实例：创建一个点到点连接" class="headerlink" title="实例：创建一个点到点连接"></a>实例：创建一个点到点连接</h2><p>这里出现了一点问题，暂时还没解决</p><p><img src="/2021/04/19/task4-wang-luo/实例.png" alt=""></p><p>还有一点，我没有 <code>/etc/docker/daemon.json</code> 这个文件</p>]]></content>
      
      
      
        <tags>
            
            <tag> Docker </tag>
            
            <tag> DataWhale </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Graph Neural Networks(GNN)</title>
      <link href="2021/04/18/graph-neural-networks-gnn/"/>
      <url>2021/04/18/graph-neural-networks-gnn/</url>
      
        <content type="html"><![CDATA[<h1 id="Graph-Neural-Networks-GNN"><a href="#Graph-Neural-Networks-GNN" class="headerlink" title="Graph Neural Networks-GNN"></a>Graph Neural Networks-GNN</h1><ul><li>本文记录 <code>GNN</code> 学习内容</li></ul><h2 id="The-Excellent-Blog"><a href="#The-Excellent-Blog" class="headerlink" title="The Excellent Blog"></a>The Excellent Blog</h2><ul><li><p><a href="https://zhuanlan.zhihu.com/p/120152289">综述|从10篇研究综述看图神经网络GNN的最新研究进展</a></p></li><li><p><a href="https://zhuanlan.zhihu.com/p/75307407">图神经网络（Graph Neural Networks，GNN）综述</a></p></li><li><p><a href="https://www.zhihu.com/question/305395488/answer/554847680">graph convolutional network有什么比较好的应用task</a></p></li><li><p><a href="https://www.zhihu.com/question/54504471/answer/332657604">如何理解 Graph Convolutional Network（GCN）？</a></p></li><li><a href="https://zhuanlan.zhihu.com/p/72373094">解读三种经典GCN中的Parameter Sharing</a></li></ul><h2 id="Other"><a href="#Other" class="headerlink" title="Other"></a>Other</h2><ul><li><a href="https://zhuanlan.zhihu.com/p/62629465">图嵌入（Graph embedding）综述</a></li></ul><h2 id="Waiting-to-read"><a href="#Waiting-to-read" class="headerlink" title="Waiting to read"></a>Waiting to read</h2><ul><li><a href="http://tkipf.github.io/graph-convolutional-networks/"><strong>GRAPH CONVOLUTIONAL NETWORKS</strong></a></li><li><a href="https://www.cnblogs.com/pinard/p/6221564.html">谱聚类（spectral clustering）原理总结</a></li></ul><h2 id="Paper"><a href="#Paper" class="headerlink" title="Paper"></a>Paper</h2><ul><li><p><a href="https://arxiv.org/abs/1812.04202">Deep Learning on Graphs: A Survey</a></p></li><li><p><a href="https://arxiv.org/abs/1901.00596">A Comprehensive Survey on Graph Neural Networks</a></p></li><li><p><a href="https://arxiv.org/abs/1710.10903">Graph Attention Networks</a></p></li><li><p><a href="https://arxiv.org/abs/1605.05273">Learning Convolutional Neural Networks for Graphs</a></p></li><li><p><a href="https://www.imperial.ac.uk/media/imperial-college/faculty-of-engineering/computing/public/1819-pg-projects/Geometric-Deep-Learning-with-3D-Facial-Motion.pdf">Geometric Deep Learning with 3DFacial Motion</a></p></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> Deep Learning </tag>
            
            <tag> GNN </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Task3 数据管理</title>
      <link href="2021/04/16/task3-shu-ju-guan-li/"/>
      <url>2021/04/16/task3-shu-ju-guan-li/</url>
      
        <content type="html"><![CDATA[<h1 id="Docker-数据管理"><a href="#Docker-数据管理" class="headerlink" title="Docker 数据管理"></a>Docker 数据管理</h1><p>Docker 可以做持久化的数据保存，在容器中管理数据主要有两种方式：</p><ul><li>数据卷（Data volumes）</li><li>数据卷容器（Data volume containers）</li></ul><h2 id="数据卷"><a href="#数据卷" class="headerlink" title="数据卷"></a>数据卷</h2><p>数据卷（Data Volumes）是一个可供容器使用的特殊目录，它将主机操作系统目录直接映射进容器，类似于 Linux 中的 mount 行为。</p><p>数据卷的特性有：</p><ul><li>数据卷可以在容器之间共享和重用，容器间传递数据将变得高效和方便</li><li>对数据卷内的数据的修改会立马生效，无论容器内操作还是本地操作</li><li>对数据卷的更新不会影响镜像，解耦开应用和数据</li><li>卷会一直存在，直到没有容器使用，可以安全地卸载它</li></ul><h3 id="创建一个数据卷"><a href="#创建一个数据卷" class="headerlink" title="创建一个数据卷"></a>创建一个数据卷</h3><p>在用 <code>docker run</code> 命令的时候，使用 <code>-v</code> 标记来创建一个数据卷并挂载到容器里。在一次 run 中多次使用可以挂载多个数据卷。</p><p>下面创建一个名为 web 的容器，并加载一个数据卷到容器的 <code>/webapp</code> 目录。</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">$ <span class="token function">sudo</span> docker run -d -P --name web -v /webapp training/webapp python app.py<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><p>注意：也可以在 Dockerfile 中使用 <code>VOLUME</code> 来添加一个或者多个新的卷到由该镜像创建的任意容器。</p></blockquote><h3 id="删除数据卷"><a href="#删除数据卷" class="headerlink" title="删除数据卷"></a>删除数据卷</h3><p>数据卷是被设计用来持久化数据的，它的生命周期独立于容器，Docker不会在容器被删除后自动删除数据卷，并且也不存在垃圾回收这样的机制来处理没有任何容器引用的数据卷。如果需要在删除容器的同时移除数据卷。可以在删除容器的时候使用 <code>docker rm -v</code> 这个命令。无主的数据卷可能会占据很多空间，要清理会很麻烦。Docker官方正在试图解决这个问题，相关工作的进度可以查看这个<a href="https://github.com/docker/docker/pull/8484">PR</a>。</p><h3 id="挂载一个主机目录作为数据卷"><a href="#挂载一个主机目录作为数据卷" class="headerlink" title="挂载一个主机目录作为数据卷"></a>挂载一个主机目录作为数据卷</h3><p>使用 <code>-v</code> 标记也可以指定挂载一个本地主机的目录到容器中去。</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">$ <span class="token function">sudo</span> docker run -d -P --name web -v /src/webapp:/opt/webapp training/webapp python app.py<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>上面的命令加载主机的 <code>/src/webapp</code> 目录到容器的 <code>/opt/webapp</code> 目录。这个功能在进行测试的时候十分方便，比如用户可以放置一些程序到本地目录中，来查看容器是否正常工作。本地目录的路径必须是绝对路径，如果目录不存在 Docker 会自动为我们创建它。</p><blockquote><p>注意：Dockerfile 中不支持这种用法，这是因为 Dockerfile 是为了移植和分享用的。然而，不同操作系统的路径格式不一样，所以目前还不能支持。</p></blockquote><p>Docker 挂载数据卷的默认权限是读写，用户也可以通过 <code>:ro</code> 指定为只读。</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">$ <span class="token function">sudo</span> docker run -d -P --name web -v /src/webapp:/opt/webapp:rotraining/webapp python app.py<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>加了 <code>:ro</code> 之后，就挂载为只读了。</p><h3 id="查看数据卷的具体信息"><a href="#查看数据卷的具体信息" class="headerlink" title="查看数据卷的具体信息"></a>查看数据卷的具体信息</h3><p>在主机里使用以下命令可以查看指定容器的信息</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">$ docker inspect web<span class="token punctuation">..</span>.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>在输出的内容中找到其中和数据卷相关的部分，可以看到所有的数据卷都是创建在主机的<code>/var/lib/docker/volumes/</code>下面的</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"><span class="token string">"Volumes"</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>    <span class="token string">"/webapp"</span><span class="token builtin class-name">:</span> <span class="token string">"/var/lib/docker/volumes/fac362...80535"</span><span class="token punctuation">}</span>,<span class="token string">"VolumesRW"</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span>    <span class="token string">"/webapp"</span><span class="token builtin class-name">:</span> <span class="token boolean">true</span><span class="token punctuation">}</span><span class="token punctuation">..</span>.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>注：从Docker 1.8.0起，数据卷配置在”Mounts”Key下面，可以看到所有的数据卷都是创建在主机的<code>/mnt/sda1/var/lib/docker/volumes/....</code>下面了。</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"><span class="token string">"Mounts"</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span>            <span class="token punctuation">{</span>                <span class="token string">"Name"</span><span class="token builtin class-name">:</span> <span class="token string">"b53ebd40054dae599faf7c9666acfe205c3e922fc3e8bc3f2fd178ed788f1c29"</span>,                <span class="token string">"Source"</span><span class="token builtin class-name">:</span> <span class="token string">"/mnt/sda1/var/lib/docker/volumes/b53ebd40054dae599faf7c9666acfe205c3e922fc3e8bc3f2fd178ed788f1c29/_data"</span>,                <span class="token string">"Destination"</span><span class="token builtin class-name">:</span> <span class="token string">"/webapp"</span>,                <span class="token string">"Driver"</span><span class="token builtin class-name">:</span> <span class="token string">"local"</span>,                <span class="token string">"Mode"</span><span class="token builtin class-name">:</span> <span class="token string">""</span>,                <span class="token string">"RW"</span><span class="token builtin class-name">:</span> true,                <span class="token string">"Propagation"</span><span class="token builtin class-name">:</span> <span class="token string">""</span>            <span class="token punctuation">}</span>        <span class="token punctuation">]</span><span class="token punctuation">..</span>.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="挂载一个本地主机文件作为数据卷"><a href="#挂载一个本地主机文件作为数据卷" class="headerlink" title="挂载一个本地主机文件作为数据卷"></a>挂载一个本地主机文件作为数据卷</h3><p><code>-v</code> 标记也可以从主机挂载单个文件到容器中</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell">$ <span class="token function">sudo</span> docker run --rm -it -v ~/.bash_history:/.bash_history ubuntu /bin/bash<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>这样就可以记录在容器输入过的命令了。</p><p>*注意：如果直接挂载一个文件，很多文件编辑工具，包括 <code>vi</code> 或者 <code>sed --in-place</code>，可能会造成文件 inode 的改变，从 Docker 1.1 .0起，这会导致报错误信息。所以最简单的办法就直接挂载文件的父目录。</p><h2 id="数据卷容器"><a href="#数据卷容器" class="headerlink" title="数据卷容器"></a>数据卷容器</h2><p>如果我们有一些持续更新的数据需要在容器之间共享，最好创建数据卷容器。</p><p>数据卷容器，其实就是一个正常的容器，专门用来提供数据卷供其它容器挂载的。</p><p>首先，创建一个名为 dbdata 的数据卷容器：</p><pre class="line-numbers language-none"><code class="language-none">$ sudo docker run -d -v /dbdata --name dbdata training/postgres echo Data-only container for postgres<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>然后，在其他容器中使用 <code>--volumes-from</code> 来挂载 dbdata 容器中的数据卷。</p><pre class="line-numbers language-none"><code class="language-none">$ sudo docker run -d --volumes-from dbdata --name db1 training/postgres$ sudo docker run -d --volumes-from dbdata --name db2 training/postgres<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>可以使用超过一个的 <code>--volumes-from</code> 参数来指定从多个容器挂载不同的数据卷。 也可以从其他已经挂载了数据卷的容器来级联挂载数据卷。</p><pre class="line-numbers language-none"><code class="language-none">$ sudo docker run -d --name db3 --volumes-from db1 training/postgres<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><blockquote><p>注意：使用 <code>--volumes-from</code> 参数所挂载数据卷的容器自己并不需要保持在运行状态。</p></blockquote><p>如果删除了挂载的容器（包括 dbdata、db1 和 db2），数据卷并不会被自动删除。如果要删除一个数据卷，必须在删除最后一个还挂载着它的容器时使用 <code>docker rm -v</code> 命令来指定同时删除关联的容器。 这可以让用户在容器之间升级和移动数据卷。</p><h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><ul><li><a href="http://shouce.jb51.net/docker_practice/">Docker — 从入门到实践</a></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> Docker </tag>
            
            <tag> DataWhale </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Deconvolution Layer</title>
      <link href="2021/04/15/deconvolution-layer/"/>
      <url>2021/04/15/deconvolution-layer/</url>
      
        <content type="html"><![CDATA[<h1 id="Deconvolution-Layer"><a href="#Deconvolution-Layer" class="headerlink" title="Deconvolution Layer"></a>Deconvolution Layer</h1><ul><li><a href="https://datascience.stackexchange.com/questions/6107/what-are-deconvolutional-layers">Remember Other Answer</a></li></ul><p><em>Deconvolution layer</em> is a very unfortunate name and should rather be called a <a href="https://github.com/tensorflow/tensorflow/issues/256#issuecomment-162257789"><em>transposed convolutional layer</em></a>.</p><p>Visually, for a transposed convolution with stride one and no padding, we just pad the original input (blue entries) with zeroes (white entries) (Figure 1).</p><p><a href="https://i.stack.imgur.com/YyCu2.gif"><img src="https://i.stack.imgur.com/YyCu2.gif" alt="Figure 1"></a></p><p>In case of stride two and padding, the transposed convolution would look like this (Figure 2):</p><p><a href="https://i.stack.imgur.com/f2RiP.gif"><img src="https://i.stack.imgur.com/f2RiP.gif" alt="Figure 2"></a></p><p>All credits for the great visualisations go to</p><ul><li>Vincent Dumoulin, Francesco Visin - <a href="https://arxiv.org/pdf/1603.07285v1.pdf">A guide to convolution arithmetic for deep learning</a></li></ul><p>You can find more visualisations of convolutional arithmetics <a href="https://github.com/vdumoulin/conv_arithmetic">here</a>.</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Generative Adversarial Networks(GAN)</title>
      <link href="2021/04/15/generative-adversarial-networks-gan/"/>
      <url>2021/04/15/generative-adversarial-networks-gan/</url>
      
        <content type="html"><![CDATA[<h1 id="Generative-Adversarial-Networks-GAN"><a href="#Generative-Adversarial-Networks-GAN" class="headerlink" title="Generative Adversarial Networks-GAN"></a>Generative Adversarial Networks-GAN</h1><ul><li>本文记录 <code>GAN</code> 学习内容</li></ul><h2 id="The-Excellent-Blog"><a href="#The-Excellent-Blog" class="headerlink" title="The Excellent Blog"></a>The Excellent Blog</h2><ul><li><a href="https://blog.floydhub.com/gans-story-so-far/#dcgan">Generative Adversarial Networks - The Story So Far</a></li></ul><p>We’ll traverse it one step at a time. Let the journey begin.</p><ol><li><a href="https://blog.floydhub.com/gans-story-so-far/#gan">GAN: Generative Adversarial Networks</a></li><li><a href="https://blog.floydhub.com/gans-story-so-far/#dcgan">DCGAN: Deep Convolutional Generative Adversarial Network</a></li><li><a href="https://blog.floydhub.com/gans-story-so-far/#cgan">CGAN: Conditional Generative Adversarial Network</a></li><li><a href="https://blog.floydhub.com/gans-story-so-far/#cyclegan">CycleGAN</a></li><li><a href="https://blog.floydhub.com/gans-story-so-far/#cogan">CoGAN: Coupled Generative Adversarial Networks</a></li><li><a href="https://blog.floydhub.com/gans-story-so-far/#progan">ProGAN: Progressive growing of Generative Adversarial Networks</a></li><li><a href="https://blog.floydhub.com/gans-story-so-far/#wgan">WGAN: Wasserstein Generative Adversarial Networks</a></li><li><a href="https://blog.floydhub.com/gans-story-so-far/#sagan">SAGAN: Self-Attention Generative Adversarial Networks</a></li><li><a href="https://blog.floydhub.com/gans-story-so-far/#biggan">BigGAN: Big Generative Adversarial Networks</a></li><li><a href="https://blog.floydhub.com/gans-story-so-far/#stylegan">StyleGAN: Style-based Generative Adversarial Networks</a></li></ol><h2 id="Other"><a href="#Other" class="headerlink" title="Other"></a>Other</h2><ul><li><p><a href="https://bamos.github.io/2016/08/09/deep-completion/#step-1-interpreting-images-as-samples-from-a-probability-distribution">Image Completion with Deep Learning in TensorFlow</a></p></li><li><p><a href="https://openai.com/blog/generative-models/">Generative Models</a></p></li><li><p><a href="https://wiki.pathmind.com/">A.I. Wiki</a></p></li><li><p><a href="https://www.analyticsvidhya.com/blog/2019/04/top-5-interesting-applications-gans-deep-learning/?utm_source=blog&amp;utm_medium=top_4_GAN_Libraries">Conditional Generative Adversarial Nets in TensorFlow</a></p></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> GAN </tag>
            
            <tag> Deep Learning </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Task2 容器与镜像</title>
      <link href="2021/04/14/task2-rong-qi-yu-jing-xiang/"/>
      <url>2021/04/14/task2-rong-qi-yu-jing-xiang/</url>
      
        <content type="html"><![CDATA[<h1 id="容器与镜像"><a href="#容器与镜像" class="headerlink" title="容器与镜像"></a>容器与镜像</h1><ul><li>该文主要记录 <a href="https://github.com/datawhalechina/team-learning-program/tree/master/Docker"><code>Docker</code></a> 学习内容</li></ul><h2 id="一、Images-and-Containers"><a href="#一、Images-and-Containers" class="headerlink" title="一、Images and Containers"></a>一、Images and Containers</h2><p><strong>Docker 把应用程序及其依赖，打包在 image 文件里面。</strong>只有通过这个文件，才能生成 Docker 容器。image 文件可以看作是容器的模板。Docker 根据 image 文件生成容器的实例。同一个 image 文件，可以生成多个同时运行的容器实例。</p><p>Images 可以独立存在没有 Containers，但是 Containers 不能脱离 Images 独立存在。</p><ul><li>Images</li></ul><p><img src="/2021/04/14/task2-rong-qi-yu-jing-xiang/QQ图片20210111214659.png" alt=""></p><ul><li>Containers</li></ul><p><img src="/2021/04/14/task2-rong-qi-yu-jing-xiang/QQ图片20210111214715.png" alt=""></p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># 列出本机的所有 image 文件。</span>docker image <span class="token function">ls</span><span class="token comment"># 删除 image 文件</span>docker image <span class="token function">rm</span> <span class="token punctuation">[</span>imageName<span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>image 文件是通用的，一台机器的 image 文件拷贝到另一台机器，照样可以使用。一般来说，为了节省时间，我们应该尽量使用别人制作好的 image 文件，而不是自己制作。即使要定制，也应该基于别人的 image 文件进行加工，而不是从零开始制作。</p><p>为了方便共享，image 文件制作完成后，可以上传到网上的仓库。Docker 的官方仓库 <a href="https://hub.docker.com/">Docker Hub</a> 是最重要、最常用的 image 仓库。此外，出售自己制作的 image 文件也是可以的。（这段描述来自阮一峰老师，相关资料会附上原文链接）</p><p>下面是两者的图像表示</p><p><img src="/2021/04/14/task2-rong-qi-yu-jing-xiang/crating-a-docker-container.png" alt=""></p><h2 id="二、项目实践"><a href="#二、项目实践" class="headerlink" title="二、项目实践"></a>二、项目实践</h2><h3 id="实例：官网引导"><a href="#实例：官网引导" class="headerlink" title="实例：官网引导"></a>实例：官网引导</h3><p>类似于新手指引的简单项目：<a href="https://hub.docker.com/">https://hub.docker.com/</a></p><h3 id="实例：hello-world"><a href="#实例：hello-world" class="headerlink" title="实例：hello world"></a>实例：hello world</h3><p>因为这个实例是跟这阮一峰老师的博客学习的，这里就转载一下了</p><p>下面，我们通过最简单的 image 文件”<a href="https://hub.docker.com/r/library/hello-world/">hello world”</a>，感受一下 Docker。</p><p>需要说明的是，国内连接 Docker 的官方仓库很慢，还会断线，需要将默认仓库改成国内的镜像网站，具体的修改方法在<a href="http://www.ruanyifeng.com/blog/2018/02/docker-wordpress-tutorial.html">下一篇文章</a>的第一节。有需要的朋友，可以先看一下。</p><p>首先，运行下面的命令，将 image 文件从仓库抓取到本地。</p><blockquote><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ docker image pull library/hello-world<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>上面代码中，<code>docker image pull</code>是抓取 image 文件的命令。<code>library/hello-world</code>是 image 文件在仓库里面的位置，其中<code>library</code>是 image 文件所在的组，<code>hello-world</code>是 image 文件的名字。</p></blockquote><p>由于 Docker 官方提供的 image 文件，都放在<a href="https://hub.docker.com/r/library/"><code>library</code></a>组里面，所以它的是默认组，可以省略。因此，上面的命令可以写成下面这样。</p><blockquote><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ docker image pull hello-world<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>抓取成功以后，就可以在本机看到这个 image 文件了。</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ docker image <span class="token function">ls</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>现在，运行这个 image 文件。</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ docker container run hello-world<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><code>docker container run</code>命令会从 image 文件，生成一个正在运行的容器实例。</p></blockquote><p>注意，<code>docker container run</code>命令具有自动抓取 image 文件的功能。如果发现本地没有指定的 image 文件，就会从仓库自动抓取。因此，前面的<code>docker image pull</code>命令并不是必需的步骤。</p><p>如果运行成功，你会在屏幕上读到下面的输出。</p><blockquote><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ docker container run hello-worldHello from Docker<span class="token operator">!</span>This message shows that your installation appears to be working correctly.<span class="token punctuation">..</span>. <span class="token punctuation">..</span>.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>输出这段提示以后，<code>hello world</code>就会停止运行，容器自动终止。</p></blockquote><p>有些容器不会自动终止，因为提供的是服务。比如，安装运行 Ubuntu 的 image，就可以在命令行体验 Ubuntu 系统。</p><blockquote><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ docker container run -it ubuntu <span class="token function">bash</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>对于那些不会自动终止的容器，必须使用<a href="https://docs.docker.com/engine/reference/commandline/container_kill/"><code>docker container kill</code></a> 命令手动终止。</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ docker container <span class="token function">kill</span> <span class="token punctuation">[</span>containID<span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></blockquote><h3 id="实例：koa-demos——使用-docker-run-生成-Docker-容器"><a href="#实例：koa-demos——使用-docker-run-生成-Docker-容器" class="headerlink" title="实例：koa-demos——使用 docker run 生成 Docker 容器"></a>实例：koa-demos——使用 docker run 生成 Docker 容器</h3><p>下面我以 <a href="http://www.ruanyifeng.com/blog/2017/08/koa.html">koa-demos</a> 项目为例，介绍怎么写 Dockerfile 文件，实现让用户在 Docker 容器里面运行 Koa 框架。</p><p>作为准备工作，请先<a href="https://github.com/ruanyf/koa-demos/archive/master.zip">下载源码</a>。</p><blockquote><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ <span class="token function">git</span> clone https://github.com/ruanyf/koa-demos.git$ <span class="token builtin class-name">cd</span> koa-demos<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></blockquote><h4 id="编写-Dockerfile-文件"><a href="#编写-Dockerfile-文件" class="headerlink" title="编写 Dockerfile 文件"></a>编写 Dockerfile 文件</h4><p>首先，在项目的根目录下，新建一个文本文件<code>.dockerignore</code>，写入下面的<a href="https://github.com/ruanyf/koa-demos/blob/master/.dockerignore">内容</a>。</p><blockquote><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">.gitnode_modulesnpm-debug.log<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>上面代码表示，这三个路径要排除，不要打包进入 image 文件。如果你没有路径要排除，这个文件可以不新建。</p></blockquote><p>然后，在项目的根目录下，新建一个文本文件 Dockerfile，写入下面的<a href="https://github.com/ruanyf/koa-demos/blob/master/Dockerfile">内容</a>。</p><blockquote><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">FROM node:8.4COPY <span class="token builtin class-name">.</span> /appWORKDIR /appRUN <span class="token function">npm</span> <span class="token function">install</span> --registry<span class="token operator">=</span>https://registry.npm.taobao.orgEXPOSE <span class="token number">3000</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>上面代码一共五行，含义如下。</p><ul><li><code>FROM node:8.4</code>：该 image 文件继承官方的 node image，冒号表示标签，这里标签是<code>8.4</code>，即8.4版本的 node。</li><li><code>COPY . /app</code>：将当前目录下的所有文件（除了<code>.dockerignore</code>排除的路径），都拷贝进入 image 文件的<code>/app</code>目录。</li><li><code>WORKDIR /app</code>：指定接下来的工作路径为<code>/app</code>。</li><li><code>RUN npm install</code>：在<code>/app</code>目录下，运行<code>npm install</code>命令安装依赖。注意，安装后所有的依赖，都将打包进入 image 文件。</li><li><code>EXPOSE 3000</code>：将容器 3000 端口暴露出来， 允许外部连接这个端口。</li></ul></blockquote><h4 id="创建-image-文件"><a href="#创建-image-文件" class="headerlink" title="创建 image 文件"></a>创建 image 文件</h4><p>有了 Dockerfile 文件以后，就可以使用<code>docker image build</code>命令创建 image 文件了。</p><blockquote><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ docker image build -t koa-demo <span class="token builtin class-name">.</span><span class="token comment"># 或者</span>$ docker image build -t koa-demo:0.0.1 <span class="token builtin class-name">.</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>上面代码中，<code>-t</code>参数用来指定 image 文件的名字，后面还可以用冒号指定标签。如果不指定，默认的标签就是<code>latest</code>。最后的那个点表示 Dockerfile 文件所在的路径，上例是当前路径，所以是一个点。</p></blockquote><p>如果运行成功，就可以看到新生成的 image 文件<code>koa-demo</code>了。</p><blockquote><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ docker image <span class="token function">ls</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></blockquote><h4 id="生成容器"><a href="#生成容器" class="headerlink" title="生成容器"></a>生成容器</h4><p><code>docker container run</code>命令会从 image 文件生成容器。</p><blockquote><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ docker container run -p <span class="token number">8000</span>:3000 -it koa-demo /bin/bash<span class="token comment"># 或者</span>$ docker container run -p <span class="token number">8000</span>:3000 -it koa-demo:0.0.1 /bin/bash<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>上面命令的各个参数含义如下：</p><ul><li><code>-p</code>参数：容器的 3000 端口映射到本机的 8000 端口。</li><li><code>-it</code>参数：容器的 Shell 映射到当前的 Shell，然后你在本机窗口输入的命令，就会传入容器。</li><li><code>koa-demo:0.0.1</code>：image 文件的名字（如果有标签，还需要提供标签，默认是 latest 标签）。</li><li><code>/bin/bash</code>：容器启动以后，内部第一个执行的命令。这里是启动 Bash，保证用户可以使用 Shell。</li></ul></blockquote><p>如果一切正常，运行上面的命令以后，就会返回一个命令行提示符。</p><blockquote><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">root@66d80f4aaf1e:/app<span class="token comment">#</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>这表示你已经在容器里面了，返回的提示符就是容器内部的 Shell 提示符。执行下面的命令。</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">root@66d80f4aaf1e:/app<span class="token comment"># node demos/01.js</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>这时，Koa 框架已经运行起来了。打开本机的浏览器，访问 <a href="http://127.0.0.1:8000，网页显示&quot;Not">http://127.0.0.1:8000，网页显示"Not</a> Found”，这是因为这个 <a href="https://github.com/ruanyf/koa-demos/blob/master/demos/01.js">demo</a> 没有写路由。</p></blockquote><p>这个例子中，Node 进程运行在 Docker 容器的虚拟环境里面，进程接触到的文件系统和网络接口都是虚拟的，与本机的文件系统和网络接口是隔离的，因此需要定义容器与物理机的端口映射（map）。</p><p>现在，在容器的命令行，按下 Ctrl + c 停止 Node 进程，然后按下 Ctrl + d （或者输入 exit）退出容器。此外，也可以用<code>docker container kill</code>终止容器运行。</p><blockquote><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># 在本机的另一个终端窗口，查出容器的 ID</span>$ docker container <span class="token function">ls</span><span class="token comment"># 停止指定的容器运行</span>$ docker container <span class="token function">kill</span> <span class="token punctuation">[</span>containerID<span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>容器停止运行之后，并不会消失，用下面的命令删除容器文件。</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># 查出容器的 ID</span>$ docker container <span class="token function">ls</span> --all<span class="token comment"># 删除指定的容器文件</span>$ docker container <span class="token function">rm</span> <span class="token punctuation">[</span>containerID<span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>也可以使用<code>docker container run</code>命令的<code>--rm</code>参数，在容器终止运行后自动删除容器文件。</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ docker container run --rm -p <span class="token number">8000</span>:3000 -it koa-demo /bin/bash<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></blockquote><h4 id="CMD-命令"><a href="#CMD-命令" class="headerlink" title="CMD 命令"></a>CMD 命令</h4><p>上一节的例子里面，容器启动以后，需要手动输入命令<code>node demos/01.js</code>。我们可以把这个命令写在 Dockerfile 里面，这样容器启动以后，这个命令就已经执行了，不用再手动输入了。</p><blockquote><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">FROM node:8.4COPY <span class="token builtin class-name">.</span> /appWORKDIR /appRUN <span class="token function">npm</span> <span class="token function">install</span> --registry<span class="token operator">=</span>https://registry.npm.taobao.orgEXPOSE <span class="token number">3000</span>CMD node demos/01.js<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>上面的 Dockerfile 里面，多了最后一行<code>CMD node demos/01.js</code>，它表示容器启动后自动执行<code>node demos/01.js</code>。</p></blockquote><p>你可能会问，<code>RUN</code>命令与<code>CMD</code>命令的区别在哪里？简单说，<code>RUN</code>命令在 image 文件的构建阶段执行，执行结果都会打包进入 image 文件；<code>CMD</code>命令则是在容器启动后执行。另外，一个 Dockerfile 可以包含多个<code>RUN</code>命令，但是只能有一个<code>CMD</code>命令。</p><p>注意，指定了<code>CMD</code>命令以后，<code>docker container run</code>命令就不能附加命令了（比如前面的<code>/bin/bash</code>），否则它会覆盖<code>CMD</code>命令。现在，启动容器可以使用下面的命令。</p><blockquote><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ docker container run --rm -p <span class="token number">8000</span>:3000 -it koa-demo:0.0.1<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></blockquote><h4 id="发布-image-文件"><a href="#发布-image-文件" class="headerlink" title="发布 image 文件"></a>发布 image 文件</h4><p>容器运行成功后，就确认了 image 文件的有效性。这时，我们就可以考虑把 image 文件分享到网上，让其他人使用。</p><p>首先，去 <a href="https://hub.docker.com/">hub.docker.com</a> 或 <a href="https://cloud.docker.com/">cloud.docker.com</a> 注册一个账户。然后，用下面的命令登录。</p><blockquote><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ docker login<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>接着，为本地的 image 标注用户名和版本。</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ docker image tag <span class="token punctuation">[</span>imageName<span class="token punctuation">]</span> <span class="token punctuation">[</span>username<span class="token punctuation">]</span>/<span class="token punctuation">[</span>repository<span class="token punctuation">]</span>:<span class="token punctuation">[</span>tag<span class="token punctuation">]</span><span class="token comment"># 实例</span>$ docker image tag koa-demos:0.0.1 ruanyf/koa-demos:0.0.1<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>也可以不标注用户名，重新构建一下 image 文件。</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ docker image build -t <span class="token punctuation">[</span>username<span class="token punctuation">]</span>/<span class="token punctuation">[</span>repository<span class="token punctuation">]</span>:<span class="token punctuation">[</span>tag<span class="token punctuation">]</span> <span class="token builtin class-name">.</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>最后，发布 image 文件。</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ docker image push <span class="token punctuation">[</span>username<span class="token punctuation">]</span>/<span class="token punctuation">[</span>repository<span class="token punctuation">]</span>:<span class="token punctuation">[</span>tag<span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>发布成功以后，登录 hub.docker.com，就可以看到已经发布的 image 文件。</p></blockquote><h3 id="实例-：artipub——使用-docker-compose-代替-docker-run"><a href="#实例-：artipub——使用-docker-compose-代替-docker-run" class="headerlink" title="实例 ：artipub——使用 docker-compose 代替 docker run"></a>实例 ：artipub——使用 docker-compose 代替 docker run</h3><p>项目链接：<a href="https://github.com/crawlab-team/artipub">https://github.com/crawlab-team/artipub</a></p><ul><li><p>通过创建 <code>docker-compose.yaml</code> 文件，内容配置见下文</p></li><li><p>然后在命令行中输入如下命令</p><pre class="line-numbers language-none"><code class="language-none">docker-compose up<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li><li>然后在浏览器中输入 <code>http://localhost:8000</code> 可以看到界面。</li></ul><p><img src="/2021/04/14/task2-rong-qi-yu-jing-xiang/QQ截图20210111222839.png" alt=""></p><h4 id="Docker-Compose"><a href="#Docker-Compose" class="headerlink" title="Docker Compose"></a>Docker Compose</h4><h4 id="Compose-简介"><a href="#Compose-简介" class="headerlink" title="Compose 简介"></a>Compose 简介</h4><p>Compose 是用于定义和运行多容器 Docker 应用程序的工具。通过 Compose，我们可以使用 YML 文件来配置应用程序需要的所有服务。然后，使用一个命令，就可以从 YML 文件配置中创建并启动所有服务。如果还不了解 YML 文件配置，可以先阅读<a href="https://www.runoob.com/w3cnote/yaml-intro.html"> YAML 入门教程</a>。</p><p>Compose 使用的三个步骤：</p><ul><li>使用 Dockerfile 定义应用程序的环境。</li><li>使用 docker-compose.yml 定义构成应用程序的服务，这样它们可以在隔离环境中一起运行。</li><li>最后，执行 docker-compose up 命令来启动并运行整个应用程序。</li></ul><h4 id="Compose-安装"><a href="#Compose-安装" class="headerlink" title="Compose 安装"></a>Compose 安装</h4><p>Windows 的 Docker 桌面版和 Docker Toolbox 已经包括 Compose 和其他 Docker 应用程序，因此 Windows 用户不需要单独安装 Compose。Docker 安装说明可以参阅<a href="https://www.runoob.com/docker/windows-docker-install.html"> Windows Docker 安装</a>。</p><p>该项目的 docker-compose.yml 文件</p><pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"><span class="token key atrule">version</span><span class="token punctuation">:</span> <span class="token string">'3.3'</span><span class="token key atrule">services</span><span class="token punctuation">:</span>  <span class="token key atrule">app</span><span class="token punctuation">:</span>    <span class="token key atrule">image</span><span class="token punctuation">:</span> <span class="token string">"tikazyq/artipub:latest"</span>    <span class="token key atrule">environment</span><span class="token punctuation">:</span>      <span class="token key atrule">MONGO_HOST</span><span class="token punctuation">:</span> <span class="token string">"mongo"</span>      <span class="token key atrule">ARTIPUB_API_ADDRESS</span><span class="token punctuation">:</span> <span class="token string">"http://localhost:3000"</span> <span class="token comment"># 后端 API 地址，如果安装地址不在本机，请修改为协议 + 服务器 IP 地址 + 端口号（默认为 3000）</span>    <span class="token key atrule">ports</span><span class="token punctuation">:</span>      <span class="token punctuation">-</span> <span class="token string">"8000:8000"</span> <span class="token comment"># frontend</span>      <span class="token punctuation">-</span> <span class="token string">"3000:3000"</span> <span class="token comment"># backend</span>    <span class="token key atrule">depends_on</span><span class="token punctuation">:</span>      <span class="token punctuation">-</span> mongo  <span class="token key atrule">mongo</span><span class="token punctuation">:</span>    <span class="token key atrule">image</span><span class="token punctuation">:</span> mongo<span class="token punctuation">:</span>latest    <span class="token key atrule">restart</span><span class="token punctuation">:</span> always    <span class="token key atrule">ports</span><span class="token punctuation">:</span>      <span class="token punctuation">-</span> <span class="token string">"27017:27017"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>这里需要格外注意 yml 文件的格式、缩进、是否有空置、数据格式是否符合等问题，如果出现报错（因为已经遇到错误了，源文件是有个值为空），根据报错信息检查对应的问题。</p><p>打开 120.0.0.1:8000</p><p><img src="/2021/04/14/task2-rong-qi-yu-jing-xiang/QQ截图20210111221618.png" alt=""></p><h2 id="相关资料"><a href="#相关资料" class="headerlink" title="相关资料"></a>相关资料</h2><ul><li><p><a href="https://www.ruanyifeng.com/blog/2018/02/docker-tutorial.html">阮一峰 Docker 入门教程</a></p></li><li><p><a href="http://www.ruanyifeng.com/blog/2018/02/docker-wordpress-tutorial.html">阮一峰 Docker 微服务教程</a></p></li><li><p><a href="https://phoenixnap.com/kb/docker-image-vs-container">Docker Image Vs Container: The Major Differences</a></p></li><li><p><a href="https://www.runoob.com/docker/docker-compose.html">Docker Compose</a></p></li><li><p><a href="https://github.com/crawlab-team/artipub">artipub</a></p></li><li><p><a href="https://beginor.github.io/2017/06/08/use-compose-instead-of-run.html">使用 docker-compose 替代 docker run</a></p></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> Docker </tag>
            
            <tag> DataWhale </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Task1 Docker 简介与安装</title>
      <link href="2021/04/12/task1-docker-jian-jie-yu-an-zhuang/"/>
      <url>2021/04/12/task1-docker-jian-jie-yu-an-zhuang/</url>
      
        <content type="html"><![CDATA[<h1 id="Docker-简介与安装"><a href="#Docker-简介与安装" class="headerlink" title="Docker 简介与安装"></a>Docker 简介与安装</h1><ul><li>该文主要记录<a href="https://github.com/datawhalechina/team-learning-program/tree/master/Docker"><code>Docker 学习内容</code></a>学习内容</li></ul><p>Docker 之前就尝试安装过，最初是在自己的笔记本安装的，但是因为 Windows 并不是专业版，导致不能成功安装 docker，然后就逐渐搁置。2020年双十一组装了自己的第一台主机，系统也是 Windows 专业版，因此就把 docker 安装上了。当时对 docker 的印象就是它可以很好地迁移、很好配置环境（指的是不会将本机环境弄混），今天才将 Docker 借助项目实践对其有了基础的操作和认识，使用记录如下。</p><h3 id="一、Docker-是什么"><a href="#一、Docker-是什么" class="headerlink" title="一、Docker 是什么"></a>一、Docker 是什么</h3><p>Docker 属于 Linux 容器的一种封装，提供简单易用的容器使用接口。它是目前最流行的 Linux 容器解决方案。</p><h3 id="二、Docker-的用途"><a href="#二、Docker-的用途" class="headerlink" title="二、Docker 的用途"></a>二、Docker 的用途</h3><p>Docker 的主要用途，目前有三大类。</p><p><strong>（1）提供一次性的环境。</strong>比如，本地测试他人的软件、持续集成的时候提供单元测试和构建的环境。</p><p><strong>（2）提供弹性的云服务。</strong>因为 Docker 容器可以随开随关，很适合动态扩容和缩容。</p><p><strong>（3）组建微服务架构。</strong>通过多个容器，一台机器可以跑多个服务，因此在本机就可以模拟出微服务架构。</p><h3 id="三、Docker安装"><a href="#三、Docker安装" class="headerlink" title="三、Docker安装"></a>三、Docker安装</h3><p>根据官网链接和指引安装即可</p><ul><li><p><a href="https://docs.docker.com/docker-for-mac/install/">Mac</a></p></li><li><p><a href="https://docs.docker.com/docker-for-windows/install/">Windows</a></p></li><li><p><a href="https://docs.docker.com/install/linux/docker-ce/ubuntu/">Ubuntu</a></p></li><li><p><a href="https://docs.docker.com/install/linux/docker-ce/debian/">Debian</a></p></li><li><p><a href="https://docs.docker.com/install/linux/docker-ce/centos/">CentOS</a></p></li><li><p><a href="https://docs.docker.com/install/linux/docker-ce/fedora/">Fedora</a></p></li><li><p><a href="https://docs.docker.com/install/linux/docker-ce/binaries/">其他 Linux 发行版</a></p></li></ul><p>因为我是 Windows 系统，安装完成，打开 CMD 运行</p><pre class="line-numbers language-none"><code class="language-none">docker version<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="四、Images-and-Containers"><a href="#四、Images-and-Containers" class="headerlink" title="四、Images and Containers"></a>四、Images and Containers</h3><p><strong>Docker 把应用程序及其依赖，打包在 image 文件里面。</strong>只有通过这个文件，才能生成 Docker 容器。image 文件可以看作是容器的模板。Docker 根据 image 文件生成容器的实例。同一个 image 文件，可以生成多个同时运行的容器实例。</p><p>Images 可以独立存在没有 Containers，但是 Containers 不能脱离 Images 独立存在。</p><ul><li>Images</li></ul><p><img src="/2021/04/12/task1-docker-jian-jie-yu-an-zhuang/QQ图片20210111214659.png" alt=""></p><ul><li>Containers</li></ul><p><img src="/2021/04/12/task1-docker-jian-jie-yu-an-zhuang/QQ图片20210111214715.png" alt=""></p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># 列出本机的所有 image 文件。</span>docker image <span class="token function">ls</span><span class="token comment"># 删除 image 文件</span>docker image <span class="token function">rm</span> <span class="token punctuation">[</span>imageName<span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>image 文件是通用的，一台机器的 image 文件拷贝到另一台机器，照样可以使用。一般来说，为了节省时间，我们应该尽量使用别人制作好的 image 文件，而不是自己制作。即使要定制，也应该基于别人的 image 文件进行加工，而不是从零开始制作。</p><p>为了方便共享，image 文件制作完成后，可以上传到网上的仓库。Docker 的官方仓库 <a href="https://hub.docker.com/">Docker Hub</a> 是最重要、最常用的 image 仓库。此外，出售自己制作的 image 文件也是可以的。（这段描述来自阮一峰老师，相关资料会附上原文链接）</p><p>下面是两者的图像表示</p><p><img src="/2021/04/12/task1-docker-jian-jie-yu-an-zhuang/crating-a-docker-container.png" alt=""></p><h3 id="五、项目实践"><a href="#五、项目实践" class="headerlink" title="五、项目实践"></a>五、项目实践</h3><h4 id="实例：官网引导"><a href="#实例：官网引导" class="headerlink" title="实例：官网引导"></a>实例：官网引导</h4><p>类似于新手指引的简单项目：<a href="https://hub.docker.com/">https://hub.docker.com/</a></p><h4 id="实例：hello-world"><a href="#实例：hello-world" class="headerlink" title="实例：hello world"></a>实例：hello world</h4><p>因为这个实例是跟这阮一峰老师的博客学习的，这里就转载一下了</p><p>下面，我们通过最简单的 image 文件”<a href="https://hub.docker.com/r/library/hello-world/">hello world”</a>，感受一下 Docker。</p><p>需要说明的是，国内连接 Docker 的官方仓库很慢，还会断线，需要将默认仓库改成国内的镜像网站，具体的修改方法在<a href="http://www.ruanyifeng.com/blog/2018/02/docker-wordpress-tutorial.html">下一篇文章</a>的第一节。有需要的朋友，可以先看一下。</p><p>首先，运行下面的命令，将 image 文件从仓库抓取到本地。</p><blockquote><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ docker image pull library/hello-world<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>上面代码中，<code>docker image pull</code>是抓取 image 文件的命令。<code>library/hello-world</code>是 image 文件在仓库里面的位置，其中<code>library</code>是 image 文件所在的组，<code>hello-world</code>是 image 文件的名字。</p></blockquote><p>由于 Docker 官方提供的 image 文件，都放在<a href="https://hub.docker.com/r/library/"><code>library</code></a>组里面，所以它的是默认组，可以省略。因此，上面的命令可以写成下面这样。</p><blockquote><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ docker image pull hello-world<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>抓取成功以后，就可以在本机看到这个 image 文件了。</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ docker image <span class="token function">ls</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>现在，运行这个 image 文件。</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ docker container run hello-world<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><code>docker container run</code>命令会从 image 文件，生成一个正在运行的容器实例。</p></blockquote><p>注意，<code>docker container run</code>命令具有自动抓取 image 文件的功能。如果发现本地没有指定的 image 文件，就会从仓库自动抓取。因此，前面的<code>docker image pull</code>命令并不是必需的步骤。</p><p>如果运行成功，你会在屏幕上读到下面的输出。</p><blockquote><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ docker container run hello-worldHello from Docker<span class="token operator">!</span>This message shows that your installation appears to be working correctly.<span class="token punctuation">..</span>. <span class="token punctuation">..</span>.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>输出这段提示以后，<code>hello world</code>就会停止运行，容器自动终止。</p></blockquote><p>有些容器不会自动终止，因为提供的是服务。比如，安装运行 Ubuntu 的 image，就可以在命令行体验 Ubuntu 系统。</p><blockquote><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ docker container run -it ubuntu <span class="token function">bash</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>对于那些不会自动终止的容器，必须使用<a href="https://docs.docker.com/engine/reference/commandline/container_kill/"><code>docker container kill</code></a> 命令手动终止。</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ docker container <span class="token function">kill</span> <span class="token punctuation">[</span>containID<span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="实例：koa-demos——使用-docker-run-生成-Docker-容器"><a href="#实例：koa-demos——使用-docker-run-生成-Docker-容器" class="headerlink" title="实例：koa-demos——使用 docker run 生成 Docker 容器"></a>实例：koa-demos——使用 docker run 生成 Docker 容器</h4></blockquote><p>下面我以 <a href="http://www.ruanyifeng.com/blog/2017/08/koa.html">koa-demos</a> 项目为例，介绍怎么写 Dockerfile 文件，实现让用户在 Docker 容器里面运行 Koa 框架。</p><p>作为准备工作，请先<a href="https://github.com/ruanyf/koa-demos/archive/master.zip">下载源码</a>。</p><blockquote><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ <span class="token function">git</span> clone https://github.com/ruanyf/koa-demos.git$ <span class="token builtin class-name">cd</span> koa-demos<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h5 id="编写-Dockerfile-文件"><a href="#编写-Dockerfile-文件" class="headerlink" title="编写 Dockerfile 文件"></a>编写 Dockerfile 文件</h5></blockquote><p>首先，在项目的根目录下，新建一个文本文件<code>.dockerignore</code>，写入下面的<a href="https://github.com/ruanyf/koa-demos/blob/master/.dockerignore">内容</a>。</p><blockquote><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">.gitnode_modulesnpm-debug.log<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>上面代码表示，这三个路径要排除，不要打包进入 image 文件。如果你没有路径要排除，这个文件可以不新建。</p></blockquote><p>然后，在项目的根目录下，新建一个文本文件 Dockerfile，写入下面的<a href="https://github.com/ruanyf/koa-demos/blob/master/Dockerfile">内容</a>。</p><blockquote><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">FROM node:8.4COPY <span class="token builtin class-name">.</span> /appWORKDIR /appRUN <span class="token function">npm</span> <span class="token function">install</span> --registry<span class="token operator">=</span>https://registry.npm.taobao.orgEXPOSE <span class="token number">3000</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>上面代码一共五行，含义如下。</p><ul><li><code>FROM node:8.4</code>：该 image 文件继承官方的 node image，冒号表示标签，这里标签是<code>8.4</code>，即8.4版本的 node。</li><li><code>COPY . /app</code>：将当前目录下的所有文件（除了<code>.dockerignore</code>排除的路径），都拷贝进入 image 文件的<code>/app</code>目录。</li><li><code>WORKDIR /app</code>：指定接下来的工作路径为<code>/app</code>。</li><li><code>RUN npm install</code>：在<code>/app</code>目录下，运行<code>npm install</code>命令安装依赖。注意，安装后所有的依赖，都将打包进入 image 文件。</li><li><code>EXPOSE 3000</code>：将容器 3000 端口暴露出来， 允许外部连接这个端口。</li></ul></blockquote><h5 id="创建-image-文件"><a href="#创建-image-文件" class="headerlink" title="创建 image 文件"></a>创建 image 文件</h5><p>有了 Dockerfile 文件以后，就可以使用<code>docker image build</code>命令创建 image 文件了。</p><blockquote><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ docker image build -t koa-demo <span class="token builtin class-name">.</span><span class="token comment"># 或者</span>$ docker image build -t koa-demo:0.0.1 <span class="token builtin class-name">.</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>上面代码中，<code>-t</code>参数用来指定 image 文件的名字，后面还可以用冒号指定标签。如果不指定，默认的标签就是<code>latest</code>。最后的那个点表示 Dockerfile 文件所在的路径，上例是当前路径，所以是一个点。</p></blockquote><p>如果运行成功，就可以看到新生成的 image 文件<code>koa-demo</code>了。</p><blockquote><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ docker image <span class="token function">ls</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h5 id="生成容器"><a href="#生成容器" class="headerlink" title="生成容器"></a>生成容器</h5></blockquote><p><code>docker container run</code>命令会从 image 文件生成容器。</p><blockquote><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ docker container run -p <span class="token number">8000</span>:3000 -it koa-demo /bin/bash<span class="token comment"># 或者</span>$ docker container run -p <span class="token number">8000</span>:3000 -it koa-demo:0.0.1 /bin/bash<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>上面命令的各个参数含义如下：</p><ul><li><code>-p</code>参数：容器的 3000 端口映射到本机的 8000 端口。</li><li><code>-it</code>参数：容器的 Shell 映射到当前的 Shell，然后你在本机窗口输入的命令，就会传入容器。</li><li><code>koa-demo:0.0.1</code>：image 文件的名字（如果有标签，还需要提供标签，默认是 latest 标签）。</li><li><code>/bin/bash</code>：容器启动以后，内部第一个执行的命令。这里是启动 Bash，保证用户可以使用 Shell。</li></ul></blockquote><p>如果一切正常，运行上面的命令以后，就会返回一个命令行提示符。</p><blockquote><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">root@66d80f4aaf1e:/app<span class="token comment">#</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>这表示你已经在容器里面了，返回的提示符就是容器内部的 Shell 提示符。执行下面的命令。</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">root@66d80f4aaf1e:/app<span class="token comment"># node demos/01.js</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>这时，Koa 框架已经运行起来了。打开本机的浏览器，访问 <a href="http://127.0.0.1:8000，网页显示&quot;Not">http://127.0.0.1:8000，网页显示"Not</a> Found”，这是因为这个 <a href="https://github.com/ruanyf/koa-demos/blob/master/demos/01.js">demo</a> 没有写路由。</p></blockquote><p>这个例子中，Node 进程运行在 Docker 容器的虚拟环境里面，进程接触到的文件系统和网络接口都是虚拟的，与本机的文件系统和网络接口是隔离的，因此需要定义容器与物理机的端口映射（map）。</p><p>现在，在容器的命令行，按下 Ctrl + c 停止 Node 进程，然后按下 Ctrl + d （或者输入 exit）退出容器。此外，也可以用<code>docker container kill</code>终止容器运行。</p><blockquote><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># 在本机的另一个终端窗口，查出容器的 ID</span>$ docker container <span class="token function">ls</span><span class="token comment"># 停止指定的容器运行</span>$ docker container <span class="token function">kill</span> <span class="token punctuation">[</span>containerID<span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>容器停止运行之后，并不会消失，用下面的命令删除容器文件。</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># 查出容器的 ID</span>$ docker container <span class="token function">ls</span> --all<span class="token comment"># 删除指定的容器文件</span>$ docker container <span class="token function">rm</span> <span class="token punctuation">[</span>containerID<span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>也可以使用<code>docker container run</code>命令的<code>--rm</code>参数，在容器终止运行后自动删除容器文件。</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ docker container run --rm -p <span class="token number">8000</span>:3000 -it koa-demo /bin/bash<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h5 id="CMD-命令"><a href="#CMD-命令" class="headerlink" title="CMD 命令"></a>CMD 命令</h5></blockquote><p>上一节的例子里面，容器启动以后，需要手动输入命令<code>node demos/01.js</code>。我们可以把这个命令写在 Dockerfile 里面，这样容器启动以后，这个命令就已经执行了，不用再手动输入了。</p><blockquote><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">FROM node:8.4COPY <span class="token builtin class-name">.</span> /appWORKDIR /appRUN <span class="token function">npm</span> <span class="token function">install</span> --registry<span class="token operator">=</span>https://registry.npm.taobao.orgEXPOSE <span class="token number">3000</span>CMD node demos/01.js<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>上面的 Dockerfile 里面，多了最后一行<code>CMD node demos/01.js</code>，它表示容器启动后自动执行<code>node demos/01.js</code>。</p></blockquote><p>你可能会问，<code>RUN</code>命令与<code>CMD</code>命令的区别在哪里？简单说，<code>RUN</code>命令在 image 文件的构建阶段执行，执行结果都会打包进入 image 文件；<code>CMD</code>命令则是在容器启动后执行。另外，一个 Dockerfile 可以包含多个<code>RUN</code>命令，但是只能有一个<code>CMD</code>命令。</p><p>注意，指定了<code>CMD</code>命令以后，<code>docker container run</code>命令就不能附加命令了（比如前面的<code>/bin/bash</code>），否则它会覆盖<code>CMD</code>命令。现在，启动容器可以使用下面的命令。</p><blockquote><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ docker container run --rm -p <span class="token number">8000</span>:3000 -it koa-demo:0.0.1<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h5 id="发布-image-文件"><a href="#发布-image-文件" class="headerlink" title="发布 image 文件"></a>发布 image 文件</h5></blockquote><p>容器运行成功后，就确认了 image 文件的有效性。这时，我们就可以考虑把 image 文件分享到网上，让其他人使用。</p><p>首先，去 <a href="https://hub.docker.com/">hub.docker.com</a> 或 <a href="https://cloud.docker.com/">cloud.docker.com</a> 注册一个账户。然后，用下面的命令登录。</p><blockquote><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ docker login<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>接着，为本地的 image 标注用户名和版本。</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ docker image tag <span class="token punctuation">[</span>imageName<span class="token punctuation">]</span> <span class="token punctuation">[</span>username<span class="token punctuation">]</span>/<span class="token punctuation">[</span>repository<span class="token punctuation">]</span>:<span class="token punctuation">[</span>tag<span class="token punctuation">]</span><span class="token comment"># 实例</span>$ docker image tag koa-demos:0.0.1 ruanyf/koa-demos:0.0.1<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>也可以不标注用户名，重新构建一下 image 文件。</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ docker image build -t <span class="token punctuation">[</span>username<span class="token punctuation">]</span>/<span class="token punctuation">[</span>repository<span class="token punctuation">]</span>:<span class="token punctuation">[</span>tag<span class="token punctuation">]</span> <span class="token builtin class-name">.</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>最后，发布 image 文件。</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ docker image push <span class="token punctuation">[</span>username<span class="token punctuation">]</span>/<span class="token punctuation">[</span>repository<span class="token punctuation">]</span>:<span class="token punctuation">[</span>tag<span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>发布成功以后，登录 hub.docker.com，就可以看到已经发布的 image 文件。</p></blockquote><h4 id="实例-：artipub——使用-docker-compose-代替-docker-run"><a href="#实例-：artipub——使用-docker-compose-代替-docker-run" class="headerlink" title="实例 ：artipub——使用 docker-compose 代替 docker run"></a>实例 ：artipub——使用 docker-compose 代替 docker run</h4><p>项目链接：<a href="https://github.com/crawlab-team/artipub">https://github.com/crawlab-team/artipub</a></p><ul><li><p>通过创建 <code>docker-compose.yaml</code> 文件，内容配置见下文</p></li><li><p>然后在命令行中输入如下命令</p><pre class="line-numbers language-none"><code class="language-none">docker-compose up<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li><li>然后在浏览器中输入 <code>http://localhost:8000</code> 可以看到界面。</li></ul><p><img src="/2021/04/12/task1-docker-jian-jie-yu-an-zhuang/QQ截图20210111222839.png" alt=""></p><h5 id="Docker-Compose"><a href="#Docker-Compose" class="headerlink" title="Docker Compose"></a>Docker Compose</h5><h6 id="Compose-简介"><a href="#Compose-简介" class="headerlink" title="Compose 简介"></a>Compose 简介</h6><p>Compose 是用于定义和运行多容器 Docker 应用程序的工具。通过 Compose，我们可以使用 YML 文件来配置应用程序需要的所有服务。然后，使用一个命令，就可以从 YML 文件配置中创建并启动所有服务。如果还不了解 YML 文件配置，可以先阅读<a href="https://www.runoob.com/w3cnote/yaml-intro.html"> YAML 入门教程</a>。</p><p>Compose 使用的三个步骤：</p><ul><li>使用 Dockerfile 定义应用程序的环境。</li><li>使用 docker-compose.yml 定义构成应用程序的服务，这样它们可以在隔离环境中一起运行。</li><li>最后，执行 docker-compose up 命令来启动并运行整个应用程序。</li></ul><h6 id="Compose-安装"><a href="#Compose-安装" class="headerlink" title="Compose 安装"></a>Compose 安装</h6><p>Windows 的 Docker 桌面版和 Docker Toolbox 已经包括 Compose 和其他 Docker 应用程序，因此 Windows 用户不需要单独安装 Compose。Docker 安装说明可以参阅<a href="https://www.runoob.com/docker/windows-docker-install.html"> Windows Docker 安装</a>。</p><p>该项目的 docker-compose.yml 文件</p><pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"><span class="token key atrule">version</span><span class="token punctuation">:</span> <span class="token string">'3.3'</span><span class="token key atrule">services</span><span class="token punctuation">:</span>  <span class="token key atrule">app</span><span class="token punctuation">:</span>    <span class="token key atrule">image</span><span class="token punctuation">:</span> <span class="token string">"tikazyq/artipub:latest"</span>    <span class="token key atrule">environment</span><span class="token punctuation">:</span>      <span class="token key atrule">MONGO_HOST</span><span class="token punctuation">:</span> <span class="token string">"mongo"</span>      <span class="token key atrule">ARTIPUB_API_ADDRESS</span><span class="token punctuation">:</span> <span class="token string">"http://localhost:3000"</span> <span class="token comment"># 后端 API 地址，如果安装地址不在本机，请修改为协议 + 服务器 IP 地址 + 端口号（默认为 3000）</span>    <span class="token key atrule">ports</span><span class="token punctuation">:</span>      <span class="token punctuation">-</span> <span class="token string">"8000:8000"</span> <span class="token comment"># frontend</span>      <span class="token punctuation">-</span> <span class="token string">"3000:3000"</span> <span class="token comment"># backend</span>    <span class="token key atrule">depends_on</span><span class="token punctuation">:</span>      <span class="token punctuation">-</span> mongo  <span class="token key atrule">mongo</span><span class="token punctuation">:</span>    <span class="token key atrule">image</span><span class="token punctuation">:</span> mongo<span class="token punctuation">:</span>latest    <span class="token key atrule">restart</span><span class="token punctuation">:</span> always    <span class="token key atrule">ports</span><span class="token punctuation">:</span>      <span class="token punctuation">-</span> <span class="token string">"27017:27017"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>这里需要格外注意 yml 文件的格式、缩进、是否有空置、数据格式是否符合等问题，如果出现报错（因为已经遇到错误了，源文件是有个值为空），根据报错信息检查对应的问题。</p><p>打开 120.0.0.1:8000</p><p><img src="/2021/04/12/task1-docker-jian-jie-yu-an-zhuang/QQ截图20210111221618.png" alt=""></p><h3 id="相关资料"><a href="#相关资料" class="headerlink" title="相关资料"></a>相关资料</h3><ul><li><a href="https://github.com/datawhalechina/team-learning-program/tree/master/Docker">datawhale-Docker</a></li><li><p><a href="https://www.ruanyifeng.com/blog/2018/02/docker-tutorial.html">阮一峰 Docker 入门教程</a></p></li><li><p><a href="http://www.ruanyifeng.com/blog/2018/02/docker-wordpress-tutorial.html">阮一峰 Docker 微服务教程</a></p></li><li><p><a href="https://phoenixnap.com/kb/docker-image-vs-container">Docker Image Vs Container: The Major Differences</a></p></li><li><p><a href="https://www.runoob.com/docker/docker-compose.html">Docker Compose</a></p></li><li><p><a href="https://github.com/crawlab-team/artipub">artipub</a></p></li><li><p><a href="https://beginor.github.io/2017/06/08/use-compose-instead-of-run.html">使用 docker-compose 替代 docker run</a></p></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> Docker </tag>
            
            <tag> DataWhale </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>逻辑回归（LR）</title>
      <link href="2021/04/06/luo-ji-hui-gui-lr/"/>
      <url>2021/04/06/luo-ji-hui-gui-lr/</url>
      
        <content type="html"><![CDATA[<h1 id="逻辑回归（LR）个人学习总结篇"><a href="#逻辑回归（LR）个人学习总结篇" class="headerlink" title="逻辑回归（LR）个人学习总结篇"></a>逻辑回归（LR）个人学习总结篇</h1><ul><li>注本文为转载内容，只是作为学习知识库，方便笔者以后查找，原文链接放在最后</li></ul><h4 id="写作计划："><a href="#写作计划：" class="headerlink" title="写作计划："></a>写作计划：</h4><blockquote><p>线性模型LR(没有考虑特征间的关联)——&gt;LR +多项式模型（特征组合，不适用于特征稀疏场景，泛化能力弱）——&gt;FM（适用于稀疏特征场景*，泛化能力强）——&gt;FFM【省去零值特征，提高FFM模型训练和预测的速度，这也是稀疏样本采用FFM的显著优势】</p></blockquote><h2 id="0-前言"><a href="#0-前言" class="headerlink" title="0.前言"></a>0.前言</h2><p>逻辑回归（LR,Logistic Regression）是传统机器学习中的一种分类模型，由于LR算法具有简单、高效、易于并行且在线学习（动态扩展）的特点，在工业界具有非常广泛的应用。</p><blockquote><p>在线学习算法：LR属于一种在线学习算法，可以利用新的数据对各个特征的权重进行更新，而不需要重新利用历史数据训练。</p></blockquote><p>LR适用于各项广义上的分类任务，例如：评论信息正负情感分析（二分类）、用户点击率（二分类）、用户违约信息预测（二分类）、用户等级分类（多分类 ）等场景。</p><p>实际开发中，一般针对该类任务首先都会构建一个基于LR的模型作为Baseline Model，实现快速上线，然后在此基础上结合后续业务与数据的演进，不断的优化改进！</p><h2 id="1-线性回归模型（Linear-Regression）"><a href="#1-线性回归模型（Linear-Regression）" class="headerlink" title="1.线性回归模型（Linear Regression）"></a>1.线性回归模型（<strong><a href="https://links.jianshu.com/go?to=https%3A%2F%2Fwww.cnblogs.com%2FGuoJiaSheng%2Fp%2F3928160.html">Linear Regression</a></strong>）</h2><p>提到LR，就不得不先从线性回归模型讲起：</p><p>概念：对于多维空间中存在的样本点，我们用特征的线性组合（特征加权）去拟合空间中点的分布和轨迹。</p><p>有监督训练数据集（X,Y），X表示特征，Y表示标签，w表示该某一特征对应的权重，最终的线性模型如hw(x)所示：</p><p><img src="https://upload-images.jianshu.io/upload_images/1803066-081331cc26cd7b1c.png?imageMogr2/auto-orient/strip|imageView2/2/w/690/format/webp" alt="img"></p><p>线性回归模型既可以用于回归，也可以用于分类。</p><ul><li>解决回归问题，可以用于连续目标值的预测。</li><li>但是针对分类问题，该方法则有点不适应，应为线性回归的输出值是不确定范围的，无法很好的一一对应到我们的若干分类中。即便是一个二分类，线性回归+阈值的方式，已经很难完成一个鲁棒性很好的分类器了。</li></ul><p><img src="https://upload-images.jianshu.io/upload_images/1803066-60ad19968ae0a333.png?imageMogr2/auto-orient/strip|imageView2/2/w/562/format/webp" alt="img"></p><p>为了更好的实现分类，逻辑回归诞生了。</p><blockquote><p>[逻辑回归是假设数据服从Bernoulli分布，因此LR属于参数模型]</p></blockquote><h2 id="2-逻辑回归（LR）"><a href="#2-逻辑回归（LR）" class="headerlink" title="2.逻辑回归（LR）"></a>2.逻辑回归（LR）</h2><p>通过在线性回归模型中引入Sigmoid函数，将线性回归的不确定范围的连续输出值映射到（0，1）范围内，成为一个概率预测问题。</p><blockquote><p>可以把LR看作单层的神经网络。</p></blockquote><p>LR目标函数：</p><p><img src="https://upload-images.jianshu.io/upload_images/1803066-25fa907aa2063af6.png?imageMogr2/auto-orient/strip|imageView2/2/w/1066/format/webp" alt="img"></p><p>其中Sigmoid函数g(z)的定义如下：</p><p><img src="https://upload-images.jianshu.io/upload_images/1803066-956f00428accda30.png?imageMogr2/auto-orient/strip|imageView2/2/w/980/format/webp" alt="img"></p><p>Sigmoid函数的函数图像为：</p><p><img src="https://upload-images.jianshu.io/upload_images/1803066-bb13176efafa6a63.png?imageMogr2/auto-orient/strip|imageView2/2/w/628/format/webp" alt="img"></p><p>Sigmoid函数的导数形式：</p><p><img src="https://upload-images.jianshu.io/upload_images/1803066-07d16e81dd755f90.png?imageMogr2/auto-orient/strip|imageView2/2/w/442/format/webp" alt="img"></p><p>整合一下，LR的单个样本的目标函数为：</p><p><img src="https://upload-images.jianshu.io/upload_images/1803066-2c443f2cd959d104.png?imageMogr2/auto-orient/strip|imageView2/2/w/1200/format/webp" alt="img"></p><p>假设有n个独立的训练样本{(x1, y1) ,(x2, y2),…, (xn, yn)}，y={0, 1}。那每一个观察到的样本(xi, yi)出现的概率是：</p><p><img src="https://upload-images.jianshu.io/upload_images/1803066-b6a5714fd1e37654.png?imageMogr2/auto-orient/strip|imageView2/2/w/1082/format/webp" alt="img"></p><blockquote><p>解释一下：<br>当y=1的时候,后面那一项是不是没有了，那就只剩下x属于1类的概率，当y=0的时候，第一项是不是没有了，那就只剩下后面那个x属于0的概率（1减去x属于1的概率）。所以不管y是0还是1，上面得到的数，都是(x, y)出现的概率。</p></blockquote><p><img src="https://upload-images.jianshu.io/upload_images/1803066-55783002f806ce8a.png?imageMogr2/auto-orient/strip|imageView2/2/w/1006/format/webp" alt="img"></p><p>那我们的整个样本集，也就是n个独立的样本出现的似然函数为（因为每个样本都是独立的，所以n个样本出现的概率就是他们各自出现的概率相乘），到整个样本的后验概率：</p><p><img src="https://upload-images.jianshu.io/upload_images/1803066-c15667b33665d507.png?imageMogr2/auto-orient/strip|imageView2/2/w/488/format/webp" alt="img"></p><p>其中：</p><p><img src="https://upload-images.jianshu.io/upload_images/1803066-4a973f9a5354458e.png?imageMogr2/auto-orient/strip|imageView2/2/w/344/format/webp" alt="img"></p><p>通过对数进一步化简为，最终LR的目标函数为：</p><p><img src="https://upload-images.jianshu.io/upload_images/1803066-b5f9bf73dbcc4f85.png?imageMogr2/auto-orient/strip|imageView2/2/w/605/format/webp" alt="img"></p><h3 id="2-1-如何求解模型的参数？"><a href="#2-1-如何求解模型的参数？" class="headerlink" title="2.1.如何求解模型的参数？"></a>2.1.如何求解模型的参数？</h3><p>LR模型的数学形式确定后，剩下就是如何去求解模型中的参数。<br>统计学中常用的一种方法是最大似然估计（MLE），即找到一组参数，使得在这组参数下，我们的数据的似然度（概率）越大。对于该优化问题，存在多种求解方法，这里以梯度下降的为例说明。<br>梯度下降(Gradient Descent)又叫作最速梯度下降，是一种迭代求解的方法，通过在每一步选取使目标函数变化最快的一个方向调整参数的值来逼近最优值。</p><p><img src="https://upload-images.jianshu.io/upload_images/1803066-af85bbfb28f93ddf.png?imageMogr2/auto-orient/strip|imageView2/2/w/906/format/webp" alt="img"></p><hr><h5 id="基本步骤如下："><a href="#基本步骤如下：" class="headerlink" title="基本步骤如下："></a>基本步骤如下：</h5><p>利用链式法对目标函数则进行求导：</p><p><img src="https://upload-images.jianshu.io/upload_images/1803066-c8337079bdfeaf42.png?imageMogr2/auto-orient/strip|imageView2/2/w/1200/format/webp" alt="img"></p><p>其中，一共可以分为三部分分别求导：<br>第一部分：</p><p><img src="https://upload-images.jianshu.io/upload_images/1803066-69bb1f151c76eb17.png?imageMogr2/auto-orient/strip|imageView2/2/w/1200/format/webp" alt="img"></p><p>第二部分：</p><p><img src="https://upload-images.jianshu.io/upload_images/1803066-65a26ade6a999a27.png?imageMogr2/auto-orient/strip|imageView2/2/w/1200/format/webp" alt="img"></p><p>第三部分：</p><p><img src="https://upload-images.jianshu.io/upload_images/1803066-fc7b4d310ccb39b9.png?imageMogr2/auto-orient/strip|imageView2/2/w/1200/format/webp" alt="img"></p><p>最终整体的求导形式：</p><p><img src="https://upload-images.jianshu.io/upload_images/1803066-744085933f7464dd.png?imageMogr2/auto-orient/strip|imageView2/2/w/792/format/webp" alt="img"></p><p>模型参数的更新公式为：</p><p><img src="https://upload-images.jianshu.io/upload_images/1803066-2a2e7a98fdc80ab0.png?imageMogr2/auto-orient/strip|imageView2/2/w/353/format/webp" alt="img"></p><p>沿梯度负方向选择一个较小的步长可以保证损失函数是减小的，另一方面，逻辑回归的损失函数是凸函数（加入正则项后是严格凸函数），可以保证我们找到的局部最优值同时是全局最优。</p><p><img src="https://upload-images.jianshu.io/upload_images/1803066-4fa4ef224732bcff.png?imageMogr2/auto-orient/strip|imageView2/2/w/454/format/webp" alt="img"></p><blockquote><p>此外，常用的凸优化的方法都可以用于求解该问题。例如共轭梯度下降，牛顿法，LBFGS等。</p></blockquote><h3 id="2-2-python实现LR的核心代码片段"><a href="#2-2-python实现LR的核心代码片段" class="headerlink" title="2.2.python实现LR的核心代码片段"></a>2.2.python实现LR的核心代码片段</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># coding:utf-8</span><span class="token triple-quoted-string string">'''Created on Oct 27, 2010Logistic Regression Working Module@author: Peter代码来源：机器学习实战-第五章的源码片段'''</span><span class="token keyword">def</span> <span class="token function">sigmoid</span><span class="token punctuation">(</span>inX<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">return</span> <span class="token number">1.0</span><span class="token operator">/</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">+</span>exp<span class="token punctuation">(</span><span class="token operator">-</span>inX<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">stocGradAscent</span><span class="token punctuation">(</span>dataMatrix<span class="token punctuation">,</span> classLabels<span class="token punctuation">,</span> numIter<span class="token operator">=</span><span class="token number">150</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    m<span class="token punctuation">,</span>n <span class="token operator">=</span> shape<span class="token punctuation">(</span>dataMatrix<span class="token punctuation">)</span>    weights <span class="token operator">=</span> ones<span class="token punctuation">(</span>n<span class="token punctuation">)</span>   <span class="token comment">#initialize to all ones</span>    <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>numIter<span class="token punctuation">)</span><span class="token punctuation">:</span>        dataIndex <span class="token operator">=</span> <span class="token builtin">range</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span>        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">:</span>            alpha <span class="token operator">=</span> <span class="token number">4</span><span class="token operator">/</span><span class="token punctuation">(</span><span class="token number">1.0</span><span class="token operator">+</span>j<span class="token operator">+</span>i<span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">0.0001</span>    <span class="token comment">#apha decreases with iteration, does not </span>            randIndex <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>random<span class="token punctuation">.</span>uniform<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token builtin">len</span><span class="token punctuation">(</span>dataIndex<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">#go to 0 because of the constant</span>            h <span class="token operator">=</span> sigmoid<span class="token punctuation">(</span><span class="token builtin">sum</span><span class="token punctuation">(</span>dataMatrix<span class="token punctuation">[</span>randIndex<span class="token punctuation">]</span><span class="token operator">*</span>weights<span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token comment"># 标签的真实值-预测值</span>            error <span class="token operator">=</span> classLabels<span class="token punctuation">[</span>randIndex<span class="token punctuation">]</span> <span class="token operator">-</span> h            <span class="token comment"># 模型参数更新公式（与我们推导的形式一致）</span>            weights <span class="token operator">=</span> weights <span class="token operator">+</span> alpha <span class="token operator">*</span> error <span class="token operator">*</span> dataMatrix<span class="token punctuation">[</span>randIndex<span class="token punctuation">]</span>            <span class="token keyword">del</span><span class="token punctuation">(</span>dataIndex<span class="token punctuation">[</span>randIndex<span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> weights <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="2-3-模型的优化-引入正则化"><a href="#2-3-模型的优化-引入正则化" class="headerlink" title="2.3.模型的优化-引入正则化"></a>2.3.模型的优化-引入正则化</h3><p>当模型的参数过多时，很容易遇到过拟合的问题。这时就需要有一种方法来控制模型的复杂度，典型的做法在优化目标中加入正则项，通过惩罚过大的参数来防止过拟合.<br>引入正则项的LR目标函数：</p><p><img src="https://upload-images.jianshu.io/upload_images/1803066-4e69985f8b1f8d7f.png?imageMogr2/auto-orient/strip|imageView2/2/w/1026/format/webp" alt="img"></p><p>一般情况下，取p=1或p=2，分别对应L1，L2正则化，两者的区别可以从下图中看出来，L1正则化（左图）倾向于使参数变为0，因此能产生稀疏解。</p><p><img src="https://upload-images.jianshu.io/upload_images/1803066-4dfba9fc0f895918.png?imageMogr2/auto-orient/strip|imageView2/2/w/716/format/webp" alt="img"></p><blockquote><p>实际应用时，由于我们数据的维度可能非常高，L1正则化因为能产生稀疏解，使用的更为广泛一些。</p></blockquote><h2 id="3-LR如何解决多分类问题？"><a href="#3-LR如何解决多分类问题？" class="headerlink" title="3.LR如何解决多分类问题？"></a>3.LR如何解决多分类问题？</h2><p>简言之，把Sigmoid函数换成softmax函数，即可适用于多分类的场景。<br>Softmax 回归是直接对逻辑回归在多分类的推广，相应的模型也可以叫做多元逻辑回归（Multinomial Logistic Regression）。<br>softmax函数为：</p><p><img src="https://upload-images.jianshu.io/upload_images/1803066-900933806785e223.png?imageMogr2/auto-orient/strip|imageView2/2/w/800/format/webp" alt="img"></p><p>整体的目标函数：</p><p><img src="https://upload-images.jianshu.io/upload_images/1803066-91b1ae10ccade5c5.png?imageMogr2/auto-orient/strip|imageView2/2/w/1048/format/webp" alt="img"></p><h5 id="使用softmax的多分类与使用Sigmoid的二分类有什么区别与联系？"><a href="#使用softmax的多分类与使用Sigmoid的二分类有什么区别与联系？" class="headerlink" title="使用softmax的多分类与使用Sigmoid的二分类有什么区别与联系？"></a>使用softmax的多分类与使用Sigmoid的二分类有什么区别与联系？</h5><p><img src="https://upload-images.jianshu.io/upload_images/1803066-f2f47a3af93877a2.png?imageMogr2/auto-orient/strip|imageView2/2/w/1100/format/webp" alt="img"></p><p>通过上面的推导可知，当多分类的K=2时，与使用Sigmoid的二分类是一致的。</p><h3 id="4-LR如何解决线性不可分问题？"><a href="#4-LR如何解决线性不可分问题？" class="headerlink" title="4.LR如何解决线性不可分问题？"></a>4.LR如何解决线性不可分问题？</h3><p>逻辑回归本质上是一个线性模型，但是，这不意味着只有线性可分的数据能通过LR求解，实际上，我们可以通过2种方式帮助LR实现：<br>（1）利用特殊核函数，对特征进行变换：把低维空间转换到高维空间，而在低维空间不可分的数据，到高维空间中线性可分的几率会高一些。<br>（2）扩展LR算法，提出FM算法。</p><hr><h4 id="使用核函数（特征组合映射）"><a href="#使用核函数（特征组合映射）" class="headerlink" title="使用核函数（特征组合映射）"></a>使用核函数（特征组合映射）</h4><p>针对线性不可分的数据集，可以尝试对给定的两个feature做一个多项式特征的映射，例如：</p><p><img src="https://upload-images.jianshu.io/upload_images/1803066-b49e5208edf95e91.png?imageMogr2/auto-orient/strip|imageView2/2/w/504/format/webp" alt="img"></p><p>下面两个图的对比说明了线性分类曲线和非线性分类曲线（通过特征映射）</p><p><img src="https://upload-images.jianshu.io/upload_images/1803066-efca2eb0787fe898.png?imageMogr2/auto-orient/strip|imageView2/2/w/1152/format/webp" alt="img"></p><p>左图是一个线性可分的数据集，右图在原始空间中线性不可分，但是利用核函数，对特征转换 [x1,x2]=&gt;[x1,x2,x21,x22,x1x2]</p><p>后的空间是线性可分的，对应的原始空间中分类边界为一条类椭圆曲线。</p><p><img src="https://upload-images.jianshu.io/upload_images/1803066-1f8cb3a47fd9035a.png?imageMogr2/auto-orient/strip|imageView2/2/w/1200/format/webp" alt="img"></p><p><img src="https://upload-images.jianshu.io/upload_images/1803066-1ed9656d73e786ef.png?imageMogr2/auto-orient/strip|imageView2/2/w/1200/format/webp" alt="img"></p><p>在LR中，我们可以通过在基本线性回归模型的基础上引入交叉项，来实现非线性分类，如下：</p><p><img src="https://upload-images.jianshu.io/upload_images/1803066-4f0070b21ae56b38.png?imageMogr2/auto-orient/strip|imageView2/2/w/1048/format/webp" alt="img"></p><p>但是这种直接在交叉项<strong>xixj</strong>的前面加上交叉项系数<strong>wij</strong>的方式在稀疏数据的情况下存在一个很大的缺陷，即在对于观察样本中未出现交互的特征分量，不能对相应的参数进行估计。<br>即，在数据稀疏性普遍存在的实际应用场景中，二次项参数的训练是很困难的。其原因是，每个参数 <strong>wij</strong>的训练需要大量xi和 xj都非零的样本；由于样本数据本来就比较稀疏，满足xi 和 xj都非零”的样本将会非常少。训练样本的不足，很容易导致参数 <strong>wij</strong> 不准确，最终将严重影响模型的性能。</p><hr><h3 id="为什么特征稀疏？"><a href="#为什么特征稀疏？" class="headerlink" title="为什么特征稀疏？"></a>为什么特征稀疏？</h3><h6 id="one-hote编码带来的问题"><a href="#one-hote编码带来的问题" class="headerlink" title="one-hote编码带来的问题"></a>one-hote编码带来的问题</h6><p>在机器学习中，尤其是计算广告领域，特征并不总是数值型，很多时候是分类值，对于categorical feature，通常会采用one-hot encoding转换成数值型特征，转化过程会产生大量稀疏数据。</p><p><img src="https://upload-images.jianshu.io/upload_images/1803066-17e8daa095dac772.png?imageMogr2/auto-orient/strip|imageView2/2/w/1200/format/webp" alt="img"></p><p>可以这么理解：对于每一个特征，如果它有m个可能取值，那么经过one-hot encoding之后，就变成了m个二元特征，并且，这些特征互斥，每次只有一个激活，因此，数据会变得稀疏。</p><blockquote><p>one-hot编码带来的另一个问题是特征空间变大。同样以上面淘宝上的item为例，将item进行one-hot编码以后，样本空间有一个categorical变为了百万维的数值特征，特征空间一下子暴增一百万。所以大厂动不动上亿维度，就是这么来的。</p></blockquote><p>在工业界，很少直接将连续值（eg.年龄特征）作为逻辑回归模型的特征输入，而是将连续特征离散化为一系列0、1特征交给LR。</p><h5 id="LR为什么要对连续数值特征进行离散化？"><a href="#LR为什么要对连续数值特征进行离散化？" class="headerlink" title="LR为什么要对连续数值特征进行离散化？"></a>LR为什么要对连续数值特征进行离散化？</h5><ol><li>离散特征的增加和减少都很容易，易于模型的快速迭代；</li><li>稀疏向量内积乘法运算速度快，计算结果方便存储，容易扩展；</li><li>离散化后的特征对异常数据有很强的鲁棒性：比如一个特征是年龄&gt;30是1，否则0。如果特征没有离散化，一个异常数据“年龄300岁”会给模型造成很大的干扰；</li><li>逻辑回归属于广义线性模型，表达能力受限；单变量离散化为N个后，每个变量有单独的权重，相当于为模型引入了非线性，能够提升模型表达能力，加大拟合；</li><li>离散化后可以进行特征交叉，由M+N个变量变为M*N个变量，进一步引入非线性，提升表达能力；</li><li>特征离散化后，模型会更稳定，比如如果对用户年龄离散化，20-30作为一个区间，不会因为一个用户年龄长了一岁就变成一个完全不同的人。当然处于区间相邻处的样本会刚好相反，所以怎么划分区间是门学问；</li><li>特征离散化以后，起到了简化了逻辑回归模型的作用，降低了模型过拟合的风险。<br>李沐曾经说过：模型是使用离散特征还是连续特征，其实是一个“海量离散特征+简单模型” 同 “少量连续特征+复杂模型”的权衡。既可以离散化用线性模型，也可以用连续特征加深度学习。就看是喜欢折腾特征还是折腾模型了。通常来说，前者容易，而且可以n个人一起并行做，有成功经验；后者目前看很赞，能走多远还须拭目以待。</li></ol><hr><h4 id="使用FM模型"><a href="#使用FM模型" class="headerlink" title="使用FM模型"></a>使用FM模型</h4><p>另一种方法是对LR进行扩展，因子分解机（Factorization Machine，FM）是对LR算法的扩展。FM模型是一种基于矩阵分解的机器学习模型，对于稀疏数据具有很好的学习能力；<br>对于因子分解机FM来说，最大的特点是对于稀疏的数据具有很好的学习能力。<br>FM解决了LR泛化能力弱的问题，其目标函数如下所示：</p><p><img src="https:////upload-images.jianshu.io/upload_images/1803066-effda793ae441a33.png?imageMogr2/auto-orient/strip|imageView2/2/w/890/format/webp" alt="img"></p><p><img src="https:////upload-images.jianshu.io/upload_images/1803066-254c490e6bbcf8f5.png?imageMogr2/auto-orient/strip|imageView2/2/w/1200/format/webp" alt="img"></p><p><img src="https:////upload-images.jianshu.io/upload_images/1803066-df0f074c83f7673d.png?imageMogr2/auto-orient/strip|imageView2/2/w/1200/format/webp" alt="img"></p><p><strong>上面两张精简的PPT来自于新浪微博AI-Lab的张俊林老师的技术分享。</strong></p><blockquote><p>后续有时间继续从FM—&gt;FFM开始写</p></blockquote><h2 id="5-面试常问题："><a href="#5-面试常问题：" class="headerlink" title="5.面试常问题："></a>5.面试常问题：</h2><p>针对学生党的福利时刻，自己记录的几个有关LR的面试题：</p><h5 id="LR与SVM的联系与区别："><a href="#LR与SVM的联系与区别：" class="headerlink" title="LR与SVM的联系与区别："></a>LR与SVM的联系与区别：</h5><p>联系：<br> 1、LR和SVM都可以处理分类问题，且一般都用于处理线性二分类问题（在改进的情况下可以处理多分类问题）<br> 2、两个方法都可以增加不同的正则化项，如l1、l2等等。所以在很多实验中，两种算法的结果是很接近的。<br> 区别：<br> 1、LR是参数模型[逻辑回归是假设y服从Bernoulli分布]，SVM是非参数模型，LR对异常值更敏感。<br> 2、从目标函数来看，区别在于逻辑回归采用的是logistical loss，SVM采用的是hinge loss，这两个损失函数的目的都是增加对分类影响较大的数据点的权重，减少与分类关系较小的数据点的权重。<br> 3、SVM的处理方法是只考虑support vectors，也就是和分类最相关的少数点，去学习分类器。而逻辑回归通过非线性映射，大大减小了离分类平面较远的点的权重，相对提升了与分类最相关的数据点的权重。<br> 4、逻辑回归相对来说模型更简单，好理解，特别是大规模线性分类时比较方便。而SVM的理解和优化相对来说复杂一些，SVM转化为对偶问题后,分类只需要计算与少数几个支持向量的距离,这个在进行复杂核函数计算时优势很明显,能够大大简化模型和计算。<br> 5、logic 能做的 svm能做，但可能在准确率上有问题，svm能做的logic有的做不了。</p><h5 id="如何选择LR与SVM？"><a href="#如何选择LR与SVM？" class="headerlink" title="如何选择LR与SVM？"></a>如何选择LR与SVM？</h5><p>非线性分类器，低维空间可能很多特征都跑到一起了，导致线性不可分。</p><ol><li>如果Feature的数量很大，跟样本数量差不多，这时候选用LR或者是Linear Kernel的SVM</li><li>如果Feature的数量比较小，样本数量一般，不算大也不算小，选用SVM+Gaussian Kernel</li><li>如果Feature的数量比较小，而样本数量很多，需要手工添加一些feature变成第一种情况。<br> 模型复杂度：SVM支持核函数，可处理线性非线性问题;LR模型简单，训练速度快，适合处理线性问题;决策树容易过拟合，需要进行剪枝<br> 损失函数：SVM hinge loss; LR L2正则化; adaboost 指数损失<br> 数据敏感度：SVM添加容忍度对outlier不敏感，只关心支持向量，且需要先做归一化; LR对远点敏感<br> 数据量：数据量大就用LR，数据量小且特征少就用SVM非线性核</li></ol><h5 id="什么是参数模型（LR）与非参数模型（SVM）？"><a href="#什么是参数模型（LR）与非参数模型（SVM）？" class="headerlink" title="什么是参数模型（LR）与非参数模型（SVM）？"></a>什么是参数模型（LR）与非参数模型（SVM）？</h5><p>在统计学中，参数模型通常假设总体（随机变量）服从某一个分布，该分布由一些参数确定（比如正太分布由均值和方差确定），在此基础上构建的模型称为参数模型；非参数模型对于总体的分布不做任何假设，只是知道总体是一个随机变量，其分布是存在的（分布中也可能存在参数），但是无法知道其分布的形式，更不知道分布的相关参数，只有在给定一些样本的条件下，能够依据非参数统计的方法进行推断。</p><h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><ul><li><a href="https://links.jianshu.com/go?to=https%3A%2F%2Fmp.weixin.qq.com%2Fs%3F__biz%3DMzUxMjk0MDUyMg%3D%3D%26mid%3D2247483665%26idx%3D1%26sn%3D33f2a9115e6925f31fae7051ff5e99a8%26chksm%3Df95d8194ce2a0882cfbccac4bb57149609f7ce76d2f7fbac17395f8ca68e7512de85ea176eec%26token%3D366662885%26lang%3Dzh_CN%23rd">逻辑回归（LR）个人学习总结篇</a></li></ul><p>作者：流川枫AI<br>链接：<a href="https://www.jianshu.com/p/dce9f1af7bc9">https://www.jianshu.com/p/dce9f1af7bc9</a><br>来源：简书<br>著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>大规模数据集读取</title>
      <link href="2021/04/06/da-gui-mo-shu-ju-ji-du-qu/"/>
      <url>2021/04/06/da-gui-mo-shu-ju-ji-du-qu/</url>
      
        <content type="html"><![CDATA[<h1 id="大规模数据集"><a href="#大规模数据集" class="headerlink" title="大规模数据集"></a>大规模数据集</h1><ul><li>注本文为转载内容，只是作为知识库，方便笔者以后查找，原文链接放在最后</li></ul><p><img src="https://static.leiphone.com/uploads/new/sns/article/202011/1605837660804282.png" alt="img"></p><blockquote><p>对数据科学家和Kaggler来说，数据永远不嫌多。</p></blockquote><p>我敢肯定，你在解决某些问题时，一定报怨过没有足够的数据，但偶尔也会抱怨数据量太多难以处理。本文探讨的问题就是对超大规模数据集的处理。</p><p>在数据过多的情况下，最常见的解决方案是根据RAM采样适量数据，但这却浪费了未使用的数据，甚至可能导致信息缺失问题。针对这些问题，研究人员提出多种不同的非子采样方法。需要注意的时，某一方法是无法解决所有问题的，因此在不同情况下要根据具体需求选择恰当的解决方案。</p><p>本文将对一些相关技术进行描述和总结。由于<a href="https://www.kaggle.com/c/riiid-test-answer-prediction">Riiid! Answer Correctness Prediction</a>数据集由10列，超1亿行的数据组成，在Kaggle Notebook中使用pd.read_csv方法读取会导致内存不足，因此本文将该数据集做为典型示例。</p><p>不同安装包读取数据的方式有所不同，Notebook中可用方法包括（默认为Pandas，按字母表排序）：</p><ul><li><a href="https://www.kaggle.com/rohanrao/tutorial-on-reading-large-datasets#Method:-Pandas">Pandas</a></li><li><a href="https://www.kaggle.com/rohanrao/tutorial-on-reading-large-datasets#Method:-Dask">Dask</a></li><li><a href="https://www.kaggle.com/rohanrao/tutorial-on-reading-large-datasets#Method:-Datatable">Datatable</a></li><li><a href="https://www.kaggle.com/rohanrao/tutorial-on-reading-large-datasets#Method:-Rapids">Rapids</a></li></ul><p>除了从csv文件读取数据外，还可以将数据集转换为占有更少磁盘空间、更少内存、读取速度快的其他格式。Notebook可处理的文件类型包括（默认csv，按字母表排序）：</p><ul><li><a href="https://www.kaggle.com/rohanrao/tutorial-on-reading-large-datasets#Format:-csv">csv</a></li><li><a href="https://www.kaggle.com/rohanrao/tutorial-on-reading-large-datasets#Format:-feather">feather</a></li><li><a href="https://www.kaggle.com/rohanrao/tutorial-on-reading-large-datasets#Format:-hdf5">hdf5</a></li><li><a href="https://www.kaggle.com/rohanrao/tutorial-on-reading-large-datasets#Format:-jay">jay</a></li><li><a href="https://www.kaggle.com/rohanrao/tutorial-on-reading-large-datasets#Format:-parquet">parquet</a></li><li><a href="https://www.kaggle.com/rohanrao/tutorial-on-reading-large-datasets#Format:-pickle">pickle</a></li></ul><p>请注意，在实际操作中不单单是读取数据这么简单，还要同时考虑数据的下游任务和应用流程，综合衡量以确定读取方法。本文对此不做过多介绍，读者可自行查阅相关资料。</p><p>同时，你还会发现，对于不同数据集或不同环境，最有效的方法往往是不同的，也就是所，没有哪一种方法就是万能的。</p><p>后续会陆续添加新的数据读取方法。</p><h1 id="方法"><a href="#方法" class="headerlink" title="方法"></a>方法</h1><p>我们首先使用Notebook默认的pandas方法，如前文所述，这样的读取因内存不足失败。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd<span class="token keyword">import</span> dask<span class="token punctuation">.</span>dataframe <span class="token keyword">as</span> dd<span class="token comment"># confirming the default pandas doesn't work (running thebelow code should result in a memory error)</span><span class="token comment"># data = pd.read_csv("../input/riiid-test-answer-prediction/train.csv")</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="Pandas介绍"><a href="#Pandas介绍" class="headerlink" title="Pandas介绍"></a>Pandas介绍</h2><p><img src="https://static.leiphone.com/uploads/new/sns/article/202011/1605837660442324.png" alt="img"></p><p><a href="https://pandas.pydata.org/">Pandas</a>是最常用的数据集读取方法，也是Kaggle的默认方法。Pandas功能丰富、使用灵活，可以很好的读取和处理数据。</p><p>使用pandas读取大型数据集的挑战之一是其保守性，同时推断数据集列的数据类型会导致pandas dataframe占用大量非必要内存。因此，在数据读取时，可以基于先验知识或样品检查预定义列数据的最佳数据类型，避免内存损耗。</p><p>RiiiD竞赛官方提供的数据集读取方法就是如此。</p><p>帮助文档: <a href="https://pandas.pydata.org/docs/">https://pandas.pydata.org/docs/</a></p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token operator">%</span><span class="token operator">%</span>timedtypes <span class="token operator">=</span> <span class="token punctuation">{</span>    <span class="token string">"row_id"</span><span class="token punctuation">:</span> <span class="token string">"int64"</span><span class="token punctuation">,</span>    <span class="token string">"timestamp"</span><span class="token punctuation">:</span> <span class="token string">"int64"</span><span class="token punctuation">,</span>    <span class="token string">"user_id"</span><span class="token punctuation">:</span> <span class="token string">"int32"</span><span class="token punctuation">,</span>    <span class="token string">"content_id"</span><span class="token punctuation">:</span> <span class="token string">"int16"</span><span class="token punctuation">,</span>    <span class="token string">"content_type_id"</span><span class="token punctuation">:</span> <span class="token string">"boolean"</span><span class="token punctuation">,</span>    <span class="token string">"task_container_id"</span><span class="token punctuation">:</span> <span class="token string">"int16"</span><span class="token punctuation">,</span>    <span class="token string">"user_answer"</span><span class="token punctuation">:</span> <span class="token string">"int8"</span><span class="token punctuation">,</span>    <span class="token string">"answered_correctly"</span><span class="token punctuation">:</span> <span class="token string">"int8"</span><span class="token punctuation">,</span>    <span class="token string">"prior_question_elapsed_time"</span><span class="token punctuation">:</span> <span class="token string">"float32"</span><span class="token punctuation">,</span>     <span class="token string">"prior_question_had_explanation"</span><span class="token punctuation">:</span> <span class="token string">"boolean"</span><span class="token punctuation">}</span>data <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">"../input/riiid-test-answer-prediction/train.csv"</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span>dtypes<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Train size:"</span><span class="token punctuation">,</span> data<span class="token punctuation">.</span>shape<span class="token punctuation">)</span>Train size<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token number">101230332</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span>CPU times<span class="token punctuation">:</span> user 8min 11s<span class="token punctuation">,</span> sys<span class="token punctuation">:</span> <span class="token number">10.8</span> s<span class="token punctuation">,</span> total<span class="token punctuation">:</span> 8min 22sWall time<span class="token punctuation">:</span> 8min 22sdata<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://static.leiphone.com/uploads/new/sns/article/202011/1605841856887356.png" alt=""></p><h2 id="Dask介绍"><a href="#Dask介绍" class="headerlink" title="Dask介绍"></a>Dask介绍</h2><p><img src="https://static.leiphone.com/uploads/new/sns/article/202011/1605837660410508.png" alt="img"></p><p>Dask提供并行处理框架对pandas工作流进行扩展，其与Spark具有诸多相似之处。</p><p>帮助文档：<a href="https://docs.dask.org/en/latest/">https://docs.dask.org/en/latest/</a></p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token operator">%</span><span class="token operator">%</span>timedtypes <span class="token operator">=</span> <span class="token punctuation">{</span>    <span class="token string">"row_id"</span><span class="token punctuation">:</span> <span class="token string">"int64"</span><span class="token punctuation">,</span>    <span class="token string">"timestamp"</span><span class="token punctuation">:</span> <span class="token string">"int64"</span><span class="token punctuation">,</span>    <span class="token string">"user_id"</span><span class="token punctuation">:</span> <span class="token string">"int32"</span><span class="token punctuation">,</span>    <span class="token string">"content_id"</span><span class="token punctuation">:</span> <span class="token string">"int16"</span><span class="token punctuation">,</span>    <span class="token string">"content_type_id"</span><span class="token punctuation">:</span> <span class="token string">"boolean"</span><span class="token punctuation">,</span>    <span class="token string">"task_container_id"</span><span class="token punctuation">:</span> <span class="token string">"int16"</span><span class="token punctuation">,</span>    <span class="token string">"user_answer"</span><span class="token punctuation">:</span> <span class="token string">"int8"</span><span class="token punctuation">,</span>    <span class="token string">"answered_correctly"</span><span class="token punctuation">:</span> <span class="token string">"int8"</span><span class="token punctuation">,</span>    <span class="token string">"prior_question_elapsed_time"</span><span class="token punctuation">:</span> <span class="token string">"float32"</span><span class="token punctuation">,</span>     <span class="token string">"prior_question_had_explanation"</span><span class="token punctuation">:</span> <span class="token string">"boolean"</span><span class="token punctuation">}</span>data <span class="token operator">=</span> dd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">"../input/riiid-test-answer-prediction/train.csv"</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span>dtypes<span class="token punctuation">)</span><span class="token punctuation">.</span>compute<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Train size:"</span><span class="token punctuation">,</span> data<span class="token punctuation">.</span>shape<span class="token punctuation">)</span>Train size<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token number">101230332</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span>CPU times<span class="token punctuation">:</span> user 9min 24s<span class="token punctuation">,</span> sys<span class="token punctuation">:</span> <span class="token number">28.8</span> s<span class="token punctuation">,</span> total<span class="token punctuation">:</span> 9min 52sWall time<span class="token punctuation">:</span> 7min 41sdata<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://static.leiphone.com/uploads/new/sns/article/202011/1605841928775871.png" alt=""></p><h2 id="Datatable介绍"><a href="#Datatable介绍" class="headerlink" title="Datatable介绍"></a>Datatable介绍</h2><p><img src="https://static.leiphone.com/uploads/new/sns/article/202011/1605837660789266.png" alt="img"></p><p>受R语言data.table的启发，Python中提出<a href="https://github.com/h2oai/datatable">Datatable</a>，该包可快速读取大型数据集，一般要比pandas快得多。值得注意的是，该包专门用于处理表格数据集，能够快速读取大规模的表格数据集。</p><p>帮助文档：<a href="https://datatable.readthedocs.io/en/latest/index.html">https://datatable.readthedocs.io/en/latest/index.html</a></p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># datatable installation with internet</span><span class="token comment"># !pip install datatable==0.11.0 &gt; /dev/null</span><span class="token comment"># datatable installation without internet!</span>pip install <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">/</span><span class="token builtin">input</span><span class="token operator">/</span>python<span class="token operator">-</span>datatable<span class="token operator">/</span>datatable<span class="token operator">-</span><span class="token number">0.11</span><span class="token number">.0</span><span class="token operator">-</span>cp37<span class="token operator">-</span>cp37m<span class="token operator">-</span>manylinux2010_x86_64<span class="token punctuation">.</span>whl <span class="token operator">&gt;</span> <span class="token operator">/</span>dev<span class="token operator">/</span>null<span class="token keyword">import</span> datatable <span class="token keyword">as</span> dt<span class="token operator">%</span><span class="token operator">%</span>timedata <span class="token operator">=</span> dt<span class="token punctuation">.</span>fread<span class="token punctuation">(</span><span class="token string">"../input/riiid-test-answer-prediction/train.csv"</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Train size:"</span><span class="token punctuation">,</span> data<span class="token punctuation">.</span>shape<span class="token punctuation">)</span>Train size<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token number">101230332</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span>CPU times<span class="token punctuation">:</span> user <span class="token number">52.5</span> s<span class="token punctuation">,</span> sys<span class="token punctuation">:</span> <span class="token number">18.4</span> s<span class="token punctuation">,</span> total<span class="token punctuation">:</span> 1min 10sWall time<span class="token punctuation">:</span> <span class="token number">20.5</span> sdata<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://static.leiphone.com/uploads/new/sns/article/202011/1605842004353888.png" alt="img"></p><p>10 rows × 10 columns</p><h2 id="Rapids介绍"><a href="#Rapids介绍" class="headerlink" title="Rapids介绍"></a>Rapids介绍</h2><p><img src="https://static.leiphone.com/uploads/new/sns/article/202011/1605837660814932.png" alt="img"></p><p><a href="https://rapids.ai/">Rapids</a>提供了在GPU上处理数据的方法。通过将机器学习模型转移到GPU，Rapids可以在一个或多个GPU上构建端到端的数据解决方案。</p><p>帮助文档：<a href="https://docs.rapids.ai/">https://docs.rapids.ai/</a></p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># rapids installation (make sure to turn on GPU)</span><span class="token keyword">import</span> sys!cp <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">/</span><span class="token builtin">input</span><span class="token operator">/</span>rapids<span class="token operator">/</span>rapids<span class="token punctuation">.</span><span class="token number">0.15</span><span class="token number">.0</span> <span class="token operator">/</span>opt<span class="token operator">/</span>conda<span class="token operator">/</span>envs<span class="token operator">/</span>rapids<span class="token punctuation">.</span>tar<span class="token punctuation">.</span>gz!cd <span class="token operator">/</span>opt<span class="token operator">/</span>conda<span class="token operator">/</span>envs<span class="token operator">/</span> <span class="token operator">&amp;</span><span class="token operator">&amp;</span> tar <span class="token operator">-</span>xzvf rapids<span class="token punctuation">.</span>tar<span class="token punctuation">.</span>gz <span class="token operator">&gt;</span> <span class="token operator">/</span>dev<span class="token operator">/</span>nullsys<span class="token punctuation">.</span>path <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"/opt/conda/envs/rapids/lib/Python3.7/site-packages"</span><span class="token punctuation">]</span> <span class="token operator">+</span> sys<span class="token punctuation">.</span>pathsys<span class="token punctuation">.</span>path <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"/opt/conda/envs/rapids/lib/python3.7"</span><span class="token punctuation">]</span> <span class="token operator">+</span> sys<span class="token punctuation">.</span>pathsys<span class="token punctuation">.</span>path <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"/opt/conda/envs/rapids/lib"</span><span class="token punctuation">]</span> <span class="token operator">+</span> sys<span class="token punctuation">.</span>path<span class="token keyword">import</span> cudf<span class="token operator">%</span><span class="token operator">%</span>timedata <span class="token operator">=</span> cudf<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">"../input/riiid-test-answer-prediction/train.csv"</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Train size:"</span><span class="token punctuation">,</span> data<span class="token punctuation">.</span>shape<span class="token punctuation">)</span>Train size<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token number">101230332</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span>CPU times<span class="token punctuation">:</span> user <span class="token number">4.58</span> s<span class="token punctuation">,</span> sys<span class="token punctuation">:</span> <span class="token number">3.31</span> s<span class="token punctuation">,</span> total<span class="token punctuation">:</span> <span class="token number">7.89</span> sWall time<span class="token punctuation">:</span> <span class="token number">30.7</span> sdata<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="https://static.leiphone.com/uploads/new/sns/article/202011/1605842055745285.png" alt=""></p><h1 id="文件格式"><a href="#文件格式" class="headerlink" title="文件格式"></a>文件格式</h1><p>通常，我们会将数据集存储为容易读取、读取速度快或存储容量较小的格式。数据集存储有各种不同的格式，但不是每一种都可以被处理，因此接下来，我们将介绍如何将这些数据集转换为不同的格式。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># data = dt.fread("../input/riiid-test-answer-prediction/train.csv").to_pandas()</span><span class="token comment"># writing dataset as csv</span><span class="token comment"># data.to_csv("riiid_train.csv", index=False)</span><span class="token comment"># writing dataset as hdf5</span><span class="token comment"># data.to_hdf("riiid_train.h5", "riiid_train")</span><span class="token comment"># writing dataset as feather</span><span class="token comment"># data.to_feather("riiid_train.feather")</span><span class="token comment"># writing dataset as parquet</span><span class="token comment"># data.to_parquet("riiid_train.parquet")</span><span class="token comment"># writing dataset as pickle</span><span class="token comment"># data.to_pickle("riiid_train.pkl.gzip")</span><span class="token comment"># writing dataset as jay</span><span class="token comment"># dt.Frame(data).to_jay("riiid_train.jay")</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>数据集的所有格式可从<a href="https://www.kaggle.com/rohanrao/riiid-train-data-multiple-formats">此处</a>获取，不包括竞赛组提供的原始csv数据。</p><h2 id="csv格式"><a href="#csv格式" class="headerlink" title="csv格式"></a>csv格式</h2><p>大多数Kaggle数据集都提供了csv格式文件。该格式几乎成为数据集的标准格式，而且所有方法都支持从csv读取数据。</p><p>更多相关信息见: <a href="https://en.wikipedia.org/wiki/Comma-separated_values">https://en.wikipedia.org/wiki/Comma-separated_values</a></p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token operator">%</span><span class="token operator">%</span>timedtypes <span class="token operator">=</span> <span class="token punctuation">{</span>    <span class="token string">"row_id"</span><span class="token punctuation">:</span> <span class="token string">"int64"</span><span class="token punctuation">,</span>    <span class="token string">"timestamp"</span><span class="token punctuation">:</span> <span class="token string">"int64"</span><span class="token punctuation">,</span>    <span class="token string">"user_id"</span><span class="token punctuation">:</span> <span class="token string">"int32"</span><span class="token punctuation">,</span>    <span class="token string">"content_id"</span><span class="token punctuation">:</span> <span class="token string">"int16"</span><span class="token punctuation">,</span>    <span class="token string">"content_type_id"</span><span class="token punctuation">:</span> <span class="token string">"boolean"</span><span class="token punctuation">,</span>    <span class="token string">"task_container_id"</span><span class="token punctuation">:</span> <span class="token string">"int16"</span><span class="token punctuation">,</span>    <span class="token string">"user_answer"</span><span class="token punctuation">:</span> <span class="token string">"int8"</span><span class="token punctuation">,</span>    <span class="token string">"answered_correctly"</span><span class="token punctuation">:</span> <span class="token string">"int8"</span><span class="token punctuation">,</span>    <span class="token string">"prior_question_elapsed_time"</span><span class="token punctuation">:</span> <span class="token string">"float32"</span><span class="token punctuation">,</span>     <span class="token string">"prior_question_had_explanation"</span><span class="token punctuation">:</span> <span class="token string">"boolean"</span><span class="token punctuation">}</span>data <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">"../input/riiid-test-answer-prediction/train.csv"</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span>dtypes<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Train size:"</span><span class="token punctuation">,</span> data<span class="token punctuation">.</span>shape<span class="token punctuation">)</span>Train size<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token number">101230332</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span>CPU times<span class="token punctuation">:</span> user 8min 36s<span class="token punctuation">,</span> sys<span class="token punctuation">:</span> <span class="token number">11.3</span> s<span class="token punctuation">,</span> total<span class="token punctuation">:</span> 8min 48sWall time<span class="token punctuation">:</span> 8min 49s<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="feather格式"><a href="#feather格式" class="headerlink" title="feather格式"></a>feather格式</h2><p>以feature（二进制）格式存储数据对于pandas极其友好，该格式提供了更快的读取速度。</p><p>了解更多信息：<a href="https://arrow.apache.org/docs/python/feather.html">https://arrow.apache.org/docs/python/feather.html</a></p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token operator">%</span><span class="token operator">%</span>timedata <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_feather<span class="token punctuation">(</span><span class="token string">"../input/riiid-train-data-multiple-formats/riiid_train.feather"</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Train size:"</span><span class="token punctuation">,</span> data<span class="token punctuation">.</span>shape<span class="token punctuation">)</span>Train size<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token number">101230332</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span>CPU times<span class="token punctuation">:</span> user <span class="token number">2.59</span> s<span class="token punctuation">,</span> sys<span class="token punctuation">:</span> <span class="token number">8.91</span> s<span class="token punctuation">,</span> total<span class="token punctuation">:</span> <span class="token number">11.5</span> sWall time<span class="token punctuation">:</span> <span class="token number">5.19</span> s<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="hdf5格式"><a href="#hdf5格式" class="headerlink" title="hdf5格式"></a>hdf5格式</h2><p>HDF5是用于存储、管理和处理大规模数据和复杂数据的高性能数据管理组件。</p><p>了解更多信息：<a href="https://www.hdfgroup.org/solutions/hdf5">https://www.hdfgroup.org/solutions/hdf5</a></p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token operator">%</span><span class="token operator">%</span>timedata <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_hdf<span class="token punctuation">(</span><span class="token string">"../input/riiid-train-data-multiple-formats/riiid_train.h5"</span><span class="token punctuation">,</span> <span class="token string">"riiid_train"</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Train size:"</span><span class="token punctuation">,</span> data<span class="token punctuation">.</span>shape<span class="token punctuation">)</span>Train size<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token number">101230332</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span>CPU times<span class="token punctuation">:</span> user <span class="token number">8.16</span> s<span class="token punctuation">,</span> sys<span class="token punctuation">:</span> <span class="token number">10.7</span> s<span class="token punctuation">,</span> total<span class="token punctuation">:</span> <span class="token number">18.9</span> sWall time<span class="token punctuation">:</span> <span class="token number">19.8</span> s<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="jay格式"><a href="#jay格式" class="headerlink" title="jay格式"></a>jay格式</h2><p>Datatable支持.jay（二进制）格式，其在读取jay格式数据时速度快得超乎想象。从下面的示例可以看到，该方法读取整个riiid数据集用时甚至不到1秒！</p><p>了解更多信息：<a href="https://datatable.readthedocs.io/en/latest/api/frame/to_jay.html">https://datatable.readthedocs.io/en/latest/api/frame/to_jay.html</a></p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token operator">%</span><span class="token operator">%</span>timedata <span class="token operator">=</span> dt<span class="token punctuation">.</span>fread<span class="token punctuation">(</span><span class="token string">"../input/riiid-train-data-multiple-formats/riiid_train.jay"</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Train size:"</span><span class="token punctuation">,</span> data<span class="token punctuation">.</span>shape<span class="token punctuation">)</span>Train size<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token number">101230332</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span>CPU times<span class="token punctuation">:</span> user <span class="token number">4.88</span> ms<span class="token punctuation">,</span> sys<span class="token punctuation">:</span> <span class="token number">7.35</span> ms<span class="token punctuation">,</span> total<span class="token punctuation">:</span> <span class="token number">12.2</span> msWall time<span class="token punctuation">:</span> <span class="token number">38</span> ms<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="parquet格式"><a href="#parquet格式" class="headerlink" title="parquet格式"></a>parquet格式</h2><p>在Hadoop生态系统中，parquet是tabular的主要文件格式，同时还支持Spark。经过近年的发展，该数据格式更加成熟，高效易用，pandas目前也支持了该数据格式。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token operator">%</span><span class="token operator">%</span>timedata <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_parquet<span class="token punctuation">(</span><span class="token string">"../input/riiid-train-data-multiple-formats/riiid_train.parquet"</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Train size:"</span><span class="token punctuation">,</span> data<span class="token punctuation">.</span>shape<span class="token punctuation">)</span>Train size<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token number">101230332</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span>CPU times<span class="token punctuation">:</span> user <span class="token number">29.9</span> s<span class="token punctuation">,</span> sys<span class="token punctuation">:</span> <span class="token number">20.5</span> s<span class="token punctuation">,</span> total<span class="token punctuation">:</span> <span class="token number">50.4</span> sWall time<span class="token punctuation">:</span> <span class="token number">27.3</span> s<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="pickle格式"><a href="#pickle格式" class="headerlink" title="pickle格式"></a>pickle格式</h2><p>Python对象可以以pickle格式存储，pandas内置支持pickle对象的读取和写入。</p><p>了解更多信息：<a href="https://docs.python.org/3/library/pickle.html">https://docs.python.org/3/library/pickle.html</a></p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token operator">%</span><span class="token operator">%</span>timedata <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_pickle<span class="token punctuation">(</span><span class="token string">"../input/riiid-train-data-multiple-formats/riiid_train.pkl.gzip"</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Train size:"</span><span class="token punctuation">,</span> data<span class="token punctuation">.</span>shape<span class="token punctuation">)</span>Train size<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token number">101230332</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span>CPU times<span class="token punctuation">:</span> user <span class="token number">5.65</span> s<span class="token punctuation">,</span> sys<span class="token punctuation">:</span> <span class="token number">7.08</span> s<span class="token punctuation">,</span> total<span class="token punctuation">:</span> <span class="token number">12.7</span> sWall time<span class="token punctuation">:</span> <span class="token number">15</span> s<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="不同方法各有千秋"><a href="#不同方法各有千秋" class="headerlink" title="不同方法各有千秋"></a>不同方法各有千秋</h1><p><img src="https://static.leiphone.com/uploads/new/sns/article/202011/1605837661801506.png" alt="img"></p><p>每种方法都有自己的优缺点，例如：</p><ul><li><strong>Pandas</strong>在处理大规模数据时对RAM的需求增加</li><li><strong>Dask</strong>有时很慢，尤其是在无法并行化的情况下</li><li><strong>Datatable</strong>没有丰富的数据处理功能</li><li><strong>Rapids</strong>只适用于GPU</li></ul><p>因此，希望读者掌握不同的方法，并根据实际需求选择最恰当的方法。我始终相信，研究不是技术驱动的，技术方法只是手段，要有好主意、新想法、改进技术才能推动数据科学的研究与发展。</p><p>在经过大量研究后，我确信不同数据集具有不同的适用方法，因此要多尝试，千万不要试图一招半式闯江湖。</p><blockquote><p>在不断更新的开源软件包和活跃的社区支持下，数据科学必将持续蓬勃发展。</p></blockquote><h1 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h1><ul><li><a href="https://www.yanxishe.com/TextTranslation/3072"><strong>数据太多而无法使用？快试试这个Kaggle大数据集高效访问教程</strong></a></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> kaggle </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Image similarity estimation using a Siamese Network with a triplet loss</title>
      <link href="2021/04/06/image-similarity-estimation-using-a-siamese-network-with-a-triplet-loss/"/>
      <url>2021/04/06/image-similarity-estimation-using-a-siamese-network-with-a-triplet-loss/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Rapids</title>
      <link href="2021/04/06/rapids/"/>
      <url>2021/04/06/rapids/</url>
      
        <content type="html"><![CDATA[<h1 id="Rapids"><a href="#Rapids" class="headerlink" title="Rapids"></a>Rapids</h1><h2 id="RAPIDS定义"><a href="#RAPIDS定义" class="headerlink" title="RAPIDS定义"></a>RAPIDS定义</h2><p>RAPIDS，全称Real-time Acceleration Platform for Integrated Data Science，是NVIDIA针对数据科学和机器学习推出的一套开源GPU加速库，基于CUDA-X AI打造，可加速数据准备、模型训练和图分析。</p><p>使用RAPIDS加速库可以实现从数据准备、模型训练到预测整个端到端流程得到GPU的加速支持，大大提升任务的执行效率，在模型精度方面实现突破的同时降低基础架构TCO。</p><p>CUDNN已经成为GPU加速深度学习框架的标准加速库。RAPIDS（如下图）提供的cuDF、cuML和CuGraph则提供了对数据准备、机器学习算法以及图分析的GPU加速库。</p><p><img src="https://img-blog.csdnimg.cn/20200225194906780.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3NpbmF0XzI2OTE3Mzgz,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><p>RAPIDS支持轻量级大数据框架DASK，使得任务可以获得多GPU、多节点的GPU加速支持。</p><p>RAPIDS以数据准备为起点，引入新型 GPU 数据框架 (cuDF)，进而能实现并行化数据加载和数据操作，充分利用 NVIDIA GPU 上的大型高带宽显存。 cuDF 为数据科学家提供了简单易用且基于 Python 的工具集，可以替换其已十分熟悉的pandas 工具集。数据科学家无需从头学习 NVIDIA CUDA 技术，只需要对现有代码做出极少量更改，便能够大幅提速数据准备，使其不再受限于 CPU 或 CPU 与内存之间的输入输出。</p><p>RAPIDS 还引入了不断发展壮大的全新 GPU 加速 ML 算法(cuML) 库，当中包括 XGBoost 等时下热门算法，以及 Kalman、K-means、 KNN、 DBScan、 PCA、 TSVD、 OLS 线性回归、Kalman Filtering 等算法。 ML 算法可产生大量数据传输，至今仍难以实现并行化。随着 GPU 加速的 ML 和 NVIDIA NVLink™ 以及NVSwitch 架构陆续应用于服务器系统，模型训练现可轻松分布于多个 GPU 和多个节点（系统）之间，几乎不会产生延迟，且能避过 CPU 与内存之间的输入输出瓶颈。</p><p>后续补充…</p><h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><ul><li><a href="https://blog.csdn.net/sinat_26917383/article/details/104504600">nvidia-rapids︱cuDF与pandas一样的DataFrame库</a></li><li><a href="https://blog.csdn.net/sinat_26917383/article/details/104503795">NVIDIA的python-GPU算法生态 ︱ RAPIDS 0.10</a></li><li><a href="https://blog.csdn.net/sinat_26917383/article/details/104505542">nvidia-rapids︱cuML机器学习加速库</a><a href="https://blog.csdn.net/sinat_26917383/article/details/104506332">nvidia-rapids︱cuGraph(NetworkX-like)关系图模型</a></li><li><a href="https://blog.csdn.net/sinat_26917383/article/details/104503795">NVIDIA的python-GPU算法生态 ︱ RAPIDS 0.10</a></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> kaggle </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PHash</title>
      <link href="2021/04/06/phash/"/>
      <url>2021/04/06/phash/</url>
      
        <content type="html"><![CDATA[<h1 id="Perceptual-Hashing"><a href="#Perceptual-Hashing" class="headerlink" title="Perceptual Hashing"></a>Perceptual Hashing</h1><h2 id="Overview"><a href="#Overview" class="headerlink" title="Overview"></a>Overview</h2><p>Perceptual hashing is the name for a class of algorithms that attempts to produce a fingerprint of image data (or other multimedia). Unlike a checkshum or cryptographic hash, though, a perceptual hash is a fuzzy hash – the perceptual hash of two similar images should be similar.</p><p>There are many cases where you might want to do this – digital forensics, copyright enforcement, space reduction in databases, and so on.</p><p>No paper on this (the ones I know of rely on fairly advanced image-processing-specific domain knowledge); instead I asked you to read a couple web pages to give you an overview.</p><p>They all work on something like the same basis: We’re trying to extract and summarize meaningful “features” from the image. Fine details are higher-frequency (more rapid changes pixel-to-pixel), whereas broad features are lower frequency. So the simple methods described in the reading all take advantage of that.</p><h2 id="Average-and-Difference-hashing"><a href="#Average-and-Difference-hashing" class="headerlink" title="Average and Difference hashing"></a>Average and Difference hashing</h2><p>The first pair of algorithms to consider work as follows.</p><p>First, decolorize the image (change to greyscale, extract the Y component, whatever). Now you only have 8 bits per pixel instead of the 24 needed for RGB. Most information humans care about is in this channel, as we saw when we did YCrCb decomposition during our dive into JPEG.</p><p>Then, downsample / scale the image to a smaller size (dependent upon the size of the perceptual hash you want). Let’s say you want a 64-bit hash, then for aHash, 8x8; for dHash, 9x8 (we’ll see why in a moment.</p><p>Now, for aHash: compute the average value of the 64 bytes. Then create a 64-bit hash as follows. For each byte of the image, set the corresponsing bit in the hash to 0 if it’s value is less than the average, or 1 otherwise.</p><p>For dHash: For each of the eight rows in the image, consider each byte. If the byte at position x is less than the byte at position (x+1), set the next bit in the hash equal to 1, otherwise 0. (You need nine values per row to have eight differences per row, hence the 9x8 size).</p><p>”… the resulting hash won’t change if the image is scaled or the aspect ratio changes. Increasing or decreasing the brightness or contrast, or even altering the colors won’t dramatically change the hash value. Even complex adjustments like gamma corrections and color profiles won’t impact the result.”</p><h3 id="DCT-based-hashing"><a href="#DCT-based-hashing" class="headerlink" title="DCT-based hashing"></a>DCT-based hashing</h3><p>Haven’t we seen a way (there are others) to extract the frequencies from an image before? You can do this with a DCT, too! The algorithm proposed here is similar.</p><p>Reduce color and size, as before. But this time have a larger small image (author proposes 32x32). Remember, DCT will let us zero in on the low frequencies – you want to DCT a matrix larger than 8x8 if you ultimately want a 64-bit hash value based on the 64 lower-frequency values post-DCT. Author chose 32x32 as a compromise (DCT does take more time on larger matrices).</p><p>So you have a 32x32 matrix – compute the DCT.</p><p>Then reduce the DCT. The author keeps the upper-left 8x8 values, but this is actually a bad plan for two reasons, only one of which he caught. The first is that the upper-left value is just the solid-color information and should be ignored. The second is that, as you may recall, you probably want to take the upper-left triangle, not square, of values, if what you want is to maximize the low-frequency information you’re collecting.</p><p>Then, it proceeds like aHash – compute the average value of these 64 values, and set the bit in the hash corresponding to each to 0 if it’s less than the average, or 1 otherwise.</p><h3 id="Results"><a href="#Results" class="headerlink" title="Results"></a>Results</h3><p>So, dHash is way better than aHash, just hands down. I speculate this is because it captures features more clearly (local relative changes in brightness) that would bemissed by aHash.</p><p>pHash is better still, but slower. (But the author’s initial implementation was flawed, and pHash does not need to be as slow as it first appeared…)</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> <span class="token keyword">from</span> PIL <span class="token keyword">import</span> Image<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> <span class="token keyword">import</span> imagehash<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> <span class="token builtin">hash</span> <span class="token operator">=</span> imagehash<span class="token punctuation">.</span>average_hash<span class="token punctuation">(</span>Image<span class="token punctuation">.</span><span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'test.png'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">hash</span><span class="token punctuation">)</span>d879f8f89b1bbf<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> otherhash <span class="token operator">=</span> imagehash<span class="token punctuation">.</span>average_hash<span class="token punctuation">(</span>Image<span class="token punctuation">.</span><span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'other.bmp'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> <span class="token keyword">print</span><span class="token punctuation">(</span>otherhash<span class="token punctuation">)</span>ffff3720200ffff<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">hash</span> <span class="token operator">==</span> otherhash<span class="token punctuation">)</span><span class="token boolean">False</span><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">hash</span> <span class="token operator">-</span> otherhash<span class="token punctuation">)</span><span class="token number">36</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><ul><li><a href="https://people.cs.umass.edu/~liberato/courses/2020-spring-compsci590k/">COMPSCI 590K: Advanced Digital Forenics Systems | Spring 2020</a></li><li><a href="https://my.oschina.net/u/347386/blog/500768">phash图像识别应用</a></li><li><a href="https://pypi.org/project/ImageHash/">pypi</a></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> kaggle </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>麦穗理论</title>
      <link href="2021/04/01/mai-sui-li-lun/"/>
      <url>2021/04/01/mai-sui-li-lun/</url>
      
        <content type="html"><![CDATA[<h1 id="麦穗理论"><a href="#麦穗理论" class="headerlink" title="麦穗理论"></a>麦穗理论</h1><blockquote><p>　　有一天，柏拉图问老师苏个拉底什么是爱情?老师就让他先到麦田里去，摘一颗全麦田里最大最金黄的麦穗来。期间只能摘一次，并且期间只能向前走，不能回头。<br>　　柏拉图于是按照老师说的去做了，结果他两手空空的走出了田地。老师问他为什么摘不到？<br>　　他说：“因为只能摘一次，又不能走回头路，期间即使见到最大最金黄的，因为不知前面是否有更好的，所以没有摘。走到前面时，又发觉总不及之前见到的好，原来最大最金黄的麦穗早已错过了。于是我什么也没有摘！”<br>　　老师说：这就是“爱情”。</p><p>　　之后有一天柏拉图问他的老师什么是婚姻？老师就叫他先到树林里，砍下一颗全树林里最大最茂盛的，最适合放在家做圣诞树的树。期间同样只能砍一次，以及同样只能向前走，不能回头。<br>　　于是柏拉图又照着老师的话去做。今次，他带了一颗普普通通，不是很茂盛，也不算太差的树回来。老师问他：怎么带这颗这么普通的树回来？他说：“有了上一次的经验，当我走到大半路程还两手空空时，看到这颗树也不太差，便砍了下来，免得错过了后，最后有什么也带不回来。”<br>　　老师说：“这就是婚姻！”</p></blockquote><h2 id="数学求解"><a href="#数学求解" class="headerlink" title="数学求解"></a>数学求解</h2><p>从数学角度讨论这一问题：</p><p>假设整个麦田的长度为 n 米，我们采用的策略是：前 k 米，记住最大的麦穗为 M，然后从 k+1 米开始，只要出现大于 M 的麦穗就选择，否则不选择。（因为麦穗并不连续，所以这里没有用连续的长度，从 k 米后开始）</p><p>假设最大的麦穗在第 $i$ 米，如果想让我们挑选到，那就需要满足</p><script type="math/tex; mode=display">k<i \leq n</script><p>不仅仅需要最大的麦穗出现在 k 后面，还需要满足，前 $i-1$ 米中最好的麦穗出现在前 k 米，这有$k/(i-1)$种可能。考虑所有可能的 $i$ 我们得到一个能选中最大麦穗概率的总概率 $P(k)$ </p><script type="math/tex; mode=display">P(k)=\sum_{i=k+1}^{n} \frac{1}{n} \frac{k}{i-1}=\frac{k}{n} \sum_{i=k}^{n-1} \frac{1}{i}\approx \frac{k}{n} \int_{k}^{n} \frac{1}{x} \mathrm{~d} x</script><p>令 $x=k/n$，假设 $n$ 远大于 $k$，原式改写为</p><script type="math/tex; mode=display">P(k)=\frac{k}{n}(\ln (n)-\ln (k))=\frac{k}{n} \ln \left(\frac{n}{k}\right)=-x\ln(x)</script><p>对 $-x \ln (x)$求导，求极值</p><script type="math/tex; mode=display">x=\frac{1}{e}</script><p>即：</p><script type="math/tex; mode=display">k=\frac{n}{e}</script><p>如果你想摘取最大的麦穗，假设麦田长度为 n 米，应该先将前 n/e 米内的麦穗作为参考，然后在 k+1 米后开始选择比前面 k 米中最大的麦穗即可。</p><p>e = 2.718281828459，1/e = 0.36787944117144</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>计算机网络复习</title>
      <link href="2021/03/31/ji-suan-ji-wang-luo-fu-xi/"/>
      <url>2021/03/31/ji-suan-ji-wang-luo-fu-xi/</url>
      
        <content type="html"><![CDATA[<h1 id="计算机网络"><a href="#计算机网络" class="headerlink" title="计算机网络"></a>计算机网络</h1><ul><li>本文为转载记录，不断补充，原链接见参考资料</li></ul><h3 id="什么是网络协议，为什么要对网络协议分层-＊"><a href="#什么是网络协议，为什么要对网络协议分层-＊" class="headerlink" title="什么是网络协议，为什么要对网络协议分层　＊"></a>什么是网络协议，为什么要对网络协议分层　＊</h3><p>网络协议是计算机在通信过程中要遵循的一些约定好的规则。</p><p>网络分层的原因：</p><ul><li>易于实现和维护，因为各层之间是独立的，层与层之间不会收到影响。</li><li>有利于标准化的制定</li></ul><h3 id="计算机网络的各层协议及作用-＊＊＊"><a href="#计算机网络的各层协议及作用-＊＊＊" class="headerlink" title="计算机网络的各层协议及作用　＊＊＊"></a>计算机网络的各层协议及作用　＊＊＊</h3><blockquote><p>计算机网络体系可以大致分为一下三种，七层模型、五层模型和TCP/IP四层模型，一般面试能流畅回答出五层模型就可以了，表示层和会话层被问到的不多。</p></blockquote><p><img src="https://segmentfault.com/img/remote/1460000038526735" alt=""></p><ul><li><p>应用层</p><p>应用层的任务是通过应用进程之间的交互来完成特定的网络作用，常见的应用层协议有域名系统DNS，HTTP协议等。</p></li><li><p>表示层</p><p>表示层的主要作用是数据的表示、安全、压缩。可确保一个系统的应用层所发送的信息可以被另一个系统的应用层读取。</p></li><li><p>会话层</p><p>会话层的主要作用是建立通信链接，保持会话过程通信链接的畅通，同步两个节点之间的对话，决定通信是否被中断以及通信中断时决定从何处重新发送。。</p></li><li><p>传输层</p><p>传输层的主要作用是负责向两台主机进程之间的通信提供数据传输服务。传输层的协议主要有传输控制协议TCP和用户数据协议UDP。</p></li><li><p>网络层</p><p>网络层的主要作用是选择合适的网间路由和交换结点，确保数据及时送达。常见的协议有IP协议。</p></li><li><p>数据链路层</p><p>数据链路层的作用是在物理层提供比特流服务的基础上，建立相邻结点之间的数据链路，通过差错控制提供数据帧（Frame）在信道上无差错的传输，并进行各电路上的动作系列。 常见的协议有SDLC、HDLC、PPP等。</p></li><li><p>物理层</p><p>物理层的主要作用是实现相邻计算机结点之间比特流的透明传输，并尽量屏蔽掉具体传输介质和物理设备的差异。</p></li></ul><h3 id="URI和URL的区别-＊"><a href="#URI和URL的区别-＊" class="headerlink" title="URI和URL的区别　＊"></a>URI和URL的区别　＊</h3><ul><li>URI(Uniform Resource Identifier)：中文全称为统一资源标志符，主要作用是唯一标识一个资源。</li><li>URL(Uniform Resource Location)：中文全称为统一资源定位符，主要作用是提供资源的路径。</li></ul><p>有个经典的比喻是URI像是身份证，可以唯一标识一个人，而URL更像一个住址，可以通过URL找到这个人。</p><h3 id="DNS的工作流程-＊＊＊"><a href="#DNS的工作流程-＊＊＊" class="headerlink" title="DNS的工作流程　＊＊＊"></a>DNS的工作流程　＊＊＊</h3><p>DNS的定义：DNS的全称是domain name system，即域名系统。DNS是因特网上作为域名和IP地址相互映射的一个分布式数据库，能够使用户更方便的去访问互联网而不用去记住能够被机器直接读取的IP地址。比如大家访问百度，更多地肯定是访问www.baidu.com，而不是访问112.80.248.74，因为这几乎无规则的IP地址实在太难记了。DNS要做的就是将www.baidu.com解析成112.80.248.74。</p><p><strong>DNS是集群式的工作方式还是 单点式的，为什么？</strong></p><p> 答案是集群式的，很容易想到的一个方案就是只用一个DNS服务器，包含了所有域名和IP地址的映射。尽管这种设计方式看起来很简单，但是缺点显而易见，如果这个唯一的DNS服务器出了故障，那么就全完了，因特网就几乎崩了。为了避免这种情况出现，DNS系统采用的是分布式的层次数据数据库模式，还有缓存的机制也能解决这种问题。</p><p><strong>DNS的工作流程</strong></p><blockquote><p>主机向本地域名服务器的查询一般是采用递归查询，而本地域名服务器向根域名的查询一般是采用迭代查询。</p><p>递归查询主机向本地域名发送查询请求报文，而本地域名服务器不知道该域名对应的IP地址时，本地域名会继续向根域名发送查询请求报文，不是通知主机自己向根域名发送查询请求报文。迭代查询是，本地域名服务器向根域名发出查询请求报文后，根域名不会继续向顶级域名服务器发送查询请求报文，而是通知本地域名服务器向顶级域名发送查询请求报文。</p><p>简单来说，递归查询就是，小明问了小红一个问题，小红不知道，但小红是个热心肠，小红就去问小王了，小王把答案告诉小红后，小红又去把答案告诉了小明。迭代查询就是，小明问了小红一个问题，小红也不知道，然后小红让小明去问小王，小明又去问小王了，小王把答案告诉了小明。</p></blockquote><ol><li>在浏览器中输入www.baidu.com域名，操作系统会先检查自己本地的hosts文件是否有这个域名的映射关系，如果有，就先调用这个IP地址映射，完成域名解析。</li><li>如果hosts文件中没有，则查询本地DNS解析器缓存，如果有，则完成地址解析。</li><li>如果本地DNS解析器缓存中没有，则去查找本地DNS服务器，如果查到，完成解析。</li><li>如果没有，则本地服务器会向根域名服务器发起查询请求。根域名服务器会告诉本地域名服务器去查询哪个顶级域名服务器。</li><li>本地域名服务器向顶级域名服务器发起查询请求，顶级域名服务器会告诉本地域名服务器去查找哪个权限域名服务器。</li><li>本地域名服务器向权限域名服务器发起查询请求，权限域名服务器告诉本地域名服务器www.baidu.com所对应的IP地址。</li><li>本地域名服务器告诉主机www.baidu.com所对应的IP地址。</li></ol><h3 id="了解ARP协议吗-＊＊"><a href="#了解ARP协议吗-＊＊" class="headerlink" title="了解ARP协议吗?　＊＊"></a>了解ARP协议吗?　＊＊</h3><p>ARP协议属于网络层的协议，主要作用是实现从IP地址转换为MAC地址。在每个主机或者路由器中都建有一个ARP缓存表，表中有IP地址及IP地址对应的MAC地址。先来看一下什么时IP地址和MAC地址。</p><ul><li>IP地址：IP地址是指互联网协议地址，IP地址是IP协议提供的一种统一的地址格式，它为互联网上的每一个网络和每一台主机分配一个逻辑地址，以此来屏蔽物理地址的差异。</li><li>MAC地址：MAC地址又称物理地址，由网络设备制造商生产时写在硬件内部，不可更改，并且每个以太网设备的MAC地址都是唯一的。</li></ul><p>数据在传输过程中，会先从高层传到底层，然后在通信链路上传输。从下图可以看到TCP报文在网络层会被封装成IP数据报，在数据链路层被封装成MAC帧，然后在通信链路中传输。在网络层使用的是IP地址，在数据据链路层使用的是MAC地址。MAC帧在传送时的源地址和目的地址使用的都是MAC地址，在通信链路上的主机或路由器也都是根据MAC帧首部的MAC地址接收MAC帧。并且在数据链路层是看不到IP地址的，只有当数据传到网络层时去掉MAC帧的首部和尾部时才能在IP数据报的首部中找到源IP地址和目的地址。</p><p><img src="https://segmentfault.com/img/remote/1460000038526732" alt=""></p><p>网络层实现的是主机之间的通信，而链路层实现的是链路之间的通信，所以从下图可以看出，在数据传输过程中，IP数据报的源地址(IP1)和目的地址(IP2)是一直不变的，而MAC地址(硬件地址)却一直随着链路的改变而改变。</p><p><img src="https://segmentfault.com/img/remote/1460000038526738" alt=""></p><p>ARP的工作流程(面试时问ARP协议主要说这个就可以了)：</p><ol><li>在局域网内，主机A要向主机B发送IP数据报时，首先会在主机A的ARP缓存表中查找是否有IP地址及其对应的MAC地址，如果有，则将MAC地址写入到MAC帧的首部，并通过局域网将该MAC帧发送到MAC地址所在的主机B。</li><li>如果主机A的ARP缓存表中没有主机B的IP地址及所对应的MAC地址，主机A会在局域网内广播发送一个ARP请求分组。局域网内的所有主机都会收到这个ARP请求分组。</li><li>主机B在看到主机A发送的ARP请求分组中有自己的IP地址，会像主机A以单播的方式发送一个带有自己MAC地址的响应分组。</li><li>主机A收到主机B的ARP响应分组后，会在ARP缓存表中写入主机B的IP地址及其IP地址对应的MAC地址。</li><li>如果主机A和主机B不在同一个局域网内，即使知道主机B的MAC地址也是不能直接通信的，必须通过路由器转发到主机B的局域网才可以通过主机B的MAC地址找到主机B。并且主机A和主机B已经可以通信的情况下，主机A的ARP缓存表中寸的并不是主机B的IP地址及主机B的MAC地址，而是主机B的IP地址及该通信链路上的下一跳路由器的MAC地址。这就是上图中的源IP地址和目的IP地址一直不变，而MAC地址却随着链路的不同而改变。</li><li>如果主机A和主机B不在同一个局域网，参考上图中的主机H1和主机H2，这时主机H1需要先广播找到路由器R1的MAC地址，再由R1广播找到路由器R2的MAC地址，最后R2广播找到主机H2的MAC地址，建立起通信链路。</li></ol><h3 id="有了IP地址，为什么还要用MAC地址？-＊＊"><a href="#有了IP地址，为什么还要用MAC地址？-＊＊" class="headerlink" title="有了IP地址，为什么还要用MAC地址？　＊＊"></a>有了IP地址，为什么还要用MAC地址？　＊＊</h3><blockquote><p>简单来说，标识网络中的一台计算机，比较常用的就是IP地址和MAC地址，但计算机的IP地址可由用户自行更改，管理起来相对困难，而MAC地址不可更改，所以一般会把IP地址和MAC地址组合起来使用。具体是如何组合使用的在上面的ARP协议中已经讲的很清楚了。</p><p>那只用MAC地址不用IP地址可不可以呢？其实也是不行的，因为在最早就是MAC地址先出现的，并且当时并不用IP地址，只用MAC地址，后来随着网络中的设备越来越多，整个路由过程越来越复杂，便出现了子网的概念。对于目的地址在其他子网的数据包，路由只需要将数据包送到那个子网即可，这个过程就是上面说的ARP协议。</p><p>那为什么要用IP地址呢？是因为IP地址是和地域相关的，对于同一个子网上的设备，IP地址的前缀都是一样的，这样路由器通过IP地址的前缀就知道设备在在哪个子网上了，而只用MAC地址的话，路由器则需要记住每个MAC地址在哪个子网，这需要路由器有极大的存储空间，是无法实现的。</p><p>IP地址可以比作为地址，MAC地址为收件人，在一次通信过程中，两者是缺一不可的。</p></blockquote><h3 id="说一下ping的过程-＊＊"><a href="#说一下ping的过程-＊＊" class="headerlink" title="说一下ping的过程　＊＊"></a>说一下ping的过程　＊＊</h3><p>ping是ICMP(网际控制报文协议)中的一个重要应用，ICMP是网络层的协议。ping的作用是测试两个主机的连通性。</p><p>ping的工作过程：</p><ol><li>向目的主机发送多个ICMP回送请求报文</li><li>根据目的主机返回的回送报文的时间和成功响应的次数估算出数据包往返时间及丢包率。</li></ol><h3 id="路由器和交换机的区别？-＊"><a href="#路由器和交换机的区别？-＊" class="headerlink" title="路由器和交换机的区别？　＊"></a>路由器和交换机的区别？　＊</h3><div class="table-container"><table><thead><tr><th style="text-align:center"></th><th style="text-align:center">所属网络模型的层级</th><th style="text-align:center">功能</th></tr></thead><tbody><tr><td style="text-align:center">路由器</td><td style="text-align:center">网络层</td><td style="text-align:center">识别IP地址并根据IP地址转发数据包，维护数据表并基于数据表进行最佳路径选择</td></tr><tr><td style="text-align:center">交换机</td><td style="text-align:center">数据链库层</td><td style="text-align:center">识别MAC地址并根据MAC地址转发数据帧</td></tr></tbody></table></div><h3 id="TCP与UDP有什么区别-＊＊＊"><a href="#TCP与UDP有什么区别-＊＊＊" class="headerlink" title="TCP与UDP有什么区别　＊＊＊"></a>TCP与UDP有什么区别　＊＊＊</h3><div class="table-container"><table><thead><tr><th style="text-align:center"></th><th style="text-align:center">是否面向连接</th><th style="text-align:center">可靠性</th><th style="text-align:center">传输形式</th><th style="text-align:center">传输效率</th><th style="text-align:center">消耗资源</th><th style="text-align:center">应用场景</th><th style="text-align:center">首部字节</th></tr></thead><tbody><tr><td style="text-align:center">TCP</td><td style="text-align:center">面向连接</td><td style="text-align:center">可靠</td><td style="text-align:center">字节流</td><td style="text-align:center">慢</td><td style="text-align:center">多</td><td style="text-align:center">文件/邮件传输</td><td style="text-align:center">20~60</td></tr><tr><td style="text-align:center">UDP</td><td style="text-align:center">无连接</td><td style="text-align:center">不可靠</td><td style="text-align:center">数据报文段</td><td style="text-align:center">快</td><td style="text-align:center">少</td><td style="text-align:center">视频/语音传输</td><td style="text-align:center">8</td></tr></tbody></table></div><blockquote><p>有时候面试还会问到TCP的首部都包含什么</p></blockquote><ul><li><p>TCP首部(图片来源于网络)：</p><p>前20个字节是固定的，后面有4n个字节是根据需而增加的选项，所以TCP首部最小长度为20字节。</p></li></ul><p><img src="https://segmentfault.com/img/remote/1460000038526734" alt=""></p><ul><li><p>UDP首部(图片来源于网络)：</p><p>UDP的首部只有8个字节，源端口号、目的端口号、长度和校验和各两个字节。</p></li></ul><p><img src="https://segmentfault.com/img/remote/1460000038526736" alt=""></p><h3 id="TCP协议如何保证可靠传输-＊＊＊"><a href="#TCP协议如何保证可靠传输-＊＊＊" class="headerlink" title="TCP协议如何保证可靠传输　＊＊＊"></a>TCP协议如何保证可靠传输　＊＊＊</h3><blockquote><p>主要有校验和、序列号、超时重传、流量控制及拥塞避免等几种方法。</p></blockquote><ul><li>校验和：在发送算和接收端分别计算数据的校验和，如果两者不一致，则说明数据在传输过程中出现了差错，TCP将丢弃和不确认此报文段。</li><li>序列号：TCP会对每一个发送的字节进行编号，接收方接到数据后，会对发送方发送确认应答(ACK报文)，并且这个ACK报文中带有相应的确认编号，告诉发送方，下一次发送的数据从编号多少开始发。如果发送方发送相同的数据，接收端也可以通过序列号判断出，直接将数据丢弃。如果</li></ul><p><img src="https://segmentfault.com/img/remote/1460000038526737" alt=""></p><ul><li><p>超时重传：在上面说了序列号的作用，但如果发送方在发送数据后一段时间内（可以设置重传计时器规定这段时间）没有收到确认序号ACK，那么发送方就会重新发送数据。</p><p>这里发送方没有收到ACK可以分两种情况，如果是发送方发送的数据包丢失了，接收方收到发送方重新发送的数据包后会马上给发送方发送ACK；如果是接收方之前接收到了发送方发送的数据包，而返回给发送方的ACK丢失了，这种情况，发送方重传后，接收方会直接丢弃发送方冲重传的数据包，然后再次发送ACK响应报文。</p><p>如果数据被重发之后还是没有收到接收方的确认应答，则进行再次发送。此时，等待确认应答的时间将会以2倍、4倍的指数函数延长，直到最后关闭连接。</p></li><li><p>流量控制：如果发送端发送的数据太快，接收端来不及接收就会出现丢包问题。为了解决这个问题，TCP协议利用了滑动窗口进行了流量控制。在TCP首部有一个16位字段大小的窗口，窗口的大小就是接收端接收数据缓冲区的剩余大小。接收端会在收到数据包后发送ACK报文时，将自己的窗口大小填入ACK中，发送方会根据ACK报文中的窗口大小进而控制发送速度。如果窗口大小为零，发送方会停止发送数据。</p></li><li><p>拥塞控制：如果网络出现拥塞，则会产生丢包等问题，这时发送方会将丢失的数据包继续重传，网络拥塞会更加严重，所以在网络出现拥塞时应注意控制发送方的发送数据，降低整个网络的拥塞程度。拥塞控制主要有四部分组成：慢开始、拥塞避免、快重传、快恢复，如下图(图片来源于网络)。</p><p><img src="https://segmentfault.com/img/remote/1460000038526742" alt=""></p></li></ul><p>这里的发送方会维护一个拥塞窗口的状态变量，它和流量控制的滑动窗口是不一样的，滑动窗口是根据接收方数据缓冲区大小确定的，而拥塞窗口是根据网络的拥塞情况动态确定的，一般来说发送方真实的发送窗口为滑动窗口和拥塞窗口中的最小值。</p><ol><li><p>慢开始：为了避免一开始发送大量的数据而产生网络阻塞，会先初始化cwnd为1，当收到ACK后到下一个传输轮次，cwnd为2，以此类推成指数形式增长。</p></li><li><p>拥塞避免：因为cwnd的数量在慢开始是指数增长的，为了防止cwnd数量过大而导致网络阻塞，会设置一个慢开始的门限值ssthresh，当cwnd&gt;=ssthresh时，进入到拥塞避免阶段，cwnd每个传输轮次加1。但网络出现超时，会将门限值ssthresh变为出现超时cwnd数值的一半，cwnd重新设置为1，如上图，在第12轮出现超时后，cwnd变为1，ssthresh变为12。</p></li><li><p>快重传：在网络中如果出现超时或者阻塞，则按慢开始和拥塞避免算法进行调整。但如果只是丢失某一个报文段，如下图(图片来源于网络)，则使用快重传算法。</p><p><img src="https://segmentfault.com/img/remote/1460000038526741" alt=""></p></li></ol><p>从上图可知，接收方正确地接收到M1和M2，而M3丢失，由于没有接收到M3，在接收方收到M5、M6和M7时，并不会进行确认，也就是不会发送ACK。这时根据前面说的保证TCP可靠性传输中的序列号的作用，接收方这时不会接收M5，M6，M7，接收方可以什么都不会，因为发送方长时间未收到M3的确认报文，会对M3进行重传。除了这样，接收方也可以重复发送M2的确认报文，这样发送端长时间未收到M3的确认报文也会继续发送M3报文。</p><pre class="line-numbers language-none"><code class="language-none">**但是根据快重传算法，要求在这种情况下，需要快速向发送端发送M2的确认报文，在发送方收到三个M2的确认报文后，无需等待重传计时器所设置的时间，可直接进行M3的重传，这就是快重传。**(面试时说这一句就够了，前面是帮助理解)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ol><li>快恢复：从上上图圈4可以看到，当发送收到三个重复的ACK，会进行快重传和快恢复。快恢复是指将ssthresh设置为发生快重传时的cwnd数量的一半，而cwnd不是设置为1而是设置为为门限值ssthresh，并开始拥塞避免阶段。</li></ol><h3 id="TCP的三次握手及四次挥手-＊＊＊"><a href="#TCP的三次握手及四次挥手-＊＊＊" class="headerlink" title="TCP的三次握手及四次挥手　＊＊＊"></a>TCP的三次握手及四次挥手　＊＊＊</h3><blockquote><p>必考题</p></blockquote><p>在介绍三次握手和四次挥手之前，先介绍一下TCP头部的一些常用字段。</p><ul><li>序号：seq，占32位，用来标识从发送端到接收端发送的字节流。</li><li>确认号：ack，占32位，只有ACK标志位为1时，确认序号字段才有效，ack=seq+1。</li><li>标志位：<ul><li>SYN：发起一个新连接。</li><li>FIN：释放一个连接。</li><li>ACK：确认序号有效。</li></ul></li></ul><h4 id="三次握手"><a href="#三次握手" class="headerlink" title="三次握手"></a>三次握手</h4><blockquote><p>三次握手的本质就是确定发送端和接收端具备收发信息的能力，在能流畅描述三次握手的流程及其中的字段含义作用的同时还需要记住每次握手时<strong>接收端和发送端的状态</strong>。这个比较容易忽略。</p></blockquote><p>先看一张很经典的图（图片来源于网络），发送端有CLOSED、SYN-SENT、ESTABLISHED三种状态，接收端有CLOSED、LISTEN、SYN-RCVD、ESTABLISHED四种状态。<img src="https://segmentfault.com/img/remote/1460000038526739" alt=""></p><p>假设发送端为客户端，接收端为服务端。开始时客户端和服务端的状态都是CLOSE。</p><ul><li>第一次握手：客户端向服务端发起建立连接请求，客户端会随机生成一个起始序列号x，客户端向服务端发送的字段中包含标志位SYN=1，序列号seq=100。第一次握手前客户端的状态为CLOSE，第一次握手后客户端的状态为SYN-SENT。此时服务端的状态为LISTEN</li><li>第二次握手：服务端在收到客户端发来的报文后，会随机生成一个服务端的起始序列号y，然后给客户端回复一段报文，其中包括标志位SYN=1，ACK=1，序列号seq=y，确认号ack=x+1。第二次握手前服务端的状态为LISTEN，第二次握手后服务端的状态为SYN-RCVD，此时客户端的状态为SYN-SENT。（其中SYN=1表示要和客户端建立一个连接，ACK=1表示确认序号有效）</li><li>第三次握手：客户端收到服务端发来的报文后，会再向服务端发送报文，其中包含标志位ACK=1，序列号seq=x+1，确认号ack=y+1。第三次握手前客户端的状态为SYN-SENT，第三次握手后客户端和服务端的状态都为ESTABLISHED。</li></ul><blockquote><p>需要注意的一点是，第一次握手，客户端向服务端发起建立连接报文，会占一个序列号。但是第三次握手，同样是客户端向服务端发送报文，这次却不占序列号，所以建立连接后，客户端向服务端发送的第一个数据的序列号为x+1。</p></blockquote><h4 id="四次挥手"><a href="#四次挥手" class="headerlink" title="四次挥手"></a>四次挥手</h4><p>和三次握手一样，先看一张非常经典的图（图片来源于网络），客户端在四次挥手过程中有ESTABLISHED、FIN-WAIT-1、FIN-WAIT-2、TIME-WAIT、CLOSED等五个状态，服务端有ESTABLISHED、CLOSE-WAIT、LAST-ACK、CLOSED等四种状态。最好记住每次挥手时服务端和客户端的状态。<br>假设客户端首先发起的断开连接请求<br><img src="https://segmentfault.com/img/remote/1460000038526740" alt=""></p><ul><li>第一次挥手：客户端向服务端发送的数据完成后，向服务端发起释放连接报文，报文包含标志位FIN=1，序列号seq=u。此时客户端只能接收数据，不能向服务端发送数据。</li><li>第二次挥手：服务端收到客户端的释放连接报文后，向客户端发送确认报文，包含标志位ACK=1，序列号seq=v，确认号ack=u+1。此时客户端到服务端的连接已经释放掉，客户端不能像服务端发送数据，服务端也不能向客户端发送数据。但服务端到客户端的单向连接还能正常传输数据。</li><li>第三次挥手：服务端发送完数据后向客户端发出连接释放报文，报文包含标志位FIN=1，标志位ACK=1，序列号seq=w，确认号ack=u+1。</li><li>第四次挥手：客户端收到服务端发送的释放连接请求，向服务端发送确认报文，包含标志位ACK=1，序列号seq=u+1，确认号ack=w+1。</li></ul><h4 id="为什么TCP连接的时候是3次？两次是否可以？"><a href="#为什么TCP连接的时候是3次？两次是否可以？" class="headerlink" title="为什么TCP连接的时候是3次？两次是否可以？"></a>为什么TCP连接的时候是3次？两次是否可以？</h4><p>不可以，主要从以下两方面考虑（假设客户端是首先发起连接请求）：</p><ol><li>假设建立TCP连接仅需要两次握手，那么如果第二次握手时，服务端返回给客户端的确认报文丢失了，客户端这边认为服务端没有和他建立连接，而服务端却以为已经和客户端建立了连接，并且可能向服务端已经开始向客户端发送数据，但客户端并不会接收这些数据，浪费了资源。如果是三次握手，不会出现双方连接还未完全建立成功就开始发送数据的情况。</li><li>如果服务端接收到了一个早已失效的来自客户端的连接请求报文，会向客户端发送确认报文同意建立TCP连接。但因为客户端并不需要向服务端发送数据，所以此次TCP连接没有意义并且浪费了资源。</li></ol><h4 id="为什么TCP连接的时候是3次，关闭的时候却是4次？"><a href="#为什么TCP连接的时候是3次，关闭的时候却是4次？" class="headerlink" title="为什么TCP连接的时候是3次，关闭的时候却是4次？"></a>为什么TCP连接的时候是3次，关闭的时候却是4次？</h4><p>因为需要确保通信双方都能通知对方释放连接，假设客服端发送完数据向服务端发送释放连接请求，当客服端并不知道，服务端是否已经发送完数据，所以此次断开的是客服端到服务端的单向连接，服务端返回给客户端确认报文后，服务端还能继续单向给客户端发送数据。当服务端发送完数据后还需要向客户端发送释放连接请求，客户端返回确认报文，TCP连接彻底关闭。所以断开TCP连接需要客户端和服务端分别通知对方并分别收到确认报文，一共需要四次。</p><h4 id="TIME-WAIT和CLOSE-WAIT的区别在哪"><a href="#TIME-WAIT和CLOSE-WAIT的区别在哪" class="headerlink" title="TIME_WAIT和CLOSE_WAIT的区别在哪?"></a>TIME_WAIT和CLOSE_WAIT的区别在哪?</h4><p>默认客户端首先发起断开连接请求</p><ul><li>从上图可以看出，CLOSE_WAIT是被动关闭形成的，当客户端发送FIN报文，服务端返回ACK报文后进入CLOSE_WAIT。</li><li>TIME_WAIT是主动关闭形成的，当第四次挥手完成后，客户端进入TIME_WAIT状态。</li></ul><h4 id="为什么客户端发出第四次挥手的确认报文后要等2MSL的时间才能释放TCP连接？"><a href="#为什么客户端发出第四次挥手的确认报文后要等2MSL的时间才能释放TCP连接？" class="headerlink" title="为什么客户端发出第四次挥手的确认报文后要等2MSL的时间才能释放TCP连接？"></a>为什么客户端发出第四次挥手的确认报文后要等2MSL的时间才能释放TCP连接？</h4><p>MSL的意思是报文的最长寿命，可以从两方面考虑：</p><ol><li>客户端发送第四次挥手中的报文后，再经过2MSL，可使本次TCP连接中的所有报文全部消失，不会出现在下一个TCP连接中。</li><li>考虑丢包问题，如果第四挥手发送的报文在传输过程中丢失了，那么服务端没收到确认ack报文就会重发第三次挥手的报文。如果客户端发送完第四次挥手的确认报文后直接关闭，而这次报文又恰好丢失，则会造成服务端无法正常关闭。</li></ol><h4 id="如果已经建立了连接，但是客户端突然出现故障了怎么办？"><a href="#如果已经建立了连接，但是客户端突然出现故障了怎么办？" class="headerlink" title="如果已经建立了连接，但是客户端突然出现故障了怎么办？"></a>如果已经建立了连接，但是客户端突然出现故障了怎么办？</h4><p>如果TCP连接已经建立，在通信过程中，客户端突然故障，那么服务端不会一直等下去，过一段时间就关闭连接了。具体原理是TCP有一个保活机制，主要用在服务器端，用于检测已建立TCP链接的客户端的状态，防止因客户端崩溃或者客户端网络不可达，而服务器端一直保持该TCP链接，占用服务器端的大量资源(因为Linux系统中可以创建的总TCP链接数是有限制的)。</p><p>保活机制原理：设置TCP保活机制的保活时间keepIdle，即在TCP链接超过该时间没有任何数据交互时，发送保活探测报文；设置保活探测报文的发送时间间隔keepInterval；设置保活探测报文的总发送次数keepCount。如果在keepCount次的保活探测报文均没有收到客户端的回应，则服务器端即关闭与客户端的TCP链接。</p><p>具体细节请看这篇博客<a href="https://blog.csdn.net/yyc1023/article/details/80242815">TCP通信过程中异常情况整理</a>。</p><h3 id="HTTP-与-HTTPS-的区别-＊＊＊"><a href="#HTTP-与-HTTPS-的区别-＊＊＊" class="headerlink" title="HTTP 与 HTTPS 的区别　＊＊＊"></a>HTTP 与 HTTPS 的区别　＊＊＊</h3><div class="table-container"><table><thead><tr><th style="text-align:center"></th><th style="text-align:center">HTTP</th><th style="text-align:center">HTTPS</th></tr></thead><tbody><tr><td style="text-align:center">端口</td><td style="text-align:center">80</td><td style="text-align:center">443</td></tr><tr><td style="text-align:center">安全性</td><td style="text-align:center">无加密，安全性较差</td><td style="text-align:center">有加密机制，安全性较高</td></tr><tr><td style="text-align:center">资源消耗</td><td style="text-align:center">较少</td><td style="text-align:center">由于加密处理，资源消耗更多</td></tr><tr><td style="text-align:center">是否需要证书</td><td style="text-align:center">不需要</td><td style="text-align:center">需要</td></tr><tr><td style="text-align:center">协议</td><td style="text-align:center">运行在TCP协议之上</td><td style="text-align:center">运行在SSL协议之上，SSL运行在TCP协议之上</td></tr></tbody></table></div><h3 id="什么是对称加密与非对称加密-＊＊"><a href="#什么是对称加密与非对称加密-＊＊" class="headerlink" title="什么是对称加密与非对称加密　＊＊"></a>什么是对称加密与非对称加密　＊＊</h3><ul><li><p>对称加密</p><p>对称加密指加密和解密使用同一密钥，优点是运算速度快，缺点是如何安全将密钥传输给另一方。常见的对称加密算法有DES、AES等等。</p></li><li><p>非对称加密</p><p>非对称加密指的是加密和解密使用不同的密钥，一把公开的公钥，一把私有的私钥。公钥加密的信息只有私钥才能解密，私钥加密的信息只有公钥才能解密。优点解决了对称加密中存在的问题。缺点是运算速度较慢。常见的非对称加密算法有RSA、DSA、ECC等等。</p><p>非对称加密的工作流程：A生成一对非堆成密钥，将公钥向所有人公开，B拿到A的公钥后使用A的公钥对信息加密后发送给A，经过加密的信息只有A手中的私钥能解密。这样B可以通过这种方式将自己的公钥加密后发送给A，两方建立起通信，可以通过对方的公钥加密要发送的信息，接收方用自己的私钥解密信息。</p></li></ul><h3 id="HTTPS的加密过程-＊＊＊"><a href="#HTTPS的加密过程-＊＊＊" class="headerlink" title="HTTPS的加密过程　＊＊＊"></a>HTTPS的加密过程　＊＊＊</h3><p>上面已经介绍了对称加密和非对称加密的优缺点，HTTPS是将两者结合起来，使用的对称加密和非对称加密的混合加密算法。具体做法就是使用非对称加密来传输对称密钥来保证安全性，使用对称加密来保证通信的效率。</p><p>简化的工作流程：服务端生成一对非对称密钥，将公钥发给客户端。客户端生成对称密钥，用服务端发来的公钥进行加密，加密后发给服务端。服务端收到后用私钥进行解密，得到客户端发送的对称密钥。通信双方就可以通过对称密钥进行高效地通信了。</p><p>但是仔细想想这其中存在一个很大地问题，就是客户端最开始如何判断收到的这个公钥就是来自服务端而不是其他人冒充的？</p><p>这就需要证书上场了，服务端会向一个权威机构申请一个证书来证明自己的身份，到时候将证书（证书中包含了公钥）发给客户端就可以了，客户端收到证书后既证明了服务端的身份又拿到了公钥就可以进行下一步操作了。</p><p>HTTPS的加密过程：</p><ol><li>客户端向服务端发起第一次握手请求，告诉服务端客户端所支持的SSL的指定版本、加密算法及密钥长度等信息。</li><li>服务端将自己的公钥发给数字证书认证机构，数字证书认证机构利用自己的私钥对服务器的公钥进行数字签名，并给服务器颁发公钥证书。</li><li>服务端将证书发给客服端。</li><li>客服端利用数字认证机构的公钥，向数字证书认证机构验证公钥证书上的数字签名，确认服务器公开密钥的真实性。</li><li>客服端使用服务端的公开密钥加密自己生成的对称密钥，发给服务端。</li><li>服务端收到后利用私钥解密信息，获得客户端发来的对称密钥。</li><li>通信双方可用对称密钥来加密解密信息。</li></ol><p>上述流程存在的一个问题是客户端哪里来的数字认证机构的公钥，其实，在很多浏览器开发时，会内置常用数字证书认证机构的公钥。</p><p>流程图如下：</p><p><img src="https://segmentfault.com/img/remote/1460000038526733" alt=""></p><h3 id="常用HTTP状态码-＊＊＊"><a href="#常用HTTP状态码-＊＊＊" class="headerlink" title="常用HTTP状态码　＊＊＊"></a>常用HTTP状态码　＊＊＊</h3><blockquote><p>这也是一个面试经常问的题目,背下来就行了.</p></blockquote><div class="table-container"><table><thead><tr><th style="text-align:center">状态码</th><th style="text-align:center">类别</th></tr></thead><tbody><tr><td style="text-align:center">1XX</td><td style="text-align:center">信息性状态码</td></tr><tr><td style="text-align:center">2XX</td><td style="text-align:center">成功状态码</td></tr><tr><td style="text-align:center">3XX</td><td style="text-align:center">重定向状态码</td></tr><tr><td style="text-align:center">4XX</td><td style="text-align:center">客户端错误状态码</td></tr><tr><td style="text-align:center">5XX</td><td style="text-align:center">服务端错误状态码</td></tr></tbody></table></div><p>常见的HTTP状态码</p><p>1XX</p><ul><li>100 Continue：表示正常，客户端可以继续发送请求</li><li>101 Switching Protocols：切换协议，服务器根据客户端的请求切换协议。</li></ul><p>2XX</p><ul><li>200 OK：请求成功</li><li>201 Created：已创建，表示成功请求并创建了新的资源</li><li>202 Accepted：已接受，已接受请求，但未处理完成。</li><li>204 No Content：无内容，服务器成功处理，但未返回内容。</li><li>205 Reset Content：重置内容，服务器处理成功，客户端应重置文档视图。</li><li>206 Partial Content：表示客户端进行了范围请求，响应报文应包含Content-Range指定范围的实体内容</li></ul><p>3XX</p><ul><li>301 Moved Permanently：永久性重定向</li><li>302 Found：临时重定向</li><li>303 See Other：和301功能类似，但要求客户端采用get方法获取资源</li><li>304 Not Modified：所请求的资源未修改，服务器返回此状态码时，不会返回任何资源。</li><li>305 Use Proxy：所请求的资源必须通过代理访问</li><li>307 Temporary Redirect： 临时重定向，与302类似，要求使用get请求重定向。</li></ul><p>4XX</p><ul><li>400 Bad Request：客户端请求的语法错误，服务器无法理解。</li><li>401 Unauthorized：表示发送的请求需要有认证信息。</li><li>403 Forbidden：服务器理解用户的请求，但是拒绝执行该请求</li><li>404 Not Found：服务器无法根据客户端的请求找到资源。</li><li>405 Method Not Allowed：客户端请求中的方法被禁止</li><li>406 Not Acceptable：服务器无法根据客户端请求的内容特性完成请求</li><li>408 Request Time-out：服务器等待客户端发送的请求时间过长，超时</li></ul><p>5XX</p><ul><li>500 Internal Server Error：服务器内部错误，无法完成请求</li><li>501 Not Implemented：服务器不支持请求的功能，无法完成请求</li></ul><h3 id="常见的HTTP方法-＊＊＊"><a href="#常见的HTTP方法-＊＊＊" class="headerlink" title="常见的HTTP方法　＊＊＊"></a>常见的HTTP方法　＊＊＊</h3><div class="table-container"><table><thead><tr><th>方法</th><th>作用</th></tr></thead><tbody><tr><td>GET</td><td>获取资源</td></tr><tr><td>POST</td><td>传输实体主体</td></tr><tr><td>PUT</td><td>上传文件</td></tr><tr><td>DELETE</td><td>删除文件</td></tr><tr><td>HEAD</td><td>和GET方法类似，但只返回报文首部，不返回报文实体主体部分</td></tr><tr><td>PATCH</td><td>对资源进行部分修改</td></tr><tr><td>OPTIONS</td><td>查询指定的URL支持的方法</td></tr><tr><td>CONNECT</td><td>要求用隧道协议连接代理</td></tr><tr><td>TRACE</td><td>服务器会将通信路径返回给客户端</td></tr></tbody></table></div><p>为了方便记忆，可以将PUT、DELETE、POST、GET理解为客户端对服务端的增删改查。</p><ul><li>PUT：上传文件，向服务器添加数据，可以看作增</li><li>DELETE：删除文件</li><li>POST：传输数据，向服务器提交数据，对服务器数据进行更新。</li><li>GET：获取资源，查询服务器资源</li></ul><h3 id="GET和POST区别-＊＊＊"><a href="#GET和POST区别-＊＊＊" class="headerlink" title="GET和POST区别　＊＊＊"></a>GET和POST区别　＊＊＊</h3><ul><li><p>作用</p><p>GET用于获取资源，POST用于传输实体主体</p></li><li><p>参数位置</p><p>GET的参数放在URL中，POST的参数存储在实体主体中，并且GET方法提交的请求的URL中的数据做多是2048字节，POST请求没有大小限制。</p></li><li><p>安全性</p><p>GET方法因为参数放在URL中，安全性相对于POST较差一些</p></li><li><p>幂等性</p><p>GET方法是具有幂等性的，而POST方法不具有幂等性。这里幂等性指客户端连续发出多次请求，收到的结果都是一样的.</p></li></ul><h3 id="HTTP-1-0、HTTP-1-1及HTTP-2-0的主要区别是什么-＊＊"><a href="#HTTP-1-0、HTTP-1-1及HTTP-2-0的主要区别是什么-＊＊" class="headerlink" title="HTTP 1.0、HTTP 1.1及HTTP 2.0的主要区别是什么　＊＊"></a>HTTP 1.0、HTTP 1.1及HTTP 2.0的主要区别是什么　＊＊</h3><p>HTTP 1.0和HTTP 1.1的区别</p><ul><li><p>长连接</p><p>HTTP 1.1支持长连接和请求的流水线操作。长连接是指不在需要每次请求都重新建立一次连接，HTTP 1.0默认使用短连接，每次请求都要重新建立一次TCP连接，资源消耗较大。请求的流水线操作是指客户端在收到HTTP的响应报文之前可以先发送新的请求报文，不支持请求的流水线操作需要等到收到HTTP的响应报文后才能继续发送新的请求报文。</p></li><li><p>缓存处理</p><p>在HTTP 1.0中主要使用header中的If-Modified-Since,Expires作为缓存判断的标准，HTTP 1.1引入了Entity tag，If-Unmodified-Since, If-Match等更多可供选择的缓存头来控制缓存策略。</p></li><li><p>错误状态码</p><p>在HTTP 1.1新增了24个错误状态响应码</p></li><li><p>HOST域</p><p>在HTTP 1.0 中认为每台服务器都会绑定唯一的IP地址，所以，请求中的URL并没有传递主机名。但后来一台服务器上可能存在多个虚拟机，它们共享一个IP地址，所以HTTP 1.1中请求消息和响应消息都应该支持Host域。</p></li><li><p>带宽优化及网络连接的使用</p><p>在HTTP 1.0中会存在浪费带宽的现象，主要是因为不支持断点续传功能，客户端只是需要某个对象的一部分，服务端却将整个对象都传了过来。在HTTP 1.1中请求头引入了range头域，它支持只请求资源的某个部分，返回的状态码为206。</p></li></ul><p>HTTP 2.0的新特性</p><ul><li>新的二进制格式：HTTP 1.x的解析是基于文本，HTTP 2.0的解析采用二进制，实现方便，健壮性更好。</li><li>多路复用：每一个request对应一个id，一个连接上可以有多个request，每个连接的request可以随机混在一起，这样接收方可以根据request的id将request归属到各自不同的服务端请求里。</li><li>header压缩：在HTTP 1.x中，header携带大量信息，并且每次都需要重新发送，HTTP 2.0采用编码的方式减小了header的大小，同时通信双方各自缓存一份header fields表，避免了header的重复传输。</li><li>服务端推送：客户端在请求一个资源时，会把相关资源一起发给客户端，这样客户端就不需要再次发起请求。</li></ul><h3 id="Session、Cookie和Token的主要区别-＊＊＊"><a href="#Session、Cookie和Token的主要区别-＊＊＊" class="headerlink" title="Session、Cookie和Token的主要区别　＊＊＊"></a>Session、Cookie和Token的主要区别　＊＊＊</h3><p>HTTP协议是无状态的，即服务器无法判断用户身份。Session和Cookie可以用来进行身份辨认。</p><ul><li><p>Cookie</p><p>Cookie是保存在客户端一个小数据块，其中包含了用户信息。当客户端向服务端发起请求，服务端会像客户端浏览器发送一个Cookie，客户端会把Cookie存起来，当下次客户端再次请求服务端时，会携带上这个Cookie，服务端会通过这个Cookie来确定身份。</p></li><li><p>Session</p><p>Session是通过Cookie实现的，和Cookie不同的是，Session是存在服务端的。当客户端浏览器第一次访问服务器时，服务器会为浏览器创建一个sessionid，将sessionid放到Cookie中，存在客户端浏览器。比如浏览器访问的是购物网站，将一本《图解HTTP》放到了购物车，当浏览器再次访问服务器时，服务器会取出Cookie中的sessionid，并根据sessionid获取会话中的存储的信息，确认浏览器的身份是上次将《图解HTTP》放入到购物车那个用户。</p></li><li><p>Token</p><p>客户端在浏览器第一次访问服务端时，服务端生成的一串字符串作为Token发给客户端浏览器，下次浏览器在访问服务端时携带token即可无需验证用户名和密码，省下来大量的资源开销。看到这里很多人感觉这不是和sessionid作用一样吗？其实是不一样的，但是本文章主要针对面试，知识点很多，篇幅有限，几句话也解释不清楚，大家可以看看这篇文章，我觉得说的非常清楚了。<a href="https://blog.csdn.net/whl190412/article/details/90024671">cookie、session与token的真正区别</a></p><p>下面为了方便记忆，做了一个表格进行对比。</p><p>|         |   存放位置   | 占用空间 | 安全性 |      应用场景      |<br>| :——-: | :—————: | :———: | :——: | :————————: |<br>| Cookie  | 客户端浏览器 |    小    |  较低  |  一般存放配置信息  |<br>| Session |    服务端    |    多    |  较高  | 存放较为重要的信息 |</p></li></ul><h3 id="如果客户端禁止-cookie-能实现-session-还能用吗？-＊"><a href="#如果客户端禁止-cookie-能实现-session-还能用吗？-＊" class="headerlink" title="如果客户端禁止 cookie 能实现 session 还能用吗？　＊"></a>如果客户端禁止 cookie 能实现 session 还能用吗？　＊</h3><p>可以，Session的作用是在服务端来保持状态，通过sessionid来进行确认身份，但sessionid一般是通过Cookie来进行传递的。如果Cooike被禁用了，可以通过在URL中传递sessionid。</p><h3 id="在浏览器中输⼊url地址到显示主⻚的过程-＊＊＊"><a href="#在浏览器中输⼊url地址到显示主⻚的过程-＊＊＊" class="headerlink" title="在浏览器中输⼊url地址到显示主⻚的过程　＊＊＊"></a>在浏览器中输⼊url地址到显示主⻚的过程　＊＊＊</h3><blockquote><p>面试超高频的一道题，一般能说清楚流程就可以。</p></blockquote><ol><li>对输入到浏览器的url进行DNS解析，将域名转换为IP地址。</li><li>和目的服务器建立TCP连接</li><li>向目的服务器发送HTTP请求</li><li>服务器处理请求并返回HTTP报文</li><li>浏览器解析并渲染页面</li></ol><h3 id="Servlet是线程安全的吗-＊"><a href="#Servlet是线程安全的吗-＊" class="headerlink" title="Servlet是线程安全的吗　＊"></a>Servlet是线程安全的吗　＊</h3><p>Servlet不是线程安全的，多线程的读写会导致数据不同步的问题。</p><h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><ul><li><p><a href="https://segmentfault.com/a/1190000038526729">一文搞定所有计算机网络面试题</a></p></li><li><p><a href="https://juejin.cn/post/6844903662838349838">搞定计算机网络面试，看这篇就够了（补充版）</a></p></li></ul>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Task5 DIN</title>
      <link href="2021/03/27/task5-din/"/>
      <url>2021/03/27/task5-din/</url>
      
        <content type="html"><![CDATA[<h1 id="DIN"><a href="#DIN" class="headerlink" title="DIN"></a>DIN</h1><ul><li>该文主要记录<a href="https://github.com/datawhalechina/team-learning-rs/tree/master/DeepRecommendationModel"><code>深度推荐模型|DataWhale</code></a>Task5 DIN 内容</li></ul><p>Deep Interest Network(DIN) 是阿里发表在 KDD 18 上的一篇论文模型，针对电子商务领域的 CTR 预估，重点在于充分挖掘用户历史行为数据中的信息，考虑用户的历史行为商品与当前商品广告的关联性。</p><ol><li>使用用户兴趣分布来表示用户多种多样的兴趣爱好</li><li>使用 Attention 机制来实现 Local Activation</li><li>针对模型训练，提出了 Dice 激活函数（PReLU），自适应正则（a mini-batch aware regularizer），显著地提升了模型性能与收敛速度</li></ol><blockquote><p>论文在相关工作中介绍说：对于之前的 Wide&amp;Deep、DeepFM 等采用 DNN 应用于 CTR 预测，它们共有的缺点是，并没有针对用户历史行为数据进行分析和建模。这也是 DIN 主要改进的地方，DIN 同时对 Diversity + Local Activation 进行建模。</p></blockquote><p>这里需要介绍一下电子商务领域用户历史数据具有两个非常显著的特征：</p><ul><li>Diversity 兴趣爱好非常广泛</li><li>Local Activation 历史行为中部分数据会主导是否会点击候选广告</li></ul><p><strong>针对 Diversity：</strong></p><p>针对用户广泛的兴趣，DIN 采用 an interest distribution</p><p><strong>针对 Local Activation：</strong></p><p>DIN 借鉴机器翻译中的 Attention 机制，设计了一种 Attention-like network structure，针对当前候选 Ad，去局部激活（Local Activate）相关的历史兴趣信息。和当前候选 Ad 相关性越高的历史行为行为，会获得更高的 Attention Score，从而主导这一次预测。</p><p><strong>看下最重要的模型结构图</strong></p><p><img src="/2021/03/27/task5-din/pic1.png" alt=""></p><p>通过引入 Activation Unit 和 Pooling 对两个重要特征进行建模</p><ol><li>Activation Unit 实现 Attention 机制，对 Local Activation 建模</li><li>Pooling（weighted sum）对 Diversity 建模</li></ol><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> warningswarnings<span class="token punctuation">.</span>filterwarnings<span class="token punctuation">(</span><span class="token string">"ignore"</span><span class="token punctuation">)</span><span class="token keyword">import</span> itertools<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np<span class="token keyword">from</span> tqdm <span class="token keyword">import</span> tqdm<span class="token keyword">from</span> collections <span class="token keyword">import</span> namedtuple<span class="token keyword">import</span> tensorflow <span class="token keyword">as</span> tf<span class="token keyword">from</span> tensorflow <span class="token keyword">import</span> keras <span class="token keyword">from</span> tensorflow<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>layers <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> tensorflow<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>models <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>model_selection <span class="token keyword">import</span> train_test_split<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>preprocessing <span class="token keyword">import</span>  MinMaxScaler<span class="token punctuation">,</span> LabelEncoder<span class="token keyword">from</span> deepctr<span class="token punctuation">.</span>feature_column <span class="token keyword">import</span> SparseFeat<span class="token punctuation">,</span> DenseFeat<span class="token punctuation">,</span> VarLenSparseFeat<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 设置GPU显存使用，tensorflow不然会报错</span>gpus <span class="token operator">=</span> tf<span class="token punctuation">.</span>config<span class="token punctuation">.</span>experimental<span class="token punctuation">.</span>list_physical_devices<span class="token punctuation">(</span><span class="token string">'GPU'</span><span class="token punctuation">)</span><span class="token keyword">if</span> gpus<span class="token punctuation">:</span>    <span class="token keyword">try</span><span class="token punctuation">:</span>        <span class="token comment"># Currently, memory growth needs to be the same across GPUs</span>        <span class="token keyword">for</span> gpu <span class="token keyword">in</span> gpus<span class="token punctuation">:</span>            tf<span class="token punctuation">.</span>config<span class="token punctuation">.</span>experimental<span class="token punctuation">.</span>set_memory_growth<span class="token punctuation">(</span>gpu<span class="token punctuation">,</span> <span class="token boolean">True</span><span class="token punctuation">)</span>        logical_gpus <span class="token operator">=</span> tf<span class="token punctuation">.</span>config<span class="token punctuation">.</span>experimental<span class="token punctuation">.</span>list_logical_devices<span class="token punctuation">(</span><span class="token string">'GPU'</span><span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>gpus<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"Physical GPUs,"</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>logical_gpus<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"Logical GPUs"</span><span class="token punctuation">)</span>    <span class="token keyword">except</span> RuntimeError <span class="token keyword">as</span> e<span class="token punctuation">:</span>        <span class="token comment"># Memory growth must be set before GPUs have been initialized</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token number">1</span> Physical GPUs<span class="token punctuation">,</span> <span class="token number">1</span> Logical GPUs<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="1、Exploratory-Data-Analysis"><a href="#1、Exploratory-Data-Analysis" class="headerlink" title="1、Exploratory Data Analysis"></a>1、Exploratory Data Analysis</h2><pre class="line-numbers language-python" data-language="python"><code class="language-python">samples_data <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">"movie_sample.txt"</span><span class="token punctuation">,</span> sep<span class="token operator">=</span><span class="token string">"\t"</span><span class="token punctuation">,</span> header<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span>samples_data<span class="token punctuation">.</span>columns <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"user_id"</span><span class="token punctuation">,</span><span class="token string">"gender"</span><span class="token punctuation">,</span><span class="token string">"age"</span><span class="token punctuation">,</span><span class="token string">"hist_movie_id"</span><span class="token punctuation">,</span><span class="token string">"hist_len"</span><span class="token punctuation">,</span><span class="token string">"movie_id"</span><span class="token punctuation">,</span><span class="token string">"movie_type_id"</span><span class="token punctuation">,</span><span class="token string">"label"</span><span class="token punctuation">]</span>samples_data<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }    .dataframe tbody tr th {        vertical-align: top;    }    .dataframe thead th {        text-align: right;    }</style><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>user_id</th>      <th>gender</th>      <th>age</th>      <th>hist_movie_id</th>      <th>hist_len</th>      <th>movie_id</th>      <th>movie_type_id</th>      <th>label</th>    </tr>  </thead>  <tbody>    <tr>      <th>0</th>      <td>1</td>      <td>1</td>      <td>1</td>      <td>186,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,...</td>      <td>1</td>      <td>112</td>      <td>2</td>      <td>1</td>    </tr>    <tr>      <th>1</th>      <td>1</td>      <td>1</td>      <td>1</td>      <td>186,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,...</td>      <td>1</td>      <td>38</td>      <td>5</td>      <td>0</td>    </tr>    <tr>      <th>2</th>      <td>1</td>      <td>1</td>      <td>1</td>      <td>186,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,...</td>      <td>1</td>      <td>151</td>      <td>7</td>      <td>0</td>    </tr>    <tr>      <th>3</th>      <td>1</td>      <td>1</td>      <td>1</td>      <td>186,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,...</td>      <td>1</td>      <td>77</td>      <td>6</td>      <td>0</td>    </tr>    <tr>      <th>4</th>      <td>1</td>      <td>1</td>      <td>1</td>      <td>186,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,...</td>      <td>1</td>      <td>188</td>      <td>9</td>      <td>0</td>    </tr>  </tbody></table></div><pre class="line-numbers language-python" data-language="python"><code class="language-python">samples_data<span class="token punctuation">.</span>describe<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }    .dataframe tbody tr th {        vertical-align: top;    }    .dataframe thead th {        text-align: right;    }</style><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>user_id</th>      <th>gender</th>      <th>age</th>      <th>hist_len</th>      <th>movie_id</th>      <th>movie_type_id</th>      <th>label</th>    </tr>  </thead>  <tbody>    <tr>      <th>count</th>      <td>1380.000000</td>      <td>1380.000000</td>      <td>1380.000000</td>      <td>1380.000000</td>      <td>1380.000000</td>      <td>1380.000000</td>      <td>1380.000000</td>    </tr>    <tr>      <th>mean</th>      <td>1.991304</td>      <td>1.773913</td>      <td>1.991304</td>      <td>47.430435</td>      <td>104.197101</td>      <td>4.920290</td>      <td>0.166667</td>    </tr>    <tr>      <th>std</th>      <td>0.666126</td>      <td>0.418448</td>      <td>0.666126</td>      <td>34.966080</td>      <td>60.739177</td>      <td>2.441072</td>      <td>0.372813</td>    </tr>    <tr>      <th>min</th>      <td>1.000000</td>      <td>1.000000</td>      <td>1.000000</td>      <td>1.000000</td>      <td>1.000000</td>      <td>1.000000</td>      <td>0.000000</td>    </tr>    <tr>      <th>25%</th>      <td>2.000000</td>      <td>2.000000</td>      <td>2.000000</td>      <td>20.000000</td>      <td>51.000000</td>      <td>3.000000</td>      <td>0.000000</td>    </tr>    <tr>      <th>50%</th>      <td>2.000000</td>      <td>2.000000</td>      <td>2.000000</td>      <td>39.000000</td>      <td>105.000000</td>      <td>5.000000</td>      <td>0.000000</td>    </tr>    <tr>      <th>75%</th>      <td>2.000000</td>      <td>2.000000</td>      <td>2.000000</td>      <td>71.000000</td>      <td>155.250000</td>      <td>7.000000</td>      <td>0.000000</td>    </tr>    <tr>      <th>max</th>      <td>3.000000</td>      <td>2.000000</td>      <td>3.000000</td>      <td>128.000000</td>      <td>208.000000</td>      <td>9.000000</td>      <td>1.000000</td>    </tr>  </tbody></table></div><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">print</span><span class="token punctuation">(</span>samples_data<span class="token punctuation">[</span><span class="token string">"user_id"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>unique<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>samples_data<span class="token punctuation">[</span><span class="token string">"gender"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>unique<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>samples_data<span class="token punctuation">[</span><span class="token string">"age"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>unique<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span>sort<span class="token punctuation">(</span>samples_data<span class="token punctuation">[</span><span class="token string">"movie_id"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>unique<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span>sort<span class="token punctuation">(</span>samples_data<span class="token punctuation">[</span><span class="token string">"movie_type_id"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>unique<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>samples_data<span class="token punctuation">[</span><span class="token string">"label"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>unique<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token punctuation">[</span><span class="token number">1</span> <span class="token number">2</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span> <span class="token number">2</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">[</span>  <span class="token number">1</span>   <span class="token number">2</span>   <span class="token number">3</span>   <span class="token number">4</span>   <span class="token number">5</span>   <span class="token number">6</span>   <span class="token number">7</span>   <span class="token number">8</span>   <span class="token number">9</span>  <span class="token number">10</span>  <span class="token number">11</span>  <span class="token number">12</span>  <span class="token number">13</span>  <span class="token number">14</span>  <span class="token number">15</span>  <span class="token number">16</span>  <span class="token number">17</span>  <span class="token number">18</span>  <span class="token number">19</span>  <span class="token number">20</span>  <span class="token number">21</span>  <span class="token number">22</span>  <span class="token number">23</span>  <span class="token number">24</span>  <span class="token number">25</span>  <span class="token number">26</span>  <span class="token number">27</span>  <span class="token number">28</span>  <span class="token number">29</span>  <span class="token number">30</span>  <span class="token number">31</span>  <span class="token number">32</span>  <span class="token number">33</span>  <span class="token number">34</span>  <span class="token number">35</span>  <span class="token number">36</span>  <span class="token number">37</span>  <span class="token number">38</span>  <span class="token number">39</span>  <span class="token number">40</span>  <span class="token number">41</span>  <span class="token number">42</span>  <span class="token number">43</span>  <span class="token number">44</span>  <span class="token number">45</span>  <span class="token number">46</span>  <span class="token number">47</span>  <span class="token number">48</span>  <span class="token number">49</span>  <span class="token number">50</span>  <span class="token number">51</span>  <span class="token number">52</span>  <span class="token number">53</span>  <span class="token number">54</span>  <span class="token number">55</span>  <span class="token number">56</span>  <span class="token number">57</span>  <span class="token number">58</span>  <span class="token number">59</span>  <span class="token number">60</span>  <span class="token number">61</span>  <span class="token number">62</span>  <span class="token number">63</span>  <span class="token number">64</span>  <span class="token number">65</span>  <span class="token number">66</span>  <span class="token number">67</span>  <span class="token number">68</span>  <span class="token number">69</span>  <span class="token number">70</span>  <span class="token number">71</span>  <span class="token number">72</span>  <span class="token number">73</span>  <span class="token number">74</span>  <span class="token number">75</span>  <span class="token number">76</span>  <span class="token number">77</span>  <span class="token number">78</span>  <span class="token number">79</span>  <span class="token number">80</span>  <span class="token number">81</span>  <span class="token number">82</span>  <span class="token number">83</span>  <span class="token number">84</span>  <span class="token number">85</span>  <span class="token number">86</span>  <span class="token number">87</span>  <span class="token number">88</span>  <span class="token number">89</span>  <span class="token number">90</span>  <span class="token number">91</span>  <span class="token number">92</span>  <span class="token number">93</span>  <span class="token number">94</span>  <span class="token number">95</span>  <span class="token number">96</span>  <span class="token number">97</span>  <span class="token number">98</span>  <span class="token number">99</span> <span class="token number">100</span> <span class="token number">101</span> <span class="token number">102</span> <span class="token number">103</span> <span class="token number">104</span> <span class="token number">105</span> <span class="token number">106</span> <span class="token number">107</span> <span class="token number">108</span> <span class="token number">109</span> <span class="token number">110</span> <span class="token number">111</span> <span class="token number">112</span> <span class="token number">113</span> <span class="token number">114</span> <span class="token number">115</span> <span class="token number">116</span> <span class="token number">117</span> <span class="token number">118</span> <span class="token number">119</span> <span class="token number">120</span> <span class="token number">121</span> <span class="token number">122</span> <span class="token number">123</span> <span class="token number">124</span> <span class="token number">125</span> <span class="token number">126</span> <span class="token number">127</span> <span class="token number">128</span> <span class="token number">129</span> <span class="token number">130</span> <span class="token number">131</span> <span class="token number">132</span> <span class="token number">133</span> <span class="token number">134</span> <span class="token number">135</span> <span class="token number">136</span> <span class="token number">137</span> <span class="token number">138</span> <span class="token number">139</span> <span class="token number">140</span> <span class="token number">141</span> <span class="token number">142</span> <span class="token number">143</span> <span class="token number">144</span> <span class="token number">145</span> <span class="token number">146</span> <span class="token number">147</span> <span class="token number">148</span> <span class="token number">149</span> <span class="token number">150</span> <span class="token number">151</span> <span class="token number">152</span> <span class="token number">153</span> <span class="token number">154</span> <span class="token number">155</span> <span class="token number">156</span> <span class="token number">157</span> <span class="token number">158</span> <span class="token number">159</span> <span class="token number">160</span> <span class="token number">161</span> <span class="token number">162</span> <span class="token number">163</span> <span class="token number">164</span> <span class="token number">165</span> <span class="token number">166</span> <span class="token number">167</span> <span class="token number">168</span> <span class="token number">169</span> <span class="token number">170</span> <span class="token number">171</span> <span class="token number">172</span> <span class="token number">173</span> <span class="token number">174</span> <span class="token number">175</span> <span class="token number">176</span> <span class="token number">177</span> <span class="token number">178</span> <span class="token number">179</span> <span class="token number">180</span> <span class="token number">181</span> <span class="token number">182</span> <span class="token number">183</span> <span class="token number">184</span> <span class="token number">185</span> <span class="token number">186</span> <span class="token number">187</span> <span class="token number">188</span> <span class="token number">189</span> <span class="token number">190</span> <span class="token number">191</span> <span class="token number">192</span> <span class="token number">193</span> <span class="token number">194</span> <span class="token number">195</span> <span class="token number">196</span> <span class="token number">197</span> <span class="token number">198</span> <span class="token number">199</span> <span class="token number">200</span> <span class="token number">201</span> <span class="token number">202</span> <span class="token number">203</span> <span class="token number">204</span> <span class="token number">205</span> <span class="token number">206</span> <span class="token number">207</span> <span class="token number">208</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span> <span class="token number">2</span> <span class="token number">3</span> <span class="token number">4</span> <span class="token number">5</span> <span class="token number">6</span> <span class="token number">7</span> <span class="token number">8</span> <span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span> <span class="token number">0</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">X <span class="token operator">=</span> samples_data<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">"user_id"</span><span class="token punctuation">,</span><span class="token string">"gender"</span><span class="token punctuation">,</span><span class="token string">"age"</span><span class="token punctuation">,</span><span class="token string">"hist_movie_id"</span><span class="token punctuation">,</span><span class="token string">"hist_len"</span><span class="token punctuation">,</span><span class="token string">"movie_id"</span><span class="token punctuation">,</span><span class="token string">"movie_type_id"</span><span class="token punctuation">]</span><span class="token punctuation">]</span>y <span class="token operator">=</span> samples_data<span class="token punctuation">[</span><span class="token string">"label"</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">X_train <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">"user_id"</span><span class="token punctuation">:</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>X<span class="token punctuation">[</span><span class="token string">"user_id"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\    <span class="token string">"gender"</span><span class="token punctuation">:</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>X<span class="token punctuation">[</span><span class="token string">"gender"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\    <span class="token string">"age"</span><span class="token punctuation">:</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>X<span class="token punctuation">[</span><span class="token string">"age"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\    <span class="token string">"hist_movie_id"</span><span class="token punctuation">:</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> l<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">","</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token keyword">for</span> l <span class="token keyword">in</span> X<span class="token punctuation">[</span><span class="token string">"hist_movie_id"</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\    <span class="token string">"hist_len"</span><span class="token punctuation">:</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>X<span class="token punctuation">[</span><span class="token string">"hist_len"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\    <span class="token string">"movie_id"</span><span class="token punctuation">:</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>X<span class="token punctuation">[</span><span class="token string">"movie_id"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\    <span class="token string">"movie_type_id"</span><span class="token punctuation">:</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>X<span class="token punctuation">[</span><span class="token string">"movie_type_id"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token builtin">len</span><span class="token punctuation">(</span>X_train<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token number">7</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">print</span><span class="token punctuation">(</span>X_train<span class="token punctuation">[</span><span class="token string">"hist_movie_id"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token punctuation">(</span>X_train<span class="token punctuation">[</span><span class="token string">"hist_movie_id"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token punctuation">(</span>X_train<span class="token punctuation">[</span><span class="token string">"hist_movie_id"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token punctuation">[</span><span class="token number">186</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span>   <span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token string">'numpy.ndarray'</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token string">'numpy.ndarray'</span><span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">y_train <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>y<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 1. SparseFeat() vocabulary_size = max()+1</span><span class="token comment"># 2. DenseFeat() hist_len</span>feature_columns <span class="token operator">=</span> <span class="token punctuation">[</span>    SparseFeat<span class="token punctuation">(</span><span class="token string">"user_id"</span><span class="token punctuation">,</span> <span class="token builtin">max</span><span class="token punctuation">(</span>samples_data<span class="token punctuation">[</span><span class="token string">"user_id"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span> embedding_dim<span class="token operator">=</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    SparseFeat<span class="token punctuation">(</span><span class="token string">"gender"</span><span class="token punctuation">,</span> <span class="token builtin">max</span><span class="token punctuation">(</span>samples_data<span class="token punctuation">[</span><span class="token string">"gender"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span> embedding_dim<span class="token operator">=</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    SparseFeat<span class="token punctuation">(</span><span class="token string">"age"</span><span class="token punctuation">,</span> <span class="token builtin">max</span><span class="token punctuation">(</span>samples_data<span class="token punctuation">[</span><span class="token string">"age"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span> embedding_dim<span class="token operator">=</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    SparseFeat<span class="token punctuation">(</span><span class="token string">"movie_id"</span><span class="token punctuation">,</span> <span class="token builtin">max</span><span class="token punctuation">(</span>samples_data<span class="token punctuation">[</span><span class="token string">"movie_id"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span> embedding_dim<span class="token operator">=</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    SparseFeat<span class="token punctuation">(</span><span class="token string">"movie_type_id"</span><span class="token punctuation">,</span> <span class="token builtin">max</span><span class="token punctuation">(</span>samples_data<span class="token punctuation">[</span><span class="token string">"movie_type_id"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span> embedding_dim<span class="token operator">=</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    DenseFeat<span class="token punctuation">(</span><span class="token string">"hist_len"</span><span class="token punctuation">,</span> dimension<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="VarLenSparseFeat"><a href="#VarLenSparseFeat" class="headerlink" title="VarLenSparseFeat"></a>VarLenSparseFeat</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python">VarLenSparseFeat <span class="token keyword">is</span> a namedtuple <span class="token keyword">with</span> signature VarLenSparseFeat<span class="token punctuation">(</span>sparsefeat<span class="token punctuation">,</span> maxlen<span class="token punctuation">,</span> combiner<span class="token punctuation">,</span> length_name<span class="token punctuation">,</span> weight_name<span class="token punctuation">,</span>weight_norm<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li>sparsefeat : a instance of <code>SparseFeat</code></li><li>maxlen : maximum length of this feature for all samples</li><li>combiner : pooling method,can be <code>sum</code>,<code>mean</code> or <code>max</code></li><li>length_name : feature length name,if <code>None</code>, value 0 in feature is for padding.</li><li>weight_name : default <code>None</code>. If not None, the sequence feature will be multiplyed by the feature whose name is <code>weight_name</code>.</li><li>weight_norm : default <code>True</code>. Whether normalize the weight score or not.</li></ul><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 从数据上分布中可以得出，len(X_train["hist_movie_id"][0])=50，这也对应着这里的 maxlen设定</span><span class="token comment"># 这里因为使用的导入库为 from deepctr.feature_column import SparseFeat, DenseFeat, VarLenSparseFeat</span><span class="token comment"># 注意下两者的使用区别，这里需要传入的是 SparseFeat 类型和 maxlen</span><span class="token comment"># 源代码：</span><span class="token comment"># from utils import SparseFeat, DenseFeat, VarLenSparseFeat</span><span class="token comment"># feature_columns += [VarLenSparseFeat('hist_movie_id', vocabulary_size=max(samples_data["movie_id"])+1, embedding_dim=8, maxlen=50)]</span>feature_columns <span class="token operator">+=</span> <span class="token punctuation">[</span>VarLenSparseFeat<span class="token punctuation">(</span>SparseFeat<span class="token punctuation">(</span><span class="token string">'hist_movie_id'</span><span class="token punctuation">,</span> vocabulary_size<span class="token operator">=</span><span class="token builtin">max</span><span class="token punctuation">(</span>samples_data<span class="token punctuation">[</span><span class="token string">"movie_id"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span> embedding_dim<span class="token operator">=</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">,</span> maxlen<span class="token operator">=</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">feature_columns<span class="token punctuation">,</span><span class="token builtin">len</span><span class="token punctuation">(</span>feature_columns<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token builtin">type</span><span class="token punctuation">(</span>feature_columns<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token punctuation">(</span><span class="token punctuation">[</span>SparseFeat<span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">'user_id'</span><span class="token punctuation">,</span> vocabulary_size<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span> embedding_dim<span class="token operator">=</span><span class="token number">8</span><span class="token punctuation">,</span> use_hash<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span><span class="token string">'int32'</span><span class="token punctuation">,</span> embeddings_initializer<span class="token operator">=</span><span class="token operator">&lt;</span>tensorflow<span class="token punctuation">.</span>python<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>initializers<span class="token punctuation">.</span>initializers_v1<span class="token punctuation">.</span>RandomNormal <span class="token builtin">object</span> at <span class="token number">0x000001B255B75E50</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> embedding_name<span class="token operator">=</span><span class="token string">'user_id'</span><span class="token punctuation">,</span> group_name<span class="token operator">=</span><span class="token string">'default_group'</span><span class="token punctuation">,</span> trainable<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  SparseFeat<span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">'gender'</span><span class="token punctuation">,</span> vocabulary_size<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> embedding_dim<span class="token operator">=</span><span class="token number">8</span><span class="token punctuation">,</span> use_hash<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span><span class="token string">'int32'</span><span class="token punctuation">,</span> embeddings_initializer<span class="token operator">=</span><span class="token operator">&lt;</span>tensorflow<span class="token punctuation">.</span>python<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>initializers<span class="token punctuation">.</span>initializers_v1<span class="token punctuation">.</span>RandomNormal <span class="token builtin">object</span> at <span class="token number">0x000001B255B757F0</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> embedding_name<span class="token operator">=</span><span class="token string">'gender'</span><span class="token punctuation">,</span> group_name<span class="token operator">=</span><span class="token string">'default_group'</span><span class="token punctuation">,</span> trainable<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  SparseFeat<span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">'age'</span><span class="token punctuation">,</span> vocabulary_size<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span> embedding_dim<span class="token operator">=</span><span class="token number">8</span><span class="token punctuation">,</span> use_hash<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span><span class="token string">'int32'</span><span class="token punctuation">,</span> embeddings_initializer<span class="token operator">=</span><span class="token operator">&lt;</span>tensorflow<span class="token punctuation">.</span>python<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>initializers<span class="token punctuation">.</span>initializers_v1<span class="token punctuation">.</span>RandomNormal <span class="token builtin">object</span> at <span class="token number">0x000001B255B75C70</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> embedding_name<span class="token operator">=</span><span class="token string">'age'</span><span class="token punctuation">,</span> group_name<span class="token operator">=</span><span class="token string">'default_group'</span><span class="token punctuation">,</span> trainable<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  SparseFeat<span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">'movie_id'</span><span class="token punctuation">,</span> vocabulary_size<span class="token operator">=</span><span class="token number">209</span><span class="token punctuation">,</span> embedding_dim<span class="token operator">=</span><span class="token number">8</span><span class="token punctuation">,</span> use_hash<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span><span class="token string">'int32'</span><span class="token punctuation">,</span> embeddings_initializer<span class="token operator">=</span><span class="token operator">&lt;</span>tensorflow<span class="token punctuation">.</span>python<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>initializers<span class="token punctuation">.</span>initializers_v1<span class="token punctuation">.</span>RandomNormal <span class="token builtin">object</span> at <span class="token number">0x000001B255B75D00</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> embedding_name<span class="token operator">=</span><span class="token string">'movie_id'</span><span class="token punctuation">,</span> group_name<span class="token operator">=</span><span class="token string">'default_group'</span><span class="token punctuation">,</span> trainable<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  SparseFeat<span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">'movie_type_id'</span><span class="token punctuation">,</span> vocabulary_size<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span> embedding_dim<span class="token operator">=</span><span class="token number">8</span><span class="token punctuation">,</span> use_hash<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span><span class="token string">'int32'</span><span class="token punctuation">,</span> embeddings_initializer<span class="token operator">=</span><span class="token operator">&lt;</span>tensorflow<span class="token punctuation">.</span>python<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>initializers<span class="token punctuation">.</span>initializers_v1<span class="token punctuation">.</span>RandomNormal <span class="token builtin">object</span> at <span class="token number">0x000001B255B75910</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> embedding_name<span class="token operator">=</span><span class="token string">'movie_type_id'</span><span class="token punctuation">,</span> group_name<span class="token operator">=</span><span class="token string">'default_group'</span><span class="token punctuation">,</span> trainable<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  DenseFeat<span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">'hist_len'</span><span class="token punctuation">,</span> dimension<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span><span class="token string">'float32'</span><span class="token punctuation">,</span> transform_fn<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  VarLenSparseFeat<span class="token punctuation">(</span>sparsefeat<span class="token operator">=</span>SparseFeat<span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">'hist_movie_id'</span><span class="token punctuation">,</span> vocabulary_size<span class="token operator">=</span><span class="token number">209</span><span class="token punctuation">,</span> embedding_dim<span class="token operator">=</span><span class="token number">8</span><span class="token punctuation">,</span> use_hash<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span><span class="token string">'int32'</span><span class="token punctuation">,</span> embeddings_initializer<span class="token operator">=</span><span class="token operator">&lt;</span>tensorflow<span class="token punctuation">.</span>python<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>initializers<span class="token punctuation">.</span>initializers_v1<span class="token punctuation">.</span>RandomNormal <span class="token builtin">object</span> at <span class="token number">0x000001B255B90400</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> embedding_name<span class="token operator">=</span><span class="token string">'hist_movie_id'</span><span class="token punctuation">,</span> group_name<span class="token operator">=</span><span class="token string">'default_group'</span><span class="token punctuation">,</span> trainable<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">,</span> maxlen<span class="token operator">=</span><span class="token number">50</span><span class="token punctuation">,</span> combiner<span class="token operator">=</span><span class="token string">'mean'</span><span class="token punctuation">,</span> length_name<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> weight_name<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> weight_norm<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token builtin">list</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 行为特征列表，表示基础特征</span>behavior_feature_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"movie_id"</span><span class="token punctuation">]</span><span class="token comment"># 行为序列特征</span>behavior_seq_feature_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"hist_movie_id"</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="2、DIN-model-build"><a href="#2、DIN-model-build" class="headerlink" title="2、DIN model build"></a>2、DIN model build</h2><h3 id="2-1-Input-Layers"><a href="#2-1-Input-Layers" class="headerlink" title="2.1 Input Layers"></a>2.1 Input Layers</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">build_input_layers</span><span class="token punctuation">(</span>feature_columns<span class="token punctuation">)</span><span class="token punctuation">:</span>    input_layer_dict <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>        <span class="token keyword">for</span> fc <span class="token keyword">in</span> feature_columns<span class="token punctuation">:</span>        <span class="token keyword">if</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>fc<span class="token punctuation">,</span> SparseFeat<span class="token punctuation">)</span><span class="token punctuation">:</span>            input_layer_dict<span class="token punctuation">[</span>fc<span class="token punctuation">.</span>name<span class="token punctuation">]</span> <span class="token operator">=</span> Input<span class="token punctuation">(</span>shape<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token punctuation">)</span><span class="token punctuation">,</span> name<span class="token operator">=</span>fc<span class="token punctuation">.</span>name<span class="token punctuation">)</span>        <span class="token keyword">elif</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>fc<span class="token punctuation">,</span> DenseFeat<span class="token punctuation">)</span><span class="token punctuation">:</span>            input_layer_dict<span class="token punctuation">[</span>fc<span class="token punctuation">.</span>name<span class="token punctuation">]</span> <span class="token operator">=</span> Input<span class="token punctuation">(</span>shape<span class="token operator">=</span><span class="token punctuation">(</span>fc<span class="token punctuation">.</span>dimension<span class="token punctuation">,</span> <span class="token punctuation">)</span><span class="token punctuation">,</span> name<span class="token operator">=</span>fc<span class="token punctuation">.</span>name<span class="token punctuation">)</span>        <span class="token keyword">elif</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>fc<span class="token punctuation">,</span> VarLenSparseFeat<span class="token punctuation">)</span><span class="token punctuation">:</span>            input_layer_dict<span class="token punctuation">[</span>fc<span class="token punctuation">.</span>name<span class="token punctuation">]</span> <span class="token operator">=</span> Input<span class="token punctuation">(</span>shape<span class="token operator">=</span><span class="token punctuation">(</span>fc<span class="token punctuation">.</span>maxlen<span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token punctuation">,</span> name<span class="token operator">=</span>fc<span class="token punctuation">.</span>name<span class="token punctuation">)</span>    <span class="token keyword">return</span> input_layer_dict<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">input_layer_dict <span class="token operator">=</span> build_input_layers<span class="token punctuation">(</span>feature_columns<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>input_layer_dict<span class="token punctuation">[</span><span class="token string">"user_id"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>input_layer_dict<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token builtin">type</span><span class="token punctuation">(</span>input_layer_dict<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token builtin">type</span><span class="token punctuation">(</span>input_layer_dict<span class="token punctuation">[</span><span class="token string">"user_id"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">KerasTensor<span class="token punctuation">(</span>type_spec<span class="token operator">=</span>TensorSpec<span class="token punctuation">(</span>shape<span class="token operator">=</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span>tf<span class="token punctuation">.</span>float32<span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">'user_id'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">'user_id'</span><span class="token punctuation">,</span> description<span class="token operator">=</span><span class="token string">"created by layer 'user_id'"</span><span class="token punctuation">)</span> <span class="token number">7</span> <span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token string">'dict'</span><span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 将 Input 层转化成列表形式作为 model 的输入</span>input_layers <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>input_layer_dict<span class="token punctuation">.</span>values<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>input_layers<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token punctuation">[</span><span class="token operator">&lt;</span>KerasTensor<span class="token punctuation">:</span> shape<span class="token operator">=</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> dtype<span class="token operator">=</span>float32 <span class="token punctuation">(</span>created by layer <span class="token string">'user_id'</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span>KerasTensor<span class="token punctuation">:</span> shape<span class="token operator">=</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> dtype<span class="token operator">=</span>float32 <span class="token punctuation">(</span>created by layer <span class="token string">'gender'</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span>KerasTensor<span class="token punctuation">:</span> shape<span class="token operator">=</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> dtype<span class="token operator">=</span>float32 <span class="token punctuation">(</span>created by layer <span class="token string">'age'</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span>KerasTensor<span class="token punctuation">:</span> shape<span class="token operator">=</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> dtype<span class="token operator">=</span>float32 <span class="token punctuation">(</span>created by layer <span class="token string">'movie_id'</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span>KerasTensor<span class="token punctuation">:</span> shape<span class="token operator">=</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> dtype<span class="token operator">=</span>float32 <span class="token punctuation">(</span>created by layer <span class="token string">'movie_type_id'</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span>KerasTensor<span class="token punctuation">:</span> shape<span class="token operator">=</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> dtype<span class="token operator">=</span>float32 <span class="token punctuation">(</span>created by layer <span class="token string">'hist_len'</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span>KerasTensor<span class="token punctuation">:</span> shape<span class="token operator">=</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span> dtype<span class="token operator">=</span>float32 <span class="token punctuation">(</span>created by layer <span class="token string">'hist_movie_id'</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 筛选出 sparse and dense</span><span class="token comment"># 注：这里并没有计入 hist_movie_id(VarLenSparseFeat)</span>sparse_feature_columns <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">filter</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> SparseFeat<span class="token punctuation">)</span><span class="token punctuation">,</span> feature_columns<span class="token punctuation">)</span><span class="token punctuation">)</span>dense_feature_columns <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">filter</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> DenseFeat<span class="token punctuation">)</span><span class="token punctuation">,</span> feature_columns<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h4 id="2-1-1-Dense-型特征"><a href="#2-1-1-Dense-型特征" class="headerlink" title="2.1.1 Dense 型特征"></a>2.1.1 Dense 型特征</h4><ul><li>Dense型特征：由于是数值型了，这里为每个这样的特征建立Input层接收这种输入， 然后拼接起来先放着，等离散的那边处理好之后，和离散的拼接起来进DNN</li></ul><pre class="line-numbers language-python" data-language="python"><code class="language-python">dnn_dense_input <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">for</span> fc <span class="token keyword">in</span> dense_feature_columns<span class="token punctuation">:</span>    dnn_dense_input<span class="token punctuation">.</span>append<span class="token punctuation">(</span>input_layer_dict<span class="token punctuation">[</span>fc<span class="token punctuation">.</span>name<span class="token punctuation">]</span><span class="token punctuation">)</span>dnn_dense_input<span class="token punctuation">,</span><span class="token builtin">len</span><span class="token punctuation">(</span>dnn_dense_input<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token operator">&lt;</span>KerasTensor<span class="token punctuation">:</span> shape<span class="token operator">=</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> dtype<span class="token operator">=</span>float32 <span class="token punctuation">(</span>created by layer <span class="token string">'hist_len'</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 输入层拼接成列表</span><span class="token keyword">def</span> <span class="token function">concat_input_list</span><span class="token punctuation">(</span>input_list<span class="token punctuation">)</span><span class="token punctuation">:</span>    feature_nums <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>input_list<span class="token punctuation">)</span>    <span class="token keyword">if</span> feature_nums <span class="token operator">&gt;</span> <span class="token number">1</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> Concatenate<span class="token punctuation">(</span>axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">(</span>input_list<span class="token punctuation">)</span>    <span class="token keyword">elif</span> feature_nums <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> input_list<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token boolean">None</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 此刻 dnn_dense_input size = 1，因为简化，凭借后的数据和原来一致，</span><span class="token comment"># 但是如果有很多列数据，就还是需要用到拼接</span>dnn_dense_input <span class="token operator">=</span> concat_input_list<span class="token punctuation">(</span>dnn_dense_input<span class="token punctuation">)</span>dnn_dense_input <span class="token comment"># dnn dense input for end</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token operator">&lt;</span>KerasTensor<span class="token punctuation">:</span> shape<span class="token operator">=</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> dtype<span class="token operator">=</span>float32 <span class="token punctuation">(</span>created by layer <span class="token string">'hist_len'</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="2-1-2-Sparse-型特征"><a href="#2-1-2-Sparse-型特征" class="headerlink" title="2.1.2 Sparse 型特征"></a>2.1.2 Sparse 型特征</h4><ul><li>Sparse 型特征，为离散型特征建立 Input 层接收输入，然后需要先通过 embedding 层转成低维稠密向量，然后拼接起来放着，等变长离散那边处理好之后， 一块拼起来进 DNN， 但是这里面要注意有个特征的 embedding 向量还得拿出来用，就是候选商品的 embedding 向量，这个还得和后面的计算相关性，对历史行为序列加权。</li></ul><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">build_embedding_layers</span><span class="token punctuation">(</span>feature_columns<span class="token punctuation">,</span> input_layer_dict<span class="token punctuation">)</span><span class="token punctuation">:</span>    embedding_layer_dict <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>        <span class="token keyword">for</span> fc <span class="token keyword">in</span> feature_columns<span class="token punctuation">:</span>        <span class="token keyword">if</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>fc<span class="token punctuation">,</span> SparseFeat<span class="token punctuation">)</span><span class="token punctuation">:</span>            embedding_layer_dict<span class="token punctuation">[</span>fc<span class="token punctuation">.</span>name<span class="token punctuation">]</span> <span class="token operator">=</span> Embedding<span class="token punctuation">(</span>fc<span class="token punctuation">.</span>vocabulary_size<span class="token punctuation">,</span> fc<span class="token punctuation">.</span>embedding_dim<span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">"emb_"</span><span class="token operator">+</span>fc<span class="token punctuation">.</span>name<span class="token punctuation">)</span>        <span class="token keyword">elif</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>fc<span class="token punctuation">,</span> VarLenSparseFeat<span class="token punctuation">)</span><span class="token punctuation">:</span>            embedding_layer_dict<span class="token punctuation">[</span>fc<span class="token punctuation">.</span>name<span class="token punctuation">]</span> <span class="token operator">=</span> Embedding<span class="token punctuation">(</span>fc<span class="token punctuation">.</span>vocabulary_size<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span> fc<span class="token punctuation">.</span>embedding_dim<span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">"emb_"</span><span class="token operator">+</span>fc<span class="token punctuation">.</span>name<span class="token punctuation">,</span> mask_zero<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> embedding_layer_dict            <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 构建 embedding 字典</span>embedding_layer_dict <span class="token operator">=</span> build_embedding_layers<span class="token punctuation">(</span>feature_columns<span class="token punctuation">,</span> input_layer_dict<span class="token punctuation">)</span>embedding_layer_dict<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token punctuation">{</span><span class="token string">'user_id'</span><span class="token punctuation">:</span> <span class="token operator">&lt;</span>tensorflow<span class="token punctuation">.</span>python<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>layers<span class="token punctuation">.</span>embeddings<span class="token punctuation">.</span>Embedding at <span class="token number">0x1b255cddcd0</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> <span class="token string">'gender'</span><span class="token punctuation">:</span> <span class="token operator">&lt;</span>tensorflow<span class="token punctuation">.</span>python<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>layers<span class="token punctuation">.</span>embeddings<span class="token punctuation">.</span>Embedding at <span class="token number">0x1b255cd4fa0</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> <span class="token string">'age'</span><span class="token punctuation">:</span> <span class="token operator">&lt;</span>tensorflow<span class="token punctuation">.</span>python<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>layers<span class="token punctuation">.</span>embeddings<span class="token punctuation">.</span>Embedding at <span class="token number">0x1b255cdd130</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> <span class="token string">'movie_id'</span><span class="token punctuation">:</span> <span class="token operator">&lt;</span>tensorflow<span class="token punctuation">.</span>python<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>layers<span class="token punctuation">.</span>embeddings<span class="token punctuation">.</span>Embedding at <span class="token number">0x1b255cddac0</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> <span class="token string">'movie_type_id'</span><span class="token punctuation">:</span> <span class="token operator">&lt;</span>tensorflow<span class="token punctuation">.</span>python<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>layers<span class="token punctuation">.</span>embeddings<span class="token punctuation">.</span>Embedding at <span class="token number">0x1b255bc93d0</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> <span class="token string">'hist_movie_id'</span><span class="token punctuation">:</span> <span class="token operator">&lt;</span>tensorflow<span class="token punctuation">.</span>python<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>layers<span class="token punctuation">.</span>embeddings<span class="token punctuation">.</span>Embedding at <span class="token number">0x1b255bc95e0</span><span class="token operator">&gt;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 将所有的 sparse 特征 embedding 拼接</span><span class="token keyword">def</span> <span class="token function">concat_embedding_list</span><span class="token punctuation">(</span>feature_columns<span class="token punctuation">,</span> input_layer_dict<span class="token punctuation">,</span> embedding_layer_dict<span class="token punctuation">,</span> flatten<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    embedding_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> fc <span class="token keyword">in</span> feature_columns<span class="token punctuation">:</span>        _input <span class="token operator">=</span> input_layer_dict<span class="token punctuation">[</span>fc<span class="token punctuation">.</span>name<span class="token punctuation">]</span>        _embed <span class="token operator">=</span> embedding_layer_dict<span class="token punctuation">[</span>fc<span class="token punctuation">.</span>name<span class="token punctuation">]</span>        embed <span class="token operator">=</span> _embed<span class="token punctuation">(</span>_input<span class="token punctuation">)</span>                <span class="token keyword">if</span> flatten<span class="token punctuation">:</span>            embed <span class="token operator">=</span> Flatten<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span>embed<span class="token punctuation">)</span>        embedding_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span>embed<span class="token punctuation">)</span>    <span class="token keyword">return</span> embedding_list<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 将所有的 sparse 特征 embedding 拼接</span>dnn_sparse_embed_input <span class="token operator">=</span> concat_embedding_list<span class="token punctuation">(</span>sparse_feature_columns<span class="token punctuation">,</span> input_layer_dict<span class="token punctuation">,</span> embedding_layer_dict<span class="token punctuation">,</span> flatten<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>dnn_sparse_embed_input <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token punctuation">[</span><span class="token operator">&lt;</span>KerasTensor<span class="token punctuation">:</span> shape<span class="token operator">=</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span> dtype<span class="token operator">=</span>float32 <span class="token punctuation">(</span>created by layer <span class="token string">'flatten'</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span>KerasTensor<span class="token punctuation">:</span> shape<span class="token operator">=</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span> dtype<span class="token operator">=</span>float32 <span class="token punctuation">(</span>created by layer <span class="token string">'flatten_1'</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span>KerasTensor<span class="token punctuation">:</span> shape<span class="token operator">=</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span> dtype<span class="token operator">=</span>float32 <span class="token punctuation">(</span>created by layer <span class="token string">'flatten_2'</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span>KerasTensor<span class="token punctuation">:</span> shape<span class="token operator">=</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span> dtype<span class="token operator">=</span>float32 <span class="token punctuation">(</span>created by layer <span class="token string">'flatten_3'</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span>KerasTensor<span class="token punctuation">:</span> shape<span class="token operator">=</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span> dtype<span class="token operator">=</span>float32 <span class="token punctuation">(</span>created by layer <span class="token string">'flatten_4'</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">dnn_sparse_input <span class="token operator">=</span> concat_input_list<span class="token punctuation">(</span>dnn_sparse_embed_input<span class="token punctuation">)</span>dnn_sparse_input <span class="token comment"># dnn sparse input for end</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token operator">&lt;</span>KerasTensor<span class="token punctuation">:</span> shape<span class="token operator">=</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">)</span> dtype<span class="token operator">=</span>float32 <span class="token punctuation">(</span>created by layer <span class="token string">'concatenate'</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="2-2-VarlenSparse-型特征"><a href="#2-2-VarlenSparse-型特征" class="headerlink" title="2.2 VarlenSparse 型特征"></a>2.2 VarlenSparse 型特征</h3><p><img src="/2021/03/27/task5-din/pic1.png" alt=""></p><pre class="line-numbers language-python" data-language="python"><code class="language-python">behavior_feature_list<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token punctuation">[</span><span class="token string">'movie_id'</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">behavior_seq_feature_list<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token punctuation">[</span><span class="token string">'hist_movie_id'</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">embedding_lookup</span><span class="token punctuation">(</span>feature_columns<span class="token punctuation">,</span> input_layer_dict<span class="token punctuation">,</span> embedding_layer_dict<span class="token punctuation">)</span><span class="token punctuation">:</span>    embedding_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>        <span class="token keyword">for</span> fc <span class="token keyword">in</span> feature_columns<span class="token punctuation">:</span>        _input <span class="token operator">=</span> input_layer_dict<span class="token punctuation">[</span>fc<span class="token punctuation">]</span>        _embed <span class="token operator">=</span> embedding_layer_dict<span class="token punctuation">[</span>fc<span class="token punctuation">]</span>        embed <span class="token operator">=</span> _embed<span class="token punctuation">(</span>_input<span class="token punctuation">)</span>                <span class="token comment"># 未进行 Flatten</span>        embedding_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span>embed<span class="token punctuation">)</span>    <span class="token keyword">return</span> embedding_list<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">query_embed_list <span class="token operator">=</span> embedding_lookup<span class="token punctuation">(</span>behavior_feature_list<span class="token punctuation">,</span> input_layer_dict<span class="token punctuation">,</span> embedding_layer_dict<span class="token punctuation">)</span>query_embed_list<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token punctuation">[</span><span class="token operator">&lt;</span>KerasTensor<span class="token punctuation">:</span> shape<span class="token operator">=</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span> dtype<span class="token operator">=</span>float32 <span class="token punctuation">(</span>created by layer <span class="token string">'emb_movie_id'</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">keys_embed_list <span class="token operator">=</span> embedding_lookup<span class="token punctuation">(</span>behavior_seq_feature_list<span class="token punctuation">,</span> input_layer_dict<span class="token punctuation">,</span> embedding_layer_dict<span class="token punctuation">)</span>keys_embed_list<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token punctuation">[</span><span class="token operator">&lt;</span>KerasTensor<span class="token punctuation">:</span> shape<span class="token operator">=</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span> dtype<span class="token operator">=</span>float32 <span class="token punctuation">(</span>created by layer <span class="token string">'emb_hist_movie_id'</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="2-2-1-Dice-Data-Dependent-Activation-Function"><a href="#2-2-1-Dice-Data-Dependent-Activation-Function" class="headerlink" title="2.2.1 Dice: Data Dependent Activation Function"></a>2.2.1 Dice: Data Dependent Activation Function</h4><p>PReLU 是 ReLU 的改良版，ReLU 可以看作是<code>x*Max(x,0)</code>，相当于输出 x 经过了一个在 0 点的阶跃整流器。由于 ReLU 在 x 小于 0 的时候，梯度为 0，可能导致网络停止更新，PReLU 对整流器的左半部分形式进行了修改，使得 x 小于 0 时输出不为 0。<br>研究表明，PReLU 能提高准确率但是也稍微增加了过拟合的风险。PReLU 形式如下：</p><script type="math/tex; mode=display">f(s)=\left\{\begin{array}{ll}s & \text { if } s>0 \\\alpha s & \text { if } s \leq 0\end{array}=p(s) \cdot s+(1-p(s)) \cdot \alpha s\right.</script><p>无论是 ReLU 还是 PReLU 突变点都在 0，论文里认为，对于所有输入不应该都选择 0 点为突变点而是应该依赖于数据的。于是提出了一种 <strong>data dependent</strong> 的方法：<strong>Dice 激活函数</strong>。形式如下：</p><script type="math/tex; mode=display">f(s)=p(s) \cdot s+(1-p(s)) \cdot \alpha s, p(s)=\frac{1}{1+e^{-\frac{s-E[s]}{\sqrt{\operatorname{Var}[s]+\epsilon}}}}</script><p>可以看出，$P(s)$是一个概率值，这个概率值决定着输出是取$\alpha s,$或者是$s$，$P(s)$也起到了一个整流器的作用。</p><p><img src="/2021/03/27/task5-din/pic2.png" alt=""></p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">Dice</span><span class="token punctuation">(</span>Layer<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token builtin">super</span><span class="token punctuation">(</span>Dice<span class="token punctuation">,</span> self<span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>bn <span class="token operator">=</span> BatchNormalization<span class="token punctuation">(</span>center<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> scale<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>        <span class="token keyword">def</span> <span class="token function">build</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> input_shape<span class="token punctuation">)</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>alpha <span class="token operator">=</span> self<span class="token punctuation">.</span>add_weight<span class="token punctuation">(</span>shape<span class="token operator">=</span><span class="token punctuation">(</span>input_shape<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span>tf<span class="token punctuation">.</span>float32<span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">"alpha"</span><span class="token punctuation">)</span>        <span class="token keyword">def</span> <span class="token function">call</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">:</span>        x_normed <span class="token operator">=</span> self<span class="token punctuation">.</span>bn<span class="token punctuation">(</span>x<span class="token punctuation">)</span>        x_p <span class="token operator">=</span> tf<span class="token punctuation">.</span>sigmoid<span class="token punctuation">(</span>x_normed<span class="token punctuation">)</span>                <span class="token keyword">return</span> self<span class="token punctuation">.</span>alpha <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">1.0</span><span class="token operator">-</span>x_p<span class="token punctuation">)</span> <span class="token operator">*</span> x<span class="token operator">+</span>x_p <span class="token operator">*</span> x    <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="2-2-2-注意力机制"><a href="#2-2-2-注意力机制" class="headerlink" title="2.2.2 注意力机制"></a>2.2.2 注意力机制</h4><p>Attention 机制就是通过计算 query 与各个 key 的相似性，得到每个 key 的权重系数，再通过对 value 加权求和，得到最终 attention 数值。</p><p><img src="/2021/03/27/task5-din/pic3.jpg" alt=""></p><p><code>tf.concat([queries, keys, queries-keys, queries*keys], axis=-1)</code> 这一部分并不是理解，参考下别人的解读：</p><ul><li><p>这是个小细节，其实很多算法都有各种解释，比如这个差我们可以解释为差距，这个乘积我们可以解释为高阶信息。</p><p>但是真正背后的思考是，在线系统的 latency 是要求很严格的，而 attention 部分的计算是发生在 target item 和 user 的 behavior list 之间的，同时在线打分的时候每次要计算几百个target item的CTR。这使得attention部分的计算复杂度增加一点，在线的计算压力就会增加非常多，所以attention unit必须设计得足够简单。如果这个地方没什么限制显然把attention unit的神经网络加深就好了，但是有限制，我们希望计算简单效果又好，就凭经验加了一个差和一个乘积，用先验的知识降低模型拟合的难度，在线实验验证也有效就在公开数据集也加上了。</p></li></ul><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">LocalActivationUnit</span><span class="token punctuation">(</span>Layer<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> hidden_units<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">,</span> <span class="token number">128</span><span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">)</span><span class="token punctuation">,</span> activation<span class="token operator">=</span><span class="token string">"prelu"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token builtin">super</span><span class="token punctuation">(</span>LocalActivationUnit<span class="token punctuation">,</span> self<span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>hidden_units <span class="token operator">=</span> hidden_units        self<span class="token punctuation">.</span>linear <span class="token operator">=</span> Dense<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>dnn <span class="token operator">=</span> <span class="token punctuation">[</span>Dense<span class="token punctuation">(</span>unit<span class="token punctuation">,</span> activation<span class="token operator">=</span>PReLU<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">if</span> activation<span class="token operator">==</span><span class="token string">"prelu"</span> <span class="token keyword">else</span> Dice<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">for</span> unit <span class="token keyword">in</span> hidden_units<span class="token punctuation">]</span>        <span class="token keyword">def</span> <span class="token function">call</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> inputs<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token comment"># query: B x 1 x emb_dim  keys: B x len x emb_dim</span>        <span class="token comment"># query: shape=(None, 1, 8) keys: shape=(None, 50, 8)</span>        query<span class="token punctuation">,</span> keys <span class="token operator">=</span> inputs                <span class="token comment"># 获取序列长度</span>        keys_len <span class="token operator">=</span> keys<span class="token punctuation">.</span>get_shape<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>           <span class="token comment"># 重复 query 特征，得到 queries，使得 queries 的 shape 与 keys 一致</span>    <span class="token comment"># tf.tile为复制函数，1代表在该维度上保持一致，keys_len 表示在该维度上 x Keys_len</span>        queries <span class="token operator">=</span> tf<span class="token punctuation">.</span>tile<span class="token punctuation">(</span>query<span class="token punctuation">,</span> multiples<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> keys_len<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment"># (None, len, emb_dim) </span>                <span class="token comment"># 特征拼接</span>        <span class="token comment"># B x len(50) x 4*emb_dim(8)</span>        att_input <span class="token operator">=</span> tf<span class="token punctuation">.</span>concat<span class="token punctuation">(</span><span class="token punctuation">[</span>queries<span class="token punctuation">,</span> keys<span class="token punctuation">,</span> queries<span class="token operator">-</span>keys<span class="token punctuation">,</span> queries<span class="token operator">*</span>keys<span class="token punctuation">]</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>                att_out <span class="token operator">=</span> att_input        <span class="token keyword">for</span> fc <span class="token keyword">in</span> self<span class="token punctuation">.</span>dnn<span class="token punctuation">:</span>            att_out <span class="token operator">=</span> fc<span class="token punctuation">(</span>att_out<span class="token punctuation">)</span> <span class="token comment"># B x len x att_out</span>                att_out <span class="token operator">=</span> self<span class="token punctuation">.</span>linear<span class="token punctuation">(</span>att_out<span class="token punctuation">)</span>        att_out <span class="token operator">=</span> tf<span class="token punctuation">.</span>squeeze<span class="token punctuation">(</span>att_out<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>                <span class="token keyword">return</span> att_out<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">AttentionPoolingLayer</span><span class="token punctuation">(</span>Layer<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> att_hidden_units<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">,</span> <span class="token number">128</span><span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token builtin">super</span><span class="token punctuation">(</span>AttentionPoolingLayer<span class="token punctuation">,</span> self<span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>att_hidden_units <span class="token operator">=</span> att_hidden_units        self<span class="token punctuation">.</span>local_att <span class="token operator">=</span> LocalActivationUnit<span class="token punctuation">(</span>self<span class="token punctuation">.</span>att_hidden_units<span class="token punctuation">)</span>            <span class="token keyword">def</span> <span class="token function">call</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> inputs<span class="token punctuation">)</span><span class="token punctuation">:</span>        queries<span class="token punctuation">,</span> keys <span class="token operator">=</span> inputs                key_masks <span class="token operator">=</span> tf<span class="token punctuation">.</span>not_equal<span class="token punctuation">(</span>keys<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span>                attention_score <span class="token operator">=</span> self<span class="token punctuation">.</span>local_att<span class="token punctuation">(</span><span class="token punctuation">[</span>queries<span class="token punctuation">,</span> keys<span class="token punctuation">]</span><span class="token punctuation">)</span>        paddings <span class="token operator">=</span> tf<span class="token punctuation">.</span>zeros_like<span class="token punctuation">(</span>attention_score<span class="token punctuation">)</span>                outputs <span class="token operator">=</span> tf<span class="token punctuation">.</span>where<span class="token punctuation">(</span>key_masks<span class="token punctuation">,</span> attention_score<span class="token punctuation">,</span> paddings<span class="token punctuation">)</span>                outputs <span class="token operator">=</span> tf<span class="token punctuation">.</span>expand_dims<span class="token punctuation">(</span>outputs<span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>                outputs <span class="token operator">=</span> tf<span class="token punctuation">.</span>matmul<span class="token punctuation">(</span>outputs<span class="token punctuation">,</span> keys<span class="token punctuation">)</span>                outputs <span class="token operator">=</span> tf<span class="token punctuation">.</span>squeeze<span class="token punctuation">(</span>outputs<span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>                <span class="token keyword">return</span> outputs    <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">dnn_seq_input_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>keys_embed_list<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token comment"># 记得想 AttentionPoolingLayer()() 这种调用方式为什么可行</span>    seq_emb <span class="token operator">=</span> AttentionPoolingLayer<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">[</span>query_embed_list<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> keys_embed_list<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    dnn_seq_input_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span>seq_emb<span class="token punctuation">)</span>dnn_seq_input_list<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token punctuation">[</span><span class="token operator">&lt;</span>KerasTensor<span class="token punctuation">:</span> shape<span class="token operator">=</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span> dtype<span class="token operator">=</span>float32 <span class="token punctuation">(</span>created by layer <span class="token string">'attention_pooling_layer'</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 这里数据 size = 1</span>dnn_seq_input <span class="token operator">=</span> concat_input_list<span class="token punctuation">(</span>dnn_seq_input_list<span class="token punctuation">)</span>dnn_seq_input <span class="token comment"># dnn seq input for end</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token operator">&lt;</span>KerasTensor<span class="token punctuation">:</span> shape<span class="token operator">=</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span> dtype<span class="token operator">=</span>float32 <span class="token punctuation">(</span>created by layer <span class="token string">'attention_pooling_layer'</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="2-3-DNN"><a href="#2-3-DNN" class="headerlink" title="2.3 DNN"></a>2.3 DNN</h3><p>经过上面步骤的处理， 得到了处理好的连续特征（Dense），离散特征（Sparse）和变长离散特征（VarlenSparse）， 接下来把这三种特征拼接，进DNN网络，得到最后的输出结果即可。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 1 + 40 + 8 = 49</span>dnn_input <span class="token operator">=</span> Concatenate<span class="token punctuation">(</span>axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">[</span>dnn_dense_input<span class="token punctuation">,</span> dnn_sparse_input<span class="token punctuation">,</span> dnn_seq_input<span class="token punctuation">]</span><span class="token punctuation">)</span>dnn_input<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token operator">&lt;</span>KerasTensor<span class="token punctuation">:</span> shape<span class="token operator">=</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">49</span><span class="token punctuation">)</span> dtype<span class="token operator">=</span>float32 <span class="token punctuation">(</span>created by layer <span class="token string">'concatenate_1'</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">get_dnn_logits</span><span class="token punctuation">(</span>dnn_input<span class="token punctuation">,</span> hidden_units<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">)</span><span class="token punctuation">,</span> activation<span class="token operator">=</span><span class="token string">'prelu'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    dnns <span class="token operator">=</span> <span class="token punctuation">[</span>Dense<span class="token punctuation">(</span>unit<span class="token punctuation">,</span> activation<span class="token operator">=</span>PReLU<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">if</span> activation <span class="token operator">==</span> <span class="token string">'prelu'</span> <span class="token keyword">else</span> Dice<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">for</span> unit <span class="token keyword">in</span> hidden_units<span class="token punctuation">]</span>    dnn_out <span class="token operator">=</span> dnn_input    <span class="token keyword">for</span> dnn <span class="token keyword">in</span> dnns<span class="token punctuation">:</span>        dnn_out <span class="token operator">=</span> dnn<span class="token punctuation">(</span>dnn_out<span class="token punctuation">)</span>        <span class="token comment"># 获取logits</span>    dnn_logits <span class="token operator">=</span> Dense<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> activation<span class="token operator">=</span><span class="token string">'sigmoid'</span><span class="token punctuation">)</span><span class="token punctuation">(</span>dnn_out<span class="token punctuation">)</span>    <span class="token keyword">return</span> dnn_logits<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">dnn_logits <span class="token operator">=</span> get_dnn_logits<span class="token punctuation">(</span>dnn_input<span class="token punctuation">,</span> activation<span class="token operator">=</span><span class="token string">"prelu"</span><span class="token punctuation">)</span>dnn_logits<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token operator">&lt;</span>KerasTensor<span class="token punctuation">:</span> shape<span class="token operator">=</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> dtype<span class="token operator">=</span>float32 <span class="token punctuation">(</span>created by layer <span class="token string">'dense_6'</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="2-4-Output"><a href="#2-4-Output" class="headerlink" title="2.4 Output"></a>2.4 Output</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python">model <span class="token operator">=</span> Model<span class="token punctuation">(</span>input_layers<span class="token punctuation">,</span> dnn_logits<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">model<span class="token punctuation">.</span>summary<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">Model<span class="token punctuation">:</span> <span class="token string">"model"</span>__________________________________________________________________________________________________Layer <span class="token punctuation">(</span><span class="token builtin">type</span><span class="token punctuation">)</span>                    Output Shape         Param <span class="token comment">#     Connected to                     </span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span>user_id <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>            <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________gender <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>             <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________age <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________movie_id <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>           <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________movie_type_id <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>      <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________emb_user_id <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>         <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span>         <span class="token number">32</span>          user_id<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                    __________________________________________________________________________________________________emb_gender <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>          <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span>         <span class="token number">24</span>          gender<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                     __________________________________________________________________________________________________emb_age <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>             <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span>         <span class="token number">32</span>          age<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                        __________________________________________________________________________________________________emb_movie_id <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>        <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span>         <span class="token number">1672</span>        movie_id<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                    movie_id<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                   __________________________________________________________________________________________________emb_movie_type_id <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>   <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span>         <span class="token number">80</span>          movie_type_id<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>              __________________________________________________________________________________________________hist_movie_id <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>      <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">]</span>         <span class="token number">0</span>                                            __________________________________________________________________________________________________flatten <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>               <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span>            <span class="token number">0</span>           emb_user_id<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                __________________________________________________________________________________________________flatten_1 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>             <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span>            <span class="token number">0</span>           emb_gender<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                 __________________________________________________________________________________________________flatten_2 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>             <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span>            <span class="token number">0</span>           emb_age<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                    __________________________________________________________________________________________________flatten_3 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>             <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span>            <span class="token number">0</span>           emb_movie_id<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>               __________________________________________________________________________________________________flatten_4 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>             <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span>            <span class="token number">0</span>           emb_movie_type_id<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>          __________________________________________________________________________________________________emb_hist_movie_id <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>   <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span>        <span class="token number">1680</span>        hist_movie_id<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>              __________________________________________________________________________________________________hist_len <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>           <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________concatenate <span class="token punctuation">(</span>Concatenate<span class="token punctuation">)</span>       <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">)</span>           <span class="token number">0</span>           flatten<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                     flatten_1<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                   flatten_2<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                   flatten_3<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                   flatten_4<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                  __________________________________________________________________________________________________attention_pooling_layer <span class="token punctuation">(</span>Attent <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span>            <span class="token number">72065</span>       emb_movie_id<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                emb_hist_movie_id<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>          __________________________________________________________________________________________________concatenate_1 <span class="token punctuation">(</span>Concatenate<span class="token punctuation">)</span>     <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">49</span><span class="token punctuation">)</span>           <span class="token number">0</span>           hist_len<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                    concatenate<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                 attention_pooling_layer<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>    __________________________________________________________________________________________________dense_4 <span class="token punctuation">(</span>Dense<span class="token punctuation">)</span>                 <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">)</span>          <span class="token number">10200</span>       concatenate_1<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>              __________________________________________________________________________________________________dense_5 <span class="token punctuation">(</span>Dense<span class="token punctuation">)</span>                 <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">)</span>           <span class="token number">16160</span>       dense_4<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                    __________________________________________________________________________________________________dense_6 <span class="token punctuation">(</span>Dense<span class="token punctuation">)</span>                 <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>            <span class="token number">81</span>          dense_5<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                    <span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span>Total params<span class="token punctuation">:</span> <span class="token number">102</span><span class="token punctuation">,</span><span class="token number">026</span>Trainable params<span class="token punctuation">:</span> <span class="token number">102</span><span class="token punctuation">,</span><span class="token number">026</span>Non<span class="token operator">-</span>trainable params<span class="token punctuation">:</span> <span class="token number">0</span>__________________________________________________________________________________________________<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">model<span class="token punctuation">.</span><span class="token builtin">compile</span><span class="token punctuation">(</span><span class="token string">"adam"</span><span class="token punctuation">,</span> <span class="token string">"binary_crossentropy"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">model<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X_train<span class="token punctuation">,</span> y_train<span class="token punctuation">,</span> batch_size<span class="token operator">=</span><span class="token number">64</span><span class="token punctuation">,</span> epochs<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span> validation_split<span class="token operator">=</span><span class="token number">0.3</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">Epoch <span class="token number">1</span><span class="token operator">/</span><span class="token number">10</span><span class="token number">16</span><span class="token operator">/</span><span class="token number">16</span> <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token punctuation">]</span> <span class="token operator">-</span> 3s 63ms<span class="token operator">/</span>step <span class="token operator">-</span> loss<span class="token punctuation">:</span> <span class="token number">1.1904</span> <span class="token operator">-</span> val_loss<span class="token punctuation">:</span> <span class="token number">0.6021</span>Epoch <span class="token number">2</span><span class="token operator">/</span><span class="token number">10</span><span class="token number">16</span><span class="token operator">/</span><span class="token number">16</span> <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token punctuation">]</span> <span class="token operator">-</span> 0s 16ms<span class="token operator">/</span>step <span class="token operator">-</span> loss<span class="token punctuation">:</span> <span class="token number">0.6891</span> <span class="token operator">-</span> val_loss<span class="token punctuation">:</span> <span class="token number">0.4746</span>Epoch <span class="token number">3</span><span class="token operator">/</span><span class="token number">10</span><span class="token number">16</span><span class="token operator">/</span><span class="token number">16</span> <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token punctuation">]</span> <span class="token operator">-</span> 0s 15ms<span class="token operator">/</span>step <span class="token operator">-</span> loss<span class="token punctuation">:</span> <span class="token number">0.6261</span> <span class="token operator">-</span> val_loss<span class="token punctuation">:</span> <span class="token number">0.4656</span>Epoch <span class="token number">4</span><span class="token operator">/</span><span class="token number">10</span><span class="token number">16</span><span class="token operator">/</span><span class="token number">16</span> <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token punctuation">]</span> <span class="token operator">-</span> 0s 16ms<span class="token operator">/</span>step <span class="token operator">-</span> loss<span class="token punctuation">:</span> <span class="token number">0.4625</span> <span class="token operator">-</span> val_loss<span class="token punctuation">:</span> <span class="token number">0.4673</span>Epoch <span class="token number">5</span><span class="token operator">/</span><span class="token number">10</span><span class="token number">16</span><span class="token operator">/</span><span class="token number">16</span> <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token punctuation">]</span> <span class="token operator">-</span> 0s 16ms<span class="token operator">/</span>step <span class="token operator">-</span> loss<span class="token punctuation">:</span> <span class="token number">0.4636</span> <span class="token operator">-</span> val_loss<span class="token punctuation">:</span> <span class="token number">0.5309</span>Epoch <span class="token number">6</span><span class="token operator">/</span><span class="token number">10</span><span class="token number">16</span><span class="token operator">/</span><span class="token number">16</span> <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token punctuation">]</span> <span class="token operator">-</span> 0s 15ms<span class="token operator">/</span>step <span class="token operator">-</span> loss<span class="token punctuation">:</span> <span class="token number">0.4115</span> <span class="token operator">-</span> val_loss<span class="token punctuation">:</span> <span class="token number">0.6260</span>Epoch <span class="token number">7</span><span class="token operator">/</span><span class="token number">10</span><span class="token number">16</span><span class="token operator">/</span><span class="token number">16</span> <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token punctuation">]</span> <span class="token operator">-</span> 0s 15ms<span class="token operator">/</span>step <span class="token operator">-</span> loss<span class="token punctuation">:</span> <span class="token number">0.3869</span> <span class="token operator">-</span> val_loss<span class="token punctuation">:</span> <span class="token number">0.7247</span>Epoch <span class="token number">8</span><span class="token operator">/</span><span class="token number">10</span><span class="token number">16</span><span class="token operator">/</span><span class="token number">16</span> <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token punctuation">]</span> <span class="token operator">-</span> 0s 16ms<span class="token operator">/</span>step <span class="token operator">-</span> loss<span class="token punctuation">:</span> <span class="token number">0.3497</span> <span class="token operator">-</span> val_loss<span class="token punctuation">:</span> <span class="token number">0.7432</span>Epoch <span class="token number">9</span><span class="token operator">/</span><span class="token number">10</span><span class="token number">16</span><span class="token operator">/</span><span class="token number">16</span> <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token punctuation">]</span> <span class="token operator">-</span> 0s 15ms<span class="token operator">/</span>step <span class="token operator">-</span> loss<span class="token punctuation">:</span> <span class="token number">0.3128</span> <span class="token operator">-</span> val_loss<span class="token punctuation">:</span> <span class="token number">0.7747</span>Epoch <span class="token number">10</span><span class="token operator">/</span><span class="token number">10</span><span class="token number">16</span><span class="token operator">/</span><span class="token number">16</span> <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token punctuation">]</span> <span class="token operator">-</span> 0s 16ms<span class="token operator">/</span>step <span class="token operator">-</span> loss<span class="token punctuation">:</span> <span class="token number">0.3241</span> <span class="token operator">-</span> val_loss<span class="token punctuation">:</span> <span class="token number">0.9836</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="3、-思考"><a href="#3、-思考" class="headerlink" title="3、 思考"></a>3、 思考</h2><p>DIN模型在工业上的应用还是比较广泛的， 大家可以自由去通过查资料看一下具体实践当中这个模型是怎么用的？ 有什么问题？比如行为序列的制作是否合理， 如果时间间隔比较长的话应不应该分一下段？ 再比如注意力机制那里能不能改成别的计算注意力的方式会好点？(我们也知道注意力机制的方式可不仅DNN这一种)， 再比如注意力权重那里该不该加softmax？  这些其实都是可以值的思考探索的一些问题，根据实际的业务场景，大家也可以总结一些更加有意思的工业上应用该模型的技巧和tricks，欢迎一块讨论和分享。</p><p><strong>Common Feature Trick</strong></p><p>对于一个用户，一次 pageview 中假设展示了 200 个商品。那么每个商品就对应一条样本。但是，这 200 条样本中是有很多<code>Common Feature</code>的。所以 DIN 的实现中并没有把用户都展开，类似于下图：</p><p><img src="https://pic1.zhimg.com/80/v2-1e16e3cfaa5d70108b6f44526b9defc4_1440w.jpg" alt="img"></p><p>对于很多静态的不变的特征，比如性别、年龄、昨天以前的行为等只计算一次、存储一次。之后利用索引与其他特征关联，大幅度的压缩了样本的存储，加快了模型的训练。最终实验仅用了 1/3 的资源，获得了 12 倍的加速。</p><ul><li>在模型学习优化上，DIN提出了<em>Dice激活函数</em>、<em>自适应正则</em> ，显著的提升了模型性能与收敛速度。</li></ul><h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><ul><li><a href="https://arxiv.org/pdf/1706.06978.pdf">DIN原论文</a></li><li><a href="https://zhuanlan.zhihu.com/p/39439947">CTR预估—阿里Deep Interest Network</a></li><li><a href="https://zhuanlan.zhihu.com/p/47063917">Attention机制详解（一）——Seq2Seq中的Attention</a></li><li><a href="https://github.com/zhougr1993/DeepInterestNetwork/issues/23">对attention方法体的一点点疑惑</a></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> DataWhale </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>命名空间</title>
      <link href="2021/03/27/ming-ming-kong-jian/"/>
      <url>2021/03/27/ming-ming-kong-jian/</url>
      
        <content type="html"><![CDATA[<h1 id="命名空间"><a href="#命名空间" class="headerlink" title="命名空间"></a>命名空间</h1><ul><li>本文记录对 python 命名空间的思考和实践，可能逻辑上有所混乱，有时间再整理一下</li></ul><p>命名空间的定义：变量到对象映射的集合。一般是通过字典来实现的</p><p>python中：命名空间就是字典</p><h2 id="1、类的命名空间和对象的命名空间"><a href="#1、类的命名空间和对象的命名空间" class="headerlink" title="1、类的命名空间和对象的命名空间"></a>1、类的命名空间和对象的命名空间</h2><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">A</span><span class="token punctuation">:</span>    count <span class="token operator">=</span> <span class="token number">1</span>    <span class="token keyword">def</span> <span class="token function">init</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>count_ <span class="token operator">+=</span> <span class="token number">2</span>        A<span class="token punctuation">.</span>count <span class="token operator">+=</span> <span class="token number">3</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">locals</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 实例化</span>a <span class="token operator">=</span> A<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 使用 __dict__方法查看命名空间</span>a<span class="token punctuation">.</span>__dict__<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token punctuation">{</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># a 是有自己的命名空间的，这里有屏蔽作用，</span><span class="token comment"># 对象自己有的时候，就不用去类里面找</span><span class="token comment"># 但是如果对象本身找不到，就要去类的对象空间里寻找了，</span><span class="token comment"># 但是并不代表类 A 的对象空间的变量属于变量 a 了</span><span class="token comment"># 通过查看 a.__dict__，此时依旧为空</span>a<span class="token punctuation">.</span>count<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token number">1</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 查看下 A 命名空间</span><span class="token comment"># 是有 'count': 1</span>A<span class="token punctuation">.</span>__dict__<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">mappingproxy<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'__module__'</span><span class="token punctuation">:</span> <span class="token string">'__main__'</span><span class="token punctuation">,</span>              <span class="token string">'count'</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>              <span class="token string">'init'</span><span class="token punctuation">:</span> <span class="token operator">&lt;</span>function __main__<span class="token punctuation">.</span>A<span class="token punctuation">.</span>init<span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token punctuation">,</span>              <span class="token string">'__dict__'</span><span class="token punctuation">:</span> <span class="token operator">&lt;</span>attribute <span class="token string">'__dict__'</span> of <span class="token string">'A'</span> objects<span class="token operator">&gt;</span><span class="token punctuation">,</span>              <span class="token string">'__weakref__'</span><span class="token punctuation">:</span> <span class="token operator">&lt;</span>attribute <span class="token string">'__weakref__'</span> of <span class="token string">'A'</span> objects<span class="token operator">&gt;</span><span class="token punctuation">,</span>              <span class="token string">'__doc__'</span><span class="token punctuation">:</span> <span class="token boolean">None</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">A<span class="token punctuation">.</span>count<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token number">1</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">a <span class="token operator">==</span> A<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token boolean">False</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 神奇的来了，表明目前为止，两者的 count 是一致的</span><span class="token comment"># 不过这样并不能很说明问题，让我们来查看一下它们的 id</span>a<span class="token punctuation">.</span>count <span class="token operator">==</span> A<span class="token punctuation">.</span>count<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token boolean">True</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token builtin">id</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span>count<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token number">140735818053408</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token builtin">id</span><span class="token punctuation">(</span>A<span class="token punctuation">.</span>count<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token number">140735818053408</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>可以看出，这两者就是同一个 count,也就是最开始 class A 中 <code>count = 1</code>这一步。也很好理解，a 中没有 count，便在 A 的命名空间里寻找</p><h2 id="2、如果我们给对象-a-创建一个-count，结果会怎么样"><a href="#2、如果我们给对象-a-创建一个-count，结果会怎么样" class="headerlink" title="2、如果我们给对象 a 创建一个 count，结果会怎么样"></a>2、如果我们给对象 a 创建一个 count，结果会怎么样</h2><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 实现起来很简单，为了区分明显，赋值为字符串</span>a<span class="token punctuation">.</span>count <span class="token operator">=</span> <span class="token string">"hello"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 查看 a 的命名空间，就发生了变化</span>a<span class="token punctuation">.</span>__dict__<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token punctuation">{</span><span class="token string">'count'</span><span class="token punctuation">:</span> <span class="token string">'hello'</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>那么此时 A.count 和 a.count 还相等吗? 是有结论的，肯定不相等</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">a<span class="token punctuation">.</span>count <span class="token operator">==</span> A<span class="token punctuation">.</span>count<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token boolean">False</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token builtin">id</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span>count<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token number">1756673821232</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token builtin">id</span><span class="token punctuation">(</span>A<span class="token punctuation">.</span>count<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token number">140735818053408</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="3、尝试调用-init"><a href="#3、尝试调用-init" class="headerlink" title="3、尝试调用 init"></a>3、尝试调用 init</h2><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 接下来我们尝试去调用这个 init 函数</span><span class="token comment"># 如果我们直接这么使用，是会被报错的</span><span class="token comment"># &gt;&gt;&gt; a.init()</span><span class="token comment"># 报错信息如下：</span><span class="token comment"># ---------------------------------------------------------------------------</span><span class="token comment"># AttributeError                            Traceback (most recent call last)</span><span class="token comment"># &lt;ipython-input-202-6ef2be712bbb&gt; in &lt;module&gt;</span><span class="token comment">#       1 # 接下来我们尝试去调用这个 init 函数</span><span class="token comment">#       2 # 如果我们直接这么使用，是会被报错的</span><span class="token comment"># ----&gt; 3 a.init()</span><span class="token comment"># &lt;ipython-input-186-fe727f2532f8&gt; in init(self)</span><span class="token comment">#       2     count = 1</span><span class="token comment">#       3     def init(self):</span><span class="token comment"># ----&gt; 4         self.count_ += 2</span><span class="token comment">#       5         A.count += 3</span><span class="token comment">#       6         print(locals())</span><span class="token comment"># AttributeError: 'A' object has no attribute 'count_'</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>稍微解读下这个报错，因为此刻对象 a 的命名空间中没有 count_ 变量，于是在 A 的命名空间中进行寻找，也没 count_ 变量，此刻 A 的命名空间中只有 count 变量，所以出现报错提示：’A’ object has no attribute ‘count_’</p><p>为了检验这一想法，两种方式：</p><ol><li>在对象 a 里创建一个 count_ 变量</li><li>在 class A 里添加一个 count_ 变量</li></ol><h3 id="3-1-方式一：在对象-a-里创建一个-count-变量"><a href="#3-1-方式一：在对象-a-里创建一个-count-变量" class="headerlink" title="3.1 方式一：在对象 a 里创建一个 count_ 变量"></a>3.1 方式一：在对象 a 里创建一个 count_ 变量</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 方式一</span>a<span class="token punctuation">.</span>count_ <span class="token operator">=</span> <span class="token number">10</span>a<span class="token punctuation">.</span>__dict__ <span class="token comment">#已经有 count_ 变量</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token punctuation">{</span><span class="token string">'count'</span><span class="token punctuation">:</span> <span class="token string">'hello'</span><span class="token punctuation">,</span> <span class="token string">'count_'</span><span class="token punctuation">:</span> <span class="token number">10</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 再次调用 init() 函数</span>a<span class="token punctuation">.</span>init<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token punctuation">{</span><span class="token string">'self'</span><span class="token punctuation">:</span> <span class="token operator">&lt;</span>__main__<span class="token punctuation">.</span>A <span class="token builtin">object</span> at <span class="token number">0x00000199033EE9D0</span><span class="token operator">&gt;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 说明已经成功运行</span><span class="token comment"># 已进行 self.count_ += 2 操作</span>a<span class="token punctuation">.</span>count_<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token number">12</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">a<span class="token punctuation">.</span>__dict__<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token punctuation">{</span><span class="token string">'count'</span><span class="token punctuation">:</span> <span class="token string">'hello'</span><span class="token punctuation">,</span> <span class="token string">'count_'</span><span class="token punctuation">:</span> <span class="token number">12</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="3-2-方式二：在-class-A-里添加一个-count-变量"><a href="#3-2-方式二：在-class-A-里添加一个-count-变量" class="headerlink" title="3.2 方式二：在 class A 里添加一个 count_ 变量"></a>3.2 方式二：在 class A 里添加一个 count_ 变量</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 方式二，为了不清除原 class，这里我新建一个 class</span><span class="token keyword">class</span> <span class="token class-name">C</span><span class="token punctuation">:</span>    count <span class="token operator">=</span> <span class="token number">1</span>    count_ <span class="token operator">=</span> <span class="token number">10</span> <span class="token comment"># 添加的 count_ 变量</span>    <span class="token keyword">def</span> <span class="token function">init</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>count_ <span class="token operator">+=</span> <span class="token number">2</span>        C<span class="token punctuation">.</span>count <span class="token operator">+=</span> <span class="token number">3</span> <span class="token comment"># 之后考虑为什么写 count += 3 不行</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 同样，我们一边打印命名空间，一边进行</span>c <span class="token operator">=</span> C<span class="token punctuation">(</span><span class="token punctuation">)</span>c<span class="token punctuation">.</span>__dict__<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token punctuation">{</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 注意，此时类 C 的命名空间有 count、count_</span>C<span class="token punctuation">.</span>__dict__<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">mappingproxy<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'__module__'</span><span class="token punctuation">:</span> <span class="token string">'__main__'</span><span class="token punctuation">,</span>              <span class="token string">'count'</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span>              <span class="token string">'count_'</span><span class="token punctuation">:</span> <span class="token number">10</span><span class="token punctuation">,</span>              <span class="token string">'init'</span><span class="token punctuation">:</span> <span class="token operator">&lt;</span>function __main__<span class="token punctuation">.</span>C<span class="token punctuation">.</span>init<span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token punctuation">,</span>              <span class="token string">'__dict__'</span><span class="token punctuation">:</span> <span class="token operator">&lt;</span>attribute <span class="token string">'__dict__'</span> of <span class="token string">'C'</span> objects<span class="token operator">&gt;</span><span class="token punctuation">,</span>              <span class="token string">'__weakref__'</span><span class="token punctuation">:</span> <span class="token operator">&lt;</span>attribute <span class="token string">'__weakref__'</span> of <span class="token string">'C'</span> objects<span class="token operator">&gt;</span><span class="token punctuation">,</span>              <span class="token string">'__doc__'</span><span class="token punctuation">:</span> <span class="token boolean">None</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 同样，我们再次调用 init</span>c<span class="token punctuation">.</span>init<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 同样得到相同结果</span>c<span class="token punctuation">.</span>count_<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token number">12</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">c<span class="token punctuation">.</span>__dict__<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token punctuation">{</span><span class="token string">'count_'</span><span class="token punctuation">:</span> <span class="token number">12</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="4、探究变量-a-的命名空间和类-A-命名空间作用域"><a href="#4、探究变量-a-的命名空间和类-A-命名空间作用域" class="headerlink" title="4、探究变量 a 的命名空间和类 A 命名空间作用域"></a>4、探究变量 a 的命名空间和类 A 命名空间作用域</h2><pre class="line-numbers language-python" data-language="python"><code class="language-python">a<span class="token punctuation">.</span>__dict__<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token punctuation">{</span><span class="token string">'count'</span><span class="token punctuation">:</span> <span class="token string">'hello'</span><span class="token punctuation">,</span> <span class="token string">'count_'</span><span class="token punctuation">:</span> <span class="token number">12</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">A<span class="token punctuation">.</span>__dict__<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">mappingproxy<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'__module__'</span><span class="token punctuation">:</span> <span class="token string">'__main__'</span><span class="token punctuation">,</span>              <span class="token string">'count'</span><span class="token punctuation">:</span> <span class="token number">4</span><span class="token punctuation">,</span>              <span class="token string">'init'</span><span class="token punctuation">:</span> <span class="token operator">&lt;</span>function __main__<span class="token punctuation">.</span>A<span class="token punctuation">.</span>init<span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token punctuation">,</span>              <span class="token string">'__dict__'</span><span class="token punctuation">:</span> <span class="token operator">&lt;</span>attribute <span class="token string">'__dict__'</span> of <span class="token string">'A'</span> objects<span class="token operator">&gt;</span><span class="token punctuation">,</span>              <span class="token string">'__weakref__'</span><span class="token punctuation">:</span> <span class="token operator">&lt;</span>attribute <span class="token string">'__weakref__'</span> of <span class="token string">'A'</span> objects<span class="token operator">&gt;</span><span class="token punctuation">,</span>              <span class="token string">'__doc__'</span><span class="token punctuation">:</span> <span class="token boolean">None</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 再次调用</span>a<span class="token punctuation">.</span>init<span class="token punctuation">(</span><span class="token punctuation">)</span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token punctuation">{</span><span class="token string">'self'</span><span class="token punctuation">:</span> <span class="token operator">&lt;</span>__main__<span class="token punctuation">.</span>A <span class="token builtin">object</span> at <span class="token number">0x00000199033EE9D0</span><span class="token operator">&gt;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 此时 count 并没有被改变，指的是没有被 A.count 所改变</span><span class="token comment"># 如果理解清楚的话，可以很好解释</span><span class="token comment"># 对象 a m命名空间中有的变量，就不需要去类 A 中寻找，也就是保持原来的 hello 不变</span>a<span class="token punctuation">.</span>__dict__<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token punctuation">{</span><span class="token string">'count'</span><span class="token punctuation">:</span> <span class="token string">'hello'</span><span class="token punctuation">,</span> <span class="token string">'count_'</span><span class="token punctuation">:</span> <span class="token number">14</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">A<span class="token punctuation">.</span>__dict__<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">mappingproxy<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'__module__'</span><span class="token punctuation">:</span> <span class="token string">'__main__'</span><span class="token punctuation">,</span>              <span class="token string">'count'</span><span class="token punctuation">:</span> <span class="token number">7</span><span class="token punctuation">,</span>              <span class="token string">'init'</span><span class="token punctuation">:</span> <span class="token operator">&lt;</span>function __main__<span class="token punctuation">.</span>A<span class="token punctuation">.</span>init<span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token punctuation">,</span>              <span class="token string">'__dict__'</span><span class="token punctuation">:</span> <span class="token operator">&lt;</span>attribute <span class="token string">'__dict__'</span> of <span class="token string">'A'</span> objects<span class="token operator">&gt;</span><span class="token punctuation">,</span>              <span class="token string">'__weakref__'</span><span class="token punctuation">:</span> <span class="token operator">&lt;</span>attribute <span class="token string">'__weakref__'</span> of <span class="token string">'A'</span> objects<span class="token operator">&gt;</span><span class="token punctuation">,</span>              <span class="token string">'__doc__'</span><span class="token punctuation">:</span> <span class="token boolean">None</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="5、探究-self-的作用"><a href="#5、探究-self-的作用" class="headerlink" title="5、探究 self 的作用"></a>5、探究 self 的作用</h2><p>我们在写类内函数时，都会在函数输入变量中传入 self，这是为什么？</p><p>看一下不一样的调用 init 函数方式</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">A<span class="token punctuation">.</span>init<span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token comment">#需要传参数</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token punctuation">{</span><span class="token string">'self'</span><span class="token punctuation">:</span> <span class="token operator">&lt;</span>__main__<span class="token punctuation">.</span>A <span class="token builtin">object</span> at <span class="token number">0x00000199033EE9D0</span><span class="token operator">&gt;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>常规的调用方式</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">a<span class="token punctuation">.</span>init<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">#可以直接调用，但是实际上也是 init(a)，只不过没有这么表达罢了</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token punctuation">{</span><span class="token string">'self'</span><span class="token punctuation">:</span> <span class="token operator">&lt;</span>__main__<span class="token punctuation">.</span>A <span class="token builtin">object</span> at <span class="token number">0x00000199033EE9D0</span><span class="token operator">&gt;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>这里也可以解释，为什么类里面的方法，需要传入 self 作为参数，即使有时候该函数下根本用不到这个参数，比如就是一个简简单单的函数，你同样需要写 self。当然你可能还有疑问，为什么是 self，我写别的行不行？当然可以啦，一个参数名称而已，只不过写 self 已经成为一种习惯，大家也都用这个表示“对象 e ”了。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">E</span><span class="token punctuation">:</span>    <span class="token comment"># 如果 data 里不写 self ，就会报错</span>    <span class="token comment"># TypeError: init() takes 0 positional arguments but 1 was given</span>    <span class="token comment"># 告诉我们，我们多传了一个参数，你说我们没传参啊，</span>    <span class="token comment"># 用的 e.data()，没有参数啊，怎么不对？ </span>    <span class="token comment"># 这里的 but 1 was given，指的就是这个 e，对象 e 本身作为参数传进去</span>    <span class="token keyword">def</span> <span class="token function">data</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token number">2</span>e <span class="token operator">=</span> E<span class="token punctuation">(</span><span class="token punctuation">)</span>e<span class="token punctuation">.</span>data<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">E</span><span class="token punctuation">:</span>    <span class="token comment"># 如果 data 里不写 self ，就会报错</span>    <span class="token comment"># TypeError: init() takes 0 positional arguments but 1 was given</span>    <span class="token comment"># 告诉我们，我们多传了一个参数，你说我们没传参啊，</span>    <span class="token comment"># 用的 e.data()，没有参数啊，怎么不对？ </span>    <span class="token comment"># 这里的 but 1 was given，指的就是这个 e，对象 e 本身作为参数传进去</span>    <span class="token keyword">def</span> <span class="token function">data</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token number">2</span>e <span class="token operator">=</span> E<span class="token punctuation">(</span><span class="token punctuation">)</span>e<span class="token punctuation">.</span>data<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token number">2</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 可以看到类 A 是有自己的命名空间的</span><span class="token comment"># 对象 a 也是有自己的命名空间的</span><span class="token comment"># 并且</span>A<span class="token punctuation">.</span>__dict__<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">mappingproxy<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'__module__'</span><span class="token punctuation">:</span> <span class="token string">'__main__'</span><span class="token punctuation">,</span>              <span class="token string">'count'</span><span class="token punctuation">:</span> <span class="token number">13</span><span class="token punctuation">,</span>              <span class="token string">'init'</span><span class="token punctuation">:</span> <span class="token operator">&lt;</span>function __main__<span class="token punctuation">.</span>A<span class="token punctuation">.</span>init<span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token punctuation">,</span>              <span class="token string">'__dict__'</span><span class="token punctuation">:</span> <span class="token operator">&lt;</span>attribute <span class="token string">'__dict__'</span> of <span class="token string">'A'</span> objects<span class="token operator">&gt;</span><span class="token punctuation">,</span>              <span class="token string">'__weakref__'</span><span class="token punctuation">:</span> <span class="token operator">&lt;</span>attribute <span class="token string">'__weakref__'</span> of <span class="token string">'A'</span> objects<span class="token operator">&gt;</span><span class="token punctuation">,</span>              <span class="token string">'__doc__'</span><span class="token punctuation">:</span> <span class="token boolean">None</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">a<span class="token punctuation">.</span>__dict__<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token punctuation">{</span><span class="token string">'count'</span><span class="token punctuation">:</span> <span class="token string">'hello'</span><span class="token punctuation">,</span> <span class="token string">'count_'</span><span class="token punctuation">:</span> <span class="token number">18</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li><p><a href="https://blog.csdn.net/heli200482128/article/details/74990347">python中类的命名空间和面向对象的诸多问题</a></p></li><li><p><a href="http://www.ityouknow.com/python/2019/09/27/Python-Namespace&amp;Scope-022.html">Python NameSpace&amp;Scope</a></p></li><li><p><a href="https://blog.csdn.net/yuli_dai/article/details/9326773">【Python基础】之全局变量(UnboundLocalError: local variable referenced before assignment)</a></p></li><li><a href="https://www.zhihu.com/question/39264541">大家是如何理解Python中的self？</a></li></ul>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Task4 合约编写实战实例</title>
      <link href="2021/03/25/task4-he-yue-bian-xie-shi-zhan-shi-li/"/>
      <url>2021/03/25/task4-he-yue-bian-xie-shi-zhan-shi-li/</url>
      
        <content type="html"><![CDATA[<h1 id="合约编写实战实例"><a href="#合约编写实战实例" class="headerlink" title="合约编写实战实例"></a>合约编写实战实例</h1><h2 id="1、简单代币合约"><a href="#1、简单代币合约" class="headerlink" title="1、简单代币合约"></a>1、简单代币合约</h2><pre class="line-numbers language-js" data-language="js"><code class="language-js">pragma solidity <span class="token operator">&gt;</span> <span class="token number">0.4</span><span class="token number">.22</span><span class="token punctuation">;</span>contract Coin<span class="token punctuation">{</span>    address <span class="token keyword">public</span> minter<span class="token punctuation">;</span>        <span class="token function">mapping</span><span class="token punctuation">(</span><span class="token parameter">address</span><span class="token operator">=&gt;</span>uint<span class="token punctuation">)</span> balances<span class="token punctuation">;</span>    event <span class="token function">Sent</span><span class="token punctuation">(</span>address <span class="token keyword">from</span><span class="token punctuation">,</span> address to<span class="token punctuation">,</span> uint amount<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// 合约初始化，同样是为了之后的判断，当前交易者是否是创建合约的人</span>    <span class="token comment">// msg.sender == minter</span>    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        minter <span class="token operator">=</span> msg<span class="token punctuation">.</span>sender<span class="token punctuation">;</span>    <span class="token punctuation">}</span>        <span class="token keyword">function</span> <span class="token function">mint</span><span class="token punctuation">(</span><span class="token parameter">address receiver<span class="token punctuation">,</span> uint amount</span><span class="token punctuation">)</span> <span class="token keyword">public</span><span class="token punctuation">{</span>        <span class="token comment">// require msg.sender == minter</span>        <span class="token function">require</span><span class="token punctuation">(</span>msg<span class="token punctuation">.</span>sender <span class="token operator">==</span> minter<span class="token punctuation">)</span><span class="token punctuation">;</span>        balances<span class="token punctuation">[</span>receiver<span class="token punctuation">]</span> <span class="token operator">+=</span> amount<span class="token punctuation">;</span>    <span class="token punctuation">}</span>        <span class="token keyword">function</span> <span class="token function">send</span><span class="token punctuation">(</span><span class="token parameter">address receiver<span class="token punctuation">,</span> uint amount</span><span class="token punctuation">)</span> <span class="token keyword">public</span><span class="token punctuation">{</span>        <span class="token comment">//require balance &gt; amount</span>        <span class="token function">require</span><span class="token punctuation">(</span>balances<span class="token punctuation">[</span>msg<span class="token punctuation">.</span>sender<span class="token punctuation">]</span> <span class="token operator">&gt;=</span> amount<span class="token punctuation">)</span><span class="token punctuation">;</span>        balances<span class="token punctuation">[</span>msg<span class="token punctuation">.</span>sender<span class="token punctuation">]</span> <span class="token operator">-=</span> amount<span class="token punctuation">;</span>        balances<span class="token punctuation">[</span>receiver<span class="token punctuation">]</span> <span class="token operator">+=</span> amount<span class="token punctuation">;</span>        emit <span class="token function">Sent</span><span class="token punctuation">(</span>msg<span class="token punctuation">.</span>sender<span class="token punctuation">,</span> receiver<span class="token punctuation">,</span> amount<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="1-1-创建一个基础合约"><a href="#1-1-创建一个基础合约" class="headerlink" title="1.1 创建一个基础合约"></a>1.1 创建一个基础合约</h3><pre class="line-numbers language-js" data-language="js"><code class="language-js">contract Coin<span class="token punctuation">{</span>    address <span class="token keyword">public</span> minter<span class="token punctuation">;</span>    <span class="token function">mapping</span><span class="token punctuation">(</span><span class="token parameter">address</span><span class="token operator">=&gt;</span>uint<span class="token punctuation">)</span> balances<span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><ul><li>定义了一个 address 作为key, uint 做为 value 的 hashTable balances；这个类型将地址映射到无符号整型。</li></ul><h3 id="1-2-添加一个构造函数"><a href="#1-2-添加一个构造函数" class="headerlink" title="1.2 添加一个构造函数"></a>1.2 添加一个构造函数</h3><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>minter <span class="token operator">=</span> msg<span class="token punctuation">.</span>sender<span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><ul><li>minter = msg.sender; 代表创建这个合约的账户地址，被赋值给变量minter.</li></ul><h3 id="1-3-添加一个挖矿合约"><a href="#1-3-添加一个挖矿合约" class="headerlink" title="1.3 添加一个挖矿合约"></a>1.3 添加一个挖矿合约</h3><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">mint</span><span class="token punctuation">(</span><span class="token parameter">address receiver<span class="token punctuation">,</span> uint amount</span><span class="token punctuation">)</span> <span class="token keyword">public</span><span class="token punctuation">{</span>    <span class="token comment">// require msg.sender == minter</span>    <span class="token function">require</span><span class="token punctuation">(</span>msg<span class="token punctuation">.</span>sender <span class="token operator">==</span> minter<span class="token punctuation">)</span><span class="token punctuation">;</span>    balances<span class="token punctuation">[</span>receiver<span class="token punctuation">]</span> <span class="token operator">+=</span> amount<span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>mint function 关键点在于，如果调用这个方法的账户不是 minter (注意这里的 msg.sender 和 构造函数的 msg.sender 并一定相同，取决于是谁调用这个方法。例如创建这个合约的账户是A，那么minter=A，如果有一个新的账户 B 去调用了这个方法，此时 msg.sender=B，不满足<code>msg.sender == minter</code>这个条件)，也就是创建合约的账户的话，这个 mint()将不能被执行。</li></ul><h3 id="1-4-添加一个转账合约"><a href="#1-4-添加一个转账合约" class="headerlink" title="1.4 添加一个转账合约"></a>1.4 添加一个转账合约</h3><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">send</span><span class="token punctuation">(</span><span class="token parameter">address receiver<span class="token punctuation">,</span> uint amount</span><span class="token punctuation">)</span> <span class="token keyword">public</span><span class="token punctuation">{</span>    <span class="token comment">//require balance &gt; amount</span>    <span class="token function">require</span><span class="token punctuation">(</span>balances<span class="token punctuation">[</span>msg<span class="token punctuation">.</span>sender<span class="token punctuation">]</span> <span class="token operator">&gt;=</span> amount<span class="token punctuation">)</span><span class="token punctuation">;</span>    balances<span class="token punctuation">[</span>msg<span class="token punctuation">.</span>sender<span class="token punctuation">]</span> <span class="token operator">-=</span> amount<span class="token punctuation">;</span>    balances<span class="token punctuation">[</span>receiver<span class="token punctuation">]</span> <span class="token operator">+=</span> amount<span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>先判断 msg.sender 余额是否充足，然后 msg.sender 减少一定代币，接受者 receiver 增加一定代币</li></ul><h3 id="1-5-定义一个事件"><a href="#1-5-定义一个事件" class="headerlink" title="1.5 定义一个事件"></a>1.5 定义一个事件</h3><pre class="line-numbers language-js" data-language="js"><code class="language-js">event <span class="token function">Sent</span><span class="token punctuation">(</span>address <span class="token keyword">from</span><span class="token punctuation">,</span> address to<span class="token punctuation">,</span> uint amount<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">function</span> <span class="token function">send</span><span class="token punctuation">(</span><span class="token parameter">address receiver<span class="token punctuation">,</span> uint amount</span><span class="token punctuation">)</span> <span class="token keyword">public</span><span class="token punctuation">{</span>    <span class="token comment">//require balance &gt; amount</span>    <span class="token function">require</span><span class="token punctuation">(</span>balances<span class="token punctuation">[</span>msg<span class="token punctuation">.</span>sender<span class="token punctuation">]</span> <span class="token operator">&gt;=</span> amount<span class="token punctuation">)</span><span class="token punctuation">;</span>    balances<span class="token punctuation">[</span>msg<span class="token punctuation">.</span>sender<span class="token punctuation">]</span> <span class="token operator">-=</span> amount<span class="token punctuation">;</span>    balances<span class="token punctuation">[</span>receiver<span class="token punctuation">]</span> <span class="token operator">+=</span> amount<span class="token punctuation">;</span>    emit <span class="token function">Sent</span><span class="token punctuation">(</span>msg<span class="token punctuation">.</span>sender<span class="token punctuation">,</span> receiver<span class="token punctuation">,</span> amount<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li><code>event Sent(address from, address to, uint amount)</code>;声明了一个所谓的事件，它在send函数最后一行被发出。用户界面可以监听区块链上正在发送的事件，且不会花费太多成本，一旦它被发出，监听该事件的listener都将收到通知，而所有的事件都包含了<code>from</code>,<code>t</code>o和<code>amoun</code>t三个参数，可方便追踪事务。</li></ul><p><img src="/2021/03/25/task4-he-yue-bian-xie-shi-zhan-shi-li/pic3.png" alt=""></p><h2 id="2、水龙头合约"><a href="#2、水龙头合约" class="headerlink" title="2、水龙头合约"></a>2、水龙头合约</h2><pre class="line-numbers language-js" data-language="js"><code class="language-js">pragma solidity <span class="token operator">^</span><span class="token number">0.7</span><span class="token number">.0</span><span class="token punctuation">;</span>contract faucet<span class="token punctuation">{</span>    <span class="token keyword">function</span> <span class="token function">withdraw</span><span class="token punctuation">(</span><span class="token parameter">uint amount</span><span class="token punctuation">)</span> <span class="token keyword">public</span><span class="token punctuation">{</span>        <span class="token function">require</span><span class="token punctuation">(</span>amount <span class="token operator">&lt;=</span> <span class="token number">1e18</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        msg<span class="token punctuation">.</span>sender<span class="token punctuation">.</span><span class="token function">transfer</span><span class="token punctuation">(</span>amount<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>        <span class="token function">receive</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> external payable<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li><p><code>msg.sender.transfer (amount)</code> 就是实际的提款操作了。<code>msg</code> 是 Solidity 中内置的对象，所有合约都可以访问，它代表触发此合约的交易。也就是说当我们调用 <code>withdraw</code> 函数的时候实际上触发了一笔交易，并用 <code>msg</code> 来表示它。<code>sender</code> 是交易 <code>msg</code> 的属性，表示了交易的发件人地址。函数 <code>transfer</code> 是一个内置函数，它接收一个参数作为以太币的数量，并将该数量的以太币从合约账户发送到调用合约的用户的地址中。</p></li><li><p>最后一行是一个特殊的函数 <code>receive</code> ，这是所谓的 <code>fallback</code> 或 <code>default</code> 函数。当合约中的其他函数无法处理发送到合约中的交易信息时，就会执行该函数。在这里，我们将该函数声明为 <code>external</code> 和 <code>payable</code> ，<code>external</code> 意味着该函数可以接收来自外部账户的调用，<code>payable</code> 意味着该函数可以接收来自外部账户发送的以太币。</p></li></ul><p><img src="/2021/03/25/task4-he-yue-bian-xie-shi-zhan-shi-li/pic4.png" alt=""></p><h2 id="3、投票合约的实现"><a href="#3、投票合约的实现" class="headerlink" title="3、投票合约的实现"></a>3、投票合约的实现</h2><p>该智能合约实现了一个自动化的、透明的投票应用。投票发起人可以发起投票，将投票权赋予投票人；投票人可以自己投票，或将自己的票委托给其他投票人；任何人都可以公开查询投票的结果。</p><p>实现上述功能的合约代码如下所示，并不复杂，语法跟 JavaScript 十分类似。</p><pre class="line-numbers language-js" data-language="js"><code class="language-js">pragma solidity <span class="token operator">&gt;=</span><span class="token number">0.4</span><span class="token number">.22</span> <span class="token operator">&lt;</span><span class="token number">0.7</span><span class="token number">.0</span><span class="token punctuation">;</span><span class="token comment">/// @title 委托投票</span>contract Ballot <span class="token punctuation">{</span>    <span class="token comment">// 这里声明了一个新的复合类型用于稍后的变量</span>    <span class="token comment">// 它用来表示一个选民</span>    struct Voter <span class="token punctuation">{</span>        uint weight<span class="token punctuation">;</span> <span class="token comment">// 计票的权重</span>        bool voted<span class="token punctuation">;</span>  <span class="token comment">// 若为真，代表该人已投票</span>        address delegate<span class="token punctuation">;</span> <span class="token comment">// 被委托人</span>        uint vote<span class="token punctuation">;</span>   <span class="token comment">// 投票提案的索引</span>    <span class="token punctuation">}</span>    <span class="token comment">// 提案的类型</span>    struct Proposal <span class="token punctuation">{</span>        bytes32 name<span class="token punctuation">;</span>   <span class="token comment">// 简称（最长32个字节）</span>        uint voteCount<span class="token punctuation">;</span> <span class="token comment">// 得票数</span>    <span class="token punctuation">}</span>    address <span class="token keyword">public</span> chairperson<span class="token punctuation">;</span>    <span class="token comment">// 这声明了一个状态变量，为每个可能的地址存储一个 `Voter`。</span>    <span class="token function">mapping</span><span class="token punctuation">(</span><span class="token parameter">address</span> <span class="token operator">=&gt;</span> Voter<span class="token punctuation">)</span> <span class="token keyword">public</span> voters<span class="token punctuation">;</span>    <span class="token comment">// 一个 `Proposal` 结构类型的动态数组</span>    Proposal<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token keyword">public</span> proposals<span class="token punctuation">;</span>    <span class="token comment">/// 为 `proposalNames` 中的每个提案，创建一个新的（投票）表决</span>    <span class="token function">constructor</span><span class="token punctuation">(</span>bytes32<span class="token punctuation">[</span><span class="token punctuation">]</span> memory proposalNames<span class="token punctuation">)</span> <span class="token keyword">public</span> <span class="token punctuation">{</span>        chairperson <span class="token operator">=</span> msg<span class="token punctuation">.</span>sender<span class="token punctuation">;</span>        voters<span class="token punctuation">[</span>chairperson<span class="token punctuation">]</span><span class="token punctuation">.</span>weight <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>        <span class="token comment">//对于提供的每个提案名称，</span>        <span class="token comment">//创建一个新的 Proposal 对象并把它添加到数组的末尾。</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span>uint i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> proposalNames<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token comment">// `Proposal({...})` 创建一个临时 Proposal 对象，</span>            <span class="token comment">// `proposals.push(...)` 将其添加到 `proposals` 的末尾</span>            proposals<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token function">Proposal</span><span class="token punctuation">(</span><span class="token punctuation">{</span>                name<span class="token operator">:</span> proposalNames<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span>                voteCount<span class="token operator">:</span> <span class="token number">0</span>            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token comment">// 授权 `voter` 对这个（投票）表决进行投票</span>    <span class="token comment">// 只有 `chairperson` 可以调用该函数。</span>    <span class="token keyword">function</span> <span class="token function">giveRightToVote</span><span class="token punctuation">(</span><span class="token parameter">address voter</span><span class="token punctuation">)</span> <span class="token keyword">public</span> <span class="token punctuation">{</span>        <span class="token comment">// 若 `require` 的第一个参数的计算结果为 `false`，</span>        <span class="token comment">// 则终止执行，撤销所有对状态和以太币余额的改动。</span>        <span class="token comment">// 在旧版的 EVM 中这曾经会消耗所有 gas，但现在不会了。</span>        <span class="token comment">// 使用 require 来检查函数是否被正确地调用，是一个好习惯。</span>        <span class="token comment">// 你也可以在 require 的第二个参数中提供一个对错误情况的解释。</span>        <span class="token function">require</span><span class="token punctuation">(</span>            msg<span class="token punctuation">.</span>sender <span class="token operator">==</span> chairperson<span class="token punctuation">,</span>            <span class="token string">"Only chairperson can give right to vote."</span>        <span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">require</span><span class="token punctuation">(</span>            <span class="token operator">!</span>voters<span class="token punctuation">[</span>voter<span class="token punctuation">]</span><span class="token punctuation">.</span>voted<span class="token punctuation">,</span>            <span class="token string">"The voter already voted."</span>        <span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">require</span><span class="token punctuation">(</span>voters<span class="token punctuation">[</span>voter<span class="token punctuation">]</span><span class="token punctuation">.</span>weight <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        voters<span class="token punctuation">[</span>voter<span class="token punctuation">]</span><span class="token punctuation">.</span>weight <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment">/// 把你的投票委托到投票者 `to`。</span>    <span class="token keyword">function</span> <span class="token function">delegate</span><span class="token punctuation">(</span><span class="token parameter">address to</span><span class="token punctuation">)</span> <span class="token keyword">public</span> <span class="token punctuation">{</span>        <span class="token comment">// 传引用</span>        Voter storage sender <span class="token operator">=</span> voters<span class="token punctuation">[</span>msg<span class="token punctuation">.</span>sender<span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token function">require</span><span class="token punctuation">(</span><span class="token operator">!</span>sender<span class="token punctuation">.</span>voted<span class="token punctuation">,</span> <span class="token string">"You already voted."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">require</span><span class="token punctuation">(</span>to <span class="token operator">!=</span> msg<span class="token punctuation">.</span>sender<span class="token punctuation">,</span> <span class="token string">"Self-delegation is disallowed."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// 委托是可以传递的，只要被委托者 `to` 也设置了委托。</span>        <span class="token comment">// 一般来说，这种循环委托是危险的。因为，如果传递的链条太长，</span>        <span class="token comment">// 则可能需消耗的gas要多于区块中剩余的（大于区块设置的gasLimit），</span>        <span class="token comment">// 这种情况下，委托不会被执行。</span>        <span class="token comment">// 而在另一些情况下，如果形成闭环，则会让合约完全卡住。</span>        <span class="token keyword">while</span> <span class="token punctuation">(</span>voters<span class="token punctuation">[</span>to<span class="token punctuation">]</span><span class="token punctuation">.</span>delegate <span class="token operator">!=</span> <span class="token function">address</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            to <span class="token operator">=</span> voters<span class="token punctuation">[</span>to<span class="token punctuation">]</span><span class="token punctuation">.</span>delegate<span class="token punctuation">;</span>            <span class="token comment">// 不允许闭环委托</span>            <span class="token function">require</span><span class="token punctuation">(</span>to <span class="token operator">!=</span> msg<span class="token punctuation">.</span>sender<span class="token punctuation">,</span> <span class="token string">"Found loop in delegation."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token comment">// `sender` 是一个引用, 相当于对 `voters[msg.sender].voted` 进行修改</span>        sender<span class="token punctuation">.</span>voted <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>        sender<span class="token punctuation">.</span>delegate <span class="token operator">=</span> to<span class="token punctuation">;</span>        Voter storage delegate_ <span class="token operator">=</span> voters<span class="token punctuation">[</span>to<span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>delegate_<span class="token punctuation">.</span>voted<span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token comment">// 若被委托者已经投过票了，直接增加得票数</span>            proposals<span class="token punctuation">[</span>delegate_<span class="token punctuation">.</span>vote<span class="token punctuation">]</span><span class="token punctuation">.</span>voteCount <span class="token operator">+=</span> sender<span class="token punctuation">.</span>weight<span class="token punctuation">;</span>        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>            <span class="token comment">// 若被委托者还没投票，增加委托者的权重</span>            delegate_<span class="token punctuation">.</span>weight <span class="token operator">+=</span> sender<span class="token punctuation">.</span>weight<span class="token punctuation">;</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token comment">/// 把你的票(包括委托给你的票)，</span>    <span class="token comment">/// 投给提案 `proposals[proposal].name`.</span>    <span class="token keyword">function</span> <span class="token function">vote</span><span class="token punctuation">(</span><span class="token parameter">uint proposal</span><span class="token punctuation">)</span> <span class="token keyword">public</span> <span class="token punctuation">{</span>        Voter storage sender <span class="token operator">=</span> voters<span class="token punctuation">[</span>msg<span class="token punctuation">.</span>sender<span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token function">require</span><span class="token punctuation">(</span><span class="token operator">!</span>sender<span class="token punctuation">.</span>voted<span class="token punctuation">,</span> <span class="token string">"Already voted."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        sender<span class="token punctuation">.</span>voted <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>        sender<span class="token punctuation">.</span>vote <span class="token operator">=</span> proposal<span class="token punctuation">;</span>        <span class="token comment">// 如果 `proposal` 超过了数组的范围，则会自动抛出异常，并恢复所有的改动</span>        proposals<span class="token punctuation">[</span>proposal<span class="token punctuation">]</span><span class="token punctuation">.</span>voteCount <span class="token operator">+=</span> sender<span class="token punctuation">.</span>weight<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment">/// @dev 结合之前所有的投票，计算出最终胜出的提案</span>    <span class="token keyword">function</span> <span class="token function">winningProposal</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">public</span> view            <span class="token function">returns</span> <span class="token punctuation">(</span><span class="token parameter">uint winningProposal_</span><span class="token punctuation">)</span>    <span class="token punctuation">{</span>        uint winningVoteCount <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span>uint p <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> p <span class="token operator">&lt;</span> proposals<span class="token punctuation">.</span>length<span class="token punctuation">;</span> p<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>proposals<span class="token punctuation">[</span>p<span class="token punctuation">]</span><span class="token punctuation">.</span>voteCount <span class="token operator">&gt;</span> winningVoteCount<span class="token punctuation">)</span> <span class="token punctuation">{</span>                winningVoteCount <span class="token operator">=</span> proposals<span class="token punctuation">[</span>p<span class="token punctuation">]</span><span class="token punctuation">.</span>voteCount<span class="token punctuation">;</span>                winningProposal_ <span class="token operator">=</span> p<span class="token punctuation">;</span>            <span class="token punctuation">}</span>        <span class="token punctuation">}</span>    <span class="token punctuation">}</span>    <span class="token comment">// 调用 winningProposal() 函数以获取提案数组中获胜者的索引，并以此返回获胜者的名称</span>    <span class="token keyword">function</span> <span class="token function">winnerName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">public</span> view            <span class="token function">returns</span> <span class="token punctuation">(</span><span class="token parameter">bytes32 winnerName_</span><span class="token punctuation">)</span>    <span class="token punctuation">{</span>        winnerName_ <span class="token operator">=</span> proposals<span class="token punctuation">[</span><span class="token function">winningProposal</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">.</span>name<span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="代码解析"><a href="#代码解析" class="headerlink" title="代码解析"></a>代码解析</h3><h4 id="指定版本"><a href="#指定版本" class="headerlink" title="指定版本"></a>指定版本</h4><p>在第一行，<code>pragma</code> 关键字指定了和该合约兼容的编译器版本。</p><pre class="line-numbers language-none"><code class="language-none">pragma solidity ^0.4.11;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>该合约指定，不兼容比 <code>0.4.11</code> 更旧的编译器版本，且 <code>^</code> 符号表示也不兼容从 <code>0.5.0</code> 起的新编译器版本。即兼容版本范围是 <code>0.4.11 &lt;= version &lt; 0.5.0</code>。该语法与 npm 的版本描述语法一致。</p><h4 id="结构体类型"><a href="#结构体类型" class="headerlink" title="结构体类型"></a>结构体类型</h4><p>Solidity 中的合约（contract）类似面向对象编程语言中的类。每个合约可以包含状态变量、函数、事件、结构体类型和枚举类型等。一个合约也可以继承另一个合约。</p><p>在本例命名为 <code>Ballot</code> 的合约中，声明了 2 个结构体类型：<code>Voter</code> 和 <code>Proposal</code>。</p><ul><li><code>struct Voter</code>：投票人，其属性包括 <code>uint weight</code>（该投票人的权重）、<code>bool voted</code>（是否已投票）、<code>address delegate</code>（如果该投票人将投票委托给他人，则记录受委托人的账户地址）和 <code>uint vote</code>（投票做出的选择，即相应提案的索引号）。</li><li><code>struct Proposal</code>：提案，其属性包括 <code>bytes32 name</code>（名称）和 <code>uint voteCount</code>（已获得的票数）。</li></ul><p>需要注意，<code>address</code> 类型记录了一个以太坊账户的地址。<code>address</code> 可看作一个数值类型，但也包括一些与以太币相关的方法，如查询余额 <code>&lt;address&gt;.balance</code>、向该地址转账 <code>&lt;address&gt;.transfer(uint256 amount)</code> 等。</p><h4 id="状态变量"><a href="#状态变量" class="headerlink" title="状态变量"></a>状态变量</h4><p>合约中的状态变量会长期保存在区块链中。通过调用合约中的函数，这些状态变量可以被读取和改写。</p><p>本例中定义了 3 个状态变量：<code>chairperson</code>、<code>voters</code>、<code>proposals</code>。</p><ul><li><code>address public chairperson</code>：投票发起人，类型为 <code>address</code>。</li><li><code>mapping(address =&gt; Voter) public voters</code>：所有投票人，类型为 <code>address</code> 到 <code>Voter</code> 的映射。</li><li><code>Proposal[] public proposals</code>：所有提案，类型为动态大小的 <code>Proposal</code> 数组。</li></ul><p>3 个状态变量都使用了 <code>public</code> 关键字，使得变量可以被外部访问（即通过消息调用）。事实上，编译器会自动为 <code>public</code> 的变量创建同名的 getter 函数，供外部直接读取。</p><p>状态变量还可设置为 <code>internal</code> 或 <code>private</code>。<code>internal</code> 的状态变量只能被该合约和继承该合约的子合约访问，<code>private</code> 的状态变量只能被该合约访问。状态变量默认为 <code>internal</code>。</p><p>将上述关键状态信息设置为 <code>public</code> 能够增加投票的公平性和透明性。</p><h4 id="函数"><a href="#函数" class="headerlink" title="函数"></a>函数</h4><p>合约中的函数用于处理业务逻辑。函数的可见性默认为 <code>public</code>，即可以从内部或外部调用，是合约的对外接口。函数可见性也可设置为 <code>external</code>、<code>internal</code> 和 <code>private</code>。</p><p>本例实现了 6 个 <code>public</code> 函数，可看作 6 个对外接口，功能分别如下。</p><h5 id="创建投票"><a href="#创建投票" class="headerlink" title="创建投票"></a>创建投票</h5><p>函数 <code>function Ballot(bytes32[] proposalNames)</code> 用于创建一个新的投票。</p><p>所有提案的名称通过参数 <code>bytes32[] proposalNames</code> 传入，逐个记录到状态变量 <code>proposals</code> 中。同时用 <code>msg.sender</code> 获取当前调用消息的发送者的地址，记录为投票发起人 <code>chairperson</code>，该发起人投票权重设为 1。</p><h5 id="赋予投票权"><a href="#赋予投票权" class="headerlink" title="赋予投票权"></a>赋予投票权</h5><p>函数 <code>function giveRightToVote(address voter)</code> 实现给投票人赋予投票权。</p><p>该函数给 <code>address voter</code> 赋予投票权，即将 <code>voter</code> 的投票权重设为 1，存入 <code>voters</code> 状态变量。</p><p>这个函数只有投票发起人 <code>chairperson</code> 可以调用。这里用到了 <code>require((msg.sender == chairperson) &amp;&amp; !voters[voter].voted)</code> 函数。如果 <code>require</code> 中表达式结果为 <code>false</code>，这次调用会中止，且回滚所有状态和以太币余额的改变到调用前。但已消耗的 Gas 不会返还。</p><h5 id="委托投票权"><a href="#委托投票权" class="headerlink" title="委托投票权"></a>委托投票权</h5><p>函数 <code>function delegate(address to)</code> 把投票委托给其他投票人。</p><p>其中，用 <code>voters[msg.sender]</code> 获取委托人，即此次调用的发起人。用 <code>require</code> 确保发起人没有投过票，且不是委托给自己。由于被委托人也可能已将投票委托出去，所以接下来，用 <code>while</code> 循环查找最终的投票代表。找到后，如果投票代表已投票，则将委托人的权重加到所投的提案上；如果投票代表还未投票，则将委托人的权重加到代表的权重上。</p><p>该函数使用了 <code>while</code> 循环，这里合约编写者需要十分谨慎，防止调用者消耗过多 Gas，甚至出现死循环。</p><h5 id="进行投票"><a href="#进行投票" class="headerlink" title="进行投票"></a>进行投票</h5><p>函数 <code>function vote(uint proposal)</code> 实现投票过程。</p><p>其中，用 <code>voters[msg.sender]</code> 获取投票人，即此次调用的发起人。接下来检查是否是重复投票，如果不是，进行投票后相关状态变量的更新。</p><h5 id="查询获胜提案"><a href="#查询获胜提案" class="headerlink" title="查询获胜提案"></a>查询获胜提案</h5><p>函数 <code>function winningProposal() constant returns (uint winningProposal)</code> 将返回获胜提案的索引号。</p><p>这里，<code>returns (uint winningProposal)</code> 指定了函数的返回值类型，<code>constant</code> 表示该函数不会改变合约状态变量的值。</p><p>函数通过遍历所有提案进行记票，得到获胜提案。</p><h5 id="查询获胜者名称"><a href="#查询获胜者名称" class="headerlink" title="查询获胜者名称"></a>查询获胜者名称</h5><p>函数 <code>function winnerName() constant returns (bytes32 winnerName)</code> 实现返回获胜者的名称。</p><p>这里采用内部调用 <code>winningProposal()</code> 函数的方式获得获胜提案。如果需要采用外部调用，则需要写为 <code>this.winningProposal()</code>。</p><h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><ul><li><a href="https://blog.csdn.net/Vinsuan1993/article/details/77127033">Address类型和Mapping 类型</a></li><li><p><a href="https://yeasy.gitbook.io/blockchain_guide/07_ethereum/contract_example">智能合约案例：投票</a></p></li><li><p><a href="https://learnblockchain.cn/docs/solidity/examples/voting.html">投票合约</a></p></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> DataWhale </tag>
            
            <tag> Blockchain </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hexo 博客正确显示数学公式</title>
      <link href="2021/03/25/hexo-bo-ke-zheng-que-xian-shi-shu-xue-gong-shi/"/>
      <url>2021/03/25/hexo-bo-ke-zheng-que-xian-shi-shu-xue-gong-shi/</url>
      
        <content type="html"><![CDATA[<h1 id="Hexo-博客正确显示数学公式"><a href="#Hexo-博客正确显示数学公式" class="headerlink" title="Hexo 博客正确显示数学公式"></a>Hexo 博客正确显示数学公式</h1><p>昨天和前天提交作业的时候，MD文档的公式显示正常。部署后发现自己的博客有的公式可以正常显示，有的但是不可以，行内的公式也有问题。最开始我以为是自己公式打得有问题，后来排查了下是有的符号会被转译成别的东西，具体就没有深究了，参考这篇博客修改正确：</p><p><a href="https://blog.csdn.net/yexiaohhjk/article/details/82526604">hexo next主题解决无法显示数学公式</a></p><h2 id="原因"><a href="#原因" class="headerlink" title="原因"></a>原因</h2><p>Hexo 默认使用 hexo-renderer-marked 引擎渲染网页，该引擎会把一些特殊的 markdown 符号转换为相应的 html 标签，比如在 markdown 语法中，下划线<code>_</code>代表斜体，会被渲染引擎处理为<code>&lt;em&gt;</code>标签。</p><p>因为类 Latex 格式书写的数学公式下划线<code>_</code>表示下标，有特殊的含义，如果被强制转换为<code>&lt;em&gt;</code>标签，那么 MathJax 引擎在渲染数学公式的时候就会出错。类似的语义冲突的符号还包括<code>*</code>, <code>{</code>, <code>}</code>, <code>\\</code>等。</p><h2 id="解决方法"><a href="#解决方法" class="headerlink" title="解决方法"></a>解决方法</h2><h3 id="1-更换-Hexo-的-Markdown-渲染引擎"><a href="#1-更换-Hexo-的-Markdown-渲染引擎" class="headerlink" title="1. 更换 Hexo 的 Markdown 渲染引擎"></a>1. 更换 Hexo 的 Markdown 渲染引擎</h3><p>更换 Hexo 的 markdown 渲染引擎，hexo-renderer-kramed 引擎是在默认的渲染引擎 hexo-renderer-marked 的基础上修改了一些 bug ，两者比较接近，也比较轻量级。</p><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"><span class="token function">npm</span> uninstall hexo-renderer-marked --save<span class="token function">npm</span> <span class="token function">install</span> hexo-renderer-kramed --save<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>执行上面的命令即可，先卸载原来的渲染引擎，再安装新的。<br>然后，跟换引擎后行间公式可以正确渲染了，但是这样还没有完全解决问题，行内公式的渲染还是有问题，因为 hexo-renderer-kramed 引擎也有语义冲突的问题。接下来到博客根目录下，找到 <code>node_modules\kramed\lib\rules\inline.js</code>，把第11行的 escape 变量的值做相应的修改：</p><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">//escape: /^\\([\\`*{}\[\]()#$+\-.!_&gt;])/,</span>escape<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">^\\([`*\[\]()#$+\-.!_&gt;])</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>这一步是在原基础上取消了对\,{,}的转义(escape)。<br>同时把第20行的 <code>em</code> 变量也要做相应的修改。</p><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">//em: /^\b_((?:__|[\s\S])+?)_\b|^\*((?:\*\*|[\s\S])+?)\*(?!\*)/,</span>em<span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">^\*((?:\*\*|[\s\S])+?)\*(?!\*)</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h3 id="2-在-Hexo-主题中开启-MathJax-开关"><a href="#2-在-Hexo-主题中开启-MathJax-开关" class="headerlink" title="2.在 Hexo 主题中开启 MathJax 开关"></a>2.在 Hexo 主题中开启 MathJax 开关</h3><p>如何使用了主题了，别忘了在主题（Theme）中开启 MathJax 开关，因为我原本也是打开的，这里也记录下，保证完整性。下面以 Matery 主题为例，介绍下如何打开 MathJax 开关。</p><ol><li>进入到主题目录，找到 _config.yml 配置，把 math 默认的 false 修改为true，具体如下：</li></ol><pre class="line-numbers language-js" data-language="js"><code class="language-js"># Whether to activate the mathjax<span class="token punctuation">,</span> <span class="token keyword">this</span> is a global configuration<span class="token punctuation">,</span> but the post still does not open the mathjax rendering<span class="token punctuation">.</span># Considering that the mathjax loading is time consuming<span class="token punctuation">,</span># you also need to add <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">mathjax: true</span><span class="token template-punctuation string">`</span></span> to the Front<span class="token operator">-</span>matter <span class="token keyword">of</span> the post that needs to be rendered<span class="token punctuation">.</span># 是否激活mathjax数学公式，这是全局配置，但文章仍然不会都开启mathjax渲染，# 考虑到mathjax加载比较耗时，你还需要在需要渲染的文章的Front<span class="token operator">-</span>matter中再加上<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">mathjax: true</span><span class="token template-punctuation string">`</span></span>才行<span class="token punctuation">.</span>mathjax<span class="token operator">:</span>  enable<span class="token operator">:</span> <span class="token boolean">true</span>  cdn<span class="token operator">:</span> https<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>cdn<span class="token punctuation">.</span>bootcss<span class="token punctuation">.</span>com<span class="token operator">/</span>mathjax<span class="token operator">/</span><span class="token number">2.7</span><span class="token number">.5</span><span class="token operator">/</span>MathJax<span class="token punctuation">.</span>js<span class="token operator">?</span>config<span class="token operator">=</span>TeX<span class="token operator">-</span><span class="token constant">AMS</span><span class="token operator">-</span>MML_HTMLorMML<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ol><li>在文章的 Front-matter 里打开 mathjax 开关，如下：</li></ol><pre class="line-numbers language-js" data-language="js"><code class="language-js">title<span class="token operator">:</span> Task4 <span class="token constant">NFM</span>date<span class="token operator">:</span> <span class="token number">2021</span><span class="token operator">-</span><span class="token number">03</span><span class="token operator">-</span><span class="token number">24</span> <span class="token number">22</span><span class="token operator">:</span><span class="token number">42</span><span class="token operator">:</span><span class="token number">19</span>mathjax<span class="token operator">:</span> <span class="token boolean">true</span>tags<span class="token operator">:</span><span class="token operator">-</span> DataWhale<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>这里需要注意的是，mathjax 加载比较耗时，建议有公式的博客添加，没有公式的就不要加这个了。</p><h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><ul><li><a href="https://blog.csdn.net/yexiaohhjk/article/details/82526604">hexo next主题解决无法显示数学公式</a></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> Debug </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Task4 NFM</title>
      <link href="2021/03/24/task4-nfm/"/>
      <url>2021/03/24/task4-nfm/</url>
      
        <content type="html"><![CDATA[<h1 id="NFM"><a href="#NFM" class="headerlink" title="NFM"></a>NFM</h1><ul><li>该文主要记录<a href="https://github.com/datawhalechina/team-learning-rs/tree/master/DeepRecommendationModel"><code>深度推荐模型|DataWhale</code></a>Task4 NFM 内容</li></ul><p>论文 Abstract 中提到 FM 与之前的深度网络模型的不足</p><ul><li><p>FM: 局限于线性表达和二阶交互，对于捕获显示数据非线性和复杂的内在结构表现力不够</p></li><li><p>深度网络：例如 Wide&amp;Deep 和 DeepCross ，简单地拼接特征 embedding 向量不会考虑任何的特征之间的交互，但是能够学习特征交互的非线性层的深层网络结构（DNN）又很难训练优化</p></li></ul><p>NFM 放弃了直接把嵌入向量（embedding）拼接输入到神经网络的做法，在嵌入层之后增加了 B-Interaction Layer 来对二阶组合特征进行建模。这使得 low level 的输入表达的信息更加的丰富，极大的提高了后面隐藏层学习高阶非线性组合特征的能力。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> warningswarnings<span class="token punctuation">.</span>filterwarnings<span class="token punctuation">(</span><span class="token string">"ignore"</span><span class="token punctuation">)</span><span class="token keyword">import</span> itertools<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np<span class="token keyword">from</span> tqdm <span class="token keyword">import</span> tqdm<span class="token keyword">from</span> collections <span class="token keyword">import</span> namedtuple<span class="token keyword">import</span> tensorflow <span class="token keyword">as</span> tf<span class="token keyword">from</span> tensorflow <span class="token keyword">import</span> keras <span class="token keyword">from</span> tensorflow<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>layers <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> tensorflow<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>models <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>model_selection <span class="token keyword">import</span> train_test_split<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>preprocessing <span class="token keyword">import</span>  MinMaxScaler<span class="token punctuation">,</span> LabelEncoder<span class="token keyword">from</span> deepctr<span class="token punctuation">.</span>feature_column <span class="token keyword">import</span> SparseFeat<span class="token punctuation">,</span> DenseFeat<span class="token punctuation">,</span> VarLenSparseFeat<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 设置GPU显存使用，tensorflow不然会报错</span>gpus <span class="token operator">=</span> tf<span class="token punctuation">.</span>config<span class="token punctuation">.</span>experimental<span class="token punctuation">.</span>list_physical_devices<span class="token punctuation">(</span><span class="token string">'GPU'</span><span class="token punctuation">)</span><span class="token keyword">if</span> gpus<span class="token punctuation">:</span>    <span class="token keyword">try</span><span class="token punctuation">:</span>        <span class="token comment"># Currently, memory growth needs to be the same across GPUs</span>        <span class="token keyword">for</span> gpu <span class="token keyword">in</span> gpus<span class="token punctuation">:</span>            tf<span class="token punctuation">.</span>config<span class="token punctuation">.</span>experimental<span class="token punctuation">.</span>set_memory_growth<span class="token punctuation">(</span>gpu<span class="token punctuation">,</span> <span class="token boolean">True</span><span class="token punctuation">)</span>        logical_gpus <span class="token operator">=</span> tf<span class="token punctuation">.</span>config<span class="token punctuation">.</span>experimental<span class="token punctuation">.</span>list_logical_devices<span class="token punctuation">(</span><span class="token string">'GPU'</span><span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>gpus<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"Physical GPUs,"</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>logical_gpus<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"Logical GPUs"</span><span class="token punctuation">)</span>    <span class="token keyword">except</span> RuntimeError <span class="token keyword">as</span> e<span class="token punctuation">:</span>        <span class="token comment"># Memory growth must be set before GPUs have been initialized</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token number">1</span> Physical GPUs<span class="token punctuation">,</span> <span class="token number">1</span> Logical GPUs<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="1、Load-Dataset"><a href="#1、Load-Dataset" class="headerlink" title="1、Load Dataset"></a>1、Load Dataset</h2><pre class="line-numbers language-python" data-language="python"><code class="language-python">data <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">"../代码/data/criteo_sample.txt"</span><span class="token punctuation">)</span>columns <span class="token operator">=</span> data<span class="token punctuation">.</span>columns<span class="token punctuation">.</span>valuescolumns<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'label'</span><span class="token punctuation">,</span> <span class="token string">'I1'</span><span class="token punctuation">,</span> <span class="token string">'I2'</span><span class="token punctuation">,</span> <span class="token string">'I3'</span><span class="token punctuation">,</span> <span class="token string">'I4'</span><span class="token punctuation">,</span> <span class="token string">'I5'</span><span class="token punctuation">,</span> <span class="token string">'I6'</span><span class="token punctuation">,</span> <span class="token string">'I7'</span><span class="token punctuation">,</span> <span class="token string">'I8'</span><span class="token punctuation">,</span> <span class="token string">'I9'</span><span class="token punctuation">,</span>       <span class="token string">'I10'</span><span class="token punctuation">,</span> <span class="token string">'I11'</span><span class="token punctuation">,</span> <span class="token string">'I12'</span><span class="token punctuation">,</span> <span class="token string">'I13'</span><span class="token punctuation">,</span> <span class="token string">'C1'</span><span class="token punctuation">,</span> <span class="token string">'C2'</span><span class="token punctuation">,</span> <span class="token string">'C3'</span><span class="token punctuation">,</span> <span class="token string">'C4'</span><span class="token punctuation">,</span> <span class="token string">'C5'</span><span class="token punctuation">,</span> <span class="token string">'C6'</span><span class="token punctuation">,</span>       <span class="token string">'C7'</span><span class="token punctuation">,</span> <span class="token string">'C8'</span><span class="token punctuation">,</span> <span class="token string">'C9'</span><span class="token punctuation">,</span> <span class="token string">'C10'</span><span class="token punctuation">,</span> <span class="token string">'C11'</span><span class="token punctuation">,</span> <span class="token string">'C12'</span><span class="token punctuation">,</span> <span class="token string">'C13'</span><span class="token punctuation">,</span> <span class="token string">'C14'</span><span class="token punctuation">,</span> <span class="token string">'C15'</span><span class="token punctuation">,</span> <span class="token string">'C16'</span><span class="token punctuation">,</span>       <span class="token string">'C17'</span><span class="token punctuation">,</span> <span class="token string">'C18'</span><span class="token punctuation">,</span> <span class="token string">'C19'</span><span class="token punctuation">,</span> <span class="token string">'C20'</span><span class="token punctuation">,</span> <span class="token string">'C21'</span><span class="token punctuation">,</span> <span class="token string">'C22'</span><span class="token punctuation">,</span> <span class="token string">'C23'</span><span class="token punctuation">,</span> <span class="token string">'C24'</span><span class="token punctuation">,</span> <span class="token string">'C25'</span><span class="token punctuation">,</span>       <span class="token string">'C26'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span><span class="token builtin">object</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 划分 dense 和 sparse 特征</span>dense_features <span class="token operator">=</span> <span class="token punctuation">[</span>i <span class="token keyword">for</span> i <span class="token keyword">in</span> columns <span class="token keyword">if</span> <span class="token string">'I'</span> <span class="token keyword">in</span> i<span class="token punctuation">]</span>sparse_features <span class="token operator">=</span> <span class="token punctuation">[</span>i <span class="token keyword">for</span> i <span class="token keyword">in</span> columns <span class="token keyword">if</span> <span class="token string">'C'</span> <span class="token keyword">in</span> i<span class="token punctuation">]</span><span class="token keyword">print</span><span class="token punctuation">(</span>dense_features<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>sparse_features<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token punctuation">[</span><span class="token string">'I1'</span><span class="token punctuation">,</span> <span class="token string">'I2'</span><span class="token punctuation">,</span> <span class="token string">'I3'</span><span class="token punctuation">,</span> <span class="token string">'I4'</span><span class="token punctuation">,</span> <span class="token string">'I5'</span><span class="token punctuation">,</span> <span class="token string">'I6'</span><span class="token punctuation">,</span> <span class="token string">'I7'</span><span class="token punctuation">,</span> <span class="token string">'I8'</span><span class="token punctuation">,</span> <span class="token string">'I9'</span><span class="token punctuation">,</span> <span class="token string">'I10'</span><span class="token punctuation">,</span> <span class="token string">'I11'</span><span class="token punctuation">,</span> <span class="token string">'I12'</span><span class="token punctuation">,</span> <span class="token string">'I13'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'C1'</span><span class="token punctuation">,</span> <span class="token string">'C2'</span><span class="token punctuation">,</span> <span class="token string">'C3'</span><span class="token punctuation">,</span> <span class="token string">'C4'</span><span class="token punctuation">,</span> <span class="token string">'C5'</span><span class="token punctuation">,</span> <span class="token string">'C6'</span><span class="token punctuation">,</span> <span class="token string">'C7'</span><span class="token punctuation">,</span> <span class="token string">'C8'</span><span class="token punctuation">,</span> <span class="token string">'C9'</span><span class="token punctuation">,</span> <span class="token string">'C10'</span><span class="token punctuation">,</span> <span class="token string">'C11'</span><span class="token punctuation">,</span> <span class="token string">'C12'</span><span class="token punctuation">,</span> <span class="token string">'C13'</span><span class="token punctuation">,</span> <span class="token string">'C14'</span><span class="token punctuation">,</span> <span class="token string">'C15'</span><span class="token punctuation">,</span> <span class="token string">'C16'</span><span class="token punctuation">,</span> <span class="token string">'C17'</span><span class="token punctuation">,</span> <span class="token string">'C18'</span><span class="token punctuation">,</span> <span class="token string">'C19'</span><span class="token punctuation">,</span> <span class="token string">'C20'</span><span class="token punctuation">,</span> <span class="token string">'C21'</span><span class="token punctuation">,</span> <span class="token string">'C22'</span><span class="token punctuation">,</span> <span class="token string">'C23'</span><span class="token punctuation">,</span> <span class="token string">'C24'</span><span class="token punctuation">,</span> <span class="token string">'C25'</span><span class="token punctuation">,</span> <span class="token string">'C26'</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h2 id="2、Data-Process"><a href="#2、Data-Process" class="headerlink" title="2、Data Process"></a>2、Data Process</h2><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 简单处理特征，包括填充缺失值，数值处理，类别编码</span><span class="token keyword">def</span> <span class="token function">data_process</span><span class="token punctuation">(</span>data_df<span class="token punctuation">,</span> dense_features<span class="token punctuation">,</span> sparse_features<span class="token punctuation">)</span><span class="token punctuation">:</span>    data_df<span class="token punctuation">[</span>dense_features<span class="token punctuation">]</span> <span class="token operator">=</span> data_df<span class="token punctuation">[</span>dense_features<span class="token punctuation">]</span><span class="token punctuation">.</span>fillna<span class="token punctuation">(</span><span class="token number">0.0</span><span class="token punctuation">)</span>    <span class="token keyword">for</span> f <span class="token keyword">in</span> dense_features<span class="token punctuation">:</span>        data_df<span class="token punctuation">[</span>f<span class="token punctuation">]</span> <span class="token operator">=</span> data_df<span class="token punctuation">[</span>f<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> np<span class="token punctuation">.</span>log<span class="token punctuation">(</span>x<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">if</span> x <span class="token operator">&gt;</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token keyword">else</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>            data_df<span class="token punctuation">[</span>sparse_features<span class="token punctuation">]</span> <span class="token operator">=</span> data_df<span class="token punctuation">[</span>sparse_features<span class="token punctuation">]</span><span class="token punctuation">.</span>fillna<span class="token punctuation">(</span><span class="token string">"-1"</span><span class="token punctuation">)</span>    <span class="token keyword">for</span> f <span class="token keyword">in</span> sparse_features<span class="token punctuation">:</span>        lbe <span class="token operator">=</span> LabelEncoder<span class="token punctuation">(</span><span class="token punctuation">)</span>        data_df<span class="token punctuation">[</span>f<span class="token punctuation">]</span> <span class="token operator">=</span> lbe<span class="token punctuation">.</span>fit_transform<span class="token punctuation">(</span>data_df<span class="token punctuation">[</span>f<span class="token punctuation">]</span><span class="token punctuation">)</span>        <span class="token keyword">return</span> data_df<span class="token punctuation">[</span>dense_features <span class="token operator">+</span> sparse_features<span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 简单的数据预处理</span>train_data <span class="token operator">=</span> data_process<span class="token punctuation">(</span>data<span class="token punctuation">,</span> dense_features<span class="token punctuation">,</span> sparse_features<span class="token punctuation">)</span>train_data<span class="token punctuation">[</span><span class="token string">'label'</span><span class="token punctuation">]</span> <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token string">'label'</span><span class="token punctuation">]</span>train_data<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }    .dataframe tbody tr th {        vertical-align: top;    }    .dataframe thead th {        text-align: right;    }</style><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>I1</th>      <th>I2</th>      <th>I3</th>      <th>I4</th>      <th>I5</th>      <th>I6</th>      <th>I7</th>      <th>I8</th>      <th>I9</th>      <th>I10</th>      <th>...</th>      <th>C18</th>      <th>C19</th>      <th>C20</th>      <th>C21</th>      <th>C22</th>      <th>C23</th>      <th>C24</th>      <th>C25</th>      <th>C26</th>      <th>label</th>    </tr>  </thead>  <tbody>    <tr>      <th>0</th>      <td>0.0</td>      <td>1.386294</td>      <td>5.564520</td>      <td>0.000000</td>      <td>9.779567</td>      <td>0.000000</td>      <td>0.000000</td>      <td>3.526361</td>      <td>0.000000</td>      <td>0.0</td>      <td>...</td>      <td>66</td>      <td>0</td>      <td>0</td>      <td>3</td>      <td>0</td>      <td>1</td>      <td>96</td>      <td>0</td>      <td>0</td>      <td>0</td>    </tr>    <tr>      <th>1</th>      <td>0.0</td>      <td>-1.000000</td>      <td>2.995732</td>      <td>3.583519</td>      <td>10.317318</td>      <td>5.513429</td>      <td>0.693147</td>      <td>3.583519</td>      <td>5.081404</td>      <td>0.0</td>      <td>...</td>      <td>52</td>      <td>0</td>      <td>0</td>      <td>47</td>      <td>0</td>      <td>7</td>      <td>112</td>      <td>0</td>      <td>0</td>      <td>0</td>    </tr>    <tr>      <th>2</th>      <td>0.0</td>      <td>0.000000</td>      <td>1.098612</td>      <td>2.564949</td>      <td>7.607878</td>      <td>5.105945</td>      <td>1.945910</td>      <td>3.583519</td>      <td>6.261492</td>      <td>0.0</td>      <td>...</td>      <td>49</td>      <td>0</td>      <td>0</td>      <td>25</td>      <td>0</td>      <td>6</td>      <td>53</td>      <td>0</td>      <td>0</td>      <td>0</td>    </tr>    <tr>      <th>3</th>      <td>0.0</td>      <td>2.639057</td>      <td>0.693147</td>      <td>1.609438</td>      <td>9.731334</td>      <td>5.303305</td>      <td>1.791759</td>      <td>1.609438</td>      <td>3.401197</td>      <td>0.0</td>      <td>...</td>      <td>37</td>      <td>0</td>      <td>0</td>      <td>156</td>      <td>0</td>      <td>0</td>      <td>32</td>      <td>0</td>      <td>0</td>      <td>0</td>    </tr>    <tr>      <th>4</th>      <td>0.0</td>      <td>0.000000</td>      <td>4.653960</td>      <td>3.332205</td>      <td>7.596392</td>      <td>4.962845</td>      <td>1.609438</td>      <td>3.496508</td>      <td>3.637586</td>      <td>0.0</td>      <td>...</td>      <td>14</td>      <td>5</td>      <td>3</td>      <td>9</td>      <td>0</td>      <td>0</td>      <td>5</td>      <td>1</td>      <td>47</td>      <td>0</td>    </tr>  </tbody></table><p>5 rows × 40 columns</p></div><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 与 DeepFM、Wide&amp;Deep、DeepCrossing 处理方式一致，这里是分成 Linear 和 DNN 两部分</span>linear_feature_columns <span class="token operator">=</span> <span class="token punctuation">[</span>    SparseFeat<span class="token punctuation">(</span>feat<span class="token punctuation">,</span> vocabulary_size<span class="token operator">=</span>data<span class="token punctuation">[</span>feat<span class="token punctuation">]</span><span class="token punctuation">.</span>nunique<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>embedding_dim<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">)</span>    <span class="token keyword">for</span> i<span class="token punctuation">,</span>feat <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>sparse_features<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token punctuation">[</span>    DenseFeat<span class="token punctuation">(</span>feat<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">for</span> feat <span class="token keyword">in</span> dense_features<span class="token punctuation">]</span>linear_feature_columns<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token builtin">len</span><span class="token punctuation">(</span>linear_feature_columns<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token punctuation">(</span>SparseFeat<span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">'C1'</span><span class="token punctuation">,</span> vocabulary_size<span class="token operator">=</span><span class="token number">27</span><span class="token punctuation">,</span> embedding_dim<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span> use_hash<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span><span class="token string">'int32'</span><span class="token punctuation">,</span> embeddings_initializer<span class="token operator">=</span><span class="token operator">&lt;</span>tensorflow<span class="token punctuation">.</span>python<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>initializers<span class="token punctuation">.</span>initializers_v1<span class="token punctuation">.</span>RandomNormal <span class="token builtin">object</span> at <span class="token number">0x000002C0F38E6580</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> embedding_name<span class="token operator">=</span><span class="token string">'C1'</span><span class="token punctuation">,</span> group_name<span class="token operator">=</span><span class="token string">'default_group'</span><span class="token punctuation">,</span> trainable<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">39</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">dnn_feature_columns <span class="token operator">=</span> <span class="token punctuation">[</span>    SparseFeat<span class="token punctuation">(</span>feat<span class="token punctuation">,</span> vocabulary_size<span class="token operator">=</span>data<span class="token punctuation">[</span>feat<span class="token punctuation">]</span><span class="token punctuation">.</span>nunique<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>embedding_dim<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">)</span>    <span class="token keyword">for</span> i<span class="token punctuation">,</span>feat <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>sparse_features<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token punctuation">[</span>    DenseFeat<span class="token punctuation">(</span>feat<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">for</span> feat <span class="token keyword">in</span> dense_features<span class="token punctuation">]</span>dnn_feature_columns<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token builtin">len</span><span class="token punctuation">(</span>dnn_feature_columns<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token punctuation">(</span>SparseFeat<span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">'C1'</span><span class="token punctuation">,</span> vocabulary_size<span class="token operator">=</span><span class="token number">27</span><span class="token punctuation">,</span> embedding_dim<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span> use_hash<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span><span class="token string">'int32'</span><span class="token punctuation">,</span> embeddings_initializer<span class="token operator">=</span><span class="token operator">&lt;</span>tensorflow<span class="token punctuation">.</span>python<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>initializers<span class="token punctuation">.</span>initializers_v1<span class="token punctuation">.</span>RandomNormal <span class="token builtin">object</span> at <span class="token number">0x000002C093E1D070</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> embedding_name<span class="token operator">=</span><span class="token string">'C1'</span><span class="token punctuation">,</span> group_name<span class="token operator">=</span><span class="token string">'default_group'</span><span class="token punctuation">,</span> trainable<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">39</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h2 id="3、模型原理"><a href="#3、模型原理" class="headerlink" title="3、模型原理"></a>3、模型原理</h2><h3 id="3-1-NFM-Model"><a href="#3-1-NFM-Model" class="headerlink" title="3.1 NFM Model"></a>3.1 NFM Model</h3><p>与 FM 相似，第一项和第二项是线性回归部分，第三项右原来 FM 的二阶隐向量内积换成 f(x)函数</p><script type="math/tex; mode=display">\hat{y}_{N F M}(\mathbf{x})=w_{0}+\sum_{i=1}^{n} w_{i} x_{i}+f(\mathbf{x})</script><h3 id="3-2-模型整体结构图"><a href="#3-2-模型整体结构图" class="headerlink" title="3.2 模型整体结构图"></a>3.2 模型整体结构图</h3><p><img src="http://ryluo.oss-cn-chengdu.aliyuncs.com/图片2.png" style="zoom:80%;"></p><ul><li>Figure 2: Neural Factorization Machines model (the first-order linear regression part is not shown for clarity).</li></ul><p>原文对此处进行了标注说明，这里只是对 f(x) 建模的过程，并没有考虑一阶部分。</p><h2 id="4、NFM-model-build"><a href="#4、NFM-model-build" class="headerlink" title="4、NFM model build"></a>4、NFM model build</h2><h3 id="4-1-Input-Layers"><a href="#4-1-Input-Layers" class="headerlink" title="4.1 Input Layers"></a>4.1 Input Layers</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">build_input_layers</span><span class="token punctuation">(</span>feature_columns<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token comment"># 构建Input层字典，并以dense和sparse两类字典的形式返回</span>    dense_input_dict<span class="token punctuation">,</span> sparse_input_dict <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>    <span class="token keyword">for</span> fc <span class="token keyword">in</span> feature_columns<span class="token punctuation">:</span>        <span class="token keyword">if</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>fc<span class="token punctuation">,</span> SparseFeat<span class="token punctuation">)</span><span class="token punctuation">:</span>            sparse_input_dict<span class="token punctuation">[</span>fc<span class="token punctuation">.</span>name<span class="token punctuation">]</span> <span class="token operator">=</span> Input<span class="token punctuation">(</span>shape<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token punctuation">)</span><span class="token punctuation">,</span> name<span class="token operator">=</span>fc<span class="token punctuation">.</span>name<span class="token punctuation">)</span>        <span class="token keyword">elif</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>fc<span class="token punctuation">,</span> DenseFeat<span class="token punctuation">)</span><span class="token punctuation">:</span>            dense_input_dict<span class="token punctuation">[</span>fc<span class="token punctuation">.</span>name<span class="token punctuation">]</span> <span class="token operator">=</span> Input<span class="token punctuation">(</span>shape<span class="token operator">=</span><span class="token punctuation">(</span>fc<span class="token punctuation">.</span>dimension<span class="token punctuation">,</span> <span class="token punctuation">)</span><span class="token punctuation">,</span> name<span class="token operator">=</span>fc<span class="token punctuation">.</span>name<span class="token punctuation">)</span>            <span class="token keyword">return</span> dense_input_dict<span class="token punctuation">,</span> sparse_input_dict<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 同样使用字典输入方式,方便后续构建模型</span><span class="token comment"># 这里传入数据是一样的，实际情况可以根据具体场景进行选择，这点不要混淆</span>dense_input_dict<span class="token punctuation">,</span> sparse_input_dict <span class="token operator">=</span> build_input_layers<span class="token punctuation">(</span>linear_feature_columns <span class="token operator">+</span> dnn_feature_columns<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>dense_input_dict<span class="token punctuation">[</span><span class="token string">"I1"</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token builtin">len</span><span class="token punctuation">(</span>dense_input_dict<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token builtin">type</span><span class="token punctuation">(</span>dense_input_dict<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>sparse_input_dict<span class="token punctuation">[</span><span class="token string">"C1"</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token builtin">len</span><span class="token punctuation">(</span>sparse_input_dict<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token builtin">type</span><span class="token punctuation">(</span>sparse_input_dict<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">KerasTensor<span class="token punctuation">(</span>type_spec<span class="token operator">=</span>TensorSpec<span class="token punctuation">(</span>shape<span class="token operator">=</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span>tf<span class="token punctuation">.</span>float32<span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">'I1'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">'I1'</span><span class="token punctuation">,</span> description<span class="token operator">=</span><span class="token string">"created by layer 'I1'"</span><span class="token punctuation">)</span> <span class="token number">13</span> <span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token string">'dict'</span><span class="token operator">&gt;</span>KerasTensor<span class="token punctuation">(</span>type_spec<span class="token operator">=</span>TensorSpec<span class="token punctuation">(</span>shape<span class="token operator">=</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span>tf<span class="token punctuation">.</span>float32<span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">'C1'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">'C1'</span><span class="token punctuation">,</span> description<span class="token operator">=</span><span class="token string">"created by layer 'C1'"</span><span class="token punctuation">)</span> <span class="token number">26</span> <span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token string">'dict'</span><span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 构建模型的输入层，模型的输入层不能是字典的形式，应该将字典的形式转换成列表的形式</span><span class="token comment"># 注意：这里实际的输入与Input()层的对应，是通过模型输入时候的字典数据的key与对应name的Input层</span>input_layers <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>dense_input_dict<span class="token punctuation">.</span>values<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token builtin">list</span><span class="token punctuation">(</span>sparse_input_dict<span class="token punctuation">.</span>values<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>input_layers<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token builtin">len</span><span class="token punctuation">(</span>input_layers<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token builtin">type</span><span class="token punctuation">(</span>input_layers<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token punctuation">(</span><span class="token operator">&lt;</span>KerasTensor<span class="token punctuation">:</span> shape<span class="token operator">=</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> dtype<span class="token operator">=</span>float32 <span class="token punctuation">(</span>created by layer <span class="token string">'I1'</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> <span class="token number">39</span><span class="token punctuation">,</span> <span class="token builtin">list</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 示例代码给了 input_layers_dict 参数不过并没有被使用</span><span class="token keyword">def</span> <span class="token function">build_embedding_layers</span><span class="token punctuation">(</span>feature_columns<span class="token punctuation">,</span> input_layers_dict<span class="token punctuation">,</span> is_linear<span class="token punctuation">)</span><span class="token punctuation">:</span>        embedding_layers_dict <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token punctuation">)</span>        sparse_feature_columns <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">filter</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> SparseFeat<span class="token punctuation">)</span><span class="token punctuation">,</span> feature_columns<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">if</span> feature_columns <span class="token keyword">else</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>        <span class="token keyword">if</span> is_linear<span class="token punctuation">:</span>        <span class="token keyword">for</span> fc <span class="token keyword">in</span> sparse_feature_columns<span class="token punctuation">:</span>            embedding_layers_dict<span class="token punctuation">[</span>fc<span class="token punctuation">.</span>name<span class="token punctuation">]</span> <span class="token operator">=</span> Embedding<span class="token punctuation">(</span>fc<span class="token punctuation">.</span>vocabulary_size<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">"1d_emb_"</span><span class="token operator">+</span>fc<span class="token punctuation">.</span>name<span class="token punctuation">)</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token keyword">for</span> fc <span class="token keyword">in</span> sparse_feature_columns<span class="token punctuation">:</span>            embedding_layers_dict<span class="token punctuation">[</span>fc<span class="token punctuation">.</span>name<span class="token punctuation">]</span> <span class="token operator">=</span> Embedding<span class="token punctuation">(</span>fc<span class="token punctuation">.</span>vocabulary_size<span class="token punctuation">,</span> fc<span class="token punctuation">.</span>embedding_dim<span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">"kd_emb_"</span><span class="token operator">+</span>fc<span class="token punctuation">.</span>name<span class="token punctuation">)</span>    <span class="token keyword">return</span> embedding_layers_dict    <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="4-2-Linear-amp-Dnn-sparse-feature"><a href="#4-2-Linear-amp-Dnn-sparse-feature" class="headerlink" title="4.2 Linear&amp;Dnn sparse feature"></a>4.2 Linear&amp;Dnn sparse feature</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 将linear部分的特征中sparse特征筛选出来，后面用来做1维的embedding</span>linear_sparse_feature_columns <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">filter</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> SparseFeat<span class="token punctuation">)</span><span class="token punctuation">,</span> linear_feature_columns<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># 将输入到dnn中的所有sparse特征筛选出来</span>dnn_sparse_feature_columns <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">filter</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> SparseFeat<span class="token punctuation">)</span><span class="token punctuation">,</span> dnn_feature_columns<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>linear_sparse_feature_columns<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token builtin">len</span><span class="token punctuation">(</span>linear_sparse_feature_columns<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>dnn_sparse_feature_columns<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token builtin">len</span><span class="token punctuation">(</span>dnn_sparse_feature_columns<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">SparseFeat<span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">'C1'</span><span class="token punctuation">,</span> vocabulary_size<span class="token operator">=</span><span class="token number">27</span><span class="token punctuation">,</span> embedding_dim<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span> use_hash<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span><span class="token string">'int32'</span><span class="token punctuation">,</span> embeddings_initializer<span class="token operator">=</span><span class="token operator">&lt;</span>tensorflow<span class="token punctuation">.</span>python<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>initializers<span class="token punctuation">.</span>initializers_v1<span class="token punctuation">.</span>RandomNormal <span class="token builtin">object</span> at <span class="token number">0x000002C0F38E6580</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> embedding_name<span class="token operator">=</span><span class="token string">'C1'</span><span class="token punctuation">,</span> group_name<span class="token operator">=</span><span class="token string">'default_group'</span><span class="token punctuation">,</span> trainable<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span> <span class="token number">26</span>SparseFeat<span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">'C1'</span><span class="token punctuation">,</span> vocabulary_size<span class="token operator">=</span><span class="token number">27</span><span class="token punctuation">,</span> embedding_dim<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span> use_hash<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span><span class="token string">'int32'</span><span class="token punctuation">,</span> embeddings_initializer<span class="token operator">=</span><span class="token operator">&lt;</span>tensorflow<span class="token punctuation">.</span>python<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>initializers<span class="token punctuation">.</span>initializers_v1<span class="token punctuation">.</span>RandomNormal <span class="token builtin">object</span> at <span class="token number">0x000002C093E1D070</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> embedding_name<span class="token operator">=</span><span class="token string">'C1'</span><span class="token punctuation">,</span> group_name<span class="token operator">=</span><span class="token string">'default_group'</span><span class="token punctuation">,</span> trainable<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span> <span class="token number">26</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h3 id="4-3-Linear-Logits"><a href="#4-3-Linear-Logits" class="headerlink" title="4.3 Linear Logits"></a>4.3 Linear Logits</h3><ul><li>线性部分</li></ul><script type="math/tex; mode=display">\hat{y}_{N F M}(\mathbf{x})=w_{0}+\sum_{i=1}^{n} w_{i} x_{i}</script><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">get_linear_logits</span><span class="token punctuation">(</span>dense_input_dict<span class="token punctuation">,</span>sparse_input_dict<span class="token punctuation">,</span>sparse_feature_columns<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token comment"># dense 特征处理</span>    concat_dense_inputs <span class="token operator">=</span> Concatenate<span class="token punctuation">(</span>axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">(</span>dense_input_dict<span class="token punctuation">.</span>values<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    dense_logits_output <span class="token operator">=</span> Dense<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">(</span>concat_dense_inputs<span class="token punctuation">)</span>        <span class="token comment"># sparse 特征处理   </span>    linear_embedding_layers <span class="token operator">=</span> build_embedding_layers<span class="token punctuation">(</span>sparse_feature_columns<span class="token punctuation">,</span> sparse_input_dict<span class="token punctuation">,</span> is_linear<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>    <span class="token comment"># 将一维的 embedding 进行拼接</span>    sparse_1d_embed <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> fc <span class="token keyword">in</span> sparse_feature_columns<span class="token punctuation">:</span>        feat_input <span class="token operator">=</span> sparse_input_dict<span class="token punctuation">[</span>fc<span class="token punctuation">.</span>name<span class="token punctuation">]</span>        embed <span class="token operator">=</span> Flatten<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span>linear_embedding_layers<span class="token punctuation">[</span>fc<span class="token punctuation">.</span>name<span class="token punctuation">]</span><span class="token punctuation">(</span>feat_input<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># B(batch)*1</span>        sparse_1d_embed<span class="token punctuation">.</span>append<span class="token punctuation">(</span>embed<span class="token punctuation">)</span>    sparse_logits_output <span class="token operator">=</span> Add<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span>sparse_1d_embed<span class="token punctuation">)</span>        <span class="token comment"># dense + sparse</span>    linear_logits <span class="token operator">=</span> Add<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">[</span>dense_logits_output<span class="token punctuation">,</span> sparse_logits_output<span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> linear_logits<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">linear_logits <span class="token operator">=</span> get_linear_logits<span class="token punctuation">(</span>dense_input_dict<span class="token punctuation">,</span>sparse_input_dict<span class="token punctuation">,</span>linear_sparse_feature_columns<span class="token punctuation">)</span>linear_logits<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token operator">&lt;</span>KerasTensor<span class="token punctuation">:</span> shape<span class="token operator">=</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> dtype<span class="token operator">=</span>float32 <span class="token punctuation">(</span>created by layer <span class="token string">'add_1'</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="4-4-DNN-Logits"><a href="#4-4-DNN-Logits" class="headerlink" title="4.4 DNN Logits"></a>4.4 DNN Logits</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 构建维度为k的embedding层，这里使用字典的形式返回，方便后面搭建模型</span><span class="token comment"># embedding层用户构建FM交叉部分和DNN的输入部分</span>embedding_layers <span class="token operator">=</span> build_embedding_layers<span class="token punctuation">(</span>dnn_feature_columns<span class="token punctuation">,</span> sparse_input_dict<span class="token punctuation">,</span> is_linear<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>embedding_layers<span class="token punctuation">[</span><span class="token string">"C1"</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token builtin">len</span><span class="token punctuation">(</span>embedding_layers<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token punctuation">(</span><span class="token operator">&lt;</span>tensorflow<span class="token punctuation">.</span>python<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>layers<span class="token punctuation">.</span>embeddings<span class="token punctuation">.</span>Embedding at <span class="token number">0x2c0f37d9e50</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> <span class="token number">26</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="4-4-1-Bi-Interaction-Pooling-layer"><a href="#4-4-1-Bi-Interaction-Pooling-layer" class="headerlink" title="4.4.1 Bi-Interaction Pooling layer"></a>4.4.1 Bi-Interaction Pooling layer</h4><p>这里是 NFM 网络的核心结构，这里需要注意的是，和 DeepFM 不同之处在于，$\odot$是元素积，并不是内积（点乘）</p><script type="math/tex; mode=display">f_{B I}\left(\mathcal{V}_{x}\right)=\sum_{i=1}^{n} \sum_{j=i+1}^{n} x_{i} \mathbf{v}_{i} \odot x_{j} \mathbf{v}_{j}</script><p>$\odot$表示两个向量的元素积操作，即两个向量对应维度相乘得到的元素积向量（可不是点乘呀），其中第$k$维的操作：</p><script type="math/tex; mode=display">\left(v_{i} \odot v_{j}\right)_{k}=\boldsymbol{v}_{i k} \boldsymbol{v}_{j k}</script><p>同样，可以将原式化简为</p><script type="math/tex; mode=display">f_{B I}\left(V_{x}\right)=\frac{1}{2}\left[\left(\sum_{i=1}^{n} x_{i} v_{i}\right)^{2}-\sum_{i=1}^{n}\left(x_{i} v_{i}\right)^{2}\right]</script><h4 id="4-4-2-内积-inner-product-scalar-product"><a href="#4-4-2-内积-inner-product-scalar-product" class="headerlink" title="4.4.2 内积(inner product/scalar product)"></a>4.4.2 内积(inner product/scalar product)</h4><p>矢量的降维运算，结果为一个常数，矩阵的内积是每行每列的内积的矩阵。</p><script type="math/tex; mode=display">x y = \langle x,y \rangle = \textstyle \sum_{i=1}^n x_iy_i</script><pre class="line-numbers language-python" data-language="python"><code class="language-python">x <span class="token operator">=</span> numpy<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>y <span class="token operator">=</span> numpy<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Array inner:"</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>numpy<span class="token punctuation">.</span>inner<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token triple-quoted-string string">''' Output：Array inner:50'''</span>x <span class="token operator">=</span> numpy<span class="token punctuation">.</span>mat<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>y <span class="token operator">=</span> numpy<span class="token punctuation">.</span>mat<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Matrix inner:"</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>numpy<span class="token punctuation">.</span>inner<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token triple-quoted-string string">''' Output：Matrix inner:[[ 50] [110]]'''</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="4-4-3外积"><a href="#4-4-3外积" class="headerlink" title="4.4.3外积"></a>4.4.3外积</h4><p>和内积降维不同，外积是升维运算，m 维矢量和 n 维矢量的外积是 m*n（矩阵）</p><p>矩阵的并集运算，a1∗a2维矢量和b1∗b2维矩阵的外积是(a1∗a2)∗(b1∗b2)为矩阵。</p><p><img src="/2021/03/24/task4-nfm/pic1.png" alt=""></p><pre class="line-numbers language-python" data-language="python"><code class="language-python">x <span class="token operator">=</span> numpy<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>y <span class="token operator">=</span> numpy<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Array outer:"</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>numpy<span class="token punctuation">.</span>outer<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token triple-quoted-string string">''' Output：Array outer:[[10 20] [30 60]]'''</span>x <span class="token operator">=</span> numpy<span class="token punctuation">.</span>mat<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>y <span class="token operator">=</span> numpy<span class="token punctuation">.</span>mat<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Matrix outer:"</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>numpy<span class="token punctuation">.</span>outer<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token triple-quoted-string string">''' Output：Matrix outer:[[10 20] [20 40] [30 60] [40 80]]'''</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>Tips: matrix outer 是各自 vector outer 的并集</p><h4 id="4-4-4-元素积（element-wise-product-point-wise-product-Hadamard-product）"><a href="#4-4-4-元素积（element-wise-product-point-wise-product-Hadamard-product）" class="headerlink" title="4.4.4 元素积（element-wise product/point-wise product/Hadamard product）"></a>4.4.4 元素积（element-wise product/point-wise product/Hadamard product）</h4><p><img src="/2021/03/24/task4-nfm/pic2.png" style="zoom:80%;"></p><pre class="line-numbers language-python" data-language="python"><code class="language-python">x <span class="token operator">=</span> numpy<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>y <span class="token operator">=</span> numpy<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Array element-wise product:"</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>x <span class="token operator">*</span> y<span class="token punctuation">)</span><span class="token triple-quoted-string string">''' Output：Array element-wise product:[10 60]'''</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">BiInteractionPooling</span><span class="token punctuation">(</span>Layer<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token builtin">super</span><span class="token punctuation">(</span>BiInteractionPooling<span class="token punctuation">,</span> self<span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token keyword">def</span> <span class="token function">call</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> inputs<span class="token punctuation">)</span><span class="token punctuation">:</span>        concated_embeds_value <span class="token operator">=</span> inputs                square_of_sum <span class="token operator">=</span> tf<span class="token punctuation">.</span>square<span class="token punctuation">(</span>tf<span class="token punctuation">.</span>reduce_sum<span class="token punctuation">(</span>concated_embeds_value<span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> keepdims<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        sum_of_square <span class="token operator">=</span> tf<span class="token punctuation">.</span>reduce_sum<span class="token punctuation">(</span>concated_embeds_value<span class="token operator">*</span>concated_embeds_value<span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> keepdims<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>        <span class="token comment"># 和 deepFM 不同的地方 元素积并不是内积，内积输出的B x 1，元素积输出的B x k</span>        cross_term <span class="token operator">=</span> <span class="token number">0.5</span><span class="token operator">*</span><span class="token punctuation">(</span>square_of_sum<span class="token operator">-</span>sum_of_square<span class="token punctuation">)</span> <span class="token comment"># size = B x k</span>                <span class="token keyword">return</span> cross_term        <span class="token keyword">def</span> <span class="token function">compute_output_shape</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> input_shape<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> input_shape<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">get_bi_interaction_pooling_output</span><span class="token punctuation">(</span>sparse_input_dict<span class="token punctuation">,</span> sparse_feature_columns<span class="token punctuation">,</span> dnn_embedding_layers<span class="token punctuation">)</span><span class="token punctuation">:</span>        sparse_kd_embed <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> fc <span class="token keyword">in</span> sparse_feature_columns<span class="token punctuation">:</span>        feat_input <span class="token operator">=</span> sparse_input_dict<span class="token punctuation">[</span>fc<span class="token punctuation">.</span>name<span class="token punctuation">]</span>        _embed <span class="token operator">=</span> dnn_embedding_layers<span class="token punctuation">[</span>fc<span class="token punctuation">.</span>name<span class="token punctuation">]</span><span class="token punctuation">(</span>feat_input<span class="token punctuation">)</span>        sparse_kd_embed<span class="token punctuation">.</span>append<span class="token punctuation">(</span>_embed<span class="token punctuation">)</span>        concat_sparse_kd_embed <span class="token operator">=</span> Concatenate<span class="token punctuation">(</span>axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">(</span>sparse_kd_embed<span class="token punctuation">)</span>        pooling_out <span class="token operator">=</span> BiInteractionPooling<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span>concat_sparse_kd_embed<span class="token punctuation">)</span>        <span class="token keyword">return</span> pooling_out    <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">pooling_output <span class="token operator">=</span> get_bi_interaction_pooling_output<span class="token punctuation">(</span>sparse_input_dict<span class="token punctuation">,</span> dnn_sparse_feature_columns<span class="token punctuation">,</span> embedding_layers<span class="token punctuation">)</span><span class="token comment"># 归一化</span>pooling_output <span class="token operator">=</span> BatchNormalization<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span>pooling_output<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">get_dnn_logits</span><span class="token punctuation">(</span>pooling_output<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token comment"># 带有 Dropout 的 DNN</span>    dnn_out <span class="token operator">=</span> Dropout<span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">(</span>Dense<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">,</span> activation<span class="token operator">=</span><span class="token string">"relu"</span><span class="token punctuation">)</span><span class="token punctuation">(</span>pooling_output<span class="token punctuation">)</span><span class="token punctuation">)</span>    dnn_out <span class="token operator">=</span> Dropout<span class="token punctuation">(</span><span class="token number">0.3</span><span class="token punctuation">)</span><span class="token punctuation">(</span>Dense<span class="token punctuation">(</span><span class="token number">512</span><span class="token punctuation">,</span> activation<span class="token operator">=</span><span class="token string">"relu"</span><span class="token punctuation">)</span><span class="token punctuation">(</span>dnn_out<span class="token punctuation">)</span><span class="token punctuation">)</span>    dnn_out <span class="token operator">=</span> Dropout<span class="token punctuation">(</span><span class="token number">0.1</span><span class="token punctuation">)</span><span class="token punctuation">(</span>Dense<span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">,</span> activation<span class="token operator">=</span><span class="token string">"relu"</span><span class="token punctuation">)</span><span class="token punctuation">(</span>dnn_out<span class="token punctuation">)</span><span class="token punctuation">)</span>        dnn_logits <span class="token operator">=</span> Dense<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">(</span>dnn_out<span class="token punctuation">)</span>        <span class="token keyword">return</span> dnn_logits<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">dnn_logits <span class="token operator">=</span> get_dnn_logits<span class="token punctuation">(</span>pooling_output<span class="token punctuation">)</span>dnn_logits<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token operator">&lt;</span>KerasTensor<span class="token punctuation">:</span> shape<span class="token operator">=</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> dtype<span class="token operator">=</span>float32 <span class="token punctuation">(</span>created by layer <span class="token string">'dense_13'</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="4-5-Output-Logits"><a href="#4-5-Output-Logits" class="headerlink" title="4.5 Output Logits"></a>4.5 Output Logits</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># Linear + Dnn logits</span>output_logits <span class="token operator">=</span> Add<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">[</span>linear_logits<span class="token punctuation">,</span> dnn_logits<span class="token punctuation">]</span><span class="token punctuation">)</span>output_layers <span class="token operator">=</span> Activation<span class="token punctuation">(</span><span class="token string">"sigmoid"</span><span class="token punctuation">)</span><span class="token punctuation">(</span>output_logits<span class="token punctuation">)</span>model <span class="token operator">=</span> Model<span class="token punctuation">(</span>input_layers<span class="token punctuation">,</span> output_layers<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">model<span class="token punctuation">.</span>summary<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">Model<span class="token punctuation">:</span> <span class="token string">"model"</span>__________________________________________________________________________________________________Layer <span class="token punctuation">(</span><span class="token builtin">type</span><span class="token punctuation">)</span>                    Output Shape         Param <span class="token comment">#     Connected to                     </span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span>C1 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                 <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________C2 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                 <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________C3 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                 <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________C4 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                 <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________C5 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                 <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________C6 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                 <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________C7 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                 <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________C8 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                 <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________C9 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                 <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________C10 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________C11 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________C12 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________C13 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________C14 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________C15 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________C16 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________C17 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________C18 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________C19 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________C20 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________C21 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________C22 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________C23 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________C24 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________C25 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________C26 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________kd_emb_C1 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>           <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>         <span class="token number">108</span>         C1<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                         __________________________________________________________________________________________________kd_emb_C2 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>           <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>         <span class="token number">368</span>         C2<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                         __________________________________________________________________________________________________kd_emb_C3 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>           <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>         <span class="token number">688</span>         C3<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                         __________________________________________________________________________________________________kd_emb_C4 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>           <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>         <span class="token number">628</span>         C4<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                         __________________________________________________________________________________________________kd_emb_C5 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>           <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>         <span class="token number">48</span>          C5<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                         __________________________________________________________________________________________________kd_emb_C6 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>           <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>         <span class="token number">28</span>          C6<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                         __________________________________________________________________________________________________kd_emb_C7 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>           <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>         <span class="token number">732</span>         C7<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                         __________________________________________________________________________________________________kd_emb_C8 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>           <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>         <span class="token number">76</span>          C8<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                         __________________________________________________________________________________________________kd_emb_C9 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>           <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>         <span class="token number">8</span>           C9<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                         __________________________________________________________________________________________________kd_emb_C10 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>          <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>         <span class="token number">568</span>         C10<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                        __________________________________________________________________________________________________kd_emb_C11 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>          <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>         <span class="token number">692</span>         C11<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                        __________________________________________________________________________________________________kd_emb_C12 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>          <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>         <span class="token number">680</span>         C12<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                        __________________________________________________________________________________________________kd_emb_C13 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>          <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>         <span class="token number">664</span>         C13<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                        __________________________________________________________________________________________________kd_emb_C14 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>          <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>         <span class="token number">56</span>          C14<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                        __________________________________________________________________________________________________kd_emb_C15 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>          <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>         <span class="token number">680</span>         C15<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                        __________________________________________________________________________________________________kd_emb_C16 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>          <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>         <span class="token number">672</span>         C16<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                        __________________________________________________________________________________________________kd_emb_C17 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>          <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>         <span class="token number">36</span>          C17<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                        __________________________________________________________________________________________________kd_emb_C18 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>          <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>         <span class="token number">508</span>         C18<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                        __________________________________________________________________________________________________kd_emb_C19 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>          <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>         <span class="token number">176</span>         C19<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                        __________________________________________________________________________________________________kd_emb_C20 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>          <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>         <span class="token number">16</span>          C20<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                        __________________________________________________________________________________________________kd_emb_C21 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>          <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>         <span class="token number">676</span>         C21<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                        __________________________________________________________________________________________________kd_emb_C22 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>          <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>         <span class="token number">24</span>          C22<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                        __________________________________________________________________________________________________kd_emb_C23 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>          <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>         <span class="token number">40</span>          C23<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                        __________________________________________________________________________________________________kd_emb_C24 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>          <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>         <span class="token number">500</span>         C24<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                        __________________________________________________________________________________________________kd_emb_C25 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>          <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>         <span class="token number">80</span>          C25<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                        __________________________________________________________________________________________________kd_emb_C26 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>          <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>         <span class="token number">360</span>         C26<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                        __________________________________________________________________________________________________concatenate_3 <span class="token punctuation">(</span>Concatenate<span class="token punctuation">)</span>     <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">26</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>        <span class="token number">0</span>           kd_emb_C1<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                   kd_emb_C2<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                   kd_emb_C3<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                   kd_emb_C4<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                   kd_emb_C5<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                   kd_emb_C6<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                   kd_emb_C7<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                   kd_emb_C8<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                   kd_emb_C9<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                   kd_emb_C10<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  kd_emb_C11<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  kd_emb_C12<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  kd_emb_C13<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  kd_emb_C14<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  kd_emb_C15<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  kd_emb_C16<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  kd_emb_C17<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  kd_emb_C18<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  kd_emb_C19<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  kd_emb_C20<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  kd_emb_C21<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  kd_emb_C22<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  kd_emb_C23<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  kd_emb_C24<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  kd_emb_C25<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  kd_emb_C26<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                 __________________________________________________________________________________________________bi_interaction_pooling_2 <span class="token punctuation">(</span>BiInt <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>            <span class="token number">0</span>           concatenate_3<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>              __________________________________________________________________________________________________batch_normalization <span class="token punctuation">(</span>BatchNorma <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>            <span class="token number">16</span>          bi_interaction_pooling_2<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>   __________________________________________________________________________________________________dense_10 <span class="token punctuation">(</span>Dense<span class="token punctuation">)</span>                <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1024</span><span class="token punctuation">)</span>         <span class="token number">5120</span>        batch_normalization<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>        __________________________________________________________________________________________________dropout_9 <span class="token punctuation">(</span>Dropout<span class="token punctuation">)</span>             <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1024</span><span class="token punctuation">)</span>         <span class="token number">0</span>           dense_10<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                   __________________________________________________________________________________________________dense_11 <span class="token punctuation">(</span>Dense<span class="token punctuation">)</span>                <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">512</span><span class="token punctuation">)</span>          <span class="token number">524800</span>      dropout_9<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                  __________________________________________________________________________________________________I1 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                 <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________I2 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                 <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________I3 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                 <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________I4 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                 <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________I5 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                 <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________I6 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                 <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________I7 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                 <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________I8 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                 <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________I9 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                 <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________I10 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________I11 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________I12 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________I13 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________1d_emb_C1 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>           <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>         <span class="token number">27</span>          C1<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                         __________________________________________________________________________________________________1d_emb_C2 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>           <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>         <span class="token number">92</span>          C2<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                         __________________________________________________________________________________________________1d_emb_C3 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>           <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>         <span class="token number">172</span>         C3<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                         __________________________________________________________________________________________________1d_emb_C4 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>           <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>         <span class="token number">157</span>         C4<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                         __________________________________________________________________________________________________1d_emb_C5 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>           <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>         <span class="token number">12</span>          C5<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                         __________________________________________________________________________________________________1d_emb_C6 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>           <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>         <span class="token number">7</span>           C6<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                         __________________________________________________________________________________________________1d_emb_C7 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>           <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>         <span class="token number">183</span>         C7<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                         __________________________________________________________________________________________________1d_emb_C8 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>           <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>         <span class="token number">19</span>          C8<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                         __________________________________________________________________________________________________1d_emb_C9 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>           <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>         <span class="token number">2</span>           C9<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                         __________________________________________________________________________________________________1d_emb_C10 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>          <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>         <span class="token number">142</span>         C10<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                        __________________________________________________________________________________________________1d_emb_C11 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>          <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>         <span class="token number">173</span>         C11<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                        __________________________________________________________________________________________________1d_emb_C12 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>          <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>         <span class="token number">170</span>         C12<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                        __________________________________________________________________________________________________1d_emb_C13 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>          <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>         <span class="token number">166</span>         C13<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                        __________________________________________________________________________________________________1d_emb_C14 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>          <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>         <span class="token number">14</span>          C14<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                        __________________________________________________________________________________________________1d_emb_C15 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>          <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>         <span class="token number">170</span>         C15<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                        __________________________________________________________________________________________________1d_emb_C16 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>          <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>         <span class="token number">168</span>         C16<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                        __________________________________________________________________________________________________1d_emb_C17 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>          <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>         <span class="token number">9</span>           C17<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                        __________________________________________________________________________________________________1d_emb_C18 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>          <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>         <span class="token number">127</span>         C18<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                        __________________________________________________________________________________________________1d_emb_C19 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>          <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>         <span class="token number">44</span>          C19<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                        __________________________________________________________________________________________________1d_emb_C20 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>          <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>         <span class="token number">4</span>           C20<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                        __________________________________________________________________________________________________1d_emb_C21 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>          <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>         <span class="token number">169</span>         C21<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                        __________________________________________________________________________________________________1d_emb_C22 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>          <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>         <span class="token number">6</span>           C22<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                        __________________________________________________________________________________________________1d_emb_C23 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>          <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>         <span class="token number">10</span>          C23<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                        __________________________________________________________________________________________________1d_emb_C24 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>          <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>         <span class="token number">125</span>         C24<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                        __________________________________________________________________________________________________1d_emb_C25 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>          <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>         <span class="token number">20</span>          C25<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                        __________________________________________________________________________________________________1d_emb_C26 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>          <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>         <span class="token number">90</span>          C26<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                        __________________________________________________________________________________________________dropout_10 <span class="token punctuation">(</span>Dropout<span class="token punctuation">)</span>            <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">512</span><span class="token punctuation">)</span>          <span class="token number">0</span>           dense_11<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                   __________________________________________________________________________________________________concatenate <span class="token punctuation">(</span>Concatenate<span class="token punctuation">)</span>       <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">)</span>           <span class="token number">0</span>           I1<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                          I2<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                          I3<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                          I4<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                          I5<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                          I6<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                          I7<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                          I8<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                          I9<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                          I10<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                         I11<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                         I12<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                         I13<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                        __________________________________________________________________________________________________flatten <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>               <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>            <span class="token number">0</span>           1d_emb_C1<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                  __________________________________________________________________________________________________flatten_1 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>             <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>            <span class="token number">0</span>           1d_emb_C2<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                  __________________________________________________________________________________________________flatten_2 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>             <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>            <span class="token number">0</span>           1d_emb_C3<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                  __________________________________________________________________________________________________flatten_3 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>             <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>            <span class="token number">0</span>           1d_emb_C4<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                  __________________________________________________________________________________________________flatten_4 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>             <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>            <span class="token number">0</span>           1d_emb_C5<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                  __________________________________________________________________________________________________flatten_5 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>             <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>            <span class="token number">0</span>           1d_emb_C6<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                  __________________________________________________________________________________________________flatten_6 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>             <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>            <span class="token number">0</span>           1d_emb_C7<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                  __________________________________________________________________________________________________flatten_7 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>             <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>            <span class="token number">0</span>           1d_emb_C8<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                  __________________________________________________________________________________________________flatten_8 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>             <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>            <span class="token number">0</span>           1d_emb_C9<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                  __________________________________________________________________________________________________flatten_9 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>             <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>            <span class="token number">0</span>           1d_emb_C10<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                 __________________________________________________________________________________________________flatten_10 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>            <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>            <span class="token number">0</span>           1d_emb_C11<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                 __________________________________________________________________________________________________flatten_11 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>            <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>            <span class="token number">0</span>           1d_emb_C12<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                 __________________________________________________________________________________________________flatten_12 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>            <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>            <span class="token number">0</span>           1d_emb_C13<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                 __________________________________________________________________________________________________flatten_13 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>            <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>            <span class="token number">0</span>           1d_emb_C14<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                 __________________________________________________________________________________________________flatten_14 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>            <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>            <span class="token number">0</span>           1d_emb_C15<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                 __________________________________________________________________________________________________flatten_15 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>            <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>            <span class="token number">0</span>           1d_emb_C16<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                 __________________________________________________________________________________________________flatten_16 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>            <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>            <span class="token number">0</span>           1d_emb_C17<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                 __________________________________________________________________________________________________flatten_17 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>            <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>            <span class="token number">0</span>           1d_emb_C18<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                 __________________________________________________________________________________________________flatten_18 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>            <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>            <span class="token number">0</span>           1d_emb_C19<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                 __________________________________________________________________________________________________flatten_19 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>            <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>            <span class="token number">0</span>           1d_emb_C20<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                 __________________________________________________________________________________________________flatten_20 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>            <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>            <span class="token number">0</span>           1d_emb_C21<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                 __________________________________________________________________________________________________flatten_21 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>            <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>            <span class="token number">0</span>           1d_emb_C22<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                 __________________________________________________________________________________________________flatten_22 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>            <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>            <span class="token number">0</span>           1d_emb_C23<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                 __________________________________________________________________________________________________flatten_23 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>            <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>            <span class="token number">0</span>           1d_emb_C24<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                 __________________________________________________________________________________________________flatten_24 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>            <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>            <span class="token number">0</span>           1d_emb_C25<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                 __________________________________________________________________________________________________flatten_25 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>            <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>            <span class="token number">0</span>           1d_emb_C26<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                 __________________________________________________________________________________________________dense_12 <span class="token punctuation">(</span>Dense<span class="token punctuation">)</span>                <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">256</span><span class="token punctuation">)</span>          <span class="token number">131328</span>      dropout_10<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                 __________________________________________________________________________________________________dense <span class="token punctuation">(</span>Dense<span class="token punctuation">)</span>                   <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>            <span class="token number">14</span>          concatenate<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                __________________________________________________________________________________________________add <span class="token punctuation">(</span>Add<span class="token punctuation">)</span>                       <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>            <span class="token number">0</span>           flatten<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                     flatten_1<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                   flatten_2<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                   flatten_3<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                   flatten_4<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                   flatten_5<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                   flatten_6<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                   flatten_7<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                   flatten_8<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                   flatten_9<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                   flatten_10<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  flatten_11<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  flatten_12<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  flatten_13<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  flatten_14<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  flatten_15<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  flatten_16<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  flatten_17<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  flatten_18<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  flatten_19<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  flatten_20<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  flatten_21<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  flatten_22<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  flatten_23<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  flatten_24<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  flatten_25<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                 __________________________________________________________________________________________________dropout_11 <span class="token punctuation">(</span>Dropout<span class="token punctuation">)</span>            <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">256</span><span class="token punctuation">)</span>          <span class="token number">0</span>           dense_12<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                   __________________________________________________________________________________________________add_1 <span class="token punctuation">(</span>Add<span class="token punctuation">)</span>                     <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>            <span class="token number">0</span>           dense<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                       add<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                        __________________________________________________________________________________________________dense_13 <span class="token punctuation">(</span>Dense<span class="token punctuation">)</span>                <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>            <span class="token number">257</span>         dropout_11<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                 __________________________________________________________________________________________________add_2 <span class="token punctuation">(</span>Add<span class="token punctuation">)</span>                     <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>            <span class="token number">0</span>           add_1<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                       dense_13<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                   __________________________________________________________________________________________________activation <span class="token punctuation">(</span>Activation<span class="token punctuation">)</span>         <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>            <span class="token number">0</span>           add_2<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                      <span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span>Total params<span class="token punctuation">:</span> <span class="token number">672</span><span class="token punctuation">,</span><span class="token number">925</span>Trainable params<span class="token punctuation">:</span> <span class="token number">672</span><span class="token punctuation">,</span><span class="token number">917</span>Non<span class="token operator">-</span>trainable params<span class="token punctuation">:</span> <span class="token number">8</span>__________________________________________________________________________________________________<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">model<span class="token punctuation">.</span><span class="token builtin">compile</span><span class="token punctuation">(</span>optimizer<span class="token operator">=</span><span class="token string">"adam"</span><span class="token punctuation">,</span>             loss<span class="token operator">=</span><span class="token string">"binary_crossentropy"</span><span class="token punctuation">,</span>             metrics<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">"binary_crossentropy"</span><span class="token punctuation">,</span> tf<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>metrics<span class="token punctuation">.</span>AUC<span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">'auc'</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token comment"># 将输入数据转化成字典的形式输入</span>train_model_input <span class="token operator">=</span> <span class="token punctuation">{</span>name<span class="token punctuation">:</span> data<span class="token punctuation">[</span>name<span class="token punctuation">]</span> <span class="token keyword">for</span> name <span class="token keyword">in</span> dense_features <span class="token operator">+</span> sparse_features<span class="token punctuation">}</span><span class="token comment"># 模型训练</span>model<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>train_model_input<span class="token punctuation">,</span> train_data<span class="token punctuation">[</span><span class="token string">'label'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>values<span class="token punctuation">,</span>        batch_size<span class="token operator">=</span><span class="token number">64</span><span class="token punctuation">,</span> epochs<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span> validation_split<span class="token operator">=</span><span class="token number">0.3</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">Epoch <span class="token number">1</span><span class="token operator">/</span><span class="token number">10</span><span class="token number">3</span><span class="token operator">/</span><span class="token number">3</span> <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token punctuation">]</span> <span class="token operator">-</span> 6s 378ms<span class="token operator">/</span>step <span class="token operator">-</span> loss<span class="token punctuation">:</span> <span class="token number">0.3549</span> <span class="token operator">-</span> binary_crossentropy<span class="token punctuation">:</span> <span class="token number">0.3549</span> <span class="token operator">-</span> auc<span class="token punctuation">:</span> <span class="token number">0.8915</span> <span class="token operator">-</span> val_loss<span class="token punctuation">:</span> <span class="token number">0.6528</span> <span class="token operator">-</span> val_binary_crossentropy<span class="token punctuation">:</span> <span class="token number">0.6528</span> <span class="token operator">-</span> val_auc<span class="token punctuation">:</span> <span class="token number">0.6463</span>Epoch <span class="token number">2</span><span class="token operator">/</span><span class="token number">10</span><span class="token number">3</span><span class="token operator">/</span><span class="token number">3</span> <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token punctuation">]</span> <span class="token operator">-</span> 0s 50ms<span class="token operator">/</span>step <span class="token operator">-</span> loss<span class="token punctuation">:</span> <span class="token number">0.2811</span> <span class="token operator">-</span> binary_crossentropy<span class="token punctuation">:</span> <span class="token number">0.2811</span> <span class="token operator">-</span> auc<span class="token punctuation">:</span> <span class="token number">0.9425</span> <span class="token operator">-</span> val_loss<span class="token punctuation">:</span> <span class="token number">0.6455</span> <span class="token operator">-</span> val_binary_crossentropy<span class="token punctuation">:</span> <span class="token number">0.6455</span> <span class="token operator">-</span> val_auc<span class="token punctuation">:</span> <span class="token number">0.6489</span>Epoch <span class="token number">3</span><span class="token operator">/</span><span class="token number">10</span><span class="token number">3</span><span class="token operator">/</span><span class="token number">3</span> <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token punctuation">]</span> <span class="token operator">-</span> 0s 52ms<span class="token operator">/</span>step <span class="token operator">-</span> loss<span class="token punctuation">:</span> <span class="token number">0.2301</span> <span class="token operator">-</span> binary_crossentropy<span class="token punctuation">:</span> <span class="token number">0.2301</span> <span class="token operator">-</span> auc<span class="token punctuation">:</span> <span class="token number">0.9890</span> <span class="token operator">-</span> val_loss<span class="token punctuation">:</span> <span class="token number">0.6382</span> <span class="token operator">-</span> val_binary_crossentropy<span class="token punctuation">:</span> <span class="token number">0.6382</span> <span class="token operator">-</span> val_auc<span class="token punctuation">:</span> <span class="token number">0.6521</span>Epoch <span class="token number">4</span><span class="token operator">/</span><span class="token number">10</span><span class="token number">3</span><span class="token operator">/</span><span class="token number">3</span> <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token punctuation">]</span> <span class="token operator">-</span> 0s 52ms<span class="token operator">/</span>step <span class="token operator">-</span> loss<span class="token punctuation">:</span> <span class="token number">0.1785</span> <span class="token operator">-</span> binary_crossentropy<span class="token punctuation">:</span> <span class="token number">0.1785</span> <span class="token operator">-</span> auc<span class="token punctuation">:</span> <span class="token number">0.9961</span> <span class="token operator">-</span> val_loss<span class="token punctuation">:</span> <span class="token number">0.6287</span> <span class="token operator">-</span> val_binary_crossentropy<span class="token punctuation">:</span> <span class="token number">0.6287</span> <span class="token operator">-</span> val_auc<span class="token punctuation">:</span> <span class="token number">0.6630</span>Epoch <span class="token number">5</span><span class="token operator">/</span><span class="token number">10</span><span class="token number">3</span><span class="token operator">/</span><span class="token number">3</span> <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token punctuation">]</span> <span class="token operator">-</span> 0s 52ms<span class="token operator">/</span>step <span class="token operator">-</span> loss<span class="token punctuation">:</span> <span class="token number">0.1622</span> <span class="token operator">-</span> binary_crossentropy<span class="token punctuation">:</span> <span class="token number">0.1622</span> <span class="token operator">-</span> auc<span class="token punctuation">:</span> <span class="token number">0.9981</span> <span class="token operator">-</span> val_loss<span class="token punctuation">:</span> <span class="token number">0.6194</span> <span class="token operator">-</span> val_binary_crossentropy<span class="token punctuation">:</span> <span class="token number">0.6194</span> <span class="token operator">-</span> val_auc<span class="token punctuation">:</span> <span class="token number">0.6720</span>Epoch <span class="token number">6</span><span class="token operator">/</span><span class="token number">10</span><span class="token number">3</span><span class="token operator">/</span><span class="token number">3</span> <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token punctuation">]</span> <span class="token operator">-</span> 0s 52ms<span class="token operator">/</span>step <span class="token operator">-</span> loss<span class="token punctuation">:</span> <span class="token number">0.1363</span> <span class="token operator">-</span> binary_crossentropy<span class="token punctuation">:</span> <span class="token number">0.1363</span> <span class="token operator">-</span> auc<span class="token punctuation">:</span> <span class="token number">0.9977</span> <span class="token operator">-</span> val_loss<span class="token punctuation">:</span> <span class="token number">0.6095</span> <span class="token operator">-</span> val_binary_crossentropy<span class="token punctuation">:</span> <span class="token number">0.6095</span> <span class="token operator">-</span> val_auc<span class="token punctuation">:</span> <span class="token number">0.6874</span>Epoch <span class="token number">7</span><span class="token operator">/</span><span class="token number">10</span><span class="token number">3</span><span class="token operator">/</span><span class="token number">3</span> <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token punctuation">]</span> <span class="token operator">-</span> 0s 51ms<span class="token operator">/</span>step <span class="token operator">-</span> loss<span class="token punctuation">:</span> <span class="token number">0.0882</span> <span class="token operator">-</span> binary_crossentropy<span class="token punctuation">:</span> <span class="token number">0.0882</span> <span class="token operator">-</span> auc<span class="token punctuation">:</span> <span class="token number">0.9990</span> <span class="token operator">-</span> val_loss<span class="token punctuation">:</span> <span class="token number">0.6001</span> <span class="token operator">-</span> val_binary_crossentropy<span class="token punctuation">:</span> <span class="token number">0.6001</span> <span class="token operator">-</span> val_auc<span class="token punctuation">:</span> <span class="token number">0.7015</span>Epoch <span class="token number">8</span><span class="token operator">/</span><span class="token number">10</span><span class="token number">3</span><span class="token operator">/</span><span class="token number">3</span> <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token punctuation">]</span> <span class="token operator">-</span> 0s 52ms<span class="token operator">/</span>step <span class="token operator">-</span> loss<span class="token punctuation">:</span> <span class="token number">0.0372</span> <span class="token operator">-</span> binary_crossentropy<span class="token punctuation">:</span> <span class="token number">0.0372</span> <span class="token operator">-</span> auc<span class="token punctuation">:</span> <span class="token number">1.0000</span> <span class="token operator">-</span> val_loss<span class="token punctuation">:</span> <span class="token number">0.5963</span> <span class="token operator">-</span> val_binary_crossentropy<span class="token punctuation">:</span> <span class="token number">0.5963</span> <span class="token operator">-</span> val_auc<span class="token punctuation">:</span> <span class="token number">0.7163</span>Epoch <span class="token number">9</span><span class="token operator">/</span><span class="token number">10</span><span class="token number">3</span><span class="token operator">/</span><span class="token number">3</span> <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token punctuation">]</span> <span class="token operator">-</span> 0s 51ms<span class="token operator">/</span>step <span class="token operator">-</span> loss<span class="token punctuation">:</span> <span class="token number">0.0245</span> <span class="token operator">-</span> binary_crossentropy<span class="token punctuation">:</span> <span class="token number">0.0245</span> <span class="token operator">-</span> auc<span class="token punctuation">:</span> <span class="token number">1.0000</span> <span class="token operator">-</span> val_loss<span class="token punctuation">:</span> <span class="token number">0.6320</span> <span class="token operator">-</span> val_binary_crossentropy<span class="token punctuation">:</span> <span class="token number">0.6320</span> <span class="token operator">-</span> val_auc<span class="token punctuation">:</span> <span class="token number">0.7227</span>Epoch <span class="token number">10</span><span class="token operator">/</span><span class="token number">10</span><span class="token number">3</span><span class="token operator">/</span><span class="token number">3</span> <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token punctuation">]</span> <span class="token operator">-</span> 0s 52ms<span class="token operator">/</span>step <span class="token operator">-</span> loss<span class="token punctuation">:</span> <span class="token number">0.0126</span> <span class="token operator">-</span> binary_crossentropy<span class="token punctuation">:</span> <span class="token number">0.0126</span> <span class="token operator">-</span> auc<span class="token punctuation">:</span> <span class="token number">1.0000</span> <span class="token operator">-</span> val_loss<span class="token punctuation">:</span> <span class="token number">0.7111</span> <span class="token operator">-</span> val_binary_crossentropy<span class="token punctuation">:</span> <span class="token number">0.7111</span> <span class="token operator">-</span> val_auc<span class="token punctuation">:</span> <span class="token number">0.7240</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="5-思考题"><a href="#5-思考题" class="headerlink" title="5. 思考题"></a>5. 思考题</h2><ol><li>NFM中的特征交叉与FM中的特征交叉有何异同，分别从原理和代码实现上进行对比分析</li></ol><ul><li>FM 只考虑了二阶相关特征，NFM 则是使用了B-Interaction Pooling Layer，并且 NFM 借助了 DNN 进行更高阶的学习 </li><li>FM 的计算方式为内积，NFM 则是元素积</li></ul><p>代码实现上：</p><p>FM：</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">square_of_sum <span class="token operator">=</span> tf<span class="token punctuation">.</span>square<span class="token punctuation">(</span>tf<span class="token punctuation">.</span>reduce_sum<span class="token punctuation">(</span>concated_embeds_value<span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> keepdims<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># B x 1 x k</span>sum_of_square <span class="token operator">=</span> tf<span class="token punctuation">.</span>reduce_sum<span class="token punctuation">(</span>concated_embeds_value <span class="token operator">*</span> concated_embeds_value<span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> keepdims<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token comment"># B x 1 x k</span>cross_term <span class="token operator">=</span> square_of_sum <span class="token operator">-</span> sum_of_square <span class="token comment"># B x 1 x k</span>cross_term <span class="token operator">=</span> <span class="token number">0.5</span><span class="token operator">*</span>tf<span class="token punctuation">.</span>reduce_sum<span class="token punctuation">(</span>cross_term<span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> keepdims<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span> <span class="token comment"># B x 1</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>NFM：</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">square_of_sum <span class="token operator">=</span> tf<span class="token punctuation">.</span>square<span class="token punctuation">(</span>tf<span class="token punctuation">.</span>reduce_sum<span class="token punctuation">(</span>concated_embeds_value<span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> keepdims<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># B x k</span>sum_of_square <span class="token operator">=</span> tf<span class="token punctuation">.</span>reduce_sum<span class="token punctuation">(</span>concated_embeds_value <span class="token operator">*</span> concated_embeds_value<span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> keepdims<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span> <span class="token comment"># B x k</span>cross_term <span class="token operator">=</span> <span class="token number">0.5</span> <span class="token operator">*</span> <span class="token punctuation">(</span>square_of_sum <span class="token operator">-</span> sum_of_square<span class="token punctuation">)</span> <span class="token comment"># B x k</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><ul><li><a href="https://arxiv.org/pdf/1708.05027.pdf">论文原文</a></li><li><a href="https://jesse-csj.github.io/2019/07/29/NFM/">推荐系统之ctr预估-NFM模型解析</a></li><li><a href="https://zhuanlan.zhihu.com/p/92293407">推荐系统系列（七）：NFM理论与实践</a></li><li><a href="https://www.cnblogs.com/steven-yang/p/6348112.html#%E5%85%83%E7%B4%A0%E7%A7%AFelement-wise-productpoint-wise-producthadamard-product">机器学习中的基本数学知识</a></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> DataWhale </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Task3 Web3js</title>
      <link href="2021/03/23/task3-web3js/"/>
      <url>2021/03/23/task3-web3js/</url>
      
        <content type="html"><![CDATA[<h1 id="web3-js-简介"><a href="#web3-js-简介" class="headerlink" title="web3.js 简介"></a>web3.js 简介</h1><p>Web3 是一套和以太坊节点进行通信的 API，如果我们需要基于以太坊来开发去中心化应用，就可能需要使用 web3（或者使用 <code>ethers.js</code> ），例如需要通过 Web3 来获取节点状态，获取账号信息，调用合约、监听合约事件等等。</p><p>实验过程有点坎坷</p><p>记录下遇到的问题，以后有足够时间再来解决</p><h2 id="bug"><a href="#bug" class="headerlink" title="bug"></a>bug</h2><h3 id="1-挖过第一次矿就不能再挖了，然后重建一个子链也不大行"><a href="#1-挖过第一次矿就不能再挖了，然后重建一个子链也不大行" class="headerlink" title="1. 挖过第一次矿就不能再挖了，然后重建一个子链也不大行"></a>1. 挖过第一次矿就不能再挖了，然后重建一个子链也不大行</h3><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token operator">&gt;</span> eth<span class="token punctuation">.</span><span class="token function">getBalance</span><span class="token punctuation">(</span>eth<span class="token punctuation">.</span>accounts<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token number">0</span><span class="token operator">&gt;</span> miner<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token constant">INFO</span> <span class="token punctuation">[</span><span class="token number">03</span><span class="token operator">-</span><span class="token number">23</span><span class="token operator">|</span><span class="token number">16</span><span class="token operator">:</span><span class="token number">01</span><span class="token operator">:</span><span class="token number">58.352</span><span class="token punctuation">]</span> Updated mining threads                   threads<span class="token operator">=</span><span class="token number">4</span><span class="token keyword">null</span><span class="token operator">&gt;</span> miner<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token constant">INFO</span> <span class="token punctuation">[</span><span class="token number">03</span><span class="token operator">-</span><span class="token number">23</span><span class="token operator">|</span><span class="token number">16</span><span class="token operator">:</span><span class="token number">02</span><span class="token operator">:</span><span class="token number">01.197</span><span class="token punctuation">]</span> Updated mining threads                   threads<span class="token operator">=</span><span class="token number">1</span><span class="token keyword">null</span><span class="token operator">&gt;</span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>（刚才我想复现一下记录下代码，发现又可以了^_^</p><h3 id="2-err-”invalid-sender”"><a href="#2-err-”invalid-sender”" class="headerlink" title="2.err=”invalid sender”"></a>2.err=”invalid sender”</h3><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token operator">&gt;</span> eth<span class="token punctuation">.</span><span class="token function">getBalance</span><span class="token punctuation">(</span>eth<span class="token punctuation">.</span>accounts<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token number">610000000000000000000</span><span class="token operator">&gt;</span> eth<span class="token punctuation">.</span><span class="token function">getBalance</span><span class="token punctuation">(</span>eth<span class="token punctuation">.</span>accounts<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token number">0</span><span class="token operator">&gt;</span> personal<span class="token punctuation">.</span><span class="token function">unlockAccount</span><span class="token punctuation">(</span>eth<span class="token punctuation">.</span>accounts<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>Unlock account <span class="token number">0x22a95a40762d9f0580a68e2a878661dd0fd62e78</span>Passphrase<span class="token operator">:</span> <span class="token boolean">true</span><span class="token operator">&gt;</span> amount <span class="token operator">=</span> web3<span class="token punctuation">.</span><span class="token function">toWei</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token string">'ether'</span><span class="token punctuation">)</span><span class="token string">"5000000000000000000"</span><span class="token operator">&gt;</span> eth<span class="token punctuation">.</span><span class="token function">sendTransaction</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token keyword">from</span><span class="token operator">:</span>eth<span class="token punctuation">.</span>accounts<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>to<span class="token operator">:</span>eth<span class="token punctuation">.</span>accounts<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>value<span class="token operator">:</span>amount<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token constant">WARN</span> <span class="token punctuation">[</span><span class="token number">03</span><span class="token operator">-</span><span class="token number">23</span><span class="token operator">|</span><span class="token number">16</span><span class="token operator">:</span><span class="token number">32</span><span class="token operator">:</span><span class="token number">01.748</span><span class="token punctuation">]</span> Served eth_sendTransaction               reqid<span class="token operator">=</span><span class="token number">19</span> t<span class="token operator">=</span><span class="token number">1.326072</span>ms err<span class="token operator">=</span><span class="token string">"invalid sender"</span>Error<span class="token operator">:</span> invalid senderat web3<span class="token punctuation">.</span>js<span class="token operator">:</span><span class="token number">6347</span><span class="token operator">:</span><span class="token number">37</span><span class="token punctuation">(</span><span class="token number">47</span><span class="token punctuation">)</span>at web3<span class="token punctuation">.</span>js<span class="token operator">:</span><span class="token number">5081</span><span class="token operator">:</span><span class="token number">62</span><span class="token punctuation">(</span><span class="token number">37</span><span class="token punctuation">)</span>at <span class="token operator">&lt;</span>eval<span class="token operator">&gt;</span><span class="token operator">:</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">20</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token operator">&gt;</span> eth<span class="token punctuation">.</span><span class="token function">sendTransaction</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token keyword">from</span><span class="token operator">:</span><span class="token string">"0x22a95a40762d9f0580a68e2a878661dd0fd62e78"</span><span class="token punctuation">,</span>to<span class="token operator">:</span><span class="token string">"0xf48509733ecc04fc874fbde1349eb1b260aeb6a1"</span><span class="token punctuation">,</span>value<span class="token operator">:</span>amount<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token constant">WARN</span> <span class="token punctuation">[</span><span class="token number">03</span><span class="token operator">-</span><span class="token number">23</span><span class="token operator">|</span><span class="token number">16</span><span class="token operator">:</span><span class="token number">35</span><span class="token operator">:</span><span class="token number">07.159</span><span class="token punctuation">]</span> Served eth_sendTransaction               reqid<span class="token operator">=</span><span class="token number">21</span> t<span class="token operator">=</span><span class="token string">"802.013µs"</span> err<span class="token operator">=</span><span class="token string">"invalid sender"</span>Error<span class="token operator">:</span> invalid senderat web3<span class="token punctuation">.</span>js<span class="token operator">:</span><span class="token number">6347</span><span class="token operator">:</span><span class="token number">37</span><span class="token punctuation">(</span><span class="token number">47</span><span class="token punctuation">)</span>at web3<span class="token punctuation">.</span>js<span class="token operator">:</span><span class="token number">5081</span><span class="token operator">:</span><span class="token number">62</span><span class="token punctuation">(</span><span class="token number">37</span><span class="token punctuation">)</span>at <span class="token operator">&lt;</span>eval<span class="token operator">&gt;</span><span class="token operator">:</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">20</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token operator">&gt;</span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="3-换一种启动方式"><a href="#3-换一种启动方式" class="headerlink" title="3.换一种启动方式"></a>3.换一种启动方式</h3><p>ERROR[03-23|16:46:39.776] Unavailable modules in HTTP API list     unavailable=[shh] available=”[admin debug web3 eth txpool personal ethash miner net]”</p><pre class="line-numbers language-js" data-language="js"><code class="language-js">terence@ccr<span class="token operator">:</span><span class="token operator">~</span><span class="token operator">/</span>Desktop<span class="token operator">/</span>DataWhale<span class="token operator">/</span>OwnChain$ geth <span class="token operator">--</span>networkid <span class="token number">150</span> <span class="token operator">--</span>datadir <span class="token string">"."</span> <span class="token operator">--</span>identity <span class="token string">"kexin"</span> <span class="token operator">--</span>rpc <span class="token operator">--</span>rpcport <span class="token string">"8545"</span> <span class="token operator">--</span>rpcaddr <span class="token string">"localhost"</span> <span class="token operator">--</span>port <span class="token string">"30303"</span> <span class="token operator">--</span>nodiscover <span class="token operator">--</span>allow<span class="token operator">-</span>insecure<span class="token operator">-</span>unlock <span class="token operator">--</span>rpcapi <span class="token string">"eth,net,web3,personal,admin,shh,txpool,debug,miner"</span> console<span class="token constant">INFO</span> <span class="token punctuation">[</span><span class="token number">03</span><span class="token operator">-</span><span class="token number">23</span><span class="token operator">|</span><span class="token number">16</span><span class="token operator">:</span><span class="token number">46</span><span class="token operator">:</span><span class="token number">39.753</span><span class="token punctuation">]</span> Maximum peer count                       <span class="token constant">ETH</span><span class="token operator">=</span><span class="token number">50</span> <span class="token constant">LES</span><span class="token operator">=</span><span class="token number">0</span> total<span class="token operator">=</span><span class="token number">50</span><span class="token constant">WARN</span> <span class="token punctuation">[</span><span class="token number">03</span><span class="token operator">-</span><span class="token number">23</span><span class="token operator">|</span><span class="token number">16</span><span class="token operator">:</span><span class="token number">46</span><span class="token operator">:</span><span class="token number">39.753</span><span class="token punctuation">]</span> The flag <span class="token operator">--</span>rpc is deprecated and will be removed June <span class="token number">2021</span><span class="token punctuation">,</span> please use <span class="token operator">--</span>http <span class="token constant">WARN</span> <span class="token punctuation">[</span><span class="token number">03</span><span class="token operator">-</span><span class="token number">23</span><span class="token operator">|</span><span class="token number">16</span><span class="token operator">:</span><span class="token number">46</span><span class="token operator">:</span><span class="token number">39.753</span><span class="token punctuation">]</span> The flag <span class="token operator">--</span>rpcaddr is deprecated and will be removed June <span class="token number">2021</span><span class="token punctuation">,</span> please use <span class="token operator">--</span>http<span class="token punctuation">.</span>addr <span class="token constant">WARN</span> <span class="token punctuation">[</span><span class="token number">03</span><span class="token operator">-</span><span class="token number">23</span><span class="token operator">|</span><span class="token number">16</span><span class="token operator">:</span><span class="token number">46</span><span class="token operator">:</span><span class="token number">39.753</span><span class="token punctuation">]</span> The flag <span class="token operator">--</span>rpcport is deprecated and will be removed June <span class="token number">2021</span><span class="token punctuation">,</span> please use <span class="token operator">--</span>http<span class="token punctuation">.</span>port <span class="token constant">WARN</span> <span class="token punctuation">[</span><span class="token number">03</span><span class="token operator">-</span><span class="token number">23</span><span class="token operator">|</span><span class="token number">16</span><span class="token operator">:</span><span class="token number">46</span><span class="token operator">:</span><span class="token number">39.753</span><span class="token punctuation">]</span> The flag <span class="token operator">--</span>rpcapi is deprecated and will be removed June <span class="token number">2021</span><span class="token punctuation">,</span> please use <span class="token operator">--</span>http<span class="token punctuation">.</span>api <span class="token constant">INFO</span> <span class="token punctuation">[</span><span class="token number">03</span><span class="token operator">-</span><span class="token number">23</span><span class="token operator">|</span><span class="token number">16</span><span class="token operator">:</span><span class="token number">46</span><span class="token operator">:</span><span class="token number">39.753</span><span class="token punctuation">]</span> Smartcard socket not found<span class="token punctuation">,</span> disabling    err<span class="token operator">=</span><span class="token string">"stat /run/pcscd/pcscd.comm: no such file or directory"</span><span class="token constant">INFO</span> <span class="token punctuation">[</span><span class="token number">03</span><span class="token operator">-</span><span class="token number">23</span><span class="token operator">|</span><span class="token number">16</span><span class="token operator">:</span><span class="token number">46</span><span class="token operator">:</span><span class="token number">39.753</span><span class="token punctuation">]</span> Set global gas cap                       cap<span class="token operator">=</span><span class="token number">25000000</span><span class="token constant">INFO</span> <span class="token punctuation">[</span><span class="token number">03</span><span class="token operator">-</span><span class="token number">23</span><span class="token operator">|</span><span class="token number">16</span><span class="token operator">:</span><span class="token number">46</span><span class="token operator">:</span><span class="token number">39.753</span><span class="token punctuation">]</span> Allocated trie memory caches             clean<span class="token operator">=</span><span class="token number">154.00</span>MiB dirty<span class="token operator">=</span><span class="token number">256.00</span>MiB<span class="token constant">INFO</span> <span class="token punctuation">[</span><span class="token number">03</span><span class="token operator">-</span><span class="token number">23</span><span class="token operator">|</span><span class="token number">16</span><span class="token operator">:</span><span class="token number">46</span><span class="token operator">:</span><span class="token number">39.753</span><span class="token punctuation">]</span> Allocated cache and file handles         database<span class="token operator">=</span><span class="token operator">/</span>home<span class="token operator">/</span>terence<span class="token operator">/</span>Desktop<span class="token operator">/</span>DataWhale<span class="token operator">/</span>OwnChain<span class="token operator">/</span>geth<span class="token operator">/</span>chaindata cache<span class="token operator">=</span><span class="token number">512.00</span>MiB handles<span class="token operator">=</span><span class="token number">524288</span><span class="token constant">INFO</span> <span class="token punctuation">[</span><span class="token number">03</span><span class="token operator">-</span><span class="token number">23</span><span class="token operator">|</span><span class="token number">16</span><span class="token operator">:</span><span class="token number">46</span><span class="token operator">:</span><span class="token number">39.764</span><span class="token punctuation">]</span> Opened ancient database                  database<span class="token operator">=</span><span class="token operator">/</span>home<span class="token operator">/</span>terence<span class="token operator">/</span>Desktop<span class="token operator">/</span>DataWhale<span class="token operator">/</span>OwnChain<span class="token operator">/</span>geth<span class="token operator">/</span>chaindata<span class="token operator">/</span>ancient<span class="token constant">INFO</span> <span class="token punctuation">[</span><span class="token number">03</span><span class="token operator">-</span><span class="token number">23</span><span class="token operator">|</span><span class="token number">16</span><span class="token operator">:</span><span class="token number">46</span><span class="token operator">:</span><span class="token number">39.764</span><span class="token punctuation">]</span> Initialised chain configuration          config<span class="token operator">=</span><span class="token string">"{ChainID: 15 Homestead: &lt;nil&gt; DAO: &lt;nil&gt; DAOSupport: false EIP150: &lt;nil&gt; EIP155: &lt;nil&gt; EIP158: &lt;nil&gt; Byzantium: &lt;nil&gt; Constantinople: &lt;nil&gt; Petersburg: &lt;nil&gt; Istanbul: &lt;nil&gt;, Muir Glacier: &lt;nil&gt;, Berlin: &lt;nil&gt;, YOLO v3: &lt;nil&gt;, Engine: unknown}"</span><span class="token constant">INFO</span> <span class="token punctuation">[</span><span class="token number">03</span><span class="token operator">-</span><span class="token number">23</span><span class="token operator">|</span><span class="token number">16</span><span class="token operator">:</span><span class="token number">46</span><span class="token operator">:</span><span class="token number">39.764</span><span class="token punctuation">]</span> Disk storage enabled <span class="token keyword">for</span> ethash caches   dir<span class="token operator">=</span><span class="token operator">/</span>home<span class="token operator">/</span>terence<span class="token operator">/</span>Desktop<span class="token operator">/</span>DataWhale<span class="token operator">/</span>OwnChain<span class="token operator">/</span>geth<span class="token operator">/</span>ethash count<span class="token operator">=</span><span class="token number">3</span><span class="token constant">INFO</span> <span class="token punctuation">[</span><span class="token number">03</span><span class="token operator">-</span><span class="token number">23</span><span class="token operator">|</span><span class="token number">16</span><span class="token operator">:</span><span class="token number">46</span><span class="token operator">:</span><span class="token number">39.764</span><span class="token punctuation">]</span> Disk storage enabled <span class="token keyword">for</span> ethash DAGs     dir<span class="token operator">=</span><span class="token operator">/</span>home<span class="token operator">/</span>terence<span class="token operator">/</span><span class="token punctuation">.</span>ethash count<span class="token operator">=</span><span class="token number">2</span><span class="token constant">INFO</span> <span class="token punctuation">[</span><span class="token number">03</span><span class="token operator">-</span><span class="token number">23</span><span class="token operator">|</span><span class="token number">16</span><span class="token operator">:</span><span class="token number">46</span><span class="token operator">:</span><span class="token number">39.764</span><span class="token punctuation">]</span> Initialising Ethereum protocol           network<span class="token operator">=</span><span class="token number">150</span> dbversion<span class="token operator">=</span><span class="token number">8</span><span class="token constant">INFO</span> <span class="token punctuation">[</span><span class="token number">03</span><span class="token operator">-</span><span class="token number">23</span><span class="token operator">|</span><span class="token number">16</span><span class="token operator">:</span><span class="token number">46</span><span class="token operator">:</span><span class="token number">39.766</span><span class="token punctuation">]</span> Loaded most recent local header          number<span class="token operator">=</span><span class="token number">122</span> hash<span class="token operator">=</span><span class="token string">"9198ca…30151e"</span> td<span class="token operator">=</span><span class="token number">16445520</span> age<span class="token operator">=</span><span class="token number">15</span>m19s<span class="token constant">INFO</span> <span class="token punctuation">[</span><span class="token number">03</span><span class="token operator">-</span><span class="token number">23</span><span class="token operator">|</span><span class="token number">16</span><span class="token operator">:</span><span class="token number">46</span><span class="token operator">:</span><span class="token number">39.766</span><span class="token punctuation">]</span> Loaded most recent local full block      number<span class="token operator">=</span><span class="token number">122</span> hash<span class="token operator">=</span><span class="token string">"9198ca…30151e"</span> td<span class="token operator">=</span><span class="token number">16445520</span> age<span class="token operator">=</span><span class="token number">15</span>m19s<span class="token constant">INFO</span> <span class="token punctuation">[</span><span class="token number">03</span><span class="token operator">-</span><span class="token number">23</span><span class="token operator">|</span><span class="token number">16</span><span class="token operator">:</span><span class="token number">46</span><span class="token operator">:</span><span class="token number">39.766</span><span class="token punctuation">]</span> Loaded most recent local fast block      number<span class="token operator">=</span><span class="token number">122</span> hash<span class="token operator">=</span><span class="token string">"9198ca…30151e"</span> td<span class="token operator">=</span><span class="token number">16445520</span> age<span class="token operator">=</span><span class="token number">15</span>m19s<span class="token constant">INFO</span> <span class="token punctuation">[</span><span class="token number">03</span><span class="token operator">-</span><span class="token number">23</span><span class="token operator">|</span><span class="token number">16</span><span class="token operator">:</span><span class="token number">46</span><span class="token operator">:</span><span class="token number">39.769</span><span class="token punctuation">]</span> Loaded local transaction journal         transactions<span class="token operator">=</span><span class="token number">0</span> dropped<span class="token operator">=</span><span class="token number">0</span><span class="token constant">INFO</span> <span class="token punctuation">[</span><span class="token number">03</span><span class="token operator">-</span><span class="token number">23</span><span class="token operator">|</span><span class="token number">16</span><span class="token operator">:</span><span class="token number">46</span><span class="token operator">:</span><span class="token number">39.769</span><span class="token punctuation">]</span> Regenerated local transaction journal    transactions<span class="token operator">=</span><span class="token number">0</span> accounts<span class="token operator">=</span><span class="token number">0</span><span class="token constant">WARN</span> <span class="token punctuation">[</span><span class="token number">03</span><span class="token operator">-</span><span class="token number">23</span><span class="token operator">|</span><span class="token number">16</span><span class="token operator">:</span><span class="token number">46</span><span class="token operator">:</span><span class="token number">39.769</span><span class="token punctuation">]</span> Switch sync mode <span class="token keyword">from</span> fast sync to full sync <span class="token constant">INFO</span> <span class="token punctuation">[</span><span class="token number">03</span><span class="token operator">-</span><span class="token number">23</span><span class="token operator">|</span><span class="token number">16</span><span class="token operator">:</span><span class="token number">46</span><span class="token operator">:</span><span class="token number">39.769</span><span class="token punctuation">]</span> Starting peer<span class="token operator">-</span>to<span class="token operator">-</span>peer node               instance<span class="token operator">=</span>Geth<span class="token operator">/</span>kexin<span class="token operator">/</span>v1<span class="token punctuation">.</span><span class="token number">10.1</span><span class="token operator">-</span>stable<span class="token operator">-</span>c2d2f4ed<span class="token operator">/</span>linux<span class="token operator">-</span>amd64<span class="token operator">/</span>go1<span class="token punctuation">.</span><span class="token number">16</span><span class="token constant">INFO</span> <span class="token punctuation">[</span><span class="token number">03</span><span class="token operator">-</span><span class="token number">23</span><span class="token operator">|</span><span class="token number">16</span><span class="token operator">:</span><span class="token number">46</span><span class="token operator">:</span><span class="token number">39.776</span><span class="token punctuation">]</span> <span class="token constant">IPC</span> endpoint opened                      url<span class="token operator">=</span><span class="token operator">/</span>home<span class="token operator">/</span>terence<span class="token operator">/</span>Desktop<span class="token operator">/</span>DataWhale<span class="token operator">/</span>OwnChain<span class="token operator">/</span>geth<span class="token punctuation">.</span>ipc<span class="token constant">ERROR</span><span class="token punctuation">[</span><span class="token number">03</span><span class="token operator">-</span><span class="token number">23</span><span class="token operator">|</span><span class="token number">16</span><span class="token operator">:</span><span class="token number">46</span><span class="token operator">:</span><span class="token number">39.776</span><span class="token punctuation">]</span> Unavailable modules <span class="token keyword">in</span> <span class="token constant">HTTP</span> <span class="token constant">API</span> list     unavailable<span class="token operator">=</span><span class="token punctuation">[</span>shh<span class="token punctuation">]</span> available<span class="token operator">=</span><span class="token string">"[admin debug web3 eth txpool personal ethash miner net]"</span><span class="token constant">INFO</span> <span class="token punctuation">[</span><span class="token number">03</span><span class="token operator">-</span><span class="token number">23</span><span class="token operator">|</span><span class="token number">16</span><span class="token operator">:</span><span class="token number">46</span><span class="token operator">:</span><span class="token number">39.777</span><span class="token punctuation">]</span> New local node record                    seq<span class="token operator">=</span><span class="token number">12</span> id<span class="token operator">=</span><span class="token number">0</span>b52cc632063309f ip<span class="token operator">=</span><span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span> udp<span class="token operator">=</span><span class="token number">0</span> tcp<span class="token operator">=</span><span class="token number">30303</span><span class="token constant">INFO</span> <span class="token punctuation">[</span><span class="token number">03</span><span class="token operator">-</span><span class="token number">23</span><span class="token operator">|</span><span class="token number">16</span><span class="token operator">:</span><span class="token number">46</span><span class="token operator">:</span><span class="token number">39.777</span><span class="token punctuation">]</span> Started <span class="token constant">P2P</span> networking                   self<span class="token operator">=</span><span class="token string">"enode://307b4d41cb9dd38790819d73df6e0139c8f1105ed8ac4c209ee64d2c15f99ee7b7ea38000ac7a4225900b33418e5adc4ae5009e0fb45e6ed0185f72c3725295f@127.0.0.1:30303?discport=0"</span><span class="token constant">INFO</span> <span class="token punctuation">[</span><span class="token number">03</span><span class="token operator">-</span><span class="token number">23</span><span class="token operator">|</span><span class="token number">16</span><span class="token operator">:</span><span class="token number">46</span><span class="token operator">:</span><span class="token number">39.777</span><span class="token punctuation">]</span> <span class="token constant">HTTP</span> server started                      endpoint<span class="token operator">=</span><span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span><span class="token operator">:</span><span class="token number">8545</span> prefix<span class="token operator">=</span> cors<span class="token operator">=</span> vhosts<span class="token operator">=</span>localhost<span class="token constant">INFO</span> <span class="token punctuation">[</span><span class="token number">03</span><span class="token operator">-</span><span class="token number">23</span><span class="token operator">|</span><span class="token number">16</span><span class="token operator">:</span><span class="token number">46</span><span class="token operator">:</span><span class="token number">39.814</span><span class="token punctuation">]</span> Etherbase automatically configured       address<span class="token operator">=</span><span class="token number">0x22A95a40762d9f0580A68e2A878661dd0fD62e78</span>Welcome to the Geth JavaScript console<span class="token operator">!</span>instance<span class="token operator">:</span> Geth<span class="token operator">/</span>kexin<span class="token operator">/</span>v1<span class="token punctuation">.</span><span class="token number">10.1</span><span class="token operator">-</span>stable<span class="token operator">-</span>c2d2f4ed<span class="token operator">/</span>linux<span class="token operator">-</span>amd64<span class="token operator">/</span>go1<span class="token punctuation">.</span><span class="token number">16</span>coinbase<span class="token operator">:</span> <span class="token number">0x22a95a40762d9f0580a68e2a878661dd0fd62e78</span>at block<span class="token operator">:</span> <span class="token number">122</span> <span class="token punctuation">(</span>Tue Mar <span class="token number">23</span> <span class="token number">2021</span> <span class="token number">16</span><span class="token operator">:</span><span class="token number">31</span><span class="token operator">:</span><span class="token number">20</span> <span class="token constant">GMT</span><span class="token operator">+</span><span class="token number">0800</span> <span class="token punctuation">(</span><span class="token constant">CST</span><span class="token punctuation">)</span><span class="token punctuation">)</span> datadir<span class="token operator">:</span> <span class="token operator">/</span>home<span class="token operator">/</span>terence<span class="token operator">/</span>Desktop<span class="token operator">/</span>DataWhale<span class="token operator">/</span>OwnChain modules<span class="token operator">:</span> admin<span class="token operator">:</span><span class="token number">1.0</span> debug<span class="token operator">:</span><span class="token number">1.0</span> eth<span class="token operator">:</span><span class="token number">1.0</span> ethash<span class="token operator">:</span><span class="token number">1.0</span> miner<span class="token operator">:</span><span class="token number">1.0</span> net<span class="token operator">:</span><span class="token number">1.0</span> personal<span class="token operator">:</span><span class="token number">1.0</span> rpc<span class="token operator">:</span><span class="token number">1.0</span> txpool<span class="token operator">:</span><span class="token number">1.0</span> web3<span class="token operator">:</span><span class="token number">1.0</span>To exit<span class="token punctuation">,</span> press ctrl<span class="token operator">-</span>d<span class="token operator">&gt;</span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="4-web3命令"><a href="#4-web3命令" class="headerlink" title="4.web3命令"></a>4.web3命令</h3><p>具体问题点</p><p>err=”the method eth_protocolVersion does not exist/is not available”</p><p>err=”the method shh_version does not exist/is not available”</p><pre class="line-numbers language-js" data-language="js"><code class="language-js">version<span class="token operator">:</span> <span class="token constant">WARN</span> <span class="token punctuation">[</span><span class="token number">03</span><span class="token operator">-</span><span class="token number">23</span><span class="token operator">|</span><span class="token number">16</span><span class="token operator">:</span><span class="token number">37</span><span class="token operator">:</span><span class="token number">42.155</span><span class="token punctuation">]</span> Served eth_protocolVersion               reqid<span class="token operator">=</span><span class="token number">70</span> t<span class="token operator">=</span><span class="token string">"4.89µs"</span>    err<span class="token operator">=</span><span class="token string">"the method eth_protocolVersion does not exist/is not available"</span><span class="token constant">WARN</span> <span class="token punctuation">[</span><span class="token number">03</span><span class="token operator">-</span><span class="token number">23</span><span class="token operator">|</span><span class="token number">16</span><span class="token operator">:</span><span class="token number">37</span><span class="token operator">:</span><span class="token number">42.156</span><span class="token punctuation">]</span> Served shh_version                       reqid<span class="token operator">=</span><span class="token number">71</span> t<span class="token operator">=</span><span class="token string">"5.39µs"</span>    err<span class="token operator">=</span><span class="token string">"the method shh_version does not exist/is not available"</span><span class="token punctuation">{</span>    api<span class="token operator">:</span> <span class="token string">"0.20.1"</span><span class="token punctuation">,</span><span class="token constant">WARN</span> <span class="token punctuation">[</span><span class="token number">03</span><span class="token operator">-</span><span class="token number">23</span><span class="token operator">|</span><span class="token number">16</span><span class="token operator">:</span><span class="token number">37</span><span class="token operator">:</span><span class="token number">42.156</span><span class="token punctuation">]</span> Served eth_protocolVersion               reqid<span class="token operator">=</span><span class="token number">72</span> t<span class="token operator">=</span><span class="token string">"8.99µs"</span>    err<span class="token operator">=</span><span class="token string">"the method eth_protocolVersion does not exist/is not available"</span>    ethereum<span class="token operator">:</span> <span class="token keyword">undefined</span><span class="token punctuation">,</span>    network<span class="token operator">:</span> <span class="token string">"150"</span><span class="token punctuation">,</span>    node<span class="token operator">:</span> <span class="token string">"Geth/v1.10.1-stable-c2d2f4ed/linux-amd64/go1.16"</span><span class="token punctuation">,</span><span class="token constant">WARN</span> <span class="token punctuation">[</span><span class="token number">03</span><span class="token operator">-</span><span class="token number">23</span><span class="token operator">|</span><span class="token number">16</span><span class="token operator">:</span><span class="token number">37</span><span class="token operator">:</span><span class="token number">42.156</span><span class="token punctuation">]</span> Served shh_version                       reqid<span class="token operator">=</span><span class="token number">75</span> t<span class="token operator">=</span><span class="token string">"4.98µs"</span>    err<span class="token operator">=</span><span class="token string">"the method shh_version does not exist/is not available"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>全部 <code>log</code></p><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token operator">&gt;</span> web3<span class="token punctuation">{</span>  admin<span class="token operator">:</span> <span class="token punctuation">{</span>    datadir<span class="token operator">:</span> <span class="token string">"/home/terence/Desktop/DataWhale/OwnChain"</span><span class="token punctuation">,</span>    nodeInfo<span class="token operator">:</span> <span class="token punctuation">{</span>      enode<span class="token operator">:</span> <span class="token string">"enode://307b4d41cb9dd38790819d73df6e0139c8f1105ed8ac4c209ee64d2c15f99ee7b7ea38000ac7a4225900b33418e5adc4ae5009e0fb45e6ed0185f72c3725295f@127.0.0.1:30303?discport=0"</span><span class="token punctuation">,</span>      enr<span class="token operator">:</span> <span class="token string">"enr:-Ja4QDfN_iDtbTHSEp0nV5UjevhkZUGt9JNde1RCpgX2geaIBMfLqpLdG4qvSVcfbtIIhk_2Z7a53Yy_NEbZy5dAspgLg2V0aMfGhIj58RaAgmlkgnY0gmlwhH8AAAGJc2VjcDI1NmsxoQMwe01By53Th5CBnXPfbgE5yPEQXtisTCCe5k0sFfme54RzbmFwwIN0Y3CCdl8"</span><span class="token punctuation">,</span>      id<span class="token operator">:</span> <span class="token string">"0b52cc632063309fde9524dfda2aaae2c551f47eaa4f66cd237c6948e524f6c6"</span><span class="token punctuation">,</span>      ip<span class="token operator">:</span> <span class="token string">"127.0.0.1"</span><span class="token punctuation">,</span>      listenAddr<span class="token operator">:</span> <span class="token string">"[::]:30303"</span><span class="token punctuation">,</span>      name<span class="token operator">:</span> <span class="token string">"Geth/v1.10.1-stable-c2d2f4ed/linux-amd64/go1.16"</span><span class="token punctuation">,</span>      ports<span class="token operator">:</span> <span class="token punctuation">{</span>        discovery<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>        listener<span class="token operator">:</span> <span class="token number">30303</span>      <span class="token punctuation">}</span><span class="token punctuation">,</span>      protocols<span class="token operator">:</span> <span class="token punctuation">{</span>        eth<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token operator">...</span><span class="token punctuation">}</span><span class="token punctuation">,</span>        snap<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>      <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">,</span>    peers<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>    <span class="token function-variable function">addPeer</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">addTrustedPeer</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">clearHistory</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">exportChain</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">getDatadir</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">callback</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">getNodeInfo</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">callback</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">getPeers</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">callback</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">importChain</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">removePeer</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">removeTrustedPeer</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">sleep</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">sleepBlocks</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">startRPC</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">startWS</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">stopRPC</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">stopWS</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token punctuation">}</span><span class="token punctuation">,</span>  bzz<span class="token operator">:</span> <span class="token constant">WARN</span> <span class="token punctuation">[</span><span class="token number">03</span><span class="token operator">-</span><span class="token number">23</span><span class="token operator">|</span><span class="token number">16</span><span class="token operator">:</span><span class="token number">37</span><span class="token operator">:</span><span class="token number">42.148</span><span class="token punctuation">]</span> Served bzz_hive                          reqid<span class="token operator">=</span><span class="token number">28</span> t<span class="token operator">=</span><span class="token string">"104.991µs"</span> err<span class="token operator">=</span><span class="token string">"the method bzz_hive does not exist/is not available"</span><span class="token constant">WARN</span> <span class="token punctuation">[</span><span class="token number">03</span><span class="token operator">-</span><span class="token number">23</span><span class="token operator">|</span><span class="token number">16</span><span class="token operator">:</span><span class="token number">37</span><span class="token operator">:</span><span class="token number">42.148</span><span class="token punctuation">]</span> Served bzz_info                          reqid<span class="token operator">=</span><span class="token number">29</span> t<span class="token operator">=</span><span class="token string">"5.4µs"</span>     err<span class="token operator">=</span><span class="token string">"the method bzz_info does not exist/is not available"</span><span class="token punctuation">{</span><span class="token constant">WARN</span> <span class="token punctuation">[</span><span class="token number">03</span><span class="token operator">-</span><span class="token number">23</span><span class="token operator">|</span><span class="token number">16</span><span class="token operator">:</span><span class="token number">37</span><span class="token operator">:</span><span class="token number">42.148</span><span class="token punctuation">]</span> Served bzz_hive                          reqid<span class="token operator">=</span><span class="token number">30</span> t<span class="token operator">=</span><span class="token string">"4.92µs"</span>    err<span class="token operator">=</span><span class="token string">"the method bzz_hive does not exist/is not available"</span>    hive<span class="token operator">:</span> <span class="token keyword">undefined</span><span class="token punctuation">,</span><span class="token constant">WARN</span> <span class="token punctuation">[</span><span class="token number">03</span><span class="token operator">-</span><span class="token number">23</span><span class="token operator">|</span><span class="token number">16</span><span class="token operator">:</span><span class="token number">37</span><span class="token operator">:</span><span class="token number">42.148</span><span class="token punctuation">]</span> Served bzz_info                          reqid<span class="token operator">=</span><span class="token number">31</span> t<span class="token operator">=</span><span class="token string">"4.18µs"</span>    err<span class="token operator">=</span><span class="token string">"the method bzz_info does not exist/is not available"</span>    info<span class="token operator">:</span> <span class="token keyword">undefined</span><span class="token punctuation">,</span>    <span class="token function-variable function">blockNetworkRead</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">download</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">get</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">getHive</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">callback</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">getInfo</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">callback</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">modify</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">put</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">retrieve</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">store</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">swapEnabled</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">syncEnabled</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">upload</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token punctuation">}</span><span class="token punctuation">,</span>  currentProvider<span class="token operator">:</span> <span class="token punctuation">{</span>    <span class="token function-variable function">send</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">sendAsync</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token punctuation">}</span><span class="token punctuation">,</span>  db<span class="token operator">:</span> <span class="token punctuation">{</span>    <span class="token function-variable function">getHex</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">getString</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">putHex</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">putString</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token punctuation">}</span><span class="token punctuation">,</span>  debug<span class="token operator">:</span> <span class="token punctuation">{</span>    <span class="token function-variable function">accountRange</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">backtraceAt</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">blockProfile</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">chaindbCompact</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">chaindbProperty</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">cpuProfile</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">dumpBlock</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">freeOSMemory</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">freezeClient</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">gcStats</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">getBadBlocks</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">getBlockRlp</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">getModifiedAccountsByHash</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">getModifiedAccountsByNumber</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">goTrace</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">memStats</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">mutexProfile</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">preimage</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">printBlock</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">seedHash</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">setBlockProfileRate</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">setGCPercent</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">setHead</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">setMutexProfileFraction</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">stacks</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">standardTraceBadBlockToFile</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">standardTraceBlockToFile</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">startCPUProfile</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">startGoTrace</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">stopCPUProfile</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">stopGoTrace</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">storageRangeAt</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">testSignCliqueBlock</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">traceBadBlock</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">traceBlock</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">traceBlockByHash</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">traceBlockByNumber</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">traceBlockFromFile</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">traceCall</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">traceTransaction</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">verbosity</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">vmodule</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">writeBlockProfile</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">writeMemProfile</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">writeMutexProfile</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token punctuation">}</span><span class="token punctuation">,</span>  eth<span class="token operator">:</span> <span class="token constant">WARN</span> <span class="token punctuation">[</span><span class="token number">03</span><span class="token operator">-</span><span class="token number">23</span><span class="token operator">|</span><span class="token number">16</span><span class="token operator">:</span><span class="token number">37</span><span class="token operator">:</span><span class="token number">42.150</span><span class="token punctuation">]</span> Served eth_protocolVersion               reqid<span class="token operator">=</span><span class="token number">39</span> t<span class="token operator">=</span><span class="token string">"6.45µs"</span>    err<span class="token operator">=</span><span class="token string">"the method eth_protocolVersion does not exist/is not available"</span><span class="token punctuation">{</span>    accounts<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"0x22a95a40762d9f0580a68e2a878661dd0fd62e78"</span><span class="token punctuation">,</span> <span class="token string">"0xf48509733ecc04fc874fbde1349eb1b260aeb6a1"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>    blockNumber<span class="token operator">:</span> <span class="token number">122</span><span class="token punctuation">,</span>    coinbase<span class="token operator">:</span> <span class="token string">"0x22a95a40762d9f0580a68e2a878661dd0fd62e78"</span><span class="token punctuation">,</span>    compile<span class="token operator">:</span> <span class="token punctuation">{</span>      <span class="token function-variable function">lll</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>      <span class="token function-variable function">serpent</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>      <span class="token function-variable function">solidity</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">}</span><span class="token punctuation">,</span>    defaultAccount<span class="token operator">:</span> <span class="token keyword">undefined</span><span class="token punctuation">,</span>    defaultBlock<span class="token operator">:</span> <span class="token string">"latest"</span><span class="token punctuation">,</span>    gasPrice<span class="token operator">:</span> <span class="token number">1000000000</span><span class="token punctuation">,</span>    hashrate<span class="token operator">:</span> <span class="token number">24</span><span class="token punctuation">,</span>    mining<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>    pendingTransactions<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token constant">WARN</span> <span class="token punctuation">[</span><span class="token number">03</span><span class="token operator">-</span><span class="token number">23</span><span class="token operator">|</span><span class="token number">16</span><span class="token operator">:</span><span class="token number">37</span><span class="token operator">:</span><span class="token number">42.151</span><span class="token punctuation">]</span> Served eth_protocolVersion               reqid<span class="token operator">=</span><span class="token number">48</span> t<span class="token operator">=</span><span class="token string">"6.9µs"</span>     err<span class="token operator">=</span><span class="token string">"the method eth_protocolVersion does not exist/is not available"</span>    protocolVersion<span class="token operator">:</span> <span class="token keyword">undefined</span><span class="token punctuation">,</span>    syncing<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>    <span class="token function-variable function">call</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">chainId</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">contract</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">abi</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">estimateGas</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">fillTransaction</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">filter</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">options<span class="token punctuation">,</span> callback<span class="token punctuation">,</span> filterCreationErrorCallback</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">getAccounts</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">callback</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">getBalance</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">getBlock</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">getBlockByHash</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">getBlockByNumber</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">getBlockNumber</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">callback</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">getBlockTransactionCount</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">getBlockUncleCount</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">getCode</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">getCoinbase</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">callback</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">getCompilers</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">getGasPrice</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">callback</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">getHashrate</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">callback</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">getHeaderByHash</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">getHeaderByNumber</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">getMining</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">callback</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">getPendingTransactions</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">callback</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">getProof</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">getProtocolVersion</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">callback</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">getRawTransaction</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">getRawTransactionFromBlock</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">getStorageAt</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">getSyncing</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">callback</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">getTransaction</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">getTransactionCount</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">getTransactionFromBlock</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">getTransactionReceipt</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">getUncle</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">getWork</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">iban</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">iban</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">icapNamereg</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">isSyncing</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">callback</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">namereg</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">resend</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">sendIBANTransaction</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">sendRawTransaction</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">sendTransaction</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">sign</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">signTransaction</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">submitTransaction</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">submitWork</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token punctuation">}</span><span class="token punctuation">,</span>  ethash<span class="token operator">:</span> <span class="token punctuation">{</span>    <span class="token function-variable function">getHashrate</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">getWork</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">submitHashRate</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">submitWork</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token punctuation">}</span><span class="token punctuation">,</span>  isIBAN<span class="token operator">:</span> <span class="token keyword">undefined</span><span class="token punctuation">,</span>  miner<span class="token operator">:</span> <span class="token punctuation">{</span>    <span class="token function-variable function">getHashrate</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">setEtherbase</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">setExtra</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">setGasPrice</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">setRecommitInterval</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">start</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">stop</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token punctuation">}</span><span class="token punctuation">,</span>  net<span class="token operator">:</span> <span class="token punctuation">{</span>    listening<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>    peerCount<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>    version<span class="token operator">:</span> <span class="token string">"150"</span><span class="token punctuation">,</span>    <span class="token function-variable function">getListening</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">callback</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">getPeerCount</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">callback</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">getVersion</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">callback</span><span class="token punctuation">)</span>  <span class="token punctuation">}</span><span class="token punctuation">,</span>  personal<span class="token operator">:</span> <span class="token punctuation">{</span>    listAccounts<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"0x22a95a40762d9f0580a68e2a878661dd0fd62e78"</span><span class="token punctuation">,</span> <span class="token string">"0xf48509733ecc04fc874fbde1349eb1b260aeb6a1"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>    listWallets<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>        accounts<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token operator">...</span><span class="token punctuation">]</span><span class="token punctuation">,</span>        status<span class="token operator">:</span> <span class="token string">"Locked"</span><span class="token punctuation">,</span>        url<span class="token operator">:</span> <span class="token string">"keystore:///home/terence/Desktop/DataWhale/OwnChain/keystore/UTC--2021-03-22T12-15-05.415042974Z--22a95a40762d9f0580a68e2a878661dd0fd62e78"</span>    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>        accounts<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token operator">...</span><span class="token punctuation">]</span><span class="token punctuation">,</span>        status<span class="token operator">:</span> <span class="token string">"Locked"</span><span class="token punctuation">,</span>        url<span class="token operator">:</span> <span class="token string">"keystore:///home/terence/Desktop/DataWhale/OwnChain/keystore/UTC--2021-03-22T12-16-13.964571341Z--f48509733ecc04fc874fbde1349eb1b260aeb6a1"</span>    <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>    <span class="token function-variable function">deriveAccount</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">ecRecover</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">getListAccounts</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">callback</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">getListWallets</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">callback</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">importRawKey</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">initializeWallet</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">lockAccount</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">newAccount</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">openWallet</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">sendTransaction</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">sign</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">signTransaction</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">unlockAccount</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">unpair</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token punctuation">}</span><span class="token punctuation">,</span>  providers<span class="token operator">:</span> <span class="token punctuation">{</span>    <span class="token function-variable function">HttpProvider</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">host<span class="token punctuation">,</span> timeout<span class="token punctuation">,</span> user<span class="token punctuation">,</span> password</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">IpcProvider</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">path<span class="token punctuation">,</span> net</span><span class="token punctuation">)</span>  <span class="token punctuation">}</span><span class="token punctuation">,</span>  rpc<span class="token operator">:</span> <span class="token punctuation">{</span>    modules<span class="token operator">:</span> <span class="token punctuation">{</span>      admin<span class="token operator">:</span> <span class="token string">"1.0"</span><span class="token punctuation">,</span>      debug<span class="token operator">:</span> <span class="token string">"1.0"</span><span class="token punctuation">,</span>      eth<span class="token operator">:</span> <span class="token string">"1.0"</span><span class="token punctuation">,</span>      ethash<span class="token operator">:</span> <span class="token string">"1.0"</span><span class="token punctuation">,</span>      miner<span class="token operator">:</span> <span class="token string">"1.0"</span><span class="token punctuation">,</span>      net<span class="token operator">:</span> <span class="token string">"1.0"</span><span class="token punctuation">,</span>      personal<span class="token operator">:</span> <span class="token string">"1.0"</span><span class="token punctuation">,</span>      rpc<span class="token operator">:</span> <span class="token string">"1.0"</span><span class="token punctuation">,</span>      txpool<span class="token operator">:</span> <span class="token string">"1.0"</span><span class="token punctuation">,</span>      web3<span class="token operator">:</span> <span class="token string">"1.0"</span>    <span class="token punctuation">}</span><span class="token punctuation">,</span>    <span class="token function-variable function">getModules</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">callback</span><span class="token punctuation">)</span>  <span class="token punctuation">}</span><span class="token punctuation">,</span>  settings<span class="token operator">:</span> <span class="token punctuation">{</span>    defaultAccount<span class="token operator">:</span> <span class="token keyword">undefined</span><span class="token punctuation">,</span>    defaultBlock<span class="token operator">:</span> <span class="token string">"latest"</span>  <span class="token punctuation">}</span><span class="token punctuation">,</span>  shh<span class="token operator">:</span> <span class="token punctuation">{</span>    <span class="token function-variable function">addPrivateKey</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">addSymKey</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">deleteKeyPair</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">deleteSymKey</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">generateSymKeyFromPassword</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">getPrivateKey</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">getPublicKey</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">getSymKey</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">hasKeyPair</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">hasSymKey</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">info</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">markTrustedPeer</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">newKeyPair</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">newMessageFilter</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">options<span class="token punctuation">,</span> callback<span class="token punctuation">,</span> filterCreationErrorCallback</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">newSymKey</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">post</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">setMaxMessageSize</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">setMinPoW</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">version</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token punctuation">}</span><span class="token punctuation">,</span>  txpool<span class="token operator">:</span> <span class="token punctuation">{</span>    content<span class="token operator">:</span> <span class="token punctuation">{</span>      pending<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>      queued<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">,</span>    inspect<span class="token operator">:</span> <span class="token punctuation">{</span>      pending<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>      queued<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>    <span class="token punctuation">}</span><span class="token punctuation">,</span>    status<span class="token operator">:</span> <span class="token punctuation">{</span>      pending<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>      queued<span class="token operator">:</span> <span class="token number">0</span>    <span class="token punctuation">}</span><span class="token punctuation">,</span>    <span class="token function-variable function">getContent</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">callback</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">getInspect</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">callback</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">getStatus</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">callback</span><span class="token punctuation">)</span>  <span class="token punctuation">}</span><span class="token punctuation">,</span>  version<span class="token operator">:</span> <span class="token constant">WARN</span> <span class="token punctuation">[</span><span class="token number">03</span><span class="token operator">-</span><span class="token number">23</span><span class="token operator">|</span><span class="token number">16</span><span class="token operator">:</span><span class="token number">37</span><span class="token operator">:</span><span class="token number">42.155</span><span class="token punctuation">]</span> Served eth_protocolVersion               reqid<span class="token operator">=</span><span class="token number">70</span> t<span class="token operator">=</span><span class="token string">"4.89µs"</span>    err<span class="token operator">=</span><span class="token string">"the method eth_protocolVersion does not exist/is not available"</span><span class="token constant">WARN</span> <span class="token punctuation">[</span><span class="token number">03</span><span class="token operator">-</span><span class="token number">23</span><span class="token operator">|</span><span class="token number">16</span><span class="token operator">:</span><span class="token number">37</span><span class="token operator">:</span><span class="token number">42.156</span><span class="token punctuation">]</span> Served shh_version                       reqid<span class="token operator">=</span><span class="token number">71</span> t<span class="token operator">=</span><span class="token string">"5.39µs"</span>    err<span class="token operator">=</span><span class="token string">"the method shh_version does not exist/is not available"</span><span class="token punctuation">{</span>    api<span class="token operator">:</span> <span class="token string">"0.20.1"</span><span class="token punctuation">,</span><span class="token constant">WARN</span> <span class="token punctuation">[</span><span class="token number">03</span><span class="token operator">-</span><span class="token number">23</span><span class="token operator">|</span><span class="token number">16</span><span class="token operator">:</span><span class="token number">37</span><span class="token operator">:</span><span class="token number">42.156</span><span class="token punctuation">]</span> Served eth_protocolVersion               reqid<span class="token operator">=</span><span class="token number">72</span> t<span class="token operator">=</span><span class="token string">"8.99µs"</span>    err<span class="token operator">=</span><span class="token string">"the method eth_protocolVersion does not exist/is not available"</span>    ethereum<span class="token operator">:</span> <span class="token keyword">undefined</span><span class="token punctuation">,</span>    network<span class="token operator">:</span> <span class="token string">"150"</span><span class="token punctuation">,</span>    node<span class="token operator">:</span> <span class="token string">"Geth/v1.10.1-stable-c2d2f4ed/linux-amd64/go1.16"</span><span class="token punctuation">,</span><span class="token constant">WARN</span> <span class="token punctuation">[</span><span class="token number">03</span><span class="token operator">-</span><span class="token number">23</span><span class="token operator">|</span><span class="token number">16</span><span class="token operator">:</span><span class="token number">37</span><span class="token operator">:</span><span class="token number">42.156</span><span class="token punctuation">]</span> Served shh_version                       reqid<span class="token operator">=</span><span class="token number">75</span> t<span class="token operator">=</span><span class="token string">"4.98µs"</span>    err<span class="token operator">=</span><span class="token string">"the method shh_version does not exist/is not available"</span>    whisper<span class="token operator">:</span> <span class="token keyword">undefined</span><span class="token punctuation">,</span>    <span class="token function-variable function">getEthereum</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">callback</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">getNetwork</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">callback</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">getNode</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">callback</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token function-variable function">getWhisper</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">callback</span><span class="token punctuation">)</span>  <span class="token punctuation">}</span><span class="token punctuation">,</span>  <span class="token function-variable function">BigNumber</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token function">a</span><span class="token punctuation">(</span><span class="token parameter">e<span class="token punctuation">,</span>n</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token function-variable function">createBatch</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token function-variable function">fromAscii</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">str</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token function-variable function">fromDecimal</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token function-variable function">fromICAP</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">icap</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token function-variable function">fromUtf8</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">str</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token function-variable function">fromWei</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">number<span class="token punctuation">,</span> unit</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token function-variable function">isAddress</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">address</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token function-variable function">isChecksumAddress</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">address</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token function-variable function">isConnected</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token function-variable function">padLeft</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">string<span class="token punctuation">,</span> chars<span class="token punctuation">,</span> sign</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token function-variable function">padRight</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">string<span class="token punctuation">,</span> chars<span class="token punctuation">,</span> sign</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token function-variable function">reset</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">keepIsSyncing</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token function-variable function">setProvider</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">provider</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token function-variable function">sha3</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">string<span class="token punctuation">,</span> options</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token function-variable function">toAscii</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">hex</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token function-variable function">toBigNumber</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">number</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token function-variable function">toChecksumAddress</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">address</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token function-variable function">toDecimal</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token function-variable function">toHex</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">val</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token function-variable function">toUtf8</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">hex</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token function-variable function">toWei</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">number<span class="token punctuation">,</span> unit</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">&gt;</span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      
        <tags>
            
            <tag> DataWhale </tag>
            
            <tag> Blockchain </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Task3 DeepFM</title>
      <link href="2021/03/21/task3-deepfm/"/>
      <url>2021/03/21/task3-deepfm/</url>
      
        <content type="html"><![CDATA[<h1 id="DeepFM"><a href="#DeepFM" class="headerlink" title="DeepFM"></a>DeepFM</h1><ul><li>该文主要记录<a href="https://github.com/datawhalechina/team-learning-rs/tree/master/DeepRecommendationModel"><code>深度推荐模型|DataWhale</code></a>Task3 DeepFM 内容</li></ul><p>与上次一次 Task 的 Wide&amp;Deep 的模型很相似，DeepFM 同样使用浅层模型和深层模型进行联合训练。不同点主要有以下两点：</p><ul><li>Wide 部分由 LR 替换为 FM，FM 具有自动学习交叉特征的能力，避免了原始 Wide&amp;Deep 模型在 Wide 端人工特征工程的工作</li><li>共享原始输入特征，DeepFM 模型的原始特征将作为 FM 和 Deep 模型部分的共同输入，保证模型特征的准确和一致。</li></ul><p><img src="http://ryluo.oss-cn-chengdu.aliyuncs.com/图片image-20210225180556628.png" alt="" style="zoom:80%;"></p><p>论文提出的贡献点：</p><ul><li>DeepFM 模型包含 FM 和 DNN 两部分，FM 模型可以抽取 low-order 特征，DNN 可以抽取 high-order 特征。无需 Wide&amp;Deep 模型人工特征工程。</li><li>由于输入仅为原始特征，而且 FM 和 DNN 共享输入向量特征，DeepFM 模型训练速度很快。</li><li>在 Benchmark 数据集和商业数据集上，DeepFM 效果超过目前所有模型。</li></ul><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> warningswarnings<span class="token punctuation">.</span>filterwarnings<span class="token punctuation">(</span><span class="token string">"ignore"</span><span class="token punctuation">)</span><span class="token keyword">import</span> itertools<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np<span class="token keyword">from</span> tqdm <span class="token keyword">import</span> tqdm<span class="token keyword">from</span> collections <span class="token keyword">import</span> namedtuple<span class="token keyword">import</span> tensorflow <span class="token keyword">as</span> tf<span class="token keyword">from</span> tensorflow <span class="token keyword">import</span> keras <span class="token keyword">from</span> tensorflow<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>layers <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> tensorflow<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>models <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>model_selection <span class="token keyword">import</span> train_test_split<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>preprocessing <span class="token keyword">import</span>  MinMaxScaler<span class="token punctuation">,</span> LabelEncoder<span class="token keyword">from</span> deepctr<span class="token punctuation">.</span>feature_column <span class="token keyword">import</span> SparseFeat<span class="token punctuation">,</span> DenseFeat<span class="token punctuation">,</span> VarLenSparseFeat<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 设置GPU显存使用，tensorflow不然会报错</span>gpus <span class="token operator">=</span> tf<span class="token punctuation">.</span>config<span class="token punctuation">.</span>experimental<span class="token punctuation">.</span>list_physical_devices<span class="token punctuation">(</span><span class="token string">'GPU'</span><span class="token punctuation">)</span><span class="token keyword">if</span> gpus<span class="token punctuation">:</span>    <span class="token keyword">try</span><span class="token punctuation">:</span>        <span class="token comment"># Currently, memory growth needs to be the same across GPUs</span>        <span class="token keyword">for</span> gpu <span class="token keyword">in</span> gpus<span class="token punctuation">:</span>            tf<span class="token punctuation">.</span>config<span class="token punctuation">.</span>experimental<span class="token punctuation">.</span>set_memory_growth<span class="token punctuation">(</span>gpu<span class="token punctuation">,</span> <span class="token boolean">True</span><span class="token punctuation">)</span>        logical_gpus <span class="token operator">=</span> tf<span class="token punctuation">.</span>config<span class="token punctuation">.</span>experimental<span class="token punctuation">.</span>list_logical_devices<span class="token punctuation">(</span><span class="token string">'GPU'</span><span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>gpus<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"Physical GPUs,"</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>logical_gpus<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"Logical GPUs"</span><span class="token punctuation">)</span>    <span class="token keyword">except</span> RuntimeError <span class="token keyword">as</span> e<span class="token punctuation">:</span>        <span class="token comment"># Memory growth must be set before GPUs have been initialized</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token number">1</span> Physical GPUs<span class="token punctuation">,</span> <span class="token number">1</span> Logical GPUs<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="1、Load-Dataset"><a href="#1、Load-Dataset" class="headerlink" title="1、Load Dataset"></a>1、Load Dataset</h2><pre class="line-numbers language-python" data-language="python"><code class="language-python">data <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">"../代码/data/criteo_sample.txt"</span><span class="token punctuation">)</span>columns <span class="token operator">=</span> data<span class="token punctuation">.</span>columns<span class="token punctuation">.</span>valuescolumns<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'label'</span><span class="token punctuation">,</span> <span class="token string">'I1'</span><span class="token punctuation">,</span> <span class="token string">'I2'</span><span class="token punctuation">,</span> <span class="token string">'I3'</span><span class="token punctuation">,</span> <span class="token string">'I4'</span><span class="token punctuation">,</span> <span class="token string">'I5'</span><span class="token punctuation">,</span> <span class="token string">'I6'</span><span class="token punctuation">,</span> <span class="token string">'I7'</span><span class="token punctuation">,</span> <span class="token string">'I8'</span><span class="token punctuation">,</span> <span class="token string">'I9'</span><span class="token punctuation">,</span>       <span class="token string">'I10'</span><span class="token punctuation">,</span> <span class="token string">'I11'</span><span class="token punctuation">,</span> <span class="token string">'I12'</span><span class="token punctuation">,</span> <span class="token string">'I13'</span><span class="token punctuation">,</span> <span class="token string">'C1'</span><span class="token punctuation">,</span> <span class="token string">'C2'</span><span class="token punctuation">,</span> <span class="token string">'C3'</span><span class="token punctuation">,</span> <span class="token string">'C4'</span><span class="token punctuation">,</span> <span class="token string">'C5'</span><span class="token punctuation">,</span> <span class="token string">'C6'</span><span class="token punctuation">,</span>       <span class="token string">'C7'</span><span class="token punctuation">,</span> <span class="token string">'C8'</span><span class="token punctuation">,</span> <span class="token string">'C9'</span><span class="token punctuation">,</span> <span class="token string">'C10'</span><span class="token punctuation">,</span> <span class="token string">'C11'</span><span class="token punctuation">,</span> <span class="token string">'C12'</span><span class="token punctuation">,</span> <span class="token string">'C13'</span><span class="token punctuation">,</span> <span class="token string">'C14'</span><span class="token punctuation">,</span> <span class="token string">'C15'</span><span class="token punctuation">,</span> <span class="token string">'C16'</span><span class="token punctuation">,</span>       <span class="token string">'C17'</span><span class="token punctuation">,</span> <span class="token string">'C18'</span><span class="token punctuation">,</span> <span class="token string">'C19'</span><span class="token punctuation">,</span> <span class="token string">'C20'</span><span class="token punctuation">,</span> <span class="token string">'C21'</span><span class="token punctuation">,</span> <span class="token string">'C22'</span><span class="token punctuation">,</span> <span class="token string">'C23'</span><span class="token punctuation">,</span> <span class="token string">'C24'</span><span class="token punctuation">,</span> <span class="token string">'C25'</span><span class="token punctuation">,</span>       <span class="token string">'C26'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span><span class="token builtin">object</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 划分 dense 和 sparse 特征</span>dense_features <span class="token operator">=</span> <span class="token punctuation">[</span>i <span class="token keyword">for</span> i <span class="token keyword">in</span> columns <span class="token keyword">if</span> <span class="token string">'I'</span> <span class="token keyword">in</span> i<span class="token punctuation">]</span>sparse_features <span class="token operator">=</span> <span class="token punctuation">[</span>i <span class="token keyword">for</span> i <span class="token keyword">in</span> columns <span class="token keyword">if</span> <span class="token string">'C'</span> <span class="token keyword">in</span> i<span class="token punctuation">]</span><span class="token keyword">print</span><span class="token punctuation">(</span>dense_features<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>sparse_features<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token punctuation">[</span><span class="token string">'I1'</span><span class="token punctuation">,</span> <span class="token string">'I2'</span><span class="token punctuation">,</span> <span class="token string">'I3'</span><span class="token punctuation">,</span> <span class="token string">'I4'</span><span class="token punctuation">,</span> <span class="token string">'I5'</span><span class="token punctuation">,</span> <span class="token string">'I6'</span><span class="token punctuation">,</span> <span class="token string">'I7'</span><span class="token punctuation">,</span> <span class="token string">'I8'</span><span class="token punctuation">,</span> <span class="token string">'I9'</span><span class="token punctuation">,</span> <span class="token string">'I10'</span><span class="token punctuation">,</span> <span class="token string">'I11'</span><span class="token punctuation">,</span> <span class="token string">'I12'</span><span class="token punctuation">,</span> <span class="token string">'I13'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'C1'</span><span class="token punctuation">,</span> <span class="token string">'C2'</span><span class="token punctuation">,</span> <span class="token string">'C3'</span><span class="token punctuation">,</span> <span class="token string">'C4'</span><span class="token punctuation">,</span> <span class="token string">'C5'</span><span class="token punctuation">,</span> <span class="token string">'C6'</span><span class="token punctuation">,</span> <span class="token string">'C7'</span><span class="token punctuation">,</span> <span class="token string">'C8'</span><span class="token punctuation">,</span> <span class="token string">'C9'</span><span class="token punctuation">,</span> <span class="token string">'C10'</span><span class="token punctuation">,</span> <span class="token string">'C11'</span><span class="token punctuation">,</span> <span class="token string">'C12'</span><span class="token punctuation">,</span> <span class="token string">'C13'</span><span class="token punctuation">,</span> <span class="token string">'C14'</span><span class="token punctuation">,</span> <span class="token string">'C15'</span><span class="token punctuation">,</span> <span class="token string">'C16'</span><span class="token punctuation">,</span> <span class="token string">'C17'</span><span class="token punctuation">,</span> <span class="token string">'C18'</span><span class="token punctuation">,</span> <span class="token string">'C19'</span><span class="token punctuation">,</span> <span class="token string">'C20'</span><span class="token punctuation">,</span> <span class="token string">'C21'</span><span class="token punctuation">,</span> <span class="token string">'C22'</span><span class="token punctuation">,</span> <span class="token string">'C23'</span><span class="token punctuation">,</span> <span class="token string">'C24'</span><span class="token punctuation">,</span> <span class="token string">'C25'</span><span class="token punctuation">,</span> <span class="token string">'C26'</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h2 id="2、Data-Process"><a href="#2、Data-Process" class="headerlink" title="2、Data Process"></a>2、Data Process</h2><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 简单处理特征，包括填充缺失值，数值处理，类别编码</span><span class="token keyword">def</span> <span class="token function">data_process</span><span class="token punctuation">(</span>data_df<span class="token punctuation">,</span> dense_features<span class="token punctuation">,</span> sparse_features<span class="token punctuation">)</span><span class="token punctuation">:</span>    data_df<span class="token punctuation">[</span>dense_features<span class="token punctuation">]</span> <span class="token operator">=</span> data_df<span class="token punctuation">[</span>dense_features<span class="token punctuation">]</span><span class="token punctuation">.</span>fillna<span class="token punctuation">(</span><span class="token number">0.0</span><span class="token punctuation">)</span>    <span class="token keyword">for</span> f <span class="token keyword">in</span> dense_features<span class="token punctuation">:</span>        data_df<span class="token punctuation">[</span>f<span class="token punctuation">]</span> <span class="token operator">=</span> data_df<span class="token punctuation">[</span>f<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> np<span class="token punctuation">.</span>log<span class="token punctuation">(</span>x<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">if</span> x <span class="token operator">&gt;</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token keyword">else</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>            data_df<span class="token punctuation">[</span>sparse_features<span class="token punctuation">]</span> <span class="token operator">=</span> data_df<span class="token punctuation">[</span>sparse_features<span class="token punctuation">]</span><span class="token punctuation">.</span>fillna<span class="token punctuation">(</span><span class="token string">"-1"</span><span class="token punctuation">)</span>    <span class="token keyword">for</span> f <span class="token keyword">in</span> sparse_features<span class="token punctuation">:</span>        lbe <span class="token operator">=</span> LabelEncoder<span class="token punctuation">(</span><span class="token punctuation">)</span>        data_df<span class="token punctuation">[</span>f<span class="token punctuation">]</span> <span class="token operator">=</span> lbe<span class="token punctuation">.</span>fit_transform<span class="token punctuation">(</span>data_df<span class="token punctuation">[</span>f<span class="token punctuation">]</span><span class="token punctuation">)</span>        <span class="token keyword">return</span> data_df<span class="token punctuation">[</span>dense_features <span class="token operator">+</span> sparse_features<span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 简单的数据预处理</span>train_data <span class="token operator">=</span> data_process<span class="token punctuation">(</span>data<span class="token punctuation">,</span> dense_features<span class="token punctuation">,</span> sparse_features<span class="token punctuation">)</span>train_data<span class="token punctuation">[</span><span class="token string">'label'</span><span class="token punctuation">]</span> <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token string">'label'</span><span class="token punctuation">]</span>train_data<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }    .dataframe tbody tr th {        vertical-align: top;    }    .dataframe thead th {        text-align: right;    }</style><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>I1</th>      <th>I2</th>      <th>I3</th>      <th>I4</th>      <th>I5</th>      <th>I6</th>      <th>I7</th>      <th>I8</th>      <th>I9</th>      <th>I10</th>      <th>...</th>      <th>C18</th>      <th>C19</th>      <th>C20</th>      <th>C21</th>      <th>C22</th>      <th>C23</th>      <th>C24</th>      <th>C25</th>      <th>C26</th>      <th>label</th>    </tr>  </thead>  <tbody>    <tr>      <th>0</th>      <td>0.0</td>      <td>1.386294</td>      <td>5.564520</td>      <td>0.000000</td>      <td>9.779567</td>      <td>0.000000</td>      <td>0.000000</td>      <td>3.526361</td>      <td>0.000000</td>      <td>0.0</td>      <td>...</td>      <td>66</td>      <td>0</td>      <td>0</td>      <td>3</td>      <td>0</td>      <td>1</td>      <td>96</td>      <td>0</td>      <td>0</td>      <td>0</td>    </tr>    <tr>      <th>1</th>      <td>0.0</td>      <td>-1.000000</td>      <td>2.995732</td>      <td>3.583519</td>      <td>10.317318</td>      <td>5.513429</td>      <td>0.693147</td>      <td>3.583519</td>      <td>5.081404</td>      <td>0.0</td>      <td>...</td>      <td>52</td>      <td>0</td>      <td>0</td>      <td>47</td>      <td>0</td>      <td>7</td>      <td>112</td>      <td>0</td>      <td>0</td>      <td>0</td>    </tr>    <tr>      <th>2</th>      <td>0.0</td>      <td>0.000000</td>      <td>1.098612</td>      <td>2.564949</td>      <td>7.607878</td>      <td>5.105945</td>      <td>1.945910</td>      <td>3.583519</td>      <td>6.261492</td>      <td>0.0</td>      <td>...</td>      <td>49</td>      <td>0</td>      <td>0</td>      <td>25</td>      <td>0</td>      <td>6</td>      <td>53</td>      <td>0</td>      <td>0</td>      <td>0</td>    </tr>    <tr>      <th>3</th>      <td>0.0</td>      <td>2.639057</td>      <td>0.693147</td>      <td>1.609438</td>      <td>9.731334</td>      <td>5.303305</td>      <td>1.791759</td>      <td>1.609438</td>      <td>3.401197</td>      <td>0.0</td>      <td>...</td>      <td>37</td>      <td>0</td>      <td>0</td>      <td>156</td>      <td>0</td>      <td>0</td>      <td>32</td>      <td>0</td>      <td>0</td>      <td>0</td>    </tr>    <tr>      <th>4</th>      <td>0.0</td>      <td>0.000000</td>      <td>4.653960</td>      <td>3.332205</td>      <td>7.596392</td>      <td>4.962845</td>      <td>1.609438</td>      <td>3.496508</td>      <td>3.637586</td>      <td>0.0</td>      <td>...</td>      <td>14</td>      <td>5</td>      <td>3</td>      <td>9</td>      <td>0</td>      <td>0</td>      <td>5</td>      <td>1</td>      <td>47</td>      <td>0</td>    </tr>  </tbody></table><p>5 rows × 40 columns</p></div><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 与 Wide&amp;Deep、DeepCrossing 处理方式一致，这里是分成 Linear 和 DNN 两部分</span>linear_feature_columns <span class="token operator">=</span> <span class="token punctuation">[</span>    SparseFeat<span class="token punctuation">(</span>feat<span class="token punctuation">,</span> vocabulary_size<span class="token operator">=</span>data<span class="token punctuation">[</span>feat<span class="token punctuation">]</span><span class="token punctuation">.</span>nunique<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>embedding_dim<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">)</span>    <span class="token keyword">for</span> i<span class="token punctuation">,</span>feat <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>sparse_features<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token punctuation">[</span>    DenseFeat<span class="token punctuation">(</span>feat<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">for</span> feat <span class="token keyword">in</span> dense_features<span class="token punctuation">]</span>linear_feature_columns<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token builtin">len</span><span class="token punctuation">(</span>linear_feature_columns<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token punctuation">(</span>SparseFeat<span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">'C1'</span><span class="token punctuation">,</span> vocabulary_size<span class="token operator">=</span><span class="token number">27</span><span class="token punctuation">,</span> embedding_dim<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span> use_hash<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span><span class="token string">'int32'</span><span class="token punctuation">,</span> embeddings_initializer<span class="token operator">=</span><span class="token operator">&lt;</span>tensorflow<span class="token punctuation">.</span>python<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>initializers<span class="token punctuation">.</span>initializers_v1<span class="token punctuation">.</span>RandomNormal <span class="token builtin">object</span> at <span class="token number">0x0000026A0E4F3C70</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> embedding_name<span class="token operator">=</span><span class="token string">'C1'</span><span class="token punctuation">,</span> group_name<span class="token operator">=</span><span class="token string">'default_group'</span><span class="token punctuation">,</span> trainable<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">39</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">dnn_feature_columns <span class="token operator">=</span> <span class="token punctuation">[</span>    SparseFeat<span class="token punctuation">(</span>feat<span class="token punctuation">,</span> vocabulary_size<span class="token operator">=</span>data<span class="token punctuation">[</span>feat<span class="token punctuation">]</span><span class="token punctuation">.</span>nunique<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>embedding_dim<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">)</span>    <span class="token keyword">for</span> i<span class="token punctuation">,</span>feat <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>sparse_features<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token punctuation">[</span>    DenseFeat<span class="token punctuation">(</span>feat<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">for</span> feat <span class="token keyword">in</span> dense_features<span class="token punctuation">]</span>dnn_feature_columns<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token builtin">len</span><span class="token punctuation">(</span>dnn_feature_columns<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token punctuation">(</span>SparseFeat<span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">'C1'</span><span class="token punctuation">,</span> vocabulary_size<span class="token operator">=</span><span class="token number">27</span><span class="token punctuation">,</span> embedding_dim<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span> use_hash<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span><span class="token string">'int32'</span><span class="token punctuation">,</span> embeddings_initializer<span class="token operator">=</span><span class="token operator">&lt;</span>tensorflow<span class="token punctuation">.</span>python<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>initializers<span class="token punctuation">.</span>initializers_v1<span class="token punctuation">.</span>RandomNormal <span class="token builtin">object</span> at <span class="token number">0x0000026A0E4F7D90</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> embedding_name<span class="token operator">=</span><span class="token string">'C1'</span><span class="token punctuation">,</span> group_name<span class="token operator">=</span><span class="token string">'default_group'</span><span class="token punctuation">,</span> trainable<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">39</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h2 id="3、模型原理"><a href="#3、模型原理" class="headerlink" title="3、模型原理"></a>3、模型原理</h2><h3 id="FM"><a href="#FM" class="headerlink" title="FM"></a><a href="http://www.cs.cmu.edu/~wcohen/10-605/2015-guest-lecture/FM.pdf">FM</a></h3><p>在 FM 模型之前，CTR 预估最常用的模型是 SVM 和 LR，包括用 GBDT 给它们提取非线性特征。SVM 和 LR 都是线性的模型，SVM 理论上可以引入核函数从而引入非线性，但是由于非常高维的稀疏特征向量使得它很容易过拟合，因此实际很少用，但是实际的这些特征是有相关性的。比如根据这次的学习论文<a href="http://www.ijcai.org/proceedings/2017/0239.pdf">DeepFM: A Factorization-Machine based Neural Network for CTR Prediction</a>的调研，在主流的app应用市场里，在吃饭的时间点食谱类app的下载量明显会比平时更大，因此app的类别和时间会存在二阶的关系。另外一个例子是年轻男性更喜欢射击类游戏，这是年龄、性别和游戏类别的三阶关系。因此怎么建模二阶、三阶甚至更高阶的非线性的关系是预估能够更加准确的关键点。</p><p>下文参考了<a href="https://tech.meituan.com/2016/03/03/deep-understanding-of-ffm-principles-and-practices.html">深入FFM原理与实践</a>。</p><p>直接建模二阶关系：</p><script type="math/tex; mode=display">y(\mathbf{x})=w_{0}+\sum_{i=1}^{n} w_{i} x_{i}+\sum_{i=1}^{n} \sum_{j=i+1}^{n} w_{i j} x_{i} x_{j}</script><p>其中，n 是特征向量的维度，$x_{i}$是第i维特征，$w_{0}$、$w_{i}$、$w_{ij}$是模型参数。这种方法存在一个问题，参数个数较多为$\frac{n(n-1)}{2}$，另外由于样本数据本身就较为稀疏，想要找到$x_{i}$和$x_{j}$都非零的样本更少。训练样本的不足，很容易导致参数$w_{ij}$不准确，影响最终模型的性能。</p><p>如何解决二次项参数的训练问题？矩阵分解提供了一种解决思路。根据<a href="http://www.cs.cmu.edu/~wcohen/10-605/2015-guest-lecture/FM.pdf">《Factorization Machines的一个talk》</a>在 model-based 的协同过滤中，一个 rating 矩阵可以分解为 user 矩阵和 item 矩阵，每个 user 和 item 都可以采用一个隐向量表示。比如在下图中的例子中，我们把每个 user 表示成一个二维向量，同时把每个 item 表示成一个二维向量，两个向量的点积就是矩阵中 user 对 item 的打分。</p><p><img src="/2021/03/21/task3-deepfm/matrix-decompose.png" alt=""></p><p><img src="/2021/03/21/task3-deepfm/pic1.png" alt=""></p><p>（公式显示问题，暂用图片</p><h2 id="4、DeepFM-model-build"><a href="#4、DeepFM-model-build" class="headerlink" title="4、DeepFM model build"></a>4、DeepFM model build</h2><h3 id="FM-1"><a href="#FM-1" class="headerlink" title="FM"></a>FM</h3><p>下图是 FM 的一个结构图，从图中大致可以看出 FM Layer 是由一阶特征和二阶特征 Concatenate 到一起在经过一个 Sigmoid 得到 logits（结合FM的公式一起看），所以在实现的时候需要单独考虑 linear 部分和 FM 交叉特征部分。</p><p><img src="http://ryluo.oss-cn-chengdu.aliyuncs.com/图片image-20210225181340313.png" alt="" style="zoom: 90%;"></p><p>代码实现中也是分成了两部分：</p><ul><li>一阶特征：Linear</li><li>二阶特征：FM</li></ul><h3 id="Deep"><a href="#Deep" class="headerlink" title="Deep"></a>Deep</h3><p>Deep架构图</p><p><img src="http://ryluo.oss-cn-chengdu.aliyuncs.com/图片image-20210225181010107.png" alt="" style="zoom:70%;"></p><p>Deep Module 是为了学习高阶的特征组合，在上图中使用用全连接的方式将 Dense Embedding 输入到Hidden Layer ，这里面 Dense Embeddings 就是为了解决 DNN 中的参数爆炸问题，这也是推荐模型中常用的处理方法。</p><h3 id="4-1-Input-Layers"><a href="#4-1-Input-Layers" class="headerlink" title="4.1 Input Layers"></a>4.1 Input Layers</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">build_input_layers</span><span class="token punctuation">(</span>feature_columns<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token comment"># 构建Input层字典，并以dense和sparse两类字典的形式返回</span>    dense_input_dict<span class="token punctuation">,</span> sparse_input_dict <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>    <span class="token keyword">for</span> fc <span class="token keyword">in</span> feature_columns<span class="token punctuation">:</span>        <span class="token keyword">if</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>fc<span class="token punctuation">,</span> SparseFeat<span class="token punctuation">)</span><span class="token punctuation">:</span>            sparse_input_dict<span class="token punctuation">[</span>fc<span class="token punctuation">.</span>name<span class="token punctuation">]</span> <span class="token operator">=</span> Input<span class="token punctuation">(</span>shape<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token punctuation">)</span><span class="token punctuation">,</span> name<span class="token operator">=</span>fc<span class="token punctuation">.</span>name<span class="token punctuation">)</span>        <span class="token keyword">elif</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>fc<span class="token punctuation">,</span> DenseFeat<span class="token punctuation">)</span><span class="token punctuation">:</span>            dense_input_dict<span class="token punctuation">[</span>fc<span class="token punctuation">.</span>name<span class="token punctuation">]</span> <span class="token operator">=</span> Input<span class="token punctuation">(</span>shape<span class="token operator">=</span><span class="token punctuation">(</span>fc<span class="token punctuation">.</span>dimension<span class="token punctuation">,</span> <span class="token punctuation">)</span><span class="token punctuation">,</span> name<span class="token operator">=</span>fc<span class="token punctuation">.</span>name<span class="token punctuation">)</span>            <span class="token keyword">return</span> dense_input_dict<span class="token punctuation">,</span> sparse_input_dict<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 同样使用字典输入方式,方便后续构建模型</span><span class="token comment"># 这里传入数据是一样的，实际情况可以根据具体场景进行选择，这点不要混淆</span>dense_input_dict<span class="token punctuation">,</span> sparse_input_dict <span class="token operator">=</span> build_input_layers<span class="token punctuation">(</span>linear_feature_columns <span class="token operator">+</span> dnn_feature_columns<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>dense_input_dict<span class="token punctuation">[</span><span class="token string">"I1"</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token builtin">len</span><span class="token punctuation">(</span>dense_input_dict<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token builtin">type</span><span class="token punctuation">(</span>dense_input_dict<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>sparse_input_dict<span class="token punctuation">[</span><span class="token string">"C1"</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token builtin">len</span><span class="token punctuation">(</span>sparse_input_dict<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token builtin">type</span><span class="token punctuation">(</span>sparse_input_dict<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">KerasTensor<span class="token punctuation">(</span>type_spec<span class="token operator">=</span>TensorSpec<span class="token punctuation">(</span>shape<span class="token operator">=</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span>tf<span class="token punctuation">.</span>float32<span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">'I1'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">'I1'</span><span class="token punctuation">,</span> description<span class="token operator">=</span><span class="token string">"created by layer 'I1'"</span><span class="token punctuation">)</span> <span class="token number">13</span> <span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token string">'dict'</span><span class="token operator">&gt;</span>KerasTensor<span class="token punctuation">(</span>type_spec<span class="token operator">=</span>TensorSpec<span class="token punctuation">(</span>shape<span class="token operator">=</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span>tf<span class="token punctuation">.</span>float32<span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">'C1'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">'C1'</span><span class="token punctuation">,</span> description<span class="token operator">=</span><span class="token string">"created by layer 'C1'"</span><span class="token punctuation">)</span> <span class="token number">26</span> <span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token string">'dict'</span><span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 构建模型的输入层，模型的输入层不能是字典的形式，应该将字典的形式转换成列表的形式</span><span class="token comment"># 注意：这里实际的输入与Input()层的对应，是通过模型输入时候的字典数据的key与对应name的Input层</span>input_layers <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>dense_input_dict<span class="token punctuation">.</span>values<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token builtin">list</span><span class="token punctuation">(</span>sparse_input_dict<span class="token punctuation">.</span>values<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>input_layers<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token builtin">len</span><span class="token punctuation">(</span>input_layers<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token builtin">type</span><span class="token punctuation">(</span>input_layers<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token punctuation">(</span><span class="token operator">&lt;</span>KerasTensor<span class="token punctuation">:</span> shape<span class="token operator">=</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> dtype<span class="token operator">=</span>float32 <span class="token punctuation">(</span>created by layer <span class="token string">'I1'</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> <span class="token number">39</span><span class="token punctuation">,</span> <span class="token builtin">list</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 示例代码给了 input_layers_dict 参数不过并没有被使用</span><span class="token keyword">def</span> <span class="token function">build_embedding_layers</span><span class="token punctuation">(</span>feature_columns<span class="token punctuation">,</span> input_layers_dict<span class="token punctuation">,</span> is_linear<span class="token punctuation">)</span><span class="token punctuation">:</span>        embedding_layers_dict <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token punctuation">)</span>        sparse_feature_columns <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">filter</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> SparseFeat<span class="token punctuation">)</span><span class="token punctuation">,</span> feature_columns<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">if</span> feature_columns <span class="token keyword">else</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>        <span class="token keyword">if</span> is_linear<span class="token punctuation">:</span>        <span class="token keyword">for</span> fc <span class="token keyword">in</span> sparse_feature_columns<span class="token punctuation">:</span>            embedding_layers_dict<span class="token punctuation">[</span>fc<span class="token punctuation">.</span>name<span class="token punctuation">]</span> <span class="token operator">=</span> Embedding<span class="token punctuation">(</span>fc<span class="token punctuation">.</span>vocabulary_size<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">"1d_emb_"</span><span class="token operator">+</span>fc<span class="token punctuation">.</span>name<span class="token punctuation">)</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token keyword">for</span> fc <span class="token keyword">in</span> sparse_feature_columns<span class="token punctuation">:</span>            embedding_layers_dict<span class="token punctuation">[</span>fc<span class="token punctuation">.</span>name<span class="token punctuation">]</span> <span class="token operator">=</span> Embedding<span class="token punctuation">(</span>fc<span class="token punctuation">.</span>vocabulary_size<span class="token punctuation">,</span> fc<span class="token punctuation">.</span>embedding_dim<span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">"kd_emb_"</span><span class="token operator">+</span>fc<span class="token punctuation">.</span>name<span class="token punctuation">)</span>    <span class="token keyword">return</span> embedding_layers_dict    <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="4-2-Linear-amp-Dnn-sparse-feature"><a href="#4-2-Linear-amp-Dnn-sparse-feature" class="headerlink" title="4.2 Linear&amp;Dnn sparse feature"></a>4.2 Linear&amp;Dnn sparse feature</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 将linear部分的特征中sparse特征筛选出来，后面用来做1维的embedding</span>linear_sparse_feature_columns <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">filter</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> SparseFeat<span class="token punctuation">)</span><span class="token punctuation">,</span> linear_feature_columns<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># 将输入到dnn中的所有sparse特征筛选出来</span>dnn_sparse_feature_columns <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">filter</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> SparseFeat<span class="token punctuation">)</span><span class="token punctuation">,</span> dnn_feature_columns<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>linear_sparse_feature_columns<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token builtin">len</span><span class="token punctuation">(</span>linear_sparse_feature_columns<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>dnn_sparse_feature_columns<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token builtin">len</span><span class="token punctuation">(</span>dnn_sparse_feature_columns<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">SparseFeat<span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">'C1'</span><span class="token punctuation">,</span> vocabulary_size<span class="token operator">=</span><span class="token number">27</span><span class="token punctuation">,</span> embedding_dim<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span> use_hash<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span><span class="token string">'int32'</span><span class="token punctuation">,</span> embeddings_initializer<span class="token operator">=</span><span class="token operator">&lt;</span>tensorflow<span class="token punctuation">.</span>python<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>initializers<span class="token punctuation">.</span>initializers_v1<span class="token punctuation">.</span>RandomNormal <span class="token builtin">object</span> at <span class="token number">0x0000026A0E4F3C70</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> embedding_name<span class="token operator">=</span><span class="token string">'C1'</span><span class="token punctuation">,</span> group_name<span class="token operator">=</span><span class="token string">'default_group'</span><span class="token punctuation">,</span> trainable<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span> <span class="token number">26</span>SparseFeat<span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">'C1'</span><span class="token punctuation">,</span> vocabulary_size<span class="token operator">=</span><span class="token number">27</span><span class="token punctuation">,</span> embedding_dim<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span> use_hash<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span><span class="token string">'int32'</span><span class="token punctuation">,</span> embeddings_initializer<span class="token operator">=</span><span class="token operator">&lt;</span>tensorflow<span class="token punctuation">.</span>python<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>initializers<span class="token punctuation">.</span>initializers_v1<span class="token punctuation">.</span>RandomNormal <span class="token builtin">object</span> at <span class="token number">0x0000026A0E4F7D90</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> embedding_name<span class="token operator">=</span><span class="token string">'C1'</span><span class="token punctuation">,</span> group_name<span class="token operator">=</span><span class="token string">'default_group'</span><span class="token punctuation">,</span> trainable<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span> <span class="token number">26</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h3 id="4-3-Linear-Logits"><a href="#4-3-Linear-Logits" class="headerlink" title="4.3 Linear Logits"></a>4.3 Linear Logits</h3><ul><li>linear_logits:  这部分是有关于线性计算，也就是FM的前半部分$w1x1+w2x2…wnxn+b$的计算。对于这一块的计算，我们用了一个 get_linear_logits 函数实现，后面再说，总之通过这个函数，我们就可以实现上面这个公式的计算过程，得到 linear 的输出， 这部分特征由数值特征和类别特征的 onehot 编码组成的一维向量组成，实际应用中根据自己的业务放置不同的一阶特征(这里的 dense 特征并不是必须的，有可能会将数值特征进行分桶，然后在当做类别特征来处理)</li></ul><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">get_linear_logits</span><span class="token punctuation">(</span>dense_input_dict<span class="token punctuation">,</span>sparse_input_dict<span class="token punctuation">,</span>sparse_feature_columns<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token comment"># dense 特征处理</span>    concat_dense_inputs <span class="token operator">=</span> Concatenate<span class="token punctuation">(</span>axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">(</span>dense_input_dict<span class="token punctuation">.</span>values<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    dense_logits_output <span class="token operator">=</span> Dense<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">(</span>concat_dense_inputs<span class="token punctuation">)</span>        <span class="token comment"># sparse 特征处理   </span>    linear_embedding_layers <span class="token operator">=</span> build_embedding_layers<span class="token punctuation">(</span>sparse_feature_columns<span class="token punctuation">,</span> sparse_input_dict<span class="token punctuation">,</span> is_linear<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>    <span class="token comment"># 将一维的 embedding 进行拼接</span>    sparse_1d_embed <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> fc <span class="token keyword">in</span> sparse_feature_columns<span class="token punctuation">:</span>        feat_input <span class="token operator">=</span> sparse_input_dict<span class="token punctuation">[</span>fc<span class="token punctuation">.</span>name<span class="token punctuation">]</span>        embed <span class="token operator">=</span> Flatten<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span>linear_embedding_layers<span class="token punctuation">[</span>fc<span class="token punctuation">.</span>name<span class="token punctuation">]</span><span class="token punctuation">(</span>feat_input<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># B(batch)*1</span>        sparse_1d_embed<span class="token punctuation">.</span>append<span class="token punctuation">(</span>embed<span class="token punctuation">)</span>    sparse_logits_output <span class="token operator">=</span> Add<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span>sparse_1d_embed<span class="token punctuation">)</span>        <span class="token comment"># dense + sparse</span>    linear_logits <span class="token operator">=</span> Add<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">[</span>dense_logits_output<span class="token punctuation">,</span> sparse_logits_output<span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> linear_logits<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">linear_logits <span class="token operator">=</span> get_linear_logits<span class="token punctuation">(</span>dense_input_dict<span class="token punctuation">,</span>sparse_input_dict<span class="token punctuation">,</span>linear_sparse_feature_columns<span class="token punctuation">)</span>linear_logits<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token operator">&lt;</span>KerasTensor<span class="token punctuation">:</span> shape<span class="token operator">=</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> dtype<span class="token operator">=</span>float32 <span class="token punctuation">(</span>created by layer <span class="token string">'add_5'</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="4-4-FM-Logits"><a href="#4-4-FM-Logits" class="headerlink" title="4.4 FM Logits"></a>4.4 FM Logits</h3><ul><li>fm_logits:  这一块主要是针对离散的特征，首先过 embedding，然后使用 FM 特征交叉的方式，两两特征进行交叉，得到新的特征向量，最后计算交叉特征的 logits</li></ul><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 构建维度为k的embedding层，这里使用字典的形式返回，方便后面搭建模型</span><span class="token comment"># embedding层用户构建FM交叉部分和DNN的输入部分</span>embedding_layers <span class="token operator">=</span> build_embedding_layers<span class="token punctuation">(</span>dnn_feature_columns<span class="token punctuation">,</span> sparse_input_dict<span class="token punctuation">,</span> is_linear<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>embedding_layers<span class="token punctuation">[</span><span class="token string">"C1"</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token builtin">len</span><span class="token punctuation">(</span>embedding_layers<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token punctuation">(</span><span class="token operator">&lt;</span>tensorflow<span class="token punctuation">.</span>python<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>layers<span class="token punctuation">.</span>embeddings<span class="token punctuation">.</span>Embedding at <span class="token number">0x26a0e599790</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> <span class="token number">26</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>因为只考虑了二阶项，这部分直接使用公式推导的结论，并没有带上一阶项：</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">FM_Layer</span><span class="token punctuation">(</span>Layer<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token builtin">super</span><span class="token punctuation">(</span>FM_Layer<span class="token punctuation">,</span> self<span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token keyword">def</span> <span class="token function">call</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> inputs<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token comment"># 优化后的公式为： 0.5 * 求和（和的平方-平方的和）  =&gt;&gt; B x 1</span>        concated_embeds_value <span class="token operator">=</span> inputs                square_of_sum <span class="token operator">=</span> tf<span class="token punctuation">.</span>square<span class="token punctuation">(</span>tf<span class="token punctuation">.</span>reduce_sum<span class="token punctuation">(</span>concated_embeds_value<span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> keepdims<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># B x 1 x k</span>        sum_of_square <span class="token operator">=</span> tf<span class="token punctuation">.</span>reduce_sum<span class="token punctuation">(</span>concated_embeds_value <span class="token operator">*</span> concated_embeds_value<span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> keepdims<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token comment"># B x 1 x k</span>        cross_term <span class="token operator">=</span> square_of_sum <span class="token operator">-</span> sum_of_square <span class="token comment"># B x 1 x k</span>        cross_term <span class="token operator">=</span> <span class="token number">0.5</span><span class="token operator">*</span>tf<span class="token punctuation">.</span>reduce_sum<span class="token punctuation">(</span>cross_term<span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> keepdims<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span> <span class="token comment"># B x 1</span>                <span class="token keyword">return</span> cross_term        <span class="token keyword">def</span> <span class="token function">compute_output_shape</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> input_shape<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>        <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">get_fm_logits</span><span class="token punctuation">(</span>sparse_input_dict<span class="token punctuation">,</span> sparse_feature_columns<span class="token punctuation">,</span> dnn_embedding_layers<span class="token punctuation">)</span><span class="token punctuation">:</span>        sparse_feature_columns <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">filter</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> SparseFeat<span class="token punctuation">)</span><span class="token punctuation">,</span>sparse_feature_columns<span class="token punctuation">)</span><span class="token punctuation">)</span>        sparse_kd_embed <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> fc <span class="token keyword">in</span> sparse_feature_columns<span class="token punctuation">:</span>        feat_input <span class="token operator">=</span> sparse_input_dict<span class="token punctuation">[</span>fc<span class="token punctuation">.</span>name<span class="token punctuation">]</span>        <span class="token comment"># KerasTensor(type_spec=TensorSpec(shape=(None, 1, 4), dtype=tf.float32, name=None), </span>        <span class="token comment"># name='kd_emb_C1/embedding_lookup/Identity_1:0', description="created by layer 'kd_emb_C1'")</span>        _embed <span class="token operator">=</span> dnn_embedding_layers<span class="token punctuation">[</span>fc<span class="token punctuation">.</span>name<span class="token punctuation">]</span><span class="token punctuation">(</span>feat_input<span class="token punctuation">)</span><span class="token comment"># B x 1 x k</span>        sparse_kd_embed<span class="token punctuation">.</span>append<span class="token punctuation">(</span>_embed<span class="token punctuation">)</span>            <span class="token comment"># 将所有sparse的embedding拼接起来，得到 (n, k)的矩阵，其中n为特征数，k为embedding大小</span>    concat_sparse_kd_embed <span class="token operator">=</span> Concatenate<span class="token punctuation">(</span>axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">(</span>sparse_kd_embed<span class="token punctuation">)</span> <span class="token comment"># B x n x k</span>    fm_cross_out <span class="token operator">=</span> FM_Layer<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span>concat_sparse_kd_embed<span class="token punctuation">)</span>        <span class="token keyword">return</span> fm_cross_out        <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 和 linear_logits 不同的是，fm_logits 只需要处理 spare 类型</span>fm_logits <span class="token operator">=</span> get_fm_logits<span class="token punctuation">(</span>sparse_input_dict<span class="token punctuation">,</span> dnn_sparse_feature_columns<span class="token punctuation">,</span> embedding_layers<span class="token punctuation">)</span> <span class="token comment"># 只考虑二阶项</span>fm_logits<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token operator">&lt;</span>KerasTensor<span class="token punctuation">:</span> shape<span class="token operator">=</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> dtype<span class="token operator">=</span>float32 <span class="token punctuation">(</span>created by layer <span class="token string">'fm__layer_2'</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="4-5-DNN-Logits"><a href="#4-5-DNN-Logits" class="headerlink" title="4.5 DNN Logits"></a>4.5 DNN Logits</h3><ul><li>dnn_logits:   这一块主要是针对离散的特征，首先过 embedding，然后将得到的 embedding 拼接成一个向量(具体的可以看代码，也可以看一下下面的模型结构图)，通过 dnn 学习类别特征之间的隐式特征交叉并输出 logits 值 </li></ul><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">get_dnn_logits</span><span class="token punctuation">(</span>sparse_input_dict<span class="token punctuation">,</span> sparse_feature_columns<span class="token punctuation">,</span> dnn_embedding_layers<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token comment"># 将特征中的sparse特征筛选出来</span>    sparse_feature_columns <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">filter</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> SparseFeat<span class="token punctuation">)</span><span class="token punctuation">,</span> sparse_feature_columns<span class="token punctuation">)</span><span class="token punctuation">)</span>        sparse_kd_embed <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> fc <span class="token keyword">in</span> sparse_feature_columns<span class="token punctuation">:</span>        feat_input <span class="token operator">=</span> sparse_input_dict<span class="token punctuation">[</span>fc<span class="token punctuation">.</span>name<span class="token punctuation">]</span>        _embed <span class="token operator">=</span> dnn_embedding_layers<span class="token punctuation">[</span>fc<span class="token punctuation">.</span>name<span class="token punctuation">]</span><span class="token punctuation">(</span>feat_input<span class="token punctuation">)</span>        _embed <span class="token operator">=</span> Flatten<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span>_embed<span class="token punctuation">)</span>        sparse_kd_embed<span class="token punctuation">.</span>append<span class="token punctuation">(</span>_embed<span class="token punctuation">)</span>            concat_sparse_kd_embed <span class="token operator">=</span> Concatenate<span class="token punctuation">(</span>axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">(</span>sparse_kd_embed<span class="token punctuation">)</span>        mlp_out <span class="token operator">=</span> Dropout<span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">(</span>Dense<span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">,</span> activation<span class="token operator">=</span><span class="token string">"relu"</span><span class="token punctuation">)</span><span class="token punctuation">(</span>concat_sparse_kd_embed<span class="token punctuation">)</span><span class="token punctuation">)</span>    mlp_out <span class="token operator">=</span> Dropout<span class="token punctuation">(</span><span class="token number">0.3</span><span class="token punctuation">)</span><span class="token punctuation">(</span>Dense<span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">,</span> activation<span class="token operator">=</span><span class="token string">"relu"</span><span class="token punctuation">)</span><span class="token punctuation">(</span>mlp_out<span class="token punctuation">)</span><span class="token punctuation">)</span>    mlp_out <span class="token operator">=</span> Dropout<span class="token punctuation">(</span><span class="token number">0.1</span><span class="token punctuation">)</span><span class="token punctuation">(</span>Dense<span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">,</span> activation<span class="token operator">=</span><span class="token string">"relu"</span><span class="token punctuation">)</span><span class="token punctuation">(</span>mlp_out<span class="token punctuation">)</span><span class="token punctuation">)</span>        dnn_out <span class="token operator">=</span> Dense<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">(</span>mlp_out<span class="token punctuation">)</span>        <span class="token keyword">return</span> dnn_out    <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">dnn_logits <span class="token operator">=</span> get_dnn_logits<span class="token punctuation">(</span>sparse_input_dict<span class="token punctuation">,</span> dnn_sparse_feature_columns<span class="token punctuation">,</span> embedding_layers<span class="token punctuation">)</span>dnn_logits<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token operator">&lt;</span>KerasTensor<span class="token punctuation">:</span> shape<span class="token operator">=</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> dtype<span class="token operator">=</span>float32 <span class="token punctuation">(</span>created by layer <span class="token string">'dense_6'</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="4-6-Output-Layers"><a href="#4-6-Output-Layers" class="headerlink" title="4.6 Output Layers"></a>4.6 Output Layers</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python">output_logits <span class="token operator">=</span> Add<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">[</span>linear_logits<span class="token punctuation">,</span> fm_logits<span class="token punctuation">,</span> dnn_logits<span class="token punctuation">]</span><span class="token punctuation">)</span>output_layers <span class="token operator">=</span> Activation<span class="token punctuation">(</span><span class="token string">"sigmoid"</span><span class="token punctuation">)</span><span class="token punctuation">(</span>output_logits<span class="token punctuation">)</span>model <span class="token operator">=</span> Model<span class="token punctuation">(</span>input_layers<span class="token punctuation">,</span> output_layers<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">model<span class="token punctuation">.</span>summary<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">Model<span class="token punctuation">:</span> <span class="token string">"model"</span>__________________________________________________________________________________________________Layer <span class="token punctuation">(</span><span class="token builtin">type</span><span class="token punctuation">)</span>                    Output Shape         Param <span class="token comment">#     Connected to                     </span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span>C1 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                 <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________C2 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                 <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________C3 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                 <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________C4 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                 <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________C5 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                 <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________C6 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                 <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________C7 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                 <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________C8 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                 <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________C9 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                 <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________C10 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________C11 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________C12 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________C13 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________C14 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________C15 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________C16 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________C17 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________C18 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________C19 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________C20 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________C21 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________C22 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________C23 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________C24 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________C25 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________C26 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________kd_emb_C1 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>           <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>         <span class="token number">108</span>         C1<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                          C1<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                         __________________________________________________________________________________________________kd_emb_C2 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>           <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>         <span class="token number">368</span>         C2<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                          C2<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                         __________________________________________________________________________________________________kd_emb_C3 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>           <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>         <span class="token number">688</span>         C3<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                          C3<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                         __________________________________________________________________________________________________kd_emb_C4 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>           <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>         <span class="token number">628</span>         C4<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                          C4<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                         __________________________________________________________________________________________________kd_emb_C5 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>           <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>         <span class="token number">48</span>          C5<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                          C5<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                         __________________________________________________________________________________________________kd_emb_C6 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>           <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>         <span class="token number">28</span>          C6<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                          C6<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                         __________________________________________________________________________________________________kd_emb_C7 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>           <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>         <span class="token number">732</span>         C7<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                          C7<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                         __________________________________________________________________________________________________kd_emb_C8 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>           <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>         <span class="token number">76</span>          C8<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                          C8<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                         __________________________________________________________________________________________________kd_emb_C9 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>           <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>         <span class="token number">8</span>           C9<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                          C9<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                         __________________________________________________________________________________________________kd_emb_C10 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>          <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>         <span class="token number">568</span>         C10<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                         C10<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                        __________________________________________________________________________________________________kd_emb_C11 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>          <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>         <span class="token number">692</span>         C11<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                         C11<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                        __________________________________________________________________________________________________kd_emb_C12 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>          <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>         <span class="token number">680</span>         C12<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                         C12<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                        __________________________________________________________________________________________________kd_emb_C13 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>          <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>         <span class="token number">664</span>         C13<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                         C13<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                        __________________________________________________________________________________________________kd_emb_C14 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>          <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>         <span class="token number">56</span>          C14<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                         C14<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                        __________________________________________________________________________________________________kd_emb_C15 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>          <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>         <span class="token number">680</span>         C15<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                         C15<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                        __________________________________________________________________________________________________kd_emb_C16 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>          <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>         <span class="token number">672</span>         C16<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                         C16<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                        __________________________________________________________________________________________________kd_emb_C17 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>          <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>         <span class="token number">36</span>          C17<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                         C17<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                        __________________________________________________________________________________________________kd_emb_C18 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>          <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>         <span class="token number">508</span>         C18<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                         C18<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                        __________________________________________________________________________________________________kd_emb_C19 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>          <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>         <span class="token number">176</span>         C19<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                         C19<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                        __________________________________________________________________________________________________kd_emb_C20 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>          <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>         <span class="token number">16</span>          C20<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                         C20<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                        __________________________________________________________________________________________________kd_emb_C21 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>          <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>         <span class="token number">676</span>         C21<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                         C21<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                        __________________________________________________________________________________________________kd_emb_C22 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>          <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>         <span class="token number">24</span>          C22<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                         C22<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                        __________________________________________________________________________________________________kd_emb_C23 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>          <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>         <span class="token number">40</span>          C23<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                         C23<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                        __________________________________________________________________________________________________kd_emb_C24 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>          <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>         <span class="token number">500</span>         C24<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                         C24<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                        __________________________________________________________________________________________________kd_emb_C25 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>          <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>         <span class="token number">80</span>          C25<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                         C25<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                        __________________________________________________________________________________________________kd_emb_C26 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>          <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>         <span class="token number">360</span>         C26<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                         C26<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                        __________________________________________________________________________________________________flatten_78 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>            <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>            <span class="token number">0</span>           kd_emb_C1<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                  __________________________________________________________________________________________________flatten_79 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>            <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>            <span class="token number">0</span>           kd_emb_C2<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                  __________________________________________________________________________________________________flatten_80 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>            <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>            <span class="token number">0</span>           kd_emb_C3<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                  __________________________________________________________________________________________________flatten_81 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>            <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>            <span class="token number">0</span>           kd_emb_C4<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                  __________________________________________________________________________________________________flatten_82 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>            <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>            <span class="token number">0</span>           kd_emb_C5<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                  __________________________________________________________________________________________________flatten_83 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>            <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>            <span class="token number">0</span>           kd_emb_C6<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                  __________________________________________________________________________________________________flatten_84 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>            <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>            <span class="token number">0</span>           kd_emb_C7<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                  __________________________________________________________________________________________________flatten_85 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>            <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>            <span class="token number">0</span>           kd_emb_C8<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                  __________________________________________________________________________________________________flatten_86 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>            <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>            <span class="token number">0</span>           kd_emb_C9<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                  __________________________________________________________________________________________________flatten_87 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>            <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>            <span class="token number">0</span>           kd_emb_C10<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                 __________________________________________________________________________________________________flatten_88 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>            <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>            <span class="token number">0</span>           kd_emb_C11<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                 __________________________________________________________________________________________________flatten_89 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>            <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>            <span class="token number">0</span>           kd_emb_C12<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                 __________________________________________________________________________________________________flatten_90 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>            <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>            <span class="token number">0</span>           kd_emb_C13<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                 __________________________________________________________________________________________________flatten_91 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>            <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>            <span class="token number">0</span>           kd_emb_C14<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                 __________________________________________________________________________________________________flatten_92 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>            <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>            <span class="token number">0</span>           kd_emb_C15<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                 __________________________________________________________________________________________________flatten_93 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>            <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>            <span class="token number">0</span>           kd_emb_C16<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                 __________________________________________________________________________________________________flatten_94 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>            <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>            <span class="token number">0</span>           kd_emb_C17<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                 __________________________________________________________________________________________________flatten_95 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>            <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>            <span class="token number">0</span>           kd_emb_C18<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                 __________________________________________________________________________________________________flatten_96 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>            <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>            <span class="token number">0</span>           kd_emb_C19<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                 __________________________________________________________________________________________________flatten_97 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>            <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>            <span class="token number">0</span>           kd_emb_C20<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                 __________________________________________________________________________________________________flatten_98 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>            <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>            <span class="token number">0</span>           kd_emb_C21<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                 __________________________________________________________________________________________________flatten_99 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>            <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>            <span class="token number">0</span>           kd_emb_C22<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                 __________________________________________________________________________________________________flatten_100 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>           <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>            <span class="token number">0</span>           kd_emb_C23<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                 __________________________________________________________________________________________________flatten_101 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>           <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>            <span class="token number">0</span>           kd_emb_C24<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                 __________________________________________________________________________________________________flatten_102 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>           <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>            <span class="token number">0</span>           kd_emb_C25<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                 __________________________________________________________________________________________________flatten_103 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>           <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>            <span class="token number">0</span>           kd_emb_C26<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                 __________________________________________________________________________________________________concatenate_7 <span class="token punctuation">(</span>Concatenate<span class="token punctuation">)</span>     <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">104</span><span class="token punctuation">)</span>          <span class="token number">0</span>           flatten_78<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  flatten_79<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  flatten_80<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  flatten_81<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  flatten_82<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  flatten_83<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  flatten_84<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  flatten_85<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  flatten_86<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  flatten_87<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  flatten_88<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  flatten_89<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  flatten_90<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  flatten_91<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  flatten_92<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  flatten_93<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  flatten_94<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  flatten_95<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  flatten_96<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  flatten_97<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  flatten_98<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  flatten_99<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  flatten_100<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                 flatten_101<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                 flatten_102<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                 flatten_103<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                __________________________________________________________________________________________________dense_3 <span class="token punctuation">(</span>Dense<span class="token punctuation">)</span>                 <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">256</span><span class="token punctuation">)</span>          <span class="token number">26880</span>       concatenate_7<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>              __________________________________________________________________________________________________dropout <span class="token punctuation">(</span>Dropout<span class="token punctuation">)</span>               <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">256</span><span class="token punctuation">)</span>          <span class="token number">0</span>           dense_3<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                    __________________________________________________________________________________________________dense_4 <span class="token punctuation">(</span>Dense<span class="token punctuation">)</span>                 <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">256</span><span class="token punctuation">)</span>          <span class="token number">65792</span>       dropout<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                    __________________________________________________________________________________________________I1 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                 <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________I2 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                 <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________I3 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                 <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________I4 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                 <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________I5 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                 <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________I6 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                 <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________I7 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                 <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________I8 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                 <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________I9 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                 <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________I10 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________I11 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________I12 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________I13 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________1d_emb_C1 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>           <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>         <span class="token number">27</span>          C1<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                         __________________________________________________________________________________________________1d_emb_C2 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>           <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>         <span class="token number">92</span>          C2<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                         __________________________________________________________________________________________________1d_emb_C3 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>           <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>         <span class="token number">172</span>         C3<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                         __________________________________________________________________________________________________1d_emb_C4 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>           <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>         <span class="token number">157</span>         C4<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                         __________________________________________________________________________________________________1d_emb_C5 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>           <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>         <span class="token number">12</span>          C5<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                         __________________________________________________________________________________________________1d_emb_C6 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>           <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>         <span class="token number">7</span>           C6<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                         __________________________________________________________________________________________________1d_emb_C7 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>           <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>         <span class="token number">183</span>         C7<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                         __________________________________________________________________________________________________1d_emb_C8 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>           <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>         <span class="token number">19</span>          C8<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                         __________________________________________________________________________________________________1d_emb_C9 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>           <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>         <span class="token number">2</span>           C9<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                         __________________________________________________________________________________________________1d_emb_C10 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>          <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>         <span class="token number">142</span>         C10<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                        __________________________________________________________________________________________________1d_emb_C11 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>          <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>         <span class="token number">173</span>         C11<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                        __________________________________________________________________________________________________1d_emb_C12 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>          <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>         <span class="token number">170</span>         C12<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                        __________________________________________________________________________________________________1d_emb_C13 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>          <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>         <span class="token number">166</span>         C13<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                        __________________________________________________________________________________________________1d_emb_C14 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>          <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>         <span class="token number">14</span>          C14<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                        __________________________________________________________________________________________________1d_emb_C15 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>          <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>         <span class="token number">170</span>         C15<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                        __________________________________________________________________________________________________1d_emb_C16 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>          <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>         <span class="token number">168</span>         C16<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                        __________________________________________________________________________________________________1d_emb_C17 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>          <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>         <span class="token number">9</span>           C17<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                        __________________________________________________________________________________________________1d_emb_C18 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>          <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>         <span class="token number">127</span>         C18<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                        __________________________________________________________________________________________________1d_emb_C19 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>          <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>         <span class="token number">44</span>          C19<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                        __________________________________________________________________________________________________1d_emb_C20 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>          <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>         <span class="token number">4</span>           C20<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                        __________________________________________________________________________________________________1d_emb_C21 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>          <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>         <span class="token number">169</span>         C21<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                        __________________________________________________________________________________________________1d_emb_C22 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>          <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>         <span class="token number">6</span>           C22<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                        __________________________________________________________________________________________________1d_emb_C23 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>          <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>         <span class="token number">10</span>          C23<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                        __________________________________________________________________________________________________1d_emb_C24 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>          <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>         <span class="token number">125</span>         C24<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                        __________________________________________________________________________________________________1d_emb_C25 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>          <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>         <span class="token number">20</span>          C25<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                        __________________________________________________________________________________________________1d_emb_C26 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>          <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>         <span class="token number">90</span>          C26<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                        __________________________________________________________________________________________________dropout_1 <span class="token punctuation">(</span>Dropout<span class="token punctuation">)</span>             <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">256</span><span class="token punctuation">)</span>          <span class="token number">0</span>           dense_4<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                    __________________________________________________________________________________________________concatenate_2 <span class="token punctuation">(</span>Concatenate<span class="token punctuation">)</span>     <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">)</span>           <span class="token number">0</span>           I1<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                          I2<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                          I3<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                          I4<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                          I5<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                          I6<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                          I7<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                          I8<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                          I9<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                          I10<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                         I11<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                         I12<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                         I13<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                        __________________________________________________________________________________________________flatten_52 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>            <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>            <span class="token number">0</span>           1d_emb_C1<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                  __________________________________________________________________________________________________flatten_53 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>            <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>            <span class="token number">0</span>           1d_emb_C2<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                  __________________________________________________________________________________________________flatten_54 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>            <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>            <span class="token number">0</span>           1d_emb_C3<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                  __________________________________________________________________________________________________flatten_55 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>            <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>            <span class="token number">0</span>           1d_emb_C4<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                  __________________________________________________________________________________________________flatten_56 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>            <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>            <span class="token number">0</span>           1d_emb_C5<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                  __________________________________________________________________________________________________flatten_57 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>            <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>            <span class="token number">0</span>           1d_emb_C6<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                  __________________________________________________________________________________________________flatten_58 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>            <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>            <span class="token number">0</span>           1d_emb_C7<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                  __________________________________________________________________________________________________flatten_59 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>            <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>            <span class="token number">0</span>           1d_emb_C8<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                  __________________________________________________________________________________________________flatten_60 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>            <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>            <span class="token number">0</span>           1d_emb_C9<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                  __________________________________________________________________________________________________flatten_61 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>            <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>            <span class="token number">0</span>           1d_emb_C10<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                 __________________________________________________________________________________________________flatten_62 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>            <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>            <span class="token number">0</span>           1d_emb_C11<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                 __________________________________________________________________________________________________flatten_63 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>            <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>            <span class="token number">0</span>           1d_emb_C12<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                 __________________________________________________________________________________________________flatten_64 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>            <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>            <span class="token number">0</span>           1d_emb_C13<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                 __________________________________________________________________________________________________flatten_65 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>            <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>            <span class="token number">0</span>           1d_emb_C14<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                 __________________________________________________________________________________________________flatten_66 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>            <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>            <span class="token number">0</span>           1d_emb_C15<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                 __________________________________________________________________________________________________flatten_67 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>            <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>            <span class="token number">0</span>           1d_emb_C16<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                 __________________________________________________________________________________________________flatten_68 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>            <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>            <span class="token number">0</span>           1d_emb_C17<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                 __________________________________________________________________________________________________flatten_69 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>            <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>            <span class="token number">0</span>           1d_emb_C18<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                 __________________________________________________________________________________________________flatten_70 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>            <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>            <span class="token number">0</span>           1d_emb_C19<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                 __________________________________________________________________________________________________flatten_71 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>            <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>            <span class="token number">0</span>           1d_emb_C20<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                 __________________________________________________________________________________________________flatten_72 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>            <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>            <span class="token number">0</span>           1d_emb_C21<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                 __________________________________________________________________________________________________flatten_73 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>            <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>            <span class="token number">0</span>           1d_emb_C22<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                 __________________________________________________________________________________________________flatten_74 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>            <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>            <span class="token number">0</span>           1d_emb_C23<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                 __________________________________________________________________________________________________flatten_75 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>            <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>            <span class="token number">0</span>           1d_emb_C24<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                 __________________________________________________________________________________________________flatten_76 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>            <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>            <span class="token number">0</span>           1d_emb_C25<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                 __________________________________________________________________________________________________flatten_77 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>            <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>            <span class="token number">0</span>           1d_emb_C26<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                 __________________________________________________________________________________________________dense_5 <span class="token punctuation">(</span>Dense<span class="token punctuation">)</span>                 <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">256</span><span class="token punctuation">)</span>          <span class="token number">65792</span>       dropout_1<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                  __________________________________________________________________________________________________dense_2 <span class="token punctuation">(</span>Dense<span class="token punctuation">)</span>                 <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>            <span class="token number">14</span>          concatenate_2<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>              __________________________________________________________________________________________________add_4 <span class="token punctuation">(</span>Add<span class="token punctuation">)</span>                     <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>            <span class="token number">0</span>           flatten_52<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  flatten_53<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  flatten_54<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  flatten_55<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  flatten_56<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  flatten_57<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  flatten_58<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  flatten_59<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  flatten_60<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  flatten_61<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  flatten_62<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  flatten_63<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  flatten_64<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  flatten_65<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  flatten_66<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  flatten_67<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  flatten_68<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  flatten_69<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  flatten_70<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  flatten_71<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  flatten_72<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  flatten_73<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  flatten_74<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  flatten_75<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  flatten_76<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  flatten_77<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                 __________________________________________________________________________________________________concatenate_6 <span class="token punctuation">(</span>Concatenate<span class="token punctuation">)</span>     <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">26</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>        <span class="token number">0</span>           kd_emb_C1<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                   kd_emb_C2<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                   kd_emb_C3<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                   kd_emb_C4<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                   kd_emb_C5<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                   kd_emb_C6<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                   kd_emb_C7<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                   kd_emb_C8<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                   kd_emb_C9<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                   kd_emb_C10<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  kd_emb_C11<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  kd_emb_C12<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  kd_emb_C13<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  kd_emb_C14<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  kd_emb_C15<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  kd_emb_C16<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  kd_emb_C17<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  kd_emb_C18<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  kd_emb_C19<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  kd_emb_C20<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  kd_emb_C21<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  kd_emb_C22<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  kd_emb_C23<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  kd_emb_C24<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  kd_emb_C25<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  kd_emb_C26<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                 __________________________________________________________________________________________________dropout_2 <span class="token punctuation">(</span>Dropout<span class="token punctuation">)</span>             <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">256</span><span class="token punctuation">)</span>          <span class="token number">0</span>           dense_5<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                    __________________________________________________________________________________________________add_5 <span class="token punctuation">(</span>Add<span class="token punctuation">)</span>                     <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>            <span class="token number">0</span>           dense_2<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                     add_4<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                      __________________________________________________________________________________________________fm__layer_2 <span class="token punctuation">(</span>FM_Layer<span class="token punctuation">)</span>          <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>            <span class="token number">0</span>           concatenate_6<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>              __________________________________________________________________________________________________dense_6 <span class="token punctuation">(</span>Dense<span class="token punctuation">)</span>                 <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>            <span class="token number">257</span>         dropout_2<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                  __________________________________________________________________________________________________add_6 <span class="token punctuation">(</span>Add<span class="token punctuation">)</span>                     <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>            <span class="token number">0</span>           add_5<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                       fm__layer_2<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                 dense_6<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                    __________________________________________________________________________________________________activation <span class="token punctuation">(</span>Activation<span class="token punctuation">)</span>         <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>            <span class="token number">0</span>           add_6<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                      <span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span>Total params<span class="token punctuation">:</span> <span class="token number">170</span><span class="token punctuation">,</span><span class="token number">125</span>Trainable params<span class="token punctuation">:</span> <span class="token number">170</span><span class="token punctuation">,</span><span class="token number">125</span>Non<span class="token operator">-</span>trainable params<span class="token punctuation">:</span> <span class="token number">0</span>__________________________________________________________________________________________________<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">model<span class="token punctuation">.</span><span class="token builtin">compile</span><span class="token punctuation">(</span>optimizer<span class="token operator">=</span><span class="token string">"adam"</span><span class="token punctuation">,</span>                 loss<span class="token operator">=</span><span class="token string">"binary_crossentropy"</span><span class="token punctuation">,</span>                 metrics<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">"binary_crossentropy"</span><span class="token punctuation">,</span> tf<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>metrics<span class="token punctuation">.</span>AUC<span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">'auc'</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token comment"># 将输入数据转化成字典的形式输入</span>train_model_input <span class="token operator">=</span> <span class="token punctuation">{</span>name<span class="token punctuation">:</span> data<span class="token punctuation">[</span>name<span class="token punctuation">]</span> <span class="token keyword">for</span> name <span class="token keyword">in</span> dense_features <span class="token operator">+</span> sparse_features<span class="token punctuation">}</span><span class="token comment"># 模型训练</span>model<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>train_model_input<span class="token punctuation">,</span> train_data<span class="token punctuation">[</span><span class="token string">'label'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>values<span class="token punctuation">,</span>        batch_size<span class="token operator">=</span><span class="token number">64</span><span class="token punctuation">,</span> epochs<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span> validation_split<span class="token operator">=</span><span class="token number">0.3</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">Epoch <span class="token number">1</span><span class="token operator">/</span><span class="token number">10</span><span class="token number">3</span><span class="token operator">/</span><span class="token number">3</span> <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token punctuation">]</span> <span class="token operator">-</span> 6s 418ms<span class="token operator">/</span>step <span class="token operator">-</span> loss<span class="token punctuation">:</span> <span class="token number">0.6597</span> <span class="token operator">-</span> binary_crossentropy<span class="token punctuation">:</span> <span class="token number">0.6597</span> <span class="token operator">-</span> auc<span class="token punctuation">:</span> <span class="token number">0.5713</span> <span class="token operator">-</span> val_loss<span class="token punctuation">:</span> <span class="token number">0.8220</span> <span class="token operator">-</span> val_binary_crossentropy<span class="token punctuation">:</span> <span class="token number">0.8220</span> <span class="token operator">-</span> val_auc<span class="token punctuation">:</span> <span class="token number">0.5642</span>Epoch <span class="token number">2</span><span class="token operator">/</span><span class="token number">10</span><span class="token number">3</span><span class="token operator">/</span><span class="token number">3</span> <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token punctuation">]</span> <span class="token operator">-</span> 0s 53ms<span class="token operator">/</span>step <span class="token operator">-</span> loss<span class="token punctuation">:</span> <span class="token number">0.6426</span> <span class="token operator">-</span> binary_crossentropy<span class="token punctuation">:</span> <span class="token number">0.6426</span> <span class="token operator">-</span> auc<span class="token punctuation">:</span> <span class="token number">0.5833</span> <span class="token operator">-</span> val_loss<span class="token punctuation">:</span> <span class="token number">0.8138</span> <span class="token operator">-</span> val_binary_crossentropy<span class="token punctuation">:</span> <span class="token number">0.8138</span> <span class="token operator">-</span> val_auc<span class="token punctuation">:</span> <span class="token number">0.5693</span>Epoch <span class="token number">3</span><span class="token operator">/</span><span class="token number">10</span><span class="token number">3</span><span class="token operator">/</span><span class="token number">3</span> <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token punctuation">]</span> <span class="token operator">-</span> 0s 53ms<span class="token operator">/</span>step <span class="token operator">-</span> loss<span class="token punctuation">:</span> <span class="token number">0.6861</span> <span class="token operator">-</span> binary_crossentropy<span class="token punctuation">:</span> <span class="token number">0.6861</span> <span class="token operator">-</span> auc<span class="token punctuation">:</span> <span class="token number">0.5929</span> <span class="token operator">-</span> val_loss<span class="token punctuation">:</span> <span class="token number">0.8050</span> <span class="token operator">-</span> val_binary_crossentropy<span class="token punctuation">:</span> <span class="token number">0.8050</span> <span class="token operator">-</span> val_auc<span class="token punctuation">:</span> <span class="token number">0.5687</span>Epoch <span class="token number">4</span><span class="token operator">/</span><span class="token number">10</span><span class="token number">3</span><span class="token operator">/</span><span class="token number">3</span> <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token punctuation">]</span> <span class="token operator">-</span> 0s 52ms<span class="token operator">/</span>step <span class="token operator">-</span> loss<span class="token punctuation">:</span> <span class="token number">0.5978</span> <span class="token operator">-</span> binary_crossentropy<span class="token punctuation">:</span> <span class="token number">0.5978</span> <span class="token operator">-</span> auc<span class="token punctuation">:</span> <span class="token number">0.6370</span> <span class="token operator">-</span> val_loss<span class="token punctuation">:</span> <span class="token number">0.7967</span> <span class="token operator">-</span> val_binary_crossentropy<span class="token punctuation">:</span> <span class="token number">0.7967</span> <span class="token operator">-</span> val_auc<span class="token punctuation">:</span> <span class="token number">0.5712</span>Epoch <span class="token number">5</span><span class="token operator">/</span><span class="token number">10</span><span class="token number">3</span><span class="token operator">/</span><span class="token number">3</span> <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token punctuation">]</span> <span class="token operator">-</span> 0s 51ms<span class="token operator">/</span>step <span class="token operator">-</span> loss<span class="token punctuation">:</span> <span class="token number">0.5634</span> <span class="token operator">-</span> binary_crossentropy<span class="token punctuation">:</span> <span class="token number">0.5634</span> <span class="token operator">-</span> auc<span class="token punctuation">:</span> <span class="token number">0.6670</span> <span class="token operator">-</span> val_loss<span class="token punctuation">:</span> <span class="token number">0.7855</span> <span class="token operator">-</span> val_binary_crossentropy<span class="token punctuation">:</span> <span class="token number">0.7855</span> <span class="token operator">-</span> val_auc<span class="token punctuation">:</span> <span class="token number">0.5802</span>Epoch <span class="token number">6</span><span class="token operator">/</span><span class="token number">10</span><span class="token number">3</span><span class="token operator">/</span><span class="token number">3</span> <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token punctuation">]</span> <span class="token operator">-</span> 0s 54ms<span class="token operator">/</span>step <span class="token operator">-</span> loss<span class="token punctuation">:</span> <span class="token number">0.5294</span> <span class="token operator">-</span> binary_crossentropy<span class="token punctuation">:</span> <span class="token number">0.5294</span> <span class="token operator">-</span> auc<span class="token punctuation">:</span> <span class="token number">0.7190</span> <span class="token operator">-</span> val_loss<span class="token punctuation">:</span> <span class="token number">0.7734</span> <span class="token operator">-</span> val_binary_crossentropy<span class="token punctuation">:</span> <span class="token number">0.7734</span> <span class="token operator">-</span> val_auc<span class="token punctuation">:</span> <span class="token number">0.5860</span>Epoch <span class="token number">7</span><span class="token operator">/</span><span class="token number">10</span><span class="token number">3</span><span class="token operator">/</span><span class="token number">3</span> <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token punctuation">]</span> <span class="token operator">-</span> 0s 54ms<span class="token operator">/</span>step <span class="token operator">-</span> loss<span class="token punctuation">:</span> <span class="token number">0.4167</span> <span class="token operator">-</span> binary_crossentropy<span class="token punctuation">:</span> <span class="token number">0.4167</span> <span class="token operator">-</span> auc<span class="token punctuation">:</span> <span class="token number">0.8086</span> <span class="token operator">-</span> val_loss<span class="token punctuation">:</span> <span class="token number">0.7695</span> <span class="token operator">-</span> val_binary_crossentropy<span class="token punctuation">:</span> <span class="token number">0.7695</span> <span class="token operator">-</span> val_auc<span class="token punctuation">:</span> <span class="token number">0.5956</span>Epoch <span class="token number">8</span><span class="token operator">/</span><span class="token number">10</span><span class="token number">3</span><span class="token operator">/</span><span class="token number">3</span> <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token punctuation">]</span> <span class="token operator">-</span> 0s 52ms<span class="token operator">/</span>step <span class="token operator">-</span> loss<span class="token punctuation">:</span> <span class="token number">0.3800</span> <span class="token operator">-</span> binary_crossentropy<span class="token punctuation">:</span> <span class="token number">0.3800</span> <span class="token operator">-</span> auc<span class="token punctuation">:</span> <span class="token number">0.8545</span> <span class="token operator">-</span> val_loss<span class="token punctuation">:</span> <span class="token number">0.7757</span> <span class="token operator">-</span> val_binary_crossentropy<span class="token punctuation">:</span> <span class="token number">0.7757</span> <span class="token operator">-</span> val_auc<span class="token punctuation">:</span> <span class="token number">0.6117</span>Epoch <span class="token number">9</span><span class="token operator">/</span><span class="token number">10</span><span class="token number">3</span><span class="token operator">/</span><span class="token number">3</span> <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token punctuation">]</span> <span class="token operator">-</span> 0s 52ms<span class="token operator">/</span>step <span class="token operator">-</span> loss<span class="token punctuation">:</span> <span class="token number">0.2956</span> <span class="token operator">-</span> binary_crossentropy<span class="token punctuation">:</span> <span class="token number">0.2956</span> <span class="token operator">-</span> auc<span class="token punctuation">:</span> <span class="token number">0.9235</span> <span class="token operator">-</span> val_loss<span class="token punctuation">:</span> <span class="token number">0.7982</span> <span class="token operator">-</span> val_binary_crossentropy<span class="token punctuation">:</span> <span class="token number">0.7982</span> <span class="token operator">-</span> val_auc<span class="token punctuation">:</span> <span class="token number">0.6348</span>Epoch <span class="token number">10</span><span class="token operator">/</span><span class="token number">10</span><span class="token number">3</span><span class="token operator">/</span><span class="token number">3</span> <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token punctuation">]</span> <span class="token operator">-</span> 0s 51ms<span class="token operator">/</span>step <span class="token operator">-</span> loss<span class="token punctuation">:</span> <span class="token number">0.1592</span> <span class="token operator">-</span> binary_crossentropy<span class="token punctuation">:</span> <span class="token number">0.1592</span> <span class="token operator">-</span> auc<span class="token punctuation">:</span> <span class="token number">0.9863</span> <span class="token operator">-</span> val_loss<span class="token punctuation">:</span> <span class="token number">0.8413</span> <span class="token operator">-</span> val_binary_crossentropy<span class="token punctuation">:</span> <span class="token number">0.8413</span> <span class="token operator">-</span> val_auc<span class="token punctuation">:</span> <span class="token number">0.6457</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="4、思考"><a href="#4、思考" class="headerlink" title="4、思考"></a>4、思考</h2><ol><li><p>如果对于FM采用随机梯度下降SGD训练模型参数，请写出模型各个参数的梯度和FM参数训练的复杂度</p><p><img src="/2021/03/21/task3-deepfm/pic2.png" alt=""></p><p>复杂度为$O\left(k n\right)$</p></li><li><p>对于下图所示，根据你的理解Sparse Feature中的不同颜色节点分别表示什么意思</p></li></ol><p><img src="http://ryluo.oss-cn-chengdu.aliyuncs.com/图片image-20210225180556628.png" alt="image-20210225180556628" style="zoom:50%;"></p><p>黄色节点代表为1，对于每一个 Field，只有这一个位置是1，对应的灰色节点为0。</p><h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><ul><li><p><a href="https://arxiv.org/pdf/1703.04247.pdf">论文原文</a></p></li><li><p><a href="https://zhuanlan.zhihu.com/p/57873613">深度推荐模型之DeepFM</a></p></li><li><p><a href="https://tech.meituan.com/2016/03/03/deep-understanding-of-ffm-principles-and-practices.html">深入FFM原理与实践</a></p></li><li><p><a href="http://fancyerii.github.io/2019/12/19/deepfm/">DeepFM模型CTR预估理论与实战</a></p></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> DataWhale </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Task2 Solidity 基础</title>
      <link href="2021/03/20/task2-solidity-ji-chu/"/>
      <url>2021/03/20/task2-solidity-ji-chu/</url>
      
        <content type="html"><![CDATA[<h1 id="Solidity-基础"><a href="#Solidity-基础" class="headerlink" title="Solidity 基础"></a>Solidity 基础</h1><h2 id="Solidity-30-Days-day3-Hello-World"><a href="#Solidity-30-Days-day3-Hello-World" class="headerlink" title="Solidity 30 Days - day3 - Hello,World!"></a>Solidity 30 Days - day3 - Hello,World!</h2><h3 id="Code-example"><a href="#Code-example" class="headerlink" title="Code example"></a>Code example</h3><pre class="line-numbers language-js" data-language="js"><code class="language-js">pragma solidity <span class="token operator">^</span><span class="token number">0.4</span><span class="token number">.25</span><span class="token punctuation">;</span>contract helloWorld<span class="token punctuation">{</span><span class="token keyword">function</span> <span class="token function">hi</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">public</span> pure <span class="token function">returns</span><span class="token punctuation">(</span><span class="token parameter">string</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">return</span> <span class="token string">"Hello, World!"</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="Code-analysis"><a href="#Code-analysis" class="headerlink" title="Code analysis"></a>Code analysis</h3><pre class="line-numbers language-js" data-language="js"><code class="language-js">pragma solisity <span class="token operator">^</span><span class="token number">0.4</span><span class="token number">.25</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li>varsion pragma</li><li>^ presents the range from 0.4.25 to &lt; 0.5.0</li></ul><pre class="line-numbers language-js" data-language="js"><code class="language-js">contract helloWorld<span class="token punctuation">{</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li>宣告一个 contract </li><li>而一个 contract 中可以拥有多个状态变量和多个 function </li></ul><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">hi</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token function">returns</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li>宣告一个可被称呼的 function</li><li><p>function <name> (<parameters>)</parameters></name></p><ul><li>returns (return value type){}</li></ul></li><li><p>Visibility</p><ul><li>public, external(contract 外), internal(contract 内), private</li></ul></li><li><p>Pure</p><ul><li>完全不存取 state</li><li>不读取和存储链上的数据，没有和链的互动</li></ul></li></ul><h2 id="Solidity-30-Days-day4-Ganache-amp-Remix"><a href="#Solidity-30-Days-day4-Ganache-amp-Remix" class="headerlink" title="Solidity 30 Days - day4 - Ganache &amp; Remix"></a>Solidity 30 Days - day4 - Ganache &amp; Remix</h2><h3 id="Ganache"><a href="#Ganache" class="headerlink" title="Ganache"></a><a href="https://www.trufflesuite.com/ganache#">Ganache</a></h3><p>Ganache is your personal blockchain for Ethereum development.</p><p><a href="https://github.com/trufflesuite/ganache/blob/develop/.github/images/ganache_screenshot.jpg?raw=true"><img src="https://github.com/trufflesuite/ganache/raw/develop/.github/images/ganache_screenshot.jpg?raw=true" alt=""></a></p><h3 id="Remix"><a href="#Remix" class="headerlink" title="Remix"></a><a href="https://remix.ethereum.org/">Remix</a></h3><p><img src="/2021/03/20/task2-solidity-ji-chu/Remix.png" alt=""></p><h2 id="Solidity-30-Days-day5-State-Variables"><a href="#Solidity-30-Days-day5-State-Variables" class="headerlink" title="Solidity 30 Days - day5 - State Variables"></a>Solidity 30 Days - day5 - State Variables</h2><h3 id="Code-example-1"><a href="#Code-example-1" class="headerlink" title="Code example"></a>Code example</h3><pre class="line-numbers language-js" data-language="js"><code class="language-js">pragma solidity <span class="token operator">^</span><span class="token number">0.4</span><span class="token number">.0</span><span class="token punctuation">;</span>contract StateVariables<span class="token punctuation">{</span>    <span class="token comment">//state variables</span>    string name<span class="token punctuation">;</span>    address owner<span class="token punctuation">;</span>    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token comment">/* Initailize default state. */</span>        name <span class="token operator">=</span> <span class="token string">"unknown"</span><span class="token punctuation">;</span>        owner <span class="token operator">=</span> msg<span class="token punctuation">.</span>sender<span class="token punctuation">;</span>     <span class="token punctuation">}</span>        <span class="token keyword">function</span> <span class="token function">setName</span><span class="token punctuation">(</span><span class="token parameter">string _name</span><span class="token punctuation">)</span> <span class="token keyword">public</span> <span class="token function">returns</span><span class="token punctuation">(</span><span class="token parameter">string</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token comment">/* Only owner has the Permission to modify its name.*/</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>msg<span class="token punctuation">.</span>sender <span class="token operator">==</span> owner<span class="token punctuation">)</span><span class="token punctuation">{</span>            name <span class="token operator">=</span> _name<span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">else</span><span class="token punctuation">{</span>            <span class="token comment">// revert()</span>            <span class="token function">revert</span><span class="token punctuation">(</span><span class="token string">"Permission denied."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token keyword">return</span> name<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">function</span> <span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">public</span> <span class="token function">returns</span><span class="token punctuation">(</span><span class="token parameter">string</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">return</span> name<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="Code-analysis-1"><a href="#Code-analysis-1" class="headerlink" title="Code analysis"></a>Code analysis</h3><pre class="line-numbers language-C++" data-language="C++"><code class="language-C++">string name;address owner;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><ul><li>State variables 会被存放在 Smart Contract 自有的 Storage 里</li><li>string -&gt; 字串</li><li>address -&gt; 住址(account, contract)</li></ul><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token comment">//构造函数</span><span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token comment">/* Initailize default state. */</span>    name <span class="token operator">=</span> <span class="token string">"unknown"</span><span class="token punctuation">;</span>    owner <span class="token operator">=</span> msg<span class="token punctuation">.</span>sender<span class="token punctuation">;</span> <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>Contract 的构造函数</li><li>当 contract 建立时，对 State Variables 进行初始化</li><li>msg.sender -&gt; 拿到送给该 transaction 的 address</li></ul><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">setName</span><span class="token punctuation">(</span><span class="token parameter">string _name</span><span class="token punctuation">)</span> <span class="token keyword">public</span> <span class="token function">returns</span><span class="token punctuation">(</span><span class="token parameter">string</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token comment">/* Only owner has the Permission to modify its name.*/</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>msg<span class="token punctuation">.</span>sender <span class="token operator">==</span> owner<span class="token punctuation">)</span><span class="token punctuation">{</span>        name <span class="token operator">=</span> _name<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">else</span><span class="token punctuation">{</span>        <span class="token comment">// revert()</span>        <span class="token function">revert</span><span class="token punctuation">(</span><span class="token string">"Permission denied."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">return</span> name<span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token keyword">function</span> <span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">public</span> <span class="token function">returns</span><span class="token punctuation">(</span><span class="token parameter">string</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    <span class="token keyword">return</span> name<span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token function">revert</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>string<span class="token operator">&gt;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//revert：退回</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li>revert() 通常来描述程序执行到此处应该被终止，且消耗的 gas 不退回</li><li><string> 可以用来说明之所以 revert conservation 的原因</string></li><li>类似的用法有：assert(), require(), throw 等</li></ul><h2 id="Solidity-30-Days-day6-Function-Modifiers"><a href="#Solidity-30-Days-day6-Function-Modifiers" class="headerlink" title="Solidity 30 Days - day6 - Function Modifiers"></a>Solidity 30 Days - day6 - Function Modifiers</h2><h3 id="Code-example-2"><a href="#Code-example-2" class="headerlink" title="Code example"></a>Code example</h3><pre class="line-numbers language-js" data-language="js"><code class="language-js">pragma solidity <span class="token operator">^</span><span class="token number">0.4</span><span class="token number">.0</span><span class="token punctuation">;</span>contract StateVariables<span class="token punctuation">{</span>    <span class="token comment">//state variables</span>    string name<span class="token punctuation">;</span>    uint <span class="token keyword">public</span> rename_counter<span class="token punctuation">;</span>    address owner<span class="token punctuation">;</span>    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">public</span> <span class="token punctuation">{</span>        <span class="token comment">/* Initailize default state. */</span>        name <span class="token operator">=</span> <span class="token string">"unknown"</span><span class="token punctuation">;</span>        owner <span class="token operator">=</span> msg<span class="token punctuation">.</span>sender<span class="token punctuation">;</span>         rename_counter <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>        modifier <span class="token function">onlyOwner</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token function">require</span><span class="token punctuation">(</span>msg<span class="token punctuation">.</span>sender <span class="token operator">==</span> owner<span class="token punctuation">,</span> <span class="token string">"Premission dense"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        rename_counter <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>        _<span class="token punctuation">;</span>    <span class="token punctuation">}</span>        <span class="token keyword">function</span> <span class="token function">setName</span><span class="token punctuation">(</span><span class="token parameter">string _name</span><span class="token punctuation">)</span> <span class="token keyword">public</span> onlyOwner <span class="token function">returns</span><span class="token punctuation">(</span><span class="token parameter">string</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        name <span class="token operator">=</span> _name<span class="token punctuation">;</span>        <span class="token keyword">return</span> name<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">function</span> <span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">public</span> <span class="token function">returns</span><span class="token punctuation">(</span><span class="token parameter">string</span><span class="token punctuation">)</span><span class="token punctuation">{</span>        <span class="token keyword">return</span> name<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="Code-analysis-2"><a href="#Code-analysis-2" class="headerlink" title="Code analysis"></a>Code analysis</h3><pre class="line-numbers language-js" data-language="js"><code class="language-js">modifier <span class="token function">name</span><span class="token punctuation">(</span><span class="token parameter"><span class="token operator">&lt;</span>args<span class="token operator">&gt;</span></span><span class="token punctuation">)</span><span class="token punctuation">{</span>···_<span class="token punctuation">;</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><ul><li><args> 里面可以放参数</args></li><li>··· 则是 solidity 代码</li><li>_；表示执行完这个 modifier 之后，会往下执行原本 function 该做的事</li></ul><pre class="line-numbers language-js" data-language="js"><code class="language-js"><span class="token function">requier</span><span class="token punctuation">(</span>condition<span class="token punctuation">,</span> <span class="token operator">&lt;</span>string<span class="token operator">&gt;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li><p>requier() 通常用来检查程序的条件：</p><ul><li>检查使用者的输入、检验 state variables 是否符合预期、检查执行结果或者返回值等；</li><li>用来检查条件是否合理，决定要不要往下进行，因此通常会在 function 最前面使用，或者要执行某些 function 的调用或者修改 state variables 前使用</li></ul></li><li><p>如果 condition 不满足，则执行到此处程序终止，且消耗的 gas 不退回</p></li><li><string> 可以用来说明程序退出的原因</string></li></ul><h2 id="Solidity-30-Days-day7-Assert-Require-Revert"><a href="#Solidity-30-Days-day7-Assert-Require-Revert" class="headerlink" title="Solidity 30 Days - day7 - Assert, Require, Revert"></a>Solidity 30 Days - day7 - Assert, Require, Revert</h2><h3 id="throw"><a href="#throw" class="headerlink" title="throw;"></a><code>throw;</code></h3><ul><li>已经被弃用</li><li>官方建议使用 revert() 替代</li></ul><h3 id="revert-lt-string-gt"><a href="#revert-lt-string-gt" class="headerlink" title="revert(<string>);"></a><code>revert(&lt;string&gt;);</code></h3><ul><li><p>一个交易最终只有两种状态：commit &amp; revert（原子性）</p><ul><li>commit 表示正常运作，因此交易执行后的结果被写入</li><li>revert 表示交易在过程有问题，因此该交易的修改会被回溯</li></ul></li><li><p><string> 可以用来说明之所以 revert transaction 的原因</string></p></li><li>用来取代原来的 throw 语法</li></ul><h3 id="requier-condition-lt-string-gt"><a href="#requier-condition-lt-string-gt" class="headerlink" title="requier(condition, <string>);"></a><code>requier(condition, &lt;string&gt;);</code></h3><ul><li><p>requier() 通常用来检查程序的条件：</p><ul><li>检查使用者的输入、检验 state variables 是否符合预期、检查执行结果或者返回值等；</li><li>用来检查条件是否合理，决定要不要往下进行，因此通常会在 function 最前面使用，或者要执行某些 function 的调用或者修改 state variables 前使用</li></ul></li><li><p>如果 condition 不满足，则执行到此处程序终止，且消耗的 gas 不退回</p></li><li><string> 可以用来说明程序退出的原因</string></li></ul><h3 id="assert-condition"><a href="#assert-condition" class="headerlink" title="assert(condition);"></a><code>assert(condition);</code></h3><ul><li>assert 代表是不被允许出现的条件</li><li>因为该操作是已知不应该出现的，通常用来检查 overflow、underflow、检查被修改的 state 是否合法、避免不应该出现的 condition 发生等</li><li>算是最后防线，因此会是在执行的最后来检测行为的合法性</li></ul><h2 id="练习题"><a href="#练习题" class="headerlink" title="练习题"></a>练习题</h2><h3 id="1-将固定长度字节数组转化为string类型"><a href="#1-将固定长度字节数组转化为string类型" class="headerlink" title="1. 将固定长度字节数组转化为string类型"></a>1. 将固定长度字节数组转化为<code>string</code>类型</h3><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript">pragma solidity <span class="token operator">^</span><span class="token number">0.4</span><span class="token number">.0</span><span class="token punctuation">;</span>contract bytes32tostring<span class="token punctuation">{</span>        bytes10 testword<span class="token operator">=</span><span class="token number">0x68656c6c6f776f726c64</span><span class="token punctuation">;</span> <span class="token comment">//为helloworld</span>    uint count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>    <span class="token keyword">function</span> <span class="token function">bytes32tostringF</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">public</span> view <span class="token function">returns</span><span class="token punctuation">(</span><span class="token parameter">string</span><span class="token punctuation">)</span><span class="token punctuation">{</span>                count <span class="token operator">=</span> testword<span class="token punctuation">.</span>length<span class="token punctuation">;</span>        bytes memory transarr<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">bytes</span><span class="token punctuation">(</span>count<span class="token punctuation">)</span><span class="token punctuation">;</span>                                                      <span class="token keyword">for</span><span class="token punctuation">(</span>uint j<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>j<span class="token operator">&lt;</span>count<span class="token punctuation">;</span>j<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token comment">//重新对可变数组进行赋值</span>            transarr<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token operator">=</span>testword<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">;</span>              <span class="token punctuation">}</span>        <span class="token keyword">return</span> <span class="token function">string</span><span class="token punctuation">(</span>transarr<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//强制转化</span>            <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="/2021/03/20/task2-solidity-ji-chu/helloworld.png" alt=""></p><h3 id="2-实现一个带有简单逻辑判断及多种数学运算的Solidity程序"><a href="#2-实现一个带有简单逻辑判断及多种数学运算的Solidity程序" class="headerlink" title="2 实现一个带有简单逻辑判断及多种数学运算的Solidity程序"></a>2 实现一个带有简单逻辑判断及多种数学运算的Solidity程序</h3><pre class="line-numbers language-js" data-language="js"><code class="language-js">pragma solidity <span class="token operator">^</span><span class="token number">0.4</span><span class="token number">.0</span><span class="token punctuation">;</span>contract calculate<span class="token punctuation">{</span>    uint x<span class="token punctuation">;</span>    uint y<span class="token punctuation">;</span>        <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">public</span> <span class="token punctuation">{</span>        x <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span>        y <span class="token operator">=</span> <span class="token number">50</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>     modifier <span class="token function">xgreatery</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>         <span class="token function">require</span><span class="token punctuation">(</span>x<span class="token operator">&gt;</span>y<span class="token punctuation">,</span> <span class="token string">"x is less than y"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>         _<span class="token punctuation">;</span>     <span class="token punctuation">}</span>     <span class="token keyword">function</span> <span class="token function">more</span><span class="token punctuation">(</span><span class="token parameter">uint a<span class="token punctuation">,</span>uint b</span><span class="token punctuation">)</span> <span class="token keyword">public</span> <span class="token function">xgreatery</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token function">returns</span><span class="token punctuation">(</span><span class="token parameter">uint</span><span class="token punctuation">)</span><span class="token punctuation">{</span>         x <span class="token operator">=</span> a<span class="token punctuation">;</span>         y <span class="token operator">=</span> b<span class="token punctuation">;</span>         <span class="token keyword">return</span> x<span class="token operator">-</span>y<span class="token punctuation">;</span>     <span class="token punctuation">}</span>     <span class="token keyword">function</span> <span class="token function">multiply</span><span class="token punctuation">(</span><span class="token parameter">uint a<span class="token punctuation">,</span> uint b</span><span class="token punctuation">)</span> <span class="token keyword">public</span> pure <span class="token function">returns</span><span class="token punctuation">(</span><span class="token parameter">uint</span><span class="token punctuation">)</span><span class="token punctuation">{</span>         <span class="token keyword">return</span> a<span class="token operator">*</span>b<span class="token punctuation">;</span>     <span class="token punctuation">}</span>     <span class="token keyword">function</span> <span class="token function">divide</span><span class="token punctuation">(</span><span class="token parameter">uint a<span class="token punctuation">,</span> uint b</span><span class="token punctuation">)</span> <span class="token keyword">public</span> pure <span class="token function">returns</span><span class="token punctuation">(</span><span class="token parameter">uint</span><span class="token punctuation">)</span><span class="token punctuation">{</span>         <span class="token keyword">return</span> a<span class="token operator">/</span>b<span class="token punctuation">;</span>     <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="/2021/03/20/task2-solidity-ji-chu/calsulate.png" alt=""></p><h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><p><a href="https://www.youtube.com/playlist?list=PLHmOMPRfmOxSJcrlwyandWYiuP9ZAMYoF">Smart Contract 實戰教學 (Solidity 30 Days)</a><a href="https://www.youtube.com/watch?v=z2FEikbDqoA&amp;list=PLHmOMPRfmOxSJcrlwyandWYiuP9ZAMYoF">全部播放</a></p><p><a href="https://www.youtube.com/playlist?list=PLHmOMPRfmOxQ3HSlId8KAKxnt8yuyTZVk">Smart Contract 實戰教學 2020</a><a href="https://www.youtube.com/watch?v=l6xmGVweJyk&amp;list=PLHmOMPRfmOxQ3HSlId8KAKxnt8yuyTZVk">全部播放</a></p><p><a href="https://www.codetd.com/article/11134968">以太坊solidity学习记录（三）基础数据操作</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> DataWhale </tag>
            
            <tag> Blockchain </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hexo-OpenSSL SSL_connect: Connection was reset in connection to github.com:443</title>
      <link href="2021/03/19/hexo-openssl-ssl-connect-connection-was-reset-in-connection-to-github-com-443/"/>
      <url>2021/03/19/hexo-openssl-ssl-connect-connection-was-reset-in-connection-to-github-com-443/</url>
      
        <content type="html"><![CDATA[<h1 id="OpenSSL-SSL-connect-Connection-was-reset-in-connection-to-github-com-443"><a href="#OpenSSL-SSL-connect-Connection-was-reset-in-connection-to-github-com-443" class="headerlink" title="OpenSSL SSL_connect: Connection was reset in connection to github.com:443"></a>OpenSSL SSL_connect: Connection was reset in connection to github.com:443</h1><p>这两天上传写好的 Github 博客，<code>hexo d</code> 部署的时候总是遇到问题，这里记录一下：</p><h2 id="报错信息"><a href="#报错信息" class="headerlink" title="报错信息"></a>报错信息</h2><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"><span class="token punctuation">[</span>master 6cc1073<span class="token punctuation">]</span> Site updated: <span class="token number">2021</span>-03-19 <span class="token number">21</span>:46:59 <span class="token number">26</span> files changed, <span class="token number">285</span> insertions<span class="token punctuation">(</span>+<span class="token punctuation">)</span>, <span class="token number">285</span> deletions<span class="token punctuation">(</span>-<span class="token punctuation">)</span>fatal: unable to access <span class="token string">'https://github.com/terence1023/terence1023.github.io.git/'</span><span class="token builtin class-name">:</span> OpenSSL SSL_connect: Connection was reset <span class="token keyword">in</span> connection to github.com:443FATAL <span class="token punctuation">{</span>  err: Error: Spawn failed      at ChildProcess.<span class="token operator">&lt;</span>anonymous<span class="token operator">&gt;</span> <span class="token punctuation">(</span>D:<span class="token punctuation">\</span>GitHubBlog<span class="token punctuation">\</span>blog<span class="token punctuation">\</span>node_modules<span class="token punctuation">\</span>hexo-deployer-git<span class="token punctuation">\</span>node_modules<span class="token punctuation">\</span>hexo-util<span class="token punctuation">\</span>lib<span class="token punctuation">\</span>spawn.js:51:21<span class="token punctuation">)</span>      at ChildProcess.emit <span class="token punctuation">(</span>node:events:376:20<span class="token punctuation">)</span>      at ChildProcess.cp.emit <span class="token punctuation">(</span>D:<span class="token punctuation">\</span>GitHubBlog<span class="token punctuation">\</span>blog<span class="token punctuation">\</span>node_modules<span class="token punctuation">\</span>cross-spawn<span class="token punctuation">\</span>lib<span class="token punctuation">\</span>enoent.js:34:29<span class="token punctuation">)</span>      at Process.ChildProcess._handle.onexit <span class="token punctuation">(</span>node:internal/child_process:277:12<span class="token punctuation">)</span> <span class="token punctuation">{</span>    code: <span class="token number">128</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span> Something's wrong. Maybe you can <span class="token function">find</span> the solution here: %s https://hexo.io/docs/troubleshooting.html<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="解决方案一："><a href="#解决方案一：" class="headerlink" title="解决方案一："></a>解决方案一：</h2><p>配置 git 的代理</p><blockquote><p>git config —global http.proxy “127.0.0.1:1080”<br>git config —global https.proxy “127.0.0.1:1080”</p></blockquote><p>这里，梯子要始终开着，这个方法昨天还可以，今天就不行了。</p><h2 id="解决方案二："><a href="#解决方案二：" class="headerlink" title="解决方案二："></a>解决方案二：</h2><p>关于SSL，主流的解决办法是把SSL验证设为false：</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">git</span> config --global http.sslVerify <span class="token string">"false"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>(如果还有问题，就接着更新，以上解决方案均是在梯子开着的情况下操作</p><p>没救了，这篇还没 <code>hexo d</code> 上去就要接着修改了</p><h2 id="解决方案三："><a href="#解决方案三：" class="headerlink" title="解决方案三："></a>解决方案三：</h2><h3 id="1-使用-hexo-v-查看版本信息"><a href="#1-使用-hexo-v-查看版本信息" class="headerlink" title="1. 使用 hexo v 查看版本信息"></a>1. 使用 <code>hexo v</code> 查看版本信息</h3><pre class="line-numbers language-none"><code class="language-none">PS C:\Users\Administrator&gt; hexo vhexo-cli: 4.2.0os: Windows_NT 10.0.19042 win32 x64node: 15.3.0v8: 8.6.395.17-node.22uv: 1.40.0zlib: 1.2.11brotli: 1.0.9ares: 1.16.1modules: 88nghttp2: 1.41.0napi: 7llhttp: 2.1.3openssl: 1.1.1gcldr: 37.0icu: 67.1tz: 2020aunicode: 13.0<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>现在来到你的博客所在的文件夹根目录中打开 <code>_config.yml</code> 文件</p></blockquote><h3 id="2-查看原始的-deploy"><a href="#2-查看原始的-deploy" class="headerlink" title="2. 查看原始的 [deploy]"></a>2. 查看原始的 [deploy]</h3><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"><span class="token comment"># Deployment</span><span class="token comment">## Docs: https://hexo.io/docs/one-command-deployment</span>deploy:  type: <span class="token function">git</span>  repo: https://github.com/terence1023/terence1023.github.io.git  branch: main<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="3-因为-Hexo-版本更新，我们需要修改这个文件，修改后"><a href="#3-因为-Hexo-版本更新，我们需要修改这个文件，修改后" class="headerlink" title="3. 因为 Hexo 版本更新，我们需要修改这个文件，修改后"></a>3. 因为 Hexo 版本更新，我们需要修改这个文件，修改后</h3><pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"><span class="token comment"># Deployment</span><span class="token comment">## Docs: https://hexo.io/docs/one-command-deployment</span>deploy:  type: <span class="token function">git</span>  <span class="token comment"># repo: https://github.com/terence1023/terence1023.github.io.git</span>  repo: git@github.com:terence1023/terence1023.github.io.git  branch: main<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><blockquote><p>再次去执行 <code>hexo d</code> 就可以了</p></blockquote><h2 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h2><ul><li><p><a href="https://www.zhihu.com/question/48776427/answer/908435145">Failed to connect to github.com port 443: Operatio？</a></p></li><li><p><a href="https://blog.csdn.net/longroad1216/article/details/114853527">Hexo+github搭建博客的错误：连接超时port 443: Timed out和OpenSSL错误</a></p></li><li><p><a href="https://suxiexingchen.github.io/2020/03/13/34/">hexo g报错Please make sure you have the correct access rights解决[No.034]</a></p></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> debug </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>简单分享</title>
      <link href="2021/03/19/jian-dan-fen-xiang/"/>
      <url>2021/03/19/jian-dan-fen-xiang/</url>
      
        <content type="html"><![CDATA[<h1 id="XBW"><a href="#XBW" class="headerlink" title="XBW"></a>XBW</h1><h2 id="分享一句话"><a href="#分享一句话" class="headerlink" title="分享一句话"></a>分享一句话</h2><font face="微软雅黑" size="4">你我都是内卷背景下不起眼的尘埃，被时代的洪流裹挟向前。</font><h2 id="个人失败历史"><a href="#个人失败历史" class="headerlink" title="个人失败历史"></a>个人失败历史</h2><p>入学以来大一参加计算机设计大赛失败。<span class="github-emoji"><span>😟</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/1f61f.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span><br>入学以后第一场考试以及后面无数考试失利。<span class="github-emoji"><span>😩</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/1f629.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span><br>大一参加校内数学建模新生杯惨败。<span class="github-emoji"><span>😞</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/1f61e.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span><br>大一参加华中赛数学建模无功而返。<span class="github-emoji"><span>😑</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/1f611.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span><br>大一参加互联网+因特殊原因退出。<span class="github-emoji"><span>😔</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/1f614.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span><br>……<br>大二开始接触DataFountain竞赛，一直徘徊在复赛圈，与决赛无缘。<br>开始学习acm算法，在各种比赛中被吊打。<br>开始学习一些简单的开发，但是没有完整做出一款属于自己的开发的应用。<br>大二参加华为软件精英挑战赛，被数据漏洞坑害（参赛经验不足，获取比赛信息时效性低），赛区64强止步。<br>大二参加全国k-code程序设计大赛，止步21名，倒在决赛圈（前二十名）门口。<br>参加MathorCup成功参赛。<br>大二暑期建模培训最终选拔全校第七名，特殊原因被淘汰。<br>……<br>大三参加天池Redis数据库中间件挑战赛止步决赛。<br>……<br>还有很多自己以及以往的失败历史。</p><h2 id="未来准备参加的比赛"><a href="#未来准备参加的比赛" class="headerlink" title="未来准备参加的比赛"></a>未来准备参加的比赛</h2><p>美赛成绩未出<br>继续准备参加计算机设计大赛、华为软件精英挑战赛、等之类的其他比赛。</p><h2 id="xbwcj的数学建模比赛的准备"><a href="#xbwcj的数学建模比赛的准备" class="headerlink" title="xbwcj的数学建模比赛的准备"></a>xbwcj的数学建模比赛的准备</h2><p>1、提高自己的编程能力，编程能力的提升是在平时就要锻炼的，平时写代码的时候不要马虎应付，多看博客等其他网站上的一些常用算法与伪代码，最重要的是了解算法的思维，严谨的思维+超强的编程能力才能轻松应对数模中的编程。<br>2、强烈推荐去看司守奎的《数学建模算法与应用》这本书，学习上面的一些比较常见的算法，自己一定要手动实现一次，自己不手动实现，就很难理解里面的编程思维。<br>3、多去准备一些比较新的智能优化算法，推荐公众号：数学算法实验室、智能优化算法。尝试自己改进一些算法，将这些算法做成接口的形式，在使用时只需要传参就可以。准备一些可以做出精美图片的数据分析的软件，例如Oracle提供的Data Visualization Desktop的软件，也可以使用Office的PPT功能。熟练使用可以在比赛过程中省时省力。或者准备一些Matlab或者Python的作图代码，例如简单的条形图、折线图、雷达图等，或者高级点的词云之类的，也以接口的形式封装。<br>4、如何上手？一定一定要自己独自去完成一次数模的全部流程，了解每个步骤应该做什么如何去做。只有全部接触才能知道自己的优势以及劣势，了解自己应该找什么样的队友来取长补短。<br>5、暑期培训前的准备：2020年由于疫情的原因，选拔赛是以组队的形式直接做题来选拔。在暑期培训前无论是校赛还是校外的数模比赛中，都可以自己去找队友，因此最好在暑期选拔培训前就确定好自己的队友，尽早开始磨合，利用其他的数模比赛找到队伍的不足，这样可以在选拔赛中发挥的更好一些。校外的数模比赛建议参加：华中赛、泰迪杯、数维杯、深圳杯、亚太赛。（挑选其中几个即可）</p><h2 id="xbwcj的校外比赛经验"><a href="#xbwcj的校外比赛经验" class="headerlink" title="xbwcj的校外比赛经验"></a>xbwcj的校外比赛经验</h2><p>推荐几个我经常浪荡的比赛网站：<br><a href="https://tianchi.aliyun.com/competition/gameList/activeList">天池</a>、<a href="https://competition.huaweicloud.com/competitions">华为云</a>、<br><a href="https://www.datafountain.cn/competitions">DataFountain</a>、<a href="https://www.kaggle.com/competitions">kaggle</a>、<br>这些比赛有奖金，并且你会学习到很多平时在课堂里面学不到的知识技能。刚开始得奖会比较难，因为这些比赛中参加的不只是本科生，一般是面向所有在校学生，而且硕士生所占比例不低，所以开始大家可以去涨经验，后面能到何种地步就看大家自己的发挥了。<span class="github-emoji"><span>🐶</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/1f436.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span><span class="github-emoji"><span>🐶</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/1f436.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span><span class="github-emoji"><span>🐶</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/1f436.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span><br>如果想要提高自己的编程能力：<br><a href="https://ac.nowcoder.com/acm/problem/list">牛客</a>、<a href="https://www.luogu.com.cn/problem/list">洛谷</a>、<a href="http://acm.hdu.edu.cn/">hduOJ</a>、<a href="https://codeforces.com/problemset">CodeForces</a>、<a href="https://nanti.jisuanke.com/acm">计蒜客</a>。<br>去刷里面的题目，如果不是专门去训练acm，不需要去做太难的，达到中等就可以应付绝大多数公司的绝大多数笔试题了。也可以帮助你了解比较重要的基础算法。</p><h2 id="xbwcj个人大学总结经验（其实是自己的不足与后悔之处）"><a href="#xbwcj个人大学总结经验（其实是自己的不足与后悔之处）" class="headerlink" title="xbwcj个人大学总结经验（其实是自己的不足与后悔之处）"></a>xbwcj个人大学总结经验（其实是自己的不足与后悔之处）</h2><p>1、一定要尽早规划，自己以后是找工作还是要读研，读研的话，是准备考研，还是A、B保，如果保研自己还欠缺什么，尽早做打算。<br>2、精心，静心去做一件事，贪多嚼不烂。<br>3、无论做什么，基础一定要扎实。</p><h1 id="Terence"><a href="#Terence" class="headerlink" title="Terence"></a>Terence</h1><h2 id="最近做的事"><a href="#最近做的事" class="headerlink" title="最近做的事"></a>最近做的事</h2><ul><li><p>和好朋友一起参加  <code>DataWhale</code> 三月份的组队学习（推荐系统和区块链方面）</p></li><li><p>学习英语和编程</p></li><li><p>准备了解一下多模态这个领域，也顺便考虑一下自己以后的研究方向，准备读研也不得不面对这个问题，以后要做什么？</p></li></ul><p>就以这个 <code>以后要做什么？</code> 题简单跟大家分享下</p><h2 id="以后要做什么？"><a href="#以后要做什么？" class="headerlink" title="以后要做什么？"></a>以后要做什么？</h2><p>留给我们的选择其实不多，读研 or 就业</p><p>读研</p><ul><li>绩点要稳住（大数据专业绝大部分专业必修都在前两年）走 A 保</li><li>比赛拿奖项走 B 保</li></ul><p>科研</p><ul><li>理论研究</li><li>数据挖掘</li><li>机器学习</li><li>NLP（自然语言处理）</li><li>CV（计算机视觉）</li><li>多模态</li></ul><p>职业</p><ul><li><p>数据科学家</p></li><li><p>数据分析师</p></li><li><p>算法工程师</p></li></ul><h2 id="参加的比赛"><a href="#参加的比赛" class="headerlink" title="参加的比赛"></a>参加的比赛</h2><ul><li>华中地区大学生数学建模邀请赛省赛</li><li>华为大学生ICT大赛湖北区域省赛</li><li>全国大学生数学建模省赛</li><li>美国大学生数学建模大赛国赛</li><li>全国大学生节能减排国赛</li><li>中国大学生计算机设计大赛国赛</li><li>中国大学生服务外包创新创业大赛国赛</li><li>Kaggle、天池、腾讯广告…</li></ul><h2 id="数学建模"><a href="#数学建模" class="headerlink" title="数学建模"></a>数学建模</h2><p>讲下数学建模，其实刚才雯雯也说了很多，也非常详细，跟我观点也蛮吻合的。有一个观点，就是在咱们学校成功进入校队，参加国赛和美赛，不是一件容易的事情。确实它收益很大，每一年都有很多同学通过数学建模成功保研。并不是很推荐大家去很功利地做一件事情，数模带给我们的不仅仅是一个保研的资格或者说门票，更多的是带来一种能力。</p><ul><li>分析问题，将实际问题建立数学模型的能力</li><li>解决问题，运用自己所学去求解模型的能力</li><li>撰写科技论文的能力</li><li>团队配合</li></ul><p>2019年数学建模选拔形式（具体细节可以在教务处官网查询）</p><ul><li><p>编程：开卷、不限语言（主要是 Matlab ）对 8 个题目进行求解，求解问题大多是线性方程、0-1背包、最优化、智能算法以及开放题。最终按成绩排名。</p></li><li><p>建模：这个我就不太清楚了</p></li></ul><h2 id="其他比赛"><a href="#其他比赛" class="headerlink" title="其他比赛"></a>其他比赛</h2><ul><li>ACM</li><li><p><a href="http://i.whut.edu.cn/xxtg/znbm/jwc/202103/t20210317_484335.shtml">【教务处】关于组织参加 “2021 年（第14届）中国大学生计算机设计大赛”的通知</a></p></li><li><p><a href="http://i.whut.edu.cn/xxtg/znbm/jwc/202103/t20210304_483136.shtml">【教务处】关于组织参加第十二届中国大学生服务外包创新创业大赛的通知</a></p></li><li><p><a href="http://i.whut.edu.cn/xxtg/znbm/jwc/202103/t20210304_483133.shtml">【教务处】关于举办“2021年中国高校计算机大赛-团体程序设计天梯赛”校内选拔赛的通知</a></p></li></ul><p>怎么说，不断去接触去尝试才会有更多可能。你说比赛它难不难，要想拿到好名次确实很难，没有一帆风顺的路，当你觉得自己真的真的真的快撑不下去的时候，那就别撑了，我们又不是把伞，老撑着干嘛？</p><h2 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h2><p>找到自己喜欢的事情，然后坚持下去就好了。如果有一件事（限学业方面），能够让你忘记时间地投入进去，那就是足够热爱的事情啦！</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Task2 Wide&amp;Deep</title>
      <link href="2021/03/18/task2-wide-deep/"/>
      <url>2021/03/18/task2-wide-deep/</url>
      
        <content type="html"><![CDATA[<h1 id="Wide-amp-Deep"><a href="#Wide-amp-Deep" class="headerlink" title="Wide&amp;Deep"></a>Wide&amp;Deep</h1><ul><li>该文主要记录<a href="https://github.com/datawhalechina/team-learning-rs/tree/master/DeepRecommendationModel"><code>深度推荐模型|DataWhale</code></a>Task2 Wide&amp;Deep 内容</li></ul><p>Wide &amp; Deep 模型的核心思想是结合线性模型的记忆能力和 DNN 模型的泛化能力，从而提升整体模型性能。根据论文<a href="https://arxiv.org/abs/1606.07792">Wide &amp; Deep Learning for Recommender System</a>描述，Wide &amp; Deep 已成功应用在 Google Play 的app推荐业务。</p><p><strong>网络结构</strong></p><p>Wide &amp; Deep 模型的核心思想是结合线性模型的记忆能力（memorization）和 DNN 模型的泛化能力（generalization），在训练过程中同时优化 2 个模型的参数，从而达到整体模型的预测能力最优。</p><ul><li><p>记忆（memorization）即从历史数据中发现item或者特征之间的相关性。</p></li><li><p>泛化（generalization）即相关性的传递，发现在历史数据中很少或者没有出现的新的特征组合。</p></li></ul><p><img src="/2021/03/18/task2-wide-deep/image1.png" alt=""></p><p>WideDeep = LR + DNN</p><p><strong>推荐系统</strong></p><p><img src="/2021/03/18/task2-wide-deep/image2.png" alt=""></p><p>论文推荐系统流程举例：</p><ol><li>Query 召回 100 个相关的 items；<code>O(100) items</code></li><li>根据 Query + Items + User Actions 学习排序模型；</li><li>利用 2 的模型，对 1 中召回的 items 排序，将 top10 推荐给用户；</li></ol><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> warningswarnings<span class="token punctuation">.</span>filterwarnings<span class="token punctuation">(</span><span class="token string">"ignore"</span><span class="token punctuation">)</span><span class="token keyword">import</span> itertools<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np<span class="token keyword">from</span> tqdm <span class="token keyword">import</span> tqdm<span class="token keyword">from</span> collections <span class="token keyword">import</span> namedtuple<span class="token keyword">import</span> tensorflow <span class="token keyword">as</span> tf<span class="token keyword">from</span> tensorflow<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>layers <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> tensorflow<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>models <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>model_selection <span class="token keyword">import</span> train_test_split<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>preprocessing <span class="token keyword">import</span>  MinMaxScaler<span class="token punctuation">,</span> LabelEncoder<span class="token keyword">from</span> deepctr<span class="token punctuation">.</span>feature_column <span class="token keyword">import</span> SparseFeat<span class="token punctuation">,</span> DenseFeat<span class="token punctuation">,</span> VarLenSparseFeat<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 设置GPU显存使用，tensorflow不然会报错</span>gpus <span class="token operator">=</span> tf<span class="token punctuation">.</span>config<span class="token punctuation">.</span>experimental<span class="token punctuation">.</span>list_physical_devices<span class="token punctuation">(</span><span class="token string">'GPU'</span><span class="token punctuation">)</span><span class="token keyword">if</span> gpus<span class="token punctuation">:</span>    <span class="token keyword">try</span><span class="token punctuation">:</span>        <span class="token comment"># Currently, memory growth needs to be the same across GPUs</span>        <span class="token keyword">for</span> gpu <span class="token keyword">in</span> gpus<span class="token punctuation">:</span>            tf<span class="token punctuation">.</span>config<span class="token punctuation">.</span>experimental<span class="token punctuation">.</span>set_memory_growth<span class="token punctuation">(</span>gpu<span class="token punctuation">,</span> <span class="token boolean">True</span><span class="token punctuation">)</span>        logical_gpus <span class="token operator">=</span> tf<span class="token punctuation">.</span>config<span class="token punctuation">.</span>experimental<span class="token punctuation">.</span>list_logical_devices<span class="token punctuation">(</span><span class="token string">'GPU'</span><span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>gpus<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"Physical GPUs,"</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>logical_gpus<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"Logical GPUs"</span><span class="token punctuation">)</span>    <span class="token keyword">except</span> RuntimeError <span class="token keyword">as</span> e<span class="token punctuation">:</span>        <span class="token comment"># Memory growth must be set before GPUs have been initialized</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token number">1</span> Physical GPUs<span class="token punctuation">,</span> <span class="token number">1</span> Logical GPUs<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="1、Load-Dataset"><a href="#1、Load-Dataset" class="headerlink" title="1、Load Dataset"></a>1、Load Dataset</h2><pre class="line-numbers language-python" data-language="python"><code class="language-python">data <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">"../代码/data/criteo_sample.txt"</span><span class="token punctuation">)</span>columns <span class="token operator">=</span> data<span class="token punctuation">.</span>columns<span class="token punctuation">.</span>valuescolumns<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'label'</span><span class="token punctuation">,</span> <span class="token string">'I1'</span><span class="token punctuation">,</span> <span class="token string">'I2'</span><span class="token punctuation">,</span> <span class="token string">'I3'</span><span class="token punctuation">,</span> <span class="token string">'I4'</span><span class="token punctuation">,</span> <span class="token string">'I5'</span><span class="token punctuation">,</span> <span class="token string">'I6'</span><span class="token punctuation">,</span> <span class="token string">'I7'</span><span class="token punctuation">,</span> <span class="token string">'I8'</span><span class="token punctuation">,</span> <span class="token string">'I9'</span><span class="token punctuation">,</span>       <span class="token string">'I10'</span><span class="token punctuation">,</span> <span class="token string">'I11'</span><span class="token punctuation">,</span> <span class="token string">'I12'</span><span class="token punctuation">,</span> <span class="token string">'I13'</span><span class="token punctuation">,</span> <span class="token string">'C1'</span><span class="token punctuation">,</span> <span class="token string">'C2'</span><span class="token punctuation">,</span> <span class="token string">'C3'</span><span class="token punctuation">,</span> <span class="token string">'C4'</span><span class="token punctuation">,</span> <span class="token string">'C5'</span><span class="token punctuation">,</span> <span class="token string">'C6'</span><span class="token punctuation">,</span>       <span class="token string">'C7'</span><span class="token punctuation">,</span> <span class="token string">'C8'</span><span class="token punctuation">,</span> <span class="token string">'C9'</span><span class="token punctuation">,</span> <span class="token string">'C10'</span><span class="token punctuation">,</span> <span class="token string">'C11'</span><span class="token punctuation">,</span> <span class="token string">'C12'</span><span class="token punctuation">,</span> <span class="token string">'C13'</span><span class="token punctuation">,</span> <span class="token string">'C14'</span><span class="token punctuation">,</span> <span class="token string">'C15'</span><span class="token punctuation">,</span> <span class="token string">'C16'</span><span class="token punctuation">,</span>       <span class="token string">'C17'</span><span class="token punctuation">,</span> <span class="token string">'C18'</span><span class="token punctuation">,</span> <span class="token string">'C19'</span><span class="token punctuation">,</span> <span class="token string">'C20'</span><span class="token punctuation">,</span> <span class="token string">'C21'</span><span class="token punctuation">,</span> <span class="token string">'C22'</span><span class="token punctuation">,</span> <span class="token string">'C23'</span><span class="token punctuation">,</span> <span class="token string">'C24'</span><span class="token punctuation">,</span> <span class="token string">'C25'</span><span class="token punctuation">,</span>       <span class="token string">'C26'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span><span class="token builtin">object</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 划分dense和sparse特征</span>dense_features <span class="token operator">=</span> <span class="token punctuation">[</span>feat <span class="token keyword">for</span> feat <span class="token keyword">in</span> columns <span class="token keyword">if</span> <span class="token string">'I'</span> <span class="token keyword">in</span> feat<span class="token punctuation">]</span>sparse_features <span class="token operator">=</span> <span class="token punctuation">[</span>feat <span class="token keyword">for</span> feat <span class="token keyword">in</span> columns <span class="token keyword">if</span> <span class="token string">'C'</span> <span class="token keyword">in</span> feat<span class="token punctuation">]</span><span class="token keyword">print</span><span class="token punctuation">(</span>dense_features<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>sparse_features<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token punctuation">[</span><span class="token string">'I1'</span><span class="token punctuation">,</span> <span class="token string">'I2'</span><span class="token punctuation">,</span> <span class="token string">'I3'</span><span class="token punctuation">,</span> <span class="token string">'I4'</span><span class="token punctuation">,</span> <span class="token string">'I5'</span><span class="token punctuation">,</span> <span class="token string">'I6'</span><span class="token punctuation">,</span> <span class="token string">'I7'</span><span class="token punctuation">,</span> <span class="token string">'I8'</span><span class="token punctuation">,</span> <span class="token string">'I9'</span><span class="token punctuation">,</span> <span class="token string">'I10'</span><span class="token punctuation">,</span> <span class="token string">'I11'</span><span class="token punctuation">,</span> <span class="token string">'I12'</span><span class="token punctuation">,</span> <span class="token string">'I13'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'C1'</span><span class="token punctuation">,</span> <span class="token string">'C2'</span><span class="token punctuation">,</span> <span class="token string">'C3'</span><span class="token punctuation">,</span> <span class="token string">'C4'</span><span class="token punctuation">,</span> <span class="token string">'C5'</span><span class="token punctuation">,</span> <span class="token string">'C6'</span><span class="token punctuation">,</span> <span class="token string">'C7'</span><span class="token punctuation">,</span> <span class="token string">'C8'</span><span class="token punctuation">,</span> <span class="token string">'C9'</span><span class="token punctuation">,</span> <span class="token string">'C10'</span><span class="token punctuation">,</span> <span class="token string">'C11'</span><span class="token punctuation">,</span> <span class="token string">'C12'</span><span class="token punctuation">,</span> <span class="token string">'C13'</span><span class="token punctuation">,</span> <span class="token string">'C14'</span><span class="token punctuation">,</span> <span class="token string">'C15'</span><span class="token punctuation">,</span> <span class="token string">'C16'</span><span class="token punctuation">,</span> <span class="token string">'C17'</span><span class="token punctuation">,</span> <span class="token string">'C18'</span><span class="token punctuation">,</span> <span class="token string">'C19'</span><span class="token punctuation">,</span> <span class="token string">'C20'</span><span class="token punctuation">,</span> <span class="token string">'C21'</span><span class="token punctuation">,</span> <span class="token string">'C22'</span><span class="token punctuation">,</span> <span class="token string">'C23'</span><span class="token punctuation">,</span> <span class="token string">'C24'</span><span class="token punctuation">,</span> <span class="token string">'C25'</span><span class="token punctuation">,</span> <span class="token string">'C26'</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h2 id="2、Data-Process"><a href="#2、Data-Process" class="headerlink" title="2、Data Process"></a>2、Data Process</h2><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 简单处理特征，包括填充缺失值，数值处理，类别编码</span><span class="token keyword">def</span> <span class="token function">data_process</span><span class="token punctuation">(</span>data_df<span class="token punctuation">,</span> dense_features<span class="token punctuation">,</span> sparse_features<span class="token punctuation">)</span><span class="token punctuation">:</span>    data_df<span class="token punctuation">[</span>dense_features<span class="token punctuation">]</span> <span class="token operator">=</span> data_df<span class="token punctuation">[</span>dense_features<span class="token punctuation">]</span><span class="token punctuation">.</span>fillna<span class="token punctuation">(</span><span class="token number">0.0</span><span class="token punctuation">)</span>    <span class="token keyword">for</span> f <span class="token keyword">in</span> dense_features<span class="token punctuation">:</span>        data_df<span class="token punctuation">[</span>f<span class="token punctuation">]</span> <span class="token operator">=</span> data_df<span class="token punctuation">[</span>f<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> np<span class="token punctuation">.</span>log<span class="token punctuation">(</span>x<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">if</span> x <span class="token operator">&gt;</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token keyword">else</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>            data_df<span class="token punctuation">[</span>sparse_features<span class="token punctuation">]</span> <span class="token operator">=</span> data_df<span class="token punctuation">[</span>sparse_features<span class="token punctuation">]</span><span class="token punctuation">.</span>fillna<span class="token punctuation">(</span><span class="token string">"-1"</span><span class="token punctuation">)</span>    <span class="token keyword">for</span> f <span class="token keyword">in</span> sparse_features<span class="token punctuation">:</span>        lbe <span class="token operator">=</span> LabelEncoder<span class="token punctuation">(</span><span class="token punctuation">)</span>        data_df<span class="token punctuation">[</span>f<span class="token punctuation">]</span> <span class="token operator">=</span> lbe<span class="token punctuation">.</span>fit_transform<span class="token punctuation">(</span>data_df<span class="token punctuation">[</span>f<span class="token punctuation">]</span><span class="token punctuation">)</span>        <span class="token keyword">return</span> data_df<span class="token punctuation">[</span>dense_features <span class="token operator">+</span> sparse_features<span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 简单的数据预处理</span>train_data <span class="token operator">=</span> data_process<span class="token punctuation">(</span>data<span class="token punctuation">,</span> dense_features<span class="token punctuation">,</span> sparse_features<span class="token punctuation">)</span>train_data<span class="token punctuation">[</span><span class="token string">'label'</span><span class="token punctuation">]</span> <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token string">'label'</span><span class="token punctuation">]</span>train_data<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }    .dataframe tbody tr th {        vertical-align: top;    }    .dataframe thead th {        text-align: right;    }</style><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>I1</th>      <th>I2</th>      <th>I3</th>      <th>I4</th>      <th>I5</th>      <th>I6</th>      <th>I7</th>      <th>I8</th>      <th>I9</th>      <th>I10</th>      <th>...</th>      <th>C18</th>      <th>C19</th>      <th>C20</th>      <th>C21</th>      <th>C22</th>      <th>C23</th>      <th>C24</th>      <th>C25</th>      <th>C26</th>      <th>label</th>    </tr>  </thead>  <tbody>    <tr>      <th>0</th>      <td>0.0</td>      <td>1.386294</td>      <td>5.564520</td>      <td>0.000000</td>      <td>9.779567</td>      <td>0.000000</td>      <td>0.000000</td>      <td>3.526361</td>      <td>0.000000</td>      <td>0.0</td>      <td>...</td>      <td>66</td>      <td>0</td>      <td>0</td>      <td>3</td>      <td>0</td>      <td>1</td>      <td>96</td>      <td>0</td>      <td>0</td>      <td>0</td>    </tr>    <tr>      <th>1</th>      <td>0.0</td>      <td>-1.000000</td>      <td>2.995732</td>      <td>3.583519</td>      <td>10.317318</td>      <td>5.513429</td>      <td>0.693147</td>      <td>3.583519</td>      <td>5.081404</td>      <td>0.0</td>      <td>...</td>      <td>52</td>      <td>0</td>      <td>0</td>      <td>47</td>      <td>0</td>      <td>7</td>      <td>112</td>      <td>0</td>      <td>0</td>      <td>0</td>    </tr>    <tr>      <th>2</th>      <td>0.0</td>      <td>0.000000</td>      <td>1.098612</td>      <td>2.564949</td>      <td>7.607878</td>      <td>5.105945</td>      <td>1.945910</td>      <td>3.583519</td>      <td>6.261492</td>      <td>0.0</td>      <td>...</td>      <td>49</td>      <td>0</td>      <td>0</td>      <td>25</td>      <td>0</td>      <td>6</td>      <td>53</td>      <td>0</td>      <td>0</td>      <td>0</td>    </tr>    <tr>      <th>3</th>      <td>0.0</td>      <td>2.639057</td>      <td>0.693147</td>      <td>1.609438</td>      <td>9.731334</td>      <td>5.303305</td>      <td>1.791759</td>      <td>1.609438</td>      <td>3.401197</td>      <td>0.0</td>      <td>...</td>      <td>37</td>      <td>0</td>      <td>0</td>      <td>156</td>      <td>0</td>      <td>0</td>      <td>32</td>      <td>0</td>      <td>0</td>      <td>0</td>    </tr>    <tr>      <th>4</th>      <td>0.0</td>      <td>0.000000</td>      <td>4.653960</td>      <td>3.332205</td>      <td>7.596392</td>      <td>4.962845</td>      <td>1.609438</td>      <td>3.496508</td>      <td>3.637586</td>      <td>0.0</td>      <td>...</td>      <td>14</td>      <td>5</td>      <td>3</td>      <td>9</td>      <td>0</td>      <td>0</td>      <td>5</td>      <td>1</td>      <td>47</td>      <td>0</td>    </tr>  </tbody></table><p>5 rows × 40 columns</p></div><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 与 DeepCrossing 处理方式一致，这里是分成 Linear 和 DNN 两部分</span>linear_feature_columns <span class="token operator">=</span> <span class="token punctuation">[</span>    SparseFeat<span class="token punctuation">(</span>feat<span class="token punctuation">,</span> vocabulary_size<span class="token operator">=</span>data<span class="token punctuation">[</span>feat<span class="token punctuation">]</span><span class="token punctuation">.</span>nunique<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>embedding_dim<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">)</span>    <span class="token keyword">for</span> i<span class="token punctuation">,</span>feat <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>sparse_features<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token punctuation">[</span>    DenseFeat<span class="token punctuation">(</span>feat<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">for</span> feat <span class="token keyword">in</span> dense_features<span class="token punctuation">]</span>linear_feature_columns<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token builtin">len</span><span class="token punctuation">(</span>linear_feature_columns<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token punctuation">(</span>SparseFeat<span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">'C1'</span><span class="token punctuation">,</span> vocabulary_size<span class="token operator">=</span><span class="token number">27</span><span class="token punctuation">,</span> embedding_dim<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span> use_hash<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span><span class="token string">'int32'</span><span class="token punctuation">,</span> embeddings_initializer<span class="token operator">=</span><span class="token operator">&lt;</span>tensorflow<span class="token punctuation">.</span>python<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>initializers<span class="token punctuation">.</span>initializers_v1<span class="token punctuation">.</span>RandomNormal <span class="token builtin">object</span> at <span class="token number">0x0000022F91F17850</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> embedding_name<span class="token operator">=</span><span class="token string">'C1'</span><span class="token punctuation">,</span> group_name<span class="token operator">=</span><span class="token string">'default_group'</span><span class="token punctuation">,</span> trainable<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">39</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">dnn_feature_columns <span class="token operator">=</span> <span class="token punctuation">[</span>    SparseFeat<span class="token punctuation">(</span>feat<span class="token punctuation">,</span> vocabulary_size<span class="token operator">=</span>data<span class="token punctuation">[</span>feat<span class="token punctuation">]</span><span class="token punctuation">.</span>nunique<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>embedding_dim<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">)</span>    <span class="token keyword">for</span> i<span class="token punctuation">,</span>feat <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>sparse_features<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token punctuation">[</span>    DenseFeat<span class="token punctuation">(</span>feat<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">for</span> feat <span class="token keyword">in</span> dense_features<span class="token punctuation">]</span>dnn_feature_columns<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token builtin">len</span><span class="token punctuation">(</span>dnn_feature_columns<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token punctuation">(</span>SparseFeat<span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">'C1'</span><span class="token punctuation">,</span> vocabulary_size<span class="token operator">=</span><span class="token number">27</span><span class="token punctuation">,</span> embedding_dim<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span> use_hash<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span><span class="token string">'int32'</span><span class="token punctuation">,</span> embeddings_initializer<span class="token operator">=</span><span class="token operator">&lt;</span>tensorflow<span class="token punctuation">.</span>python<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>initializers<span class="token punctuation">.</span>initializers_v1<span class="token punctuation">.</span>RandomNormal <span class="token builtin">object</span> at <span class="token number">0x0000022F91A1BD90</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> embedding_name<span class="token operator">=</span><span class="token string">'C1'</span><span class="token punctuation">,</span> group_name<span class="token operator">=</span><span class="token string">'default_group'</span><span class="token punctuation">,</span> trainable<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">39</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h2 id="3、模型原理"><a href="#3、模型原理" class="headerlink" title="3、模型原理"></a>3、模型原理</h2><h3 id="3-1-The-Wide-Component"><a href="#3-1-The-Wide-Component" class="headerlink" title="3.1 The Wide Component"></a>3.1 <strong>The Wide Component</strong></h3><p>wide部分是一个广义的线性模型，输入的特征主要有两部分组成，一部分是原始的部分特征，另一部分是原始特征的交叉特征(cross-product transformation)，对于交互特征可以定义为：</p><script type="math/tex; mode=display">\phi_{k}(x)=\prod_{i=1}^d x_i^{c_{ki}}, c_{ki}\in \{0,1\}</script><p>$c_{ki}$是一个布尔变量，当第i个特征属于第k个特征组合时，$c_{ki}$的值为1，否则为0，$x_i$是第i个特征的值，大体意思就是两个特征都同时为1这个新的特征才能为1，否则就是0。交叉特征可以理解为任意两个特征的乘积，等同于一个特征组合。</p><h3 id="3-2-The-Deep-Component"><a href="#3-2-The-Deep-Component" class="headerlink" title="3.2 The Deep Component"></a>3.2 <strong>The Deep Component</strong></h3><p>Deep部分是一个DNN模型，输入的特征主要分为两大类，一类是数值特征(可直接输入DNN)，一类是类别特征(需要经过Embedding之后才能输入到DNN中)，Deep部分的数学形式如下：</p><script type="math/tex; mode=display">  a^{(l+1)} = f(W^{l}a^{(l)} + b^{l})</script><p><strong>我们知道DNN模型随着层数的增加，中间的特征就越抽象，也就提高了模型的泛化能力。</strong>对于Deep部分的DNN模型作者使用了深度学习常用的优化器AdaGrad，这也是为了使得模型可以得到更精确的解。</p><h3 id="3-3-joint-training"><a href="#3-3-joint-training" class="headerlink" title="3.3 joint training"></a>3.3 <strong>joint training</strong></h3><p>联合训练（Joint Training）和集成（Ensemble）是不同的，集成是每个模型单独训练，再将模型的结果汇合。相比联合训练，集成的每个独立模型都得学得足够好才有利于随后的汇合，因此每个模型的model size也相对更大。而联合训练的wide部分只需要作一小部分的特征叉乘来弥补deep部分的不足，不需要 一个full-size 的wide 模型。</p><p><img src="/2021/03/18/task2-wide-deep/image3.png" alt=""></p><p>W&amp;D模型是将两部分输出的结果结合起来联合训练，将deep和wide部分的输出重新使用一个逻辑回归模型做最终的预测，输出概率值。联合训练的数学形式如下：<strong>需要注意的是，因为Wide侧的数据是高维稀疏的，所以作者使用了FTRL算法优化，而Deep侧使用的是 Adagrad。</strong></p><script type="math/tex; mode=display">P(Y=1|x)=\delta(w_{wide}^T[x,\phi(x)] + w_{deep}^T a^{(lf)} + b)</script><p>在论文中，作者通过梯度的反向传播，使用 mini-batch stochastic optimization 训练参数，并对wide部分使用带L1正则的Follow- the-regularized-leader (FTRL) 算法，对deep部分使用 AdaGrad算法。</p><h2 id="4、Wide-amp-Deep-model-build"><a href="#4、Wide-amp-Deep-model-build" class="headerlink" title="4、Wide&amp;Deep model build"></a>4、Wide&amp;Deep model build</h2><h3 id="4-1-Input-Layers"><a href="#4-1-Input-Layers" class="headerlink" title="4.1 Input Layers"></a>4.1 Input Layers</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">build_input_layers</span><span class="token punctuation">(</span>feature_columns<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token comment"># 构建Input层字典，并以dense和sparse两类字典的形式返回</span>    dense_input_dict<span class="token punctuation">,</span> sparse_input_dict <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>    <span class="token keyword">for</span> fc <span class="token keyword">in</span> feature_columns<span class="token punctuation">:</span>        <span class="token keyword">if</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>fc<span class="token punctuation">,</span> SparseFeat<span class="token punctuation">)</span><span class="token punctuation">:</span>            sparse_input_dict<span class="token punctuation">[</span>fc<span class="token punctuation">.</span>name<span class="token punctuation">]</span> <span class="token operator">=</span> Input<span class="token punctuation">(</span>shape<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token punctuation">)</span><span class="token punctuation">,</span> name<span class="token operator">=</span>fc<span class="token punctuation">.</span>name<span class="token punctuation">)</span>        <span class="token keyword">elif</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>fc<span class="token punctuation">,</span> DenseFeat<span class="token punctuation">)</span><span class="token punctuation">:</span>            dense_input_dict<span class="token punctuation">[</span>fc<span class="token punctuation">.</span>name<span class="token punctuation">]</span> <span class="token operator">=</span> Input<span class="token punctuation">(</span>shape<span class="token operator">=</span><span class="token punctuation">(</span>fc<span class="token punctuation">.</span>dimension<span class="token punctuation">,</span> <span class="token punctuation">)</span><span class="token punctuation">,</span> name<span class="token operator">=</span>fc<span class="token punctuation">.</span>name<span class="token punctuation">)</span>            <span class="token keyword">return</span> dense_input_dict<span class="token punctuation">,</span> sparse_input_dict<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 同样使用字典输入方式,方便后续构建模型</span><span class="token comment"># 这里为什么传入 linear + dnn，结果和单独传入相同</span><span class="token comment"># 是因为前一步 linear ＆ dnn 特征选择不同？但是这样依旧将 linear 和 dnn 进行了融合，没有区分</span>dense_input_dict<span class="token punctuation">,</span> sparse_input_dict <span class="token operator">=</span> build_input_layers<span class="token punctuation">(</span>linear_feature_columns <span class="token operator">+</span> dnn_feature_columns<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>dense_input_dict<span class="token punctuation">[</span><span class="token string">"I1"</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token builtin">len</span><span class="token punctuation">(</span>dense_input_dict<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token builtin">type</span><span class="token punctuation">(</span>dense_input_dict<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>sparse_input_dict<span class="token punctuation">[</span><span class="token string">"C1"</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token builtin">len</span><span class="token punctuation">(</span>sparse_input_dict<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token builtin">type</span><span class="token punctuation">(</span>sparse_input_dict<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">KerasTensor<span class="token punctuation">(</span>type_spec<span class="token operator">=</span>TensorSpec<span class="token punctuation">(</span>shape<span class="token operator">=</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span>tf<span class="token punctuation">.</span>float32<span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">'I1'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">'I1'</span><span class="token punctuation">,</span> description<span class="token operator">=</span><span class="token string">"created by layer 'I1'"</span><span class="token punctuation">)</span> <span class="token number">13</span> <span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token string">'dict'</span><span class="token operator">&gt;</span>KerasTensor<span class="token punctuation">(</span>type_spec<span class="token operator">=</span>TensorSpec<span class="token punctuation">(</span>shape<span class="token operator">=</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span>tf<span class="token punctuation">.</span>float32<span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">'C1'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">'C1'</span><span class="token punctuation">,</span> description<span class="token operator">=</span><span class="token string">"created by layer 'C1'"</span><span class="token punctuation">)</span> <span class="token number">26</span> <span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token string">'dict'</span><span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 构建模型的输入层，模型的输入层不能是字典的形式，应该将字典的形式转换成列表的形式</span><span class="token comment"># 注意：这里实际的输入与Input()层的对应，是通过模型输入时候的字典数据的key与对应name的Input层</span>input_layers <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>dense_input_dict<span class="token punctuation">.</span>values<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token builtin">list</span><span class="token punctuation">(</span>sparse_input_dict<span class="token punctuation">.</span>values<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>input_layers<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token builtin">len</span><span class="token punctuation">(</span>input_layers<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token builtin">type</span><span class="token punctuation">(</span>input_layers<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token punctuation">(</span><span class="token operator">&lt;</span>KerasTensor<span class="token punctuation">:</span> shape<span class="token operator">=</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> dtype<span class="token operator">=</span>float32 <span class="token punctuation">(</span>created by layer <span class="token string">'I1'</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> <span class="token number">39</span><span class="token punctuation">,</span> <span class="token builtin">list</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">build_embedding_layers</span><span class="token punctuation">(</span>feature_columns<span class="token punctuation">,</span> input_layers_dict<span class="token punctuation">,</span> is_linear<span class="token punctuation">)</span><span class="token punctuation">:</span>        embedding_layers_dict <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token punctuation">)</span>        sparse_feature_columns <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">filter</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> SparseFeat<span class="token punctuation">)</span><span class="token punctuation">,</span> feature_columns<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">if</span> feature_columns <span class="token keyword">else</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>        <span class="token keyword">if</span> is_linear<span class="token punctuation">:</span>        <span class="token keyword">for</span> fc <span class="token keyword">in</span> sparse_feature_columns<span class="token punctuation">:</span>            embedding_layers_dict<span class="token punctuation">[</span>fc<span class="token punctuation">.</span>name<span class="token punctuation">]</span> <span class="token operator">=</span> Embedding<span class="token punctuation">(</span>fc<span class="token punctuation">.</span>vocabulary_size<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">"1d_emb_"</span><span class="token operator">+</span>fc<span class="token punctuation">.</span>name<span class="token punctuation">)</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token keyword">for</span> fc <span class="token keyword">in</span> sparse_feature_columns<span class="token punctuation">:</span>            embedding_layers_dict<span class="token punctuation">[</span>fc<span class="token punctuation">.</span>name<span class="token punctuation">]</span> <span class="token operator">=</span> Embedding<span class="token punctuation">(</span>fc<span class="token punctuation">.</span>vocabulary_size<span class="token punctuation">,</span> fc<span class="token punctuation">.</span>embedding_dim<span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">"kd_emb_"</span><span class="token operator">+</span>fc<span class="token punctuation">.</span>name<span class="token punctuation">)</span>    <span class="token keyword">return</span> embedding_layers_dict    <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="4-2-Linear"><a href="#4-2-Linear" class="headerlink" title="4.2 Linear"></a>4.2 Linear</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 将linear部分的特征中sparse特征筛选出来，后面用来做1维的embedding</span>linear_sparse_feature_columns <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">filter</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> SparseFeat<span class="token punctuation">)</span><span class="token punctuation">,</span> linear_feature_columns<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>linear_sparse_feature_columns<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>linear_sparse_feature_columns<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token punctuation">(</span>linear_sparse_feature_columns<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">SparseFeat<span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">'C1'</span><span class="token punctuation">,</span> vocabulary_size<span class="token operator">=</span><span class="token number">27</span><span class="token punctuation">,</span> embedding_dim<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span> use_hash<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span><span class="token string">'int32'</span><span class="token punctuation">,</span> embeddings_initializer<span class="token operator">=</span><span class="token operator">&lt;</span>tensorflow<span class="token punctuation">.</span>python<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>initializers<span class="token punctuation">.</span>initializers_v1<span class="token punctuation">.</span>RandomNormal <span class="token builtin">object</span> at <span class="token number">0x0000022F91F17850</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> embedding_name<span class="token operator">=</span><span class="token string">'C1'</span><span class="token punctuation">,</span> group_name<span class="token operator">=</span><span class="token string">'default_group'</span><span class="token punctuation">,</span> trainable<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token number">26</span><span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token string">'list'</span><span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">get_linear_logits</span><span class="token punctuation">(</span>dense_input_dict<span class="token punctuation">,</span> sparse_input_dict<span class="token punctuation">,</span> sparse_feature_columns<span class="token punctuation">)</span><span class="token punctuation">:</span>        concat_dense_inputs <span class="token operator">=</span> Concatenate<span class="token punctuation">(</span>axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">(</span>dense_input_dict<span class="token punctuation">.</span>values<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    dense_logits_output <span class="token operator">=</span> Dense<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">(</span>concat_dense_inputs<span class="token punctuation">)</span>        linear_embedding_layers <span class="token operator">=</span> build_embedding_layers<span class="token punctuation">(</span>sparse_feature_columns<span class="token punctuation">,</span>\                            sparse_input_dict<span class="token punctuation">,</span> is_linear<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>dense_logits_output<span class="token punctuation">)</span>    sparse_1d_embed <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> fc <span class="token keyword">in</span> sparse_feature_columns<span class="token punctuation">:</span>        feat_input <span class="token operator">=</span> sparse_input_dict<span class="token punctuation">[</span>fc<span class="token punctuation">.</span>name<span class="token punctuation">]</span>        embed <span class="token operator">=</span> Flatten<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span>linear_embedding_layers<span class="token punctuation">[</span>fc<span class="token punctuation">.</span>name<span class="token punctuation">]</span><span class="token punctuation">(</span>feat_input<span class="token punctuation">)</span><span class="token punctuation">)</span>        sparse_1d_embed<span class="token punctuation">.</span>append<span class="token punctuation">(</span>embed<span class="token punctuation">)</span>        sparse_logits_output <span class="token operator">=</span> Add<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span>sparse_1d_embed<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>sparse_logits_output<span class="token punctuation">)</span>    linear_logits <span class="token operator">=</span> Add<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">[</span>dense_logits_output<span class="token punctuation">,</span> sparse_logits_output<span class="token punctuation">]</span><span class="token punctuation">)</span>        <span class="token keyword">return</span> linear_logits        <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># Wide&amp;Deep模型论文中Wide部分使用的特征比较简单，并且得到的特征非常的稀疏，所以使用了FTRL优化Wide部分（这里没有实现FTRL）</span><span class="token comment"># 但是是根据他们业务进行选择的，我们这里将所有可能用到的特征都输入到Wide部分，具体的细节可以根据需求进行修改</span>linear_logits <span class="token operator">=</span> get_linear_logits<span class="token punctuation">(</span>dense_input_dict<span class="token punctuation">,</span> sparse_input_dict<span class="token punctuation">,</span> linear_sparse_feature_columns<span class="token punctuation">)</span>linear_logits<span class="token punctuation">,</span><span class="token builtin">type</span><span class="token punctuation">(</span>linear_logits<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">KerasTensor<span class="token punctuation">(</span>type_spec<span class="token operator">=</span>TensorSpec<span class="token punctuation">(</span>shape<span class="token operator">=</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span>tf<span class="token punctuation">.</span>float32<span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">'dense_2/BiasAdd:0'</span><span class="token punctuation">,</span> description<span class="token operator">=</span><span class="token string">"created by layer 'dense_2'"</span><span class="token punctuation">)</span>KerasTensor<span class="token punctuation">(</span>type_spec<span class="token operator">=</span>TensorSpec<span class="token punctuation">(</span>shape<span class="token operator">=</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span>tf<span class="token punctuation">.</span>float32<span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">'add_4/add_24:0'</span><span class="token punctuation">,</span> description<span class="token operator">=</span><span class="token string">"created by layer 'add_4'"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token punctuation">(</span><span class="token operator">&lt;</span>KerasTensor<span class="token punctuation">:</span> shape<span class="token operator">=</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> dtype<span class="token operator">=</span>float32 <span class="token punctuation">(</span>created by layer <span class="token string">'add_5'</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> tensorflow<span class="token punctuation">.</span>python<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>engine<span class="token punctuation">.</span>keras_tensor<span class="token punctuation">.</span>KerasTensor<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h3 id="4-3-DNN"><a href="#4-3-DNN" class="headerlink" title="4.3 DNN"></a>4.3 DNN</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python">embedding_layers <span class="token operator">=</span> build_embedding_layers<span class="token punctuation">(</span>dnn_feature_columns<span class="token punctuation">,</span> sparse_input_dict<span class="token punctuation">,</span> is_linear<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>embedding_layers<span class="token punctuation">[</span><span class="token string">"C1"</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token builtin">len</span><span class="token punctuation">(</span>embedding_layers<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token punctuation">(</span><span class="token operator">&lt;</span>tensorflow<span class="token punctuation">.</span>python<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>layers<span class="token punctuation">.</span>embeddings<span class="token punctuation">.</span>Embedding at <span class="token number">0x23000d75c40</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> <span class="token number">26</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 将所有的sparse特征embedding拼接</span><span class="token keyword">def</span> <span class="token function">concat_embedding_list</span><span class="token punctuation">(</span>feature_columns<span class="token punctuation">,</span> input_layer_dict<span class="token punctuation">,</span> embedding_layer_dict<span class="token punctuation">,</span> flatten<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token comment"># 将sparse特征筛选出来</span>    sparse_feature_columns <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">filter</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> SparseFeat<span class="token punctuation">)</span><span class="token punctuation">,</span> feature_columns<span class="token punctuation">)</span><span class="token punctuation">)</span>    embedding_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> fc <span class="token keyword">in</span> sparse_feature_columns<span class="token punctuation">:</span>        _input <span class="token operator">=</span> input_layer_dict<span class="token punctuation">[</span>fc<span class="token punctuation">.</span>name<span class="token punctuation">]</span> <span class="token comment"># 获取输入层 </span>        _embed <span class="token operator">=</span> embedding_layer_dict<span class="token punctuation">[</span>fc<span class="token punctuation">.</span>name<span class="token punctuation">]</span> <span class="token comment"># B x 1 x dim  获取对应的embedding层</span>        embed <span class="token operator">=</span> _embed<span class="token punctuation">(</span>_input<span class="token punctuation">)</span> <span class="token comment"># B x dim  将input层输入到embedding层中</span>        <span class="token comment"># 是否需要flatten, 如果embedding列表最终是直接输入到Dense层中，需要进行Flatten，否则不需要</span>        <span class="token keyword">if</span> flatten<span class="token punctuation">:</span>            embed <span class="token operator">=</span> Flatten<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span>embed<span class="token punctuation">)</span>                embedding_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span>embed<span class="token punctuation">)</span>        <span class="token keyword">return</span> embedding_list <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">get_dnn_logits</span><span class="token punctuation">(</span>dense_input_dict<span class="token punctuation">,</span> sparse_input_dict<span class="token punctuation">,</span> sparse_feature_columns<span class="token punctuation">,</span> dnn_embedding_layers<span class="token punctuation">)</span><span class="token punctuation">:</span>        concat_dense_inputs <span class="token operator">=</span> Concatenate<span class="token punctuation">(</span>axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">(</span>dense_input_dict<span class="token punctuation">.</span>values<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    sparse_kd_embed <span class="token operator">=</span> concat_embedding_list<span class="token punctuation">(</span>sparse_feature_columns<span class="token punctuation">,</span>sparse_input_dict<span class="token punctuation">,</span>dnn_embedding_layers<span class="token punctuation">,</span>flatten<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>    concat_sparse_kd_embed <span class="token operator">=</span> Concatenate<span class="token punctuation">(</span>axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">(</span>sparse_kd_embed<span class="token punctuation">)</span>        dnn_input <span class="token operator">=</span> Concatenate<span class="token punctuation">(</span>axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">[</span>concat_dense_inputs<span class="token punctuation">,</span> concat_sparse_kd_embed<span class="token punctuation">]</span><span class="token punctuation">)</span>        dnn_out <span class="token operator">=</span> Dropout<span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">(</span>Dense<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">,</span>activation<span class="token operator">=</span><span class="token string">"relu"</span><span class="token punctuation">)</span><span class="token punctuation">(</span>dnn_input<span class="token punctuation">)</span><span class="token punctuation">)</span>    dnn_out <span class="token operator">=</span> Dropout<span class="token punctuation">(</span><span class="token number">0.3</span><span class="token punctuation">)</span><span class="token punctuation">(</span>Dense<span class="token punctuation">(</span><span class="token number">512</span><span class="token punctuation">,</span>activation<span class="token operator">=</span><span class="token string">"relu"</span><span class="token punctuation">)</span><span class="token punctuation">(</span>dnn_out<span class="token punctuation">)</span><span class="token punctuation">)</span>    dnn_out <span class="token operator">=</span> Dropout<span class="token punctuation">(</span><span class="token number">0.1</span><span class="token punctuation">)</span><span class="token punctuation">(</span>Dense<span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">,</span>activation<span class="token operator">=</span><span class="token string">"relu"</span><span class="token punctuation">)</span><span class="token punctuation">(</span>dnn_out<span class="token punctuation">)</span><span class="token punctuation">)</span>        dnn_logits <span class="token operator">=</span> Dense<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">(</span>dnn_out<span class="token punctuation">)</span>        <span class="token keyword">return</span> dnn_logits<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">dnn_sparse_feature_columns <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">filter</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> SparseFeat<span class="token punctuation">)</span><span class="token punctuation">,</span> dnn_feature_columns<span class="token punctuation">)</span><span class="token punctuation">)</span>dnn_sparse_feature_columns<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">SparseFeat<span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">'C1'</span><span class="token punctuation">,</span> vocabulary_size<span class="token operator">=</span><span class="token number">27</span><span class="token punctuation">,</span> embedding_dim<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span> use_hash<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span><span class="token string">'int32'</span><span class="token punctuation">,</span> embeddings_initializer<span class="token operator">=</span><span class="token operator">&lt;</span>tensorflow<span class="token punctuation">.</span>python<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>initializers<span class="token punctuation">.</span>initializers_v1<span class="token punctuation">.</span>RandomNormal <span class="token builtin">object</span> at <span class="token number">0x0000022F91A1BD90</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> embedding_name<span class="token operator">=</span><span class="token string">'C1'</span><span class="token punctuation">,</span> group_name<span class="token operator">=</span><span class="token string">'default_group'</span><span class="token punctuation">,</span> trainable<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 在Wide&amp;Deep模型中，deep部分的输入是将dense特征和embedding特征拼在一起输入到dnn中</span>dnn_logits <span class="token operator">=</span> get_dnn_logits<span class="token punctuation">(</span>dense_input_dict<span class="token punctuation">,</span> sparse_input_dict<span class="token punctuation">,</span> dnn_sparse_feature_columns<span class="token punctuation">,</span> embedding_layers<span class="token punctuation">)</span>dnn_logits<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token operator">&lt;</span>KerasTensor<span class="token punctuation">:</span> shape<span class="token operator">=</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> dtype<span class="token operator">=</span>float32 <span class="token punctuation">(</span>created by layer <span class="token string">'dense_10'</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="4-4-Linear-DNN"><a href="#4-4-Linear-DNN" class="headerlink" title="4.4 Linear + DNN"></a>4.4 Linear + DNN</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python">output_logits <span class="token operator">=</span> Add<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">[</span>linear_logits<span class="token punctuation">,</span> dnn_logits<span class="token punctuation">]</span><span class="token punctuation">)</span>output_layer <span class="token operator">=</span> Activation<span class="token punctuation">(</span><span class="token string">"sigmoid"</span><span class="token punctuation">)</span><span class="token punctuation">(</span>output_logits<span class="token punctuation">)</span>model <span class="token operator">=</span> Model<span class="token punctuation">(</span>input_layers<span class="token punctuation">,</span> output_layer<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">model<span class="token punctuation">.</span>summary<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">Model<span class="token punctuation">:</span> <span class="token string">"model"</span>__________________________________________________________________________________________________Layer <span class="token punctuation">(</span><span class="token builtin">type</span><span class="token punctuation">)</span>                    Output Shape         Param <span class="token comment">#     Connected to                     </span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span>C1 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                 <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________C2 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                 <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________C3 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                 <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________C4 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                 <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________C5 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                 <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________C6 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                 <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________C7 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                 <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________C8 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                 <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________C9 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                 <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________C10 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________C11 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________C12 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________C13 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________C14 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________C15 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________C16 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________C17 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________C18 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________C19 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________C20 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________C21 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________C22 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________C23 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________C24 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________C25 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________C26 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________kd_emb_C1 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>           <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>         <span class="token number">108</span>         C1<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                         __________________________________________________________________________________________________kd_emb_C2 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>           <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>         <span class="token number">368</span>         C2<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                         __________________________________________________________________________________________________kd_emb_C3 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>           <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>         <span class="token number">688</span>         C3<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                         __________________________________________________________________________________________________kd_emb_C4 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>           <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>         <span class="token number">628</span>         C4<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                         __________________________________________________________________________________________________kd_emb_C5 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>           <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>         <span class="token number">48</span>          C5<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                         __________________________________________________________________________________________________kd_emb_C6 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>           <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>         <span class="token number">28</span>          C6<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                         __________________________________________________________________________________________________kd_emb_C7 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>           <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>         <span class="token number">732</span>         C7<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                         __________________________________________________________________________________________________kd_emb_C8 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>           <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>         <span class="token number">76</span>          C8<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                         __________________________________________________________________________________________________kd_emb_C9 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>           <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>         <span class="token number">8</span>           C9<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                         __________________________________________________________________________________________________kd_emb_C10 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>          <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>         <span class="token number">568</span>         C10<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                        __________________________________________________________________________________________________kd_emb_C11 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>          <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>         <span class="token number">692</span>         C11<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                        __________________________________________________________________________________________________kd_emb_C12 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>          <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>         <span class="token number">680</span>         C12<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                        __________________________________________________________________________________________________kd_emb_C13 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>          <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>         <span class="token number">664</span>         C13<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                        __________________________________________________________________________________________________kd_emb_C14 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>          <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>         <span class="token number">56</span>          C14<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                        __________________________________________________________________________________________________kd_emb_C15 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>          <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>         <span class="token number">680</span>         C15<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                        __________________________________________________________________________________________________kd_emb_C16 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>          <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>         <span class="token number">672</span>         C16<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                        __________________________________________________________________________________________________kd_emb_C17 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>          <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>         <span class="token number">36</span>          C17<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                        __________________________________________________________________________________________________kd_emb_C18 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>          <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>         <span class="token number">508</span>         C18<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                        __________________________________________________________________________________________________kd_emb_C19 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>          <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>         <span class="token number">176</span>         C19<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                        __________________________________________________________________________________________________kd_emb_C20 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>          <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>         <span class="token number">16</span>          C20<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                        __________________________________________________________________________________________________kd_emb_C21 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>          <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>         <span class="token number">676</span>         C21<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                        __________________________________________________________________________________________________kd_emb_C22 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>          <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>         <span class="token number">24</span>          C22<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                        __________________________________________________________________________________________________kd_emb_C23 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>          <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>         <span class="token number">40</span>          C23<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                        __________________________________________________________________________________________________kd_emb_C24 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>          <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>         <span class="token number">500</span>         C24<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                        __________________________________________________________________________________________________kd_emb_C25 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>          <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>         <span class="token number">80</span>          C25<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                        __________________________________________________________________________________________________kd_emb_C26 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>          <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>         <span class="token number">360</span>         C26<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                        __________________________________________________________________________________________________I1 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                 <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________I2 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                 <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________I3 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                 <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________I4 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                 <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________I5 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                 <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________I6 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                 <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________I7 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                 <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________I8 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                 <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________I9 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                 <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________I10 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________I11 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________I12 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________I13 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________flatten_104 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>           <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>            <span class="token number">0</span>           kd_emb_C1<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                  __________________________________________________________________________________________________flatten_105 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>           <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>            <span class="token number">0</span>           kd_emb_C2<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                  __________________________________________________________________________________________________flatten_106 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>           <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>            <span class="token number">0</span>           kd_emb_C3<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                  __________________________________________________________________________________________________flatten_107 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>           <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>            <span class="token number">0</span>           kd_emb_C4<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                  __________________________________________________________________________________________________flatten_108 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>           <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>            <span class="token number">0</span>           kd_emb_C5<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                  __________________________________________________________________________________________________flatten_109 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>           <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>            <span class="token number">0</span>           kd_emb_C6<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                  __________________________________________________________________________________________________flatten_110 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>           <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>            <span class="token number">0</span>           kd_emb_C7<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                  __________________________________________________________________________________________________flatten_111 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>           <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>            <span class="token number">0</span>           kd_emb_C8<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                  __________________________________________________________________________________________________flatten_112 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>           <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>            <span class="token number">0</span>           kd_emb_C9<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                  __________________________________________________________________________________________________flatten_113 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>           <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>            <span class="token number">0</span>           kd_emb_C10<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                 __________________________________________________________________________________________________flatten_114 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>           <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>            <span class="token number">0</span>           kd_emb_C11<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                 __________________________________________________________________________________________________flatten_115 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>           <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>            <span class="token number">0</span>           kd_emb_C12<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                 __________________________________________________________________________________________________flatten_116 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>           <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>            <span class="token number">0</span>           kd_emb_C13<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                 __________________________________________________________________________________________________flatten_117 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>           <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>            <span class="token number">0</span>           kd_emb_C14<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                 __________________________________________________________________________________________________flatten_118 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>           <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>            <span class="token number">0</span>           kd_emb_C15<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                 __________________________________________________________________________________________________flatten_119 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>           <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>            <span class="token number">0</span>           kd_emb_C16<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                 __________________________________________________________________________________________________flatten_120 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>           <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>            <span class="token number">0</span>           kd_emb_C17<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                 __________________________________________________________________________________________________flatten_121 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>           <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>            <span class="token number">0</span>           kd_emb_C18<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                 __________________________________________________________________________________________________flatten_122 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>           <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>            <span class="token number">0</span>           kd_emb_C19<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                 __________________________________________________________________________________________________flatten_123 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>           <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>            <span class="token number">0</span>           kd_emb_C20<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                 __________________________________________________________________________________________________flatten_124 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>           <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>            <span class="token number">0</span>           kd_emb_C21<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                 __________________________________________________________________________________________________flatten_125 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>           <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>            <span class="token number">0</span>           kd_emb_C22<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                 __________________________________________________________________________________________________flatten_126 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>           <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>            <span class="token number">0</span>           kd_emb_C23<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                 __________________________________________________________________________________________________flatten_127 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>           <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>            <span class="token number">0</span>           kd_emb_C24<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                 __________________________________________________________________________________________________flatten_128 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>           <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>            <span class="token number">0</span>           kd_emb_C25<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                 __________________________________________________________________________________________________flatten_129 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>           <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>            <span class="token number">0</span>           kd_emb_C26<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                 __________________________________________________________________________________________________concatenate_8 <span class="token punctuation">(</span>Concatenate<span class="token punctuation">)</span>     <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">)</span>           <span class="token number">0</span>           I1<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                          I2<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                          I3<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                          I4<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                          I5<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                          I6<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                          I7<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                          I8<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                          I9<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                          I10<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                         I11<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                         I12<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                         I13<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                        __________________________________________________________________________________________________concatenate_9 <span class="token punctuation">(</span>Concatenate<span class="token punctuation">)</span>     <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">104</span><span class="token punctuation">)</span>          <span class="token number">0</span>           flatten_104<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                 flatten_105<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                 flatten_106<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                 flatten_107<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                 flatten_108<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                 flatten_109<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                 flatten_110<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                 flatten_111<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                 flatten_112<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                 flatten_113<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                 flatten_114<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                 flatten_115<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                 flatten_116<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                 flatten_117<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                 flatten_118<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                 flatten_119<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                 flatten_120<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                 flatten_121<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                 flatten_122<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                 flatten_123<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                 flatten_124<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                 flatten_125<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                 flatten_126<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                 flatten_127<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                 flatten_128<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                 flatten_129<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                __________________________________________________________________________________________________concatenate_10 <span class="token punctuation">(</span>Concatenate<span class="token punctuation">)</span>    <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">117</span><span class="token punctuation">)</span>          <span class="token number">0</span>           concatenate_8<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                               concatenate_9<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>              __________________________________________________________________________________________________dense_7 <span class="token punctuation">(</span>Dense<span class="token punctuation">)</span>                 <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1024</span><span class="token punctuation">)</span>         <span class="token number">120832</span>      concatenate_10<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>             __________________________________________________________________________________________________dropout_3 <span class="token punctuation">(</span>Dropout<span class="token punctuation">)</span>             <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1024</span><span class="token punctuation">)</span>         <span class="token number">0</span>           dense_7<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                    __________________________________________________________________________________________________dense_8 <span class="token punctuation">(</span>Dense<span class="token punctuation">)</span>                 <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">512</span><span class="token punctuation">)</span>          <span class="token number">524800</span>      dropout_3<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                  __________________________________________________________________________________________________1d_emb_C1 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>           <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>         <span class="token number">27</span>          C1<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                         __________________________________________________________________________________________________1d_emb_C2 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>           <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>         <span class="token number">92</span>          C2<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                         __________________________________________________________________________________________________1d_emb_C3 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>           <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>         <span class="token number">172</span>         C3<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                         __________________________________________________________________________________________________1d_emb_C4 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>           <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>         <span class="token number">157</span>         C4<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                         __________________________________________________________________________________________________1d_emb_C5 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>           <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>         <span class="token number">12</span>          C5<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                         __________________________________________________________________________________________________1d_emb_C6 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>           <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>         <span class="token number">7</span>           C6<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                         __________________________________________________________________________________________________1d_emb_C7 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>           <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>         <span class="token number">183</span>         C7<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                         __________________________________________________________________________________________________1d_emb_C8 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>           <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>         <span class="token number">19</span>          C8<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                         __________________________________________________________________________________________________1d_emb_C9 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>           <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>         <span class="token number">2</span>           C9<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                         __________________________________________________________________________________________________1d_emb_C10 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>          <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>         <span class="token number">142</span>         C10<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                        __________________________________________________________________________________________________1d_emb_C11 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>          <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>         <span class="token number">173</span>         C11<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                        __________________________________________________________________________________________________1d_emb_C12 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>          <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>         <span class="token number">170</span>         C12<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                        __________________________________________________________________________________________________1d_emb_C13 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>          <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>         <span class="token number">166</span>         C13<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                        __________________________________________________________________________________________________1d_emb_C14 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>          <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>         <span class="token number">14</span>          C14<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                        __________________________________________________________________________________________________1d_emb_C15 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>          <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>         <span class="token number">170</span>         C15<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                        __________________________________________________________________________________________________1d_emb_C16 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>          <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>         <span class="token number">168</span>         C16<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                        __________________________________________________________________________________________________1d_emb_C17 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>          <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>         <span class="token number">9</span>           C17<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                        __________________________________________________________________________________________________1d_emb_C18 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>          <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>         <span class="token number">127</span>         C18<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                        __________________________________________________________________________________________________1d_emb_C19 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>          <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>         <span class="token number">44</span>          C19<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                        __________________________________________________________________________________________________1d_emb_C20 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>          <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>         <span class="token number">4</span>           C20<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                        __________________________________________________________________________________________________1d_emb_C21 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>          <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>         <span class="token number">169</span>         C21<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                        __________________________________________________________________________________________________1d_emb_C22 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>          <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>         <span class="token number">6</span>           C22<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                        __________________________________________________________________________________________________1d_emb_C23 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>          <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>         <span class="token number">10</span>          C23<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                        __________________________________________________________________________________________________1d_emb_C24 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>          <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>         <span class="token number">125</span>         C24<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                        __________________________________________________________________________________________________1d_emb_C25 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>          <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>         <span class="token number">20</span>          C25<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                        __________________________________________________________________________________________________1d_emb_C26 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>          <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>         <span class="token number">90</span>          C26<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                        __________________________________________________________________________________________________dropout_4 <span class="token punctuation">(</span>Dropout<span class="token punctuation">)</span>             <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">512</span><span class="token punctuation">)</span>          <span class="token number">0</span>           dense_8<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                    __________________________________________________________________________________________________concatenate_4 <span class="token punctuation">(</span>Concatenate<span class="token punctuation">)</span>     <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">)</span>           <span class="token number">0</span>           I1<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                          I2<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                          I3<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                          I4<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                          I5<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                          I6<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                          I7<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                          I8<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                          I9<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                          I10<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                         I11<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                         I12<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                         I13<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                        __________________________________________________________________________________________________flatten_52 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>            <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>            <span class="token number">0</span>           1d_emb_C1<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                  __________________________________________________________________________________________________flatten_53 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>            <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>            <span class="token number">0</span>           1d_emb_C2<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                  __________________________________________________________________________________________________flatten_54 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>            <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>            <span class="token number">0</span>           1d_emb_C3<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                  __________________________________________________________________________________________________flatten_55 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>            <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>            <span class="token number">0</span>           1d_emb_C4<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                  __________________________________________________________________________________________________flatten_56 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>            <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>            <span class="token number">0</span>           1d_emb_C5<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                  __________________________________________________________________________________________________flatten_57 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>            <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>            <span class="token number">0</span>           1d_emb_C6<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                  __________________________________________________________________________________________________flatten_58 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>            <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>            <span class="token number">0</span>           1d_emb_C7<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                  __________________________________________________________________________________________________flatten_59 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>            <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>            <span class="token number">0</span>           1d_emb_C8<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                  __________________________________________________________________________________________________flatten_60 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>            <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>            <span class="token number">0</span>           1d_emb_C9<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                  __________________________________________________________________________________________________flatten_61 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>            <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>            <span class="token number">0</span>           1d_emb_C10<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                 __________________________________________________________________________________________________flatten_62 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>            <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>            <span class="token number">0</span>           1d_emb_C11<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                 __________________________________________________________________________________________________flatten_63 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>            <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>            <span class="token number">0</span>           1d_emb_C12<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                 __________________________________________________________________________________________________flatten_64 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>            <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>            <span class="token number">0</span>           1d_emb_C13<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                 __________________________________________________________________________________________________flatten_65 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>            <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>            <span class="token number">0</span>           1d_emb_C14<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                 __________________________________________________________________________________________________flatten_66 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>            <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>            <span class="token number">0</span>           1d_emb_C15<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                 __________________________________________________________________________________________________flatten_67 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>            <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>            <span class="token number">0</span>           1d_emb_C16<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                 __________________________________________________________________________________________________flatten_68 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>            <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>            <span class="token number">0</span>           1d_emb_C17<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                 __________________________________________________________________________________________________flatten_69 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>            <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>            <span class="token number">0</span>           1d_emb_C18<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                 __________________________________________________________________________________________________flatten_70 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>            <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>            <span class="token number">0</span>           1d_emb_C19<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                 __________________________________________________________________________________________________flatten_71 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>            <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>            <span class="token number">0</span>           1d_emb_C20<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                 __________________________________________________________________________________________________flatten_72 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>            <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>            <span class="token number">0</span>           1d_emb_C21<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                 __________________________________________________________________________________________________flatten_73 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>            <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>            <span class="token number">0</span>           1d_emb_C22<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                 __________________________________________________________________________________________________flatten_74 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>            <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>            <span class="token number">0</span>           1d_emb_C23<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                 __________________________________________________________________________________________________flatten_75 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>            <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>            <span class="token number">0</span>           1d_emb_C24<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                 __________________________________________________________________________________________________flatten_76 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>            <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>            <span class="token number">0</span>           1d_emb_C25<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                 __________________________________________________________________________________________________flatten_77 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>            <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>            <span class="token number">0</span>           1d_emb_C26<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                 __________________________________________________________________________________________________dense_9 <span class="token punctuation">(</span>Dense<span class="token punctuation">)</span>                 <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">256</span><span class="token punctuation">)</span>          <span class="token number">131328</span>      dropout_4<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                  __________________________________________________________________________________________________dense_2 <span class="token punctuation">(</span>Dense<span class="token punctuation">)</span>                 <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>            <span class="token number">14</span>          concatenate_4<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>              __________________________________________________________________________________________________add_4 <span class="token punctuation">(</span>Add<span class="token punctuation">)</span>                     <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>            <span class="token number">0</span>           flatten_52<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  flatten_53<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  flatten_54<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  flatten_55<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  flatten_56<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  flatten_57<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  flatten_58<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  flatten_59<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  flatten_60<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  flatten_61<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  flatten_62<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  flatten_63<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  flatten_64<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  flatten_65<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  flatten_66<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  flatten_67<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  flatten_68<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  flatten_69<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  flatten_70<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  flatten_71<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  flatten_72<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  flatten_73<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  flatten_74<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  flatten_75<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  flatten_76<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  flatten_77<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                 __________________________________________________________________________________________________dropout_5 <span class="token punctuation">(</span>Dropout<span class="token punctuation">)</span>             <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">256</span><span class="token punctuation">)</span>          <span class="token number">0</span>           dense_9<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                    __________________________________________________________________________________________________add_5 <span class="token punctuation">(</span>Add<span class="token punctuation">)</span>                     <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>            <span class="token number">0</span>           dense_2<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                     add_4<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                      __________________________________________________________________________________________________dense_10 <span class="token punctuation">(</span>Dense<span class="token punctuation">)</span>                <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>            <span class="token number">257</span>         dropout_5<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                  __________________________________________________________________________________________________add_6 <span class="token punctuation">(</span>Add<span class="token punctuation">)</span>                     <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>            <span class="token number">0</span>           add_5<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                       dense_10<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                   __________________________________________________________________________________________________activation <span class="token punctuation">(</span>Activation<span class="token punctuation">)</span>         <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>            <span class="token number">0</span>           add_6<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                      <span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span>Total params<span class="token punctuation">:</span> <span class="token number">788</span><span class="token punctuation">,</span><span class="token number">621</span>Trainable params<span class="token punctuation">:</span> <span class="token number">788</span><span class="token punctuation">,</span><span class="token number">621</span>Non<span class="token operator">-</span>trainable params<span class="token punctuation">:</span> <span class="token number">0</span>__________________________________________________________________________________________________<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">model<span class="token punctuation">.</span><span class="token builtin">compile</span><span class="token punctuation">(</span>optimizer<span class="token operator">=</span><span class="token string">"adam"</span><span class="token punctuation">,</span>loss<span class="token operator">=</span><span class="token string">"binary_crossentropy"</span><span class="token punctuation">,</span>metrics<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">"binary_crossentropy"</span><span class="token punctuation">,</span>tf<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>metrics<span class="token punctuation">.</span>AUC<span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">"auc"</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>train_model_input <span class="token operator">=</span> <span class="token punctuation">{</span>name<span class="token punctuation">:</span>data<span class="token punctuation">[</span>name<span class="token punctuation">]</span> <span class="token keyword">for</span> name <span class="token keyword">in</span> dense_features<span class="token operator">+</span>sparse_features<span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">model<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>train_model_input<span class="token punctuation">,</span>train_data<span class="token punctuation">[</span><span class="token string">"label"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>values<span class="token punctuation">,</span>batch_size<span class="token operator">=</span><span class="token number">64</span><span class="token punctuation">,</span>epochs<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">,</span>validation_split<span class="token operator">=</span><span class="token number">0.3</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">Epoch <span class="token number">1</span><span class="token operator">/</span><span class="token number">20</span><span class="token number">3</span><span class="token operator">/</span><span class="token number">3</span> <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token punctuation">]</span> <span class="token operator">-</span> 1s 283ms<span class="token operator">/</span>step <span class="token operator">-</span> loss<span class="token punctuation">:</span> <span class="token number">0.5477</span> <span class="token operator">-</span> binary_crossentropy<span class="token punctuation">:</span> <span class="token number">0.5477</span> <span class="token operator">-</span> auc<span class="token punctuation">:</span> <span class="token number">0.6436</span> <span class="token operator">-</span> val_loss<span class="token punctuation">:</span> <span class="token number">0.7410</span> <span class="token operator">-</span> val_binary_crossentropy<span class="token punctuation">:</span> <span class="token number">0.7410</span> <span class="token operator">-</span> val_auc<span class="token punctuation">:</span> <span class="token number">0.6200</span>Epoch <span class="token number">2</span><span class="token operator">/</span><span class="token number">20</span><span class="token number">3</span><span class="token operator">/</span><span class="token number">3</span> <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token punctuation">]</span> <span class="token operator">-</span> 0s 49ms<span class="token operator">/</span>step <span class="token operator">-</span> loss<span class="token punctuation">:</span> <span class="token number">0.5829</span> <span class="token operator">-</span> binary_crossentropy<span class="token punctuation">:</span> <span class="token number">0.5829</span> <span class="token operator">-</span> auc<span class="token punctuation">:</span> <span class="token number">0.6614</span> <span class="token operator">-</span> val_loss<span class="token punctuation">:</span> <span class="token number">0.6583</span> <span class="token operator">-</span> val_binary_crossentropy<span class="token punctuation">:</span> <span class="token number">0.6583</span> <span class="token operator">-</span> val_auc<span class="token punctuation">:</span> <span class="token number">0.6290</span>Epoch <span class="token number">3</span><span class="token operator">/</span><span class="token number">20</span><span class="token number">3</span><span class="token operator">/</span><span class="token number">3</span> <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token punctuation">]</span> <span class="token operator">-</span> 0s 49ms<span class="token operator">/</span>step <span class="token operator">-</span> loss<span class="token punctuation">:</span> <span class="token number">0.4333</span> <span class="token operator">-</span> binary_crossentropy<span class="token punctuation">:</span> <span class="token number">0.4333</span> <span class="token operator">-</span> auc<span class="token punctuation">:</span> <span class="token number">0.7712</span> <span class="token operator">-</span> val_loss<span class="token punctuation">:</span> <span class="token number">0.6934</span> <span class="token operator">-</span> val_binary_crossentropy<span class="token punctuation">:</span> <span class="token number">0.6934</span> <span class="token operator">-</span> val_auc<span class="token punctuation">:</span> <span class="token number">0.5841</span>Epoch <span class="token number">4</span><span class="token operator">/</span><span class="token number">20</span><span class="token number">3</span><span class="token operator">/</span><span class="token number">3</span> <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token punctuation">]</span> <span class="token operator">-</span> 0s 48ms<span class="token operator">/</span>step <span class="token operator">-</span> loss<span class="token punctuation">:</span> <span class="token number">0.5629</span> <span class="token operator">-</span> binary_crossentropy<span class="token punctuation">:</span> <span class="token number">0.5629</span> <span class="token operator">-</span> auc<span class="token punctuation">:</span> <span class="token number">0.6908</span> <span class="token operator">-</span> val_loss<span class="token punctuation">:</span> <span class="token number">0.6786</span> <span class="token operator">-</span> val_binary_crossentropy<span class="token punctuation">:</span> <span class="token number">0.6786</span> <span class="token operator">-</span> val_auc<span class="token punctuation">:</span> <span class="token number">0.5931</span>Epoch <span class="token number">5</span><span class="token operator">/</span><span class="token number">20</span><span class="token number">3</span><span class="token operator">/</span><span class="token number">3</span> <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token punctuation">]</span> <span class="token operator">-</span> 0s 49ms<span class="token operator">/</span>step <span class="token operator">-</span> loss<span class="token punctuation">:</span> <span class="token number">0.5090</span> <span class="token operator">-</span> binary_crossentropy<span class="token punctuation">:</span> <span class="token number">0.5090</span> <span class="token operator">-</span> auc<span class="token punctuation">:</span> <span class="token number">0.7138</span> <span class="token operator">-</span> val_loss<span class="token punctuation">:</span> <span class="token number">0.6061</span> <span class="token operator">-</span> val_binary_crossentropy<span class="token punctuation">:</span> <span class="token number">0.6061</span> <span class="token operator">-</span> val_auc<span class="token punctuation">:</span> <span class="token number">0.6271</span>Epoch <span class="token number">6</span><span class="token operator">/</span><span class="token number">20</span><span class="token number">3</span><span class="token operator">/</span><span class="token number">3</span> <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token punctuation">]</span> <span class="token operator">-</span> 0s 52ms<span class="token operator">/</span>step <span class="token operator">-</span> loss<span class="token punctuation">:</span> <span class="token number">0.4698</span> <span class="token operator">-</span> binary_crossentropy<span class="token punctuation">:</span> <span class="token number">0.4698</span> <span class="token operator">-</span> auc<span class="token punctuation">:</span> <span class="token number">0.7412</span> <span class="token operator">-</span> val_loss<span class="token punctuation">:</span> <span class="token number">0.6045</span> <span class="token operator">-</span> val_binary_crossentropy<span class="token punctuation">:</span> <span class="token number">0.6045</span> <span class="token operator">-</span> val_auc<span class="token punctuation">:</span> <span class="token number">0.6117</span>Epoch <span class="token number">7</span><span class="token operator">/</span><span class="token number">20</span><span class="token number">3</span><span class="token operator">/</span><span class="token number">3</span> <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token punctuation">]</span> <span class="token operator">-</span> 0s 51ms<span class="token operator">/</span>step <span class="token operator">-</span> loss<span class="token punctuation">:</span> <span class="token number">0.3880</span> <span class="token operator">-</span> binary_crossentropy<span class="token punctuation">:</span> <span class="token number">0.3880</span> <span class="token operator">-</span> auc<span class="token punctuation">:</span> <span class="token number">0.8280</span> <span class="token operator">-</span> val_loss<span class="token punctuation">:</span> <span class="token number">0.5973</span> <span class="token operator">-</span> val_binary_crossentropy<span class="token punctuation">:</span> <span class="token number">0.5973</span> <span class="token operator">-</span> val_auc<span class="token punctuation">:</span> <span class="token number">0.6284</span>Epoch <span class="token number">8</span><span class="token operator">/</span><span class="token number">20</span><span class="token number">3</span><span class="token operator">/</span><span class="token number">3</span> <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token punctuation">]</span> <span class="token operator">-</span> 0s 49ms<span class="token operator">/</span>step <span class="token operator">-</span> loss<span class="token punctuation">:</span> <span class="token number">0.3896</span> <span class="token operator">-</span> binary_crossentropy<span class="token punctuation">:</span> <span class="token number">0.3896</span> <span class="token operator">-</span> auc<span class="token punctuation">:</span> <span class="token number">0.8258</span> <span class="token operator">-</span> val_loss<span class="token punctuation">:</span> <span class="token number">0.6379</span> <span class="token operator">-</span> val_binary_crossentropy<span class="token punctuation">:</span> <span class="token number">0.6379</span> <span class="token operator">-</span> val_auc<span class="token punctuation">:</span> <span class="token number">0.6752</span>Epoch <span class="token number">9</span><span class="token operator">/</span><span class="token number">20</span><span class="token number">3</span><span class="token operator">/</span><span class="token number">3</span> <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token punctuation">]</span> <span class="token operator">-</span> 0s 52ms<span class="token operator">/</span>step <span class="token operator">-</span> loss<span class="token punctuation">:</span> <span class="token number">0.4310</span> <span class="token operator">-</span> binary_crossentropy<span class="token punctuation">:</span> <span class="token number">0.4310</span> <span class="token operator">-</span> auc<span class="token punctuation">:</span> <span class="token number">0.8127</span> <span class="token operator">-</span> val_loss<span class="token punctuation">:</span> <span class="token number">0.6128</span> <span class="token operator">-</span> val_binary_crossentropy<span class="token punctuation">:</span> <span class="token number">0.6128</span> <span class="token operator">-</span> val_auc<span class="token punctuation">:</span> <span class="token number">0.6476</span>Epoch <span class="token number">10</span><span class="token operator">/</span><span class="token number">20</span><span class="token number">3</span><span class="token operator">/</span><span class="token number">3</span> <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token punctuation">]</span> <span class="token operator">-</span> 0s 52ms<span class="token operator">/</span>step <span class="token operator">-</span> loss<span class="token punctuation">:</span> <span class="token number">0.3449</span> <span class="token operator">-</span> binary_crossentropy<span class="token punctuation">:</span> <span class="token number">0.3449</span> <span class="token operator">-</span> auc<span class="token punctuation">:</span> <span class="token number">0.8792</span> <span class="token operator">-</span> val_loss<span class="token punctuation">:</span> <span class="token number">0.6169</span> <span class="token operator">-</span> val_binary_crossentropy<span class="token punctuation">:</span> <span class="token number">0.6169</span> <span class="token operator">-</span> val_auc<span class="token punctuation">:</span> <span class="token number">0.6239</span>Epoch <span class="token number">11</span><span class="token operator">/</span><span class="token number">20</span><span class="token number">3</span><span class="token operator">/</span><span class="token number">3</span> <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token punctuation">]</span> <span class="token operator">-</span> 0s 49ms<span class="token operator">/</span>step <span class="token operator">-</span> loss<span class="token punctuation">:</span> <span class="token number">0.3839</span> <span class="token operator">-</span> binary_crossentropy<span class="token punctuation">:</span> <span class="token number">0.3839</span> <span class="token operator">-</span> auc<span class="token punctuation">:</span> <span class="token number">0.8647</span> <span class="token operator">-</span> val_loss<span class="token punctuation">:</span> <span class="token number">0.6150</span> <span class="token operator">-</span> val_binary_crossentropy<span class="token punctuation">:</span> <span class="token number">0.6150</span> <span class="token operator">-</span> val_auc<span class="token punctuation">:</span> <span class="token number">0.6380</span>Epoch <span class="token number">12</span><span class="token operator">/</span><span class="token number">20</span><span class="token number">3</span><span class="token operator">/</span><span class="token number">3</span> <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token punctuation">]</span> <span class="token operator">-</span> 0s 48ms<span class="token operator">/</span>step <span class="token operator">-</span> loss<span class="token punctuation">:</span> <span class="token number">0.3433</span> <span class="token operator">-</span> binary_crossentropy<span class="token punctuation">:</span> <span class="token number">0.3433</span> <span class="token operator">-</span> auc<span class="token punctuation">:</span> <span class="token number">0.8788</span> <span class="token operator">-</span> val_loss<span class="token punctuation">:</span> <span class="token number">0.6719</span> <span class="token operator">-</span> val_binary_crossentropy<span class="token punctuation">:</span> <span class="token number">0.6719</span> <span class="token operator">-</span> val_auc<span class="token punctuation">:</span> <span class="token number">0.6797</span>Epoch <span class="token number">13</span><span class="token operator">/</span><span class="token number">20</span><span class="token number">3</span><span class="token operator">/</span><span class="token number">3</span> <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token punctuation">]</span> <span class="token operator">-</span> 0s 52ms<span class="token operator">/</span>step <span class="token operator">-</span> loss<span class="token punctuation">:</span> <span class="token number">0.3312</span> <span class="token operator">-</span> binary_crossentropy<span class="token punctuation">:</span> <span class="token number">0.3312</span> <span class="token operator">-</span> auc<span class="token punctuation">:</span> <span class="token number">0.8942</span> <span class="token operator">-</span> val_loss<span class="token punctuation">:</span> <span class="token number">0.7839</span> <span class="token operator">-</span> val_binary_crossentropy<span class="token punctuation">:</span> <span class="token number">0.7839</span> <span class="token operator">-</span> val_auc<span class="token punctuation">:</span> <span class="token number">0.6874</span>Epoch <span class="token number">14</span><span class="token operator">/</span><span class="token number">20</span><span class="token number">3</span><span class="token operator">/</span><span class="token number">3</span> <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token punctuation">]</span> <span class="token operator">-</span> 0s 50ms<span class="token operator">/</span>step <span class="token operator">-</span> loss<span class="token punctuation">:</span> <span class="token number">0.3214</span> <span class="token operator">-</span> binary_crossentropy<span class="token punctuation">:</span> <span class="token number">0.3214</span> <span class="token operator">-</span> auc<span class="token punctuation">:</span> <span class="token number">0.9198</span> <span class="token operator">-</span> val_loss<span class="token punctuation">:</span> <span class="token number">0.6589</span> <span class="token operator">-</span> val_binary_crossentropy<span class="token punctuation">:</span> <span class="token number">0.6589</span> <span class="token operator">-</span> val_auc<span class="token punctuation">:</span> <span class="token number">0.6694</span>Epoch <span class="token number">15</span><span class="token operator">/</span><span class="token number">20</span><span class="token number">3</span><span class="token operator">/</span><span class="token number">3</span> <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token punctuation">]</span> <span class="token operator">-</span> 0s 49ms<span class="token operator">/</span>step <span class="token operator">-</span> loss<span class="token punctuation">:</span> <span class="token number">0.2330</span> <span class="token operator">-</span> binary_crossentropy<span class="token punctuation">:</span> <span class="token number">0.2330</span> <span class="token operator">-</span> auc<span class="token punctuation">:</span> <span class="token number">0.9506</span> <span class="token operator">-</span> val_loss<span class="token punctuation">:</span> <span class="token number">0.6497</span> <span class="token operator">-</span> val_binary_crossentropy<span class="token punctuation">:</span> <span class="token number">0.6497</span> <span class="token operator">-</span> val_auc<span class="token punctuation">:</span> <span class="token number">0.6040</span>Epoch <span class="token number">16</span><span class="token operator">/</span><span class="token number">20</span><span class="token number">3</span><span class="token operator">/</span><span class="token number">3</span> <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token punctuation">]</span> <span class="token operator">-</span> 0s 50ms<span class="token operator">/</span>step <span class="token operator">-</span> loss<span class="token punctuation">:</span> <span class="token number">0.2512</span> <span class="token operator">-</span> binary_crossentropy<span class="token punctuation">:</span> <span class="token number">0.2512</span> <span class="token operator">-</span> auc<span class="token punctuation">:</span> <span class="token number">0.9612</span> <span class="token operator">-</span> val_loss<span class="token punctuation">:</span> <span class="token number">0.6793</span> <span class="token operator">-</span> val_binary_crossentropy<span class="token punctuation">:</span> <span class="token number">0.6793</span> <span class="token operator">-</span> val_auc<span class="token punctuation">:</span> <span class="token number">0.5879</span>Epoch <span class="token number">17</span><span class="token operator">/</span><span class="token number">20</span><span class="token number">3</span><span class="token operator">/</span><span class="token number">3</span> <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token punctuation">]</span> <span class="token operator">-</span> 0s 53ms<span class="token operator">/</span>step <span class="token operator">-</span> loss<span class="token punctuation">:</span> <span class="token number">0.2180</span> <span class="token operator">-</span> binary_crossentropy<span class="token punctuation">:</span> <span class="token number">0.2180</span> <span class="token operator">-</span> auc<span class="token punctuation">:</span> <span class="token number">0.9765</span> <span class="token operator">-</span> val_loss<span class="token punctuation">:</span> <span class="token number">0.6687</span> <span class="token operator">-</span> val_binary_crossentropy<span class="token punctuation">:</span> <span class="token number">0.6687</span> <span class="token operator">-</span> val_auc<span class="token punctuation">:</span> <span class="token number">0.6297</span>Epoch <span class="token number">18</span><span class="token operator">/</span><span class="token number">20</span><span class="token number">3</span><span class="token operator">/</span><span class="token number">3</span> <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token punctuation">]</span> <span class="token operator">-</span> 0s 50ms<span class="token operator">/</span>step <span class="token operator">-</span> loss<span class="token punctuation">:</span> <span class="token number">0.1580</span> <span class="token operator">-</span> binary_crossentropy<span class="token punctuation">:</span> <span class="token number">0.1580</span> <span class="token operator">-</span> auc<span class="token punctuation">:</span> <span class="token number">0.9880</span> <span class="token operator">-</span> val_loss<span class="token punctuation">:</span> <span class="token number">0.8166</span> <span class="token operator">-</span> val_binary_crossentropy<span class="token punctuation">:</span> <span class="token number">0.8166</span> <span class="token operator">-</span> val_auc<span class="token punctuation">:</span> <span class="token number">0.6386</span>Epoch <span class="token number">19</span><span class="token operator">/</span><span class="token number">20</span><span class="token number">3</span><span class="token operator">/</span><span class="token number">3</span> <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token punctuation">]</span> <span class="token operator">-</span> 0s 51ms<span class="token operator">/</span>step <span class="token operator">-</span> loss<span class="token punctuation">:</span> <span class="token number">0.1155</span> <span class="token operator">-</span> binary_crossentropy<span class="token punctuation">:</span> <span class="token number">0.1155</span> <span class="token operator">-</span> auc<span class="token punctuation">:</span> <span class="token number">0.9997</span> <span class="token operator">-</span> val_loss<span class="token punctuation">:</span> <span class="token number">0.7452</span> <span class="token operator">-</span> val_binary_crossentropy<span class="token punctuation">:</span> <span class="token number">0.7452</span> <span class="token operator">-</span> val_auc<span class="token punctuation">:</span> <span class="token number">0.6187</span>Epoch <span class="token number">20</span><span class="token operator">/</span><span class="token number">20</span><span class="token number">3</span><span class="token operator">/</span><span class="token number">3</span> <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token punctuation">]</span> <span class="token operator">-</span> 0s 52ms<span class="token operator">/</span>step <span class="token operator">-</span> loss<span class="token punctuation">:</span> <span class="token number">0.1096</span> <span class="token operator">-</span> binary_crossentropy<span class="token punctuation">:</span> <span class="token number">0.1096</span> <span class="token operator">-</span> auc<span class="token punctuation">:</span> <span class="token number">0.9976</span> <span class="token operator">-</span> val_loss<span class="token punctuation">:</span> <span class="token number">0.6991</span> <span class="token operator">-</span> val_binary_crossentropy<span class="token punctuation">:</span> <span class="token number">0.6991</span> <span class="token operator">-</span> val_auc<span class="token punctuation">:</span> <span class="token number">0.5911</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="/2021/03/18/task2-wide-deep/Wide&amp;Deep.png" alt=""></p><h2 id="5、思考"><a href="#5、思考" class="headerlink" title="5、思考"></a>5、思考</h2><ol><li><p>在你的应用场景中，哪些特征适合放在Wide侧，哪些特征适合放在Deep侧，为什么呢？</p><p>wide侧用于记忆，适合输入组合特征，用于记住那些已经存在过的特征组合。deep侧用于泛化，适合输入非组合特征，包括离散特征和连续特征，用于泛化那些未曾出现过或者低频的特征组合。</p></li><li><p>为什么Wide部分要用L1 FTRL训练？</p><p><strong>W&amp;D采用L1 FTRL是想让Wide部分变得更加稀疏</strong>。该部分也是和 Google 当时的业务需求有关，论文中 Wide 部分采用的特征是：<strong>User Installed App</strong> 和 <strong>Impression App</strong>，两个id类特征向量进行组合，在维度爆炸的同时，会让原本已经非常稀疏的multihot特征向量，变得更加稀疏。正因如此，wide部分的权重数量其实是海量的。为了不把数量如此之巨的权重都搬到线上进行model serving，采用FTRL过滤掉哪些稀疏特征无疑是非常好的工程经验。</p></li><li><p>为什么Deep部分不特别考虑稀疏性的问题？</p><p>Deep 的输入数据为 Continuous Features 和经过 Embedding 的 Categorical Features，所以 Deep 部分并不存在很严重的特征稀疏问题。</p></li></ol><h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><ul><li><p><a href="https://zhuanlan.zhihu.com/p/53361519">详解 Wide &amp; Deep 结构背后的动机</a></p></li><li><p><a href="https://www.jianshu.com/p/dbaf2d9d8c94">Wide &amp; Deep</a></p></li><li><p><a href="https://zhuanlan.zhihu.com/p/32903540">FOLLOW THE REGULARIZED LEADER (FTRL) 算法总结</a></p></li><li><p><a href="https://zhuanlan.zhihu.com/p/29920135">Deep Learning 最优化方法之AdaGrad</a></p></li><li><p><a href="https://arxiv.org/pdf/1606.07792.pdf">论文原文</a></p></li><li><p><a href="https://github.com/shenweichen/DeepCTR">deepctr</a></p></li><li><p><a href="https://zhuanlan.zhihu.com/p/47293765">看Google如何实现Wide &amp; Deep模型(1)</a></p></li><li><p><a href="https://zhuanlan.zhihu.com/p/92279796?utm_source=wechat_session&amp;utm_medium=social&amp;utm_oi=753565305866829824&amp;utm_campaign=shareopn">推荐系统系列（六）：Wide&amp;Deep理论与实践</a></p></li><li><p><a href="https://zhuanlan.zhihu.com/p/142958834">见微知著，你真的搞懂Google的Wide&amp;Deep模型了吗?</a></p></li><li><p><a href="https://zhuanlan.zhihu.com/p/53110408">用NumPy手工打造 Wide &amp; Deep</a></p></li><li><p><a href="https://www.tensorflow.org/api_docs/python/tf/keras/experimental/WideDeepModel">tensorflow官网的WideDeepModel</a></p></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> DataWhale </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Task1 区块链简介与以太坊入门介绍</title>
      <link href="2021/03/17/task1-qu-kuai-lian-jian-jie-yu-yi-tai-fang-ru-men-jie-shao/"/>
      <url>2021/03/17/task1-qu-kuai-lian-jian-jie-yu-yi-tai-fang-ru-men-jie-shao/</url>
      
        <content type="html"><![CDATA[<h1 id="一、区块链简介"><a href="#一、区块链简介" class="headerlink" title="一、区块链简介"></a>一、区块链简介</h1><h2 id="1-1、区块链的本质"><a href="#1-1、区块链的本质" class="headerlink" title="1.1、区块链的本质"></a>1.1、区块链的本质</h2><p>区块链，是一种特殊的分布式数据库，去中心化是其最大的特点。</p><p>去中心化一词，我是在美剧硅谷中第一次清楚地接触到，简单梳理下硅谷剧情，记忆不准确，<a href="https://www.chainnews.com/articles/962007723378.htm">参考博客</a></p><ul><li>发散压缩算法 (Middle-Out Algorithm)</li><li>去中心化的互联网-New Internet</li><li>安东之子 Son of Anton</li></ul><p>在正式的产品交付前几天，Richard 发现自己发送的加密信息，在 Morika 接受的短信中少了一个点，更严重的是，网络发送量和接受量不一致。最终推演的结果是，网络的加密算法被绕过或者被攻破了。加密算法可以说是世界上最重要的算法之一，如果说一旦有破解工具，一切隐私、安全都不存在。最终 Piper 创始人选择放弃，关上潘多拉魔盒。</p><p>说回正题，本文是作为一个区块链初学者的知识总结，参考了很多优秀的博客，文章框架按照学习思路汇总，在文章最后会附上参考资料链接。区块链的主要作用是储存信息。任何需要保存的信息，都可以写入区块链，也可以从里面读取，所以它是数据库。任何人都可以架设服务器，加入区块链网络，成为一个节点。区块链的世界里面，没有中心节点，每个节点都是平等的，都保存着整个数据库。你可以向任何一个节点，写入/读取数据，因为所有节点最后都会同步，保证区块链一致。</p><h2 id="1-2、区块链的特点"><a href="#1-2、区块链的特点" class="headerlink" title="1.2、区块链的特点"></a>1.2、区块链的特点</h2><p>分布式数据库并非新发明，市场上早有此类产品。但是，区块链有一个革命性特点。</p><p><strong>区块链没有管理员，它是彻底无中心的。</strong>其他的数据库都有管理员，但是区块链没有。如果有人想对区块链添加审核，也实现不了，因为它的设计目标就是防止出现居于中心地位的管理当局。</p><p>正是因为无法管理，区块链才能做到无法被控制。否则一旦大公司大集团控制了管理权，他们就会控制整个平台，其他使用者就都必须听命于他们了。</p><p>但是，没有了管理员，人人都可以往里面写入数据，怎么才能保证数据是可信的呢？被坏人改了怎么办？请接着往下读，这就是区块链奇妙的地方。</p><h2 id="1-3、区块链技术与算法"><a href="#1-3、区块链技术与算法" class="headerlink" title="1.3、区块链技术与算法"></a>1.3、区块链技术与算法</h2><p>区块链技术不是单独的一项技术，而是一系列技术组成的技术栈，其具有以下的特点：</p><ul><li>数据分布式存储</li><li>存储的数据不可逆、不可篡改、可回溯</li><li>数据的创建和维护由所有参与方共同参与</li></ul><p>为了实现这些特点、维护区块链应用的稳定运行，区块链技术中包含了分布式存储技术、密码学技术、共识机制以及区块链2.0提出的智能合约。</p><h3 id="1-3-1、区块"><a href="#1-3-1、区块" class="headerlink" title="1.3.1、区块"></a>1.3.1、区块</h3><p>区块链由一个个区块（block）组成。区块很像数据库的记录，每次写入数据，就是创建一个区块。</p><p><img src="/2021/03/17/task1-qu-kuai-lian-jian-jie-yu-yi-tai-fang-ru-men-jie-shao/区块.png" alt="区块"></p><p>每个区块包含两个部分。</p><blockquote><ul><li>区块头（Head）：记录当前区块的特征值</li><li>区块体（Body）：实际数据</li></ul></blockquote><p>区块头包含了当前区块的多项特征值。</p><blockquote><ul><li>生成时间</li><li>实际数据（即区块体）的哈希</li><li>上一个区块的哈希</li><li>…</li></ul></blockquote><p>这里，我们需要理解什么叫<a href="https://baike.baidu.com/item/哈希值">哈希</a>（hash），这是理解区块链必需的。</p><p><img src="http://www.ruanyifeng.com/blogimg/asset/2017/bg2017122704.png" alt="区块"></p><p>所谓”哈希”就是计算机可以对任意内容，计算出一个长度相同的特征值。区块链的哈希长度是256位，这就是说，不管原始内容是什么，最后都会计算出一个256位的二进制数字。而且可以保证，只要原始内容不同，对应的哈希一定是不同的。</p><p>举例来说，字符串<code>123</code>的哈希是<code>a8fdc205a9f19cc1c7507a60c4f01b13d11d7fd0</code>（十六进制），转成二进制就是256位，而且只有<code>123</code>能得到这个哈希。（理论上，其他字符串也有可能得到这个哈希，但是概率极低，可以近似认为不可能发生。）</p><p>因此，就有两个重要的推论。</p><blockquote><ul><li>推论1：每个区块的哈希都是不一样的，可以通过哈希标识区块。</li><li>推论2：如果区块的内容变了，它的哈希一定会改变。</li></ul></blockquote><h3 id="1-3-2、Hash-的不可修改性"><a href="#1-3-2、Hash-的不可修改性" class="headerlink" title="1.3.2、Hash 的不可修改性"></a>1.3.2、Hash 的不可修改性</h3><p>区块与哈希是一一对应的，每个区块的哈希都是针对”区块头”（Head）计算的。也就是说，把区块头的各项特征值，按照顺序连接在一起，组成一个很长的字符串，再对这个字符串计算哈希。</p><blockquote><p>Hash = SHA256( 区块头 )</p></blockquote><p>上面就是区块哈希的计算公式，<code>SHA256</code>是区块链的哈希算法。注意，这个公式里面只包含区块头，不包含区块体，也就是说，哈希由区块头唯一决定，</p><p>前面说过，区块头包含很多内容，其中有当前区块体的哈希，还有上一个区块的哈希。这意味着，如果当前区块体的内容变了，或者上一个区块的哈希变了，一定会引起当前区块的哈希改变。</p><p>这一点对区块链有重大意义。如果有人修改了一个区块，该区块的哈希就变了。为了让后面的区块还能连到它（因为下一个区块包含上一个区块的哈希），该人必须依次修改后面所有的区块，否则被改掉的区块就脱离区块链了。由于后面要提到的原因，哈希的计算很耗时，短时间内修改多个区块几乎不可能发生，除非有人掌握了全网51%以上的计算能力。</p><p>正是通过这种联动机制，区块链保证了自身的可靠性，数据一旦写入，就无法被篡改。这就像历史一样，发生了就是发生了，从此再无法改变。</p><p><img src="http://www.ruanyifeng.com/blogimg/asset/2017/bg2017122705.png" alt="区块链"></p><p>每个区块都连着上一个区块，这也是”区块链”这个名字的由来。</p><h3 id="1-3-3、分布式存储技术"><a href="#1-3-3、分布式存储技术" class="headerlink" title="1.3.3、分布式存储技术"></a>1.3.3、分布式存储技术</h3><p>与传统的数据存储技术不同，在区块链技术中，数据并不是集中存放在某个数据中心上，也不是由某个权威机构或是大多数节点来存储，而是分散存储在区块链网络中的每一个节点上。</p><p><img src="/2021/03/17/task1-qu-kuai-lian-jian-jie-yu-yi-tai-fang-ru-men-jie-shao/中心化存储.png" alt="中心化存储" style="zoom:80%;"></p><p><img src="/2021/03/17/task1-qu-kuai-lian-jian-jie-yu-yi-tai-fang-ru-men-jie-shao/分布式存储.png" alt="分布式存储" style="zoom:80%;"></p><p><strong>节点和区块的关系是什么？</strong></p><p>可以用共享文档来简单描述：所有可以访问共享文档的账号就叫做节点，当然全节点需要同步共享文档，也就是拥有全部的区块数据区块就是共享文档。每个人更新了，所有人都可以查看最新的文档</p><h3 id="1-3-4、密码学技术"><a href="#1-3-4、密码学技术" class="headerlink" title="1.3.4、密码学技术"></a>1.3.4、密码学技术</h3><p>为了实现数据的不可逆、不可篡改和可回溯，区块链技术采用了一系列密码学算法和技术，包括哈希算法、Merkle 树、非对称加密算法。</p><h4 id="哈希算法"><a href="#哈希算法" class="headerlink" title="哈希算法"></a>哈希算法</h4><p>哈希算法是一个单向函数，可以将任意长度的输入数据转化为固定长度的输出数据（哈希值），哈希值就是这段输入数据唯一的数值表现。由于在计算上不可能找到哈希值相同而输入值不同的字符串，因此两段数据的哈希值相同，就可以认为这两段数据也是相同的，所以哈希算法常被用于对数据进行验证。</p><p>在区块链中，数据存储在区块里。每个区块都有一个区块头，区块头中存储了一个将该区块所有数据经过哈希算法得到的哈希值，同时，每个区块中还存储了前一个区块的哈希值，这样就形成了区块链。如果想要篡改某一个区块A中的数据，就会导致A的哈希值发生变化，后一个区块B就无法通过哈希值正确地指向A，这样篡改者又必须篡改B中的数据……也就是说，篡改者需要篡改被篡改的区块以及后面的所有区块，才能让所有的节点都接受篡改。</p><h4 id="Merkle树"><a href="#Merkle树" class="headerlink" title="Merkle树"></a>Merkle树</h4><p>Merkle树是一种树形结构，在区块链中，Merkle树的叶子节点是区块中数据的哈希值，非叶子节点是其子结点组合后的哈希值，这样由叶子节点开始逐层往上计算，最终形成一个Merkle根，记录在区块的头部，这样就可以保证每一笔交易都无法篡改。</p><center class="half">    <img src="/2021/03/17/task1-qu-kuai-lian-jian-jie-yu-yi-tai-fang-ru-men-jie-shao/image4.png" width="500"></center><center>Merkle 树</center><p>Merkle Tree实际上就是 树+Hash，具有树的性质，树的每个节点都是Hash值。Merkle Tree有以下特点：</p><ol><li>Merkle Tree可以是二叉树，也可以是多叉树，不管是什么树，它都具有树结构的所有特点。</li><li>Merkel Tree的叶子节点的Value是数据集合的单元数据 或 单元数据的Hash值。</li><li>Merkel Tree所有非叶子节点的Value是所有子节点Value的Hash值。</li></ol><h5 id="Merkle-Tree的应用"><a href="#Merkle-Tree的应用" class="headerlink" title="Merkle Tree的应用"></a>Merkle Tree的应用</h5><p>Merkel Tree多用在数据验证，其中最有名的应用领域可能就属加密货币了。矿机在挖矿实际上就是在运算一组复杂的公式：</p><blockquote><p>SHA256(SHA256(version + prevHash + <strong>merkleRoot</strong> + time + currentDifficulty + nonce )) &lt; TARGET</p></blockquote><p>这里不必深究公式的意义，只需要关注其中的一个“merkleRoot”参数，这个“merkleRoot”就是Merkle Tree的根节点的值。想要算出根节点的值，必须要从叶子节点出发（在加密货币中，叶子节点通常为各区块内从n个交易提取的n个Hash值），最后由根节点的两个子节点的Hash计算出根节点的Hash。这只是挖矿的一个小环节。</p><h5 id="Merkle-Tree的实现"><a href="#Merkle-Tree的实现" class="headerlink" title="Merkle Tree的实现"></a>Merkle Tree的实现</h5><ul><li>使用python语言，用到hashlib</li><li>为了简便，这里的Merkle Tree为二叉树</li><li>简单的将子节点Hash相加来生成父节点的Hash</li><li>假设初始有八个叶子节点，输出结果为二叉树各节点的值</li></ul><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> hashlib<span class="token keyword">class</span> <span class="token class-name">Merkle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment">#Merkle Tree</span>    Merkle_tree <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>        <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> values<span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># 将字符串初始化为叶子节点的Hash值</span>        child_node_start_index <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>values<span class="token punctuation">)</span>        total_length <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>values<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">-</span> <span class="token number">1</span>        sha256 <span class="token operator">=</span> hashlib<span class="token punctuation">.</span>sha256<span class="token punctuation">(</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>Merkle_tree <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">""</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>total_length<span class="token punctuation">)</span><span class="token punctuation">]</span>                <span class="token keyword">for</span> each <span class="token keyword">in</span> values<span class="token punctuation">:</span>            sha256<span class="token punctuation">.</span>update<span class="token punctuation">(</span>each<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            self<span class="token punctuation">.</span>Merkle_tree<span class="token punctuation">[</span>child_node_start_index <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> sha256<span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span>            child_node_start_index <span class="token operator">+=</span> <span class="token number">1</span>            <span class="token keyword">def</span> <span class="token function">merkel_yourself</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>  <span class="token comment"># 生成Merkle Tree</span>        node_index <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>Merkle_tree<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span>  <span class="token comment"># 由叶子节点末尾向前计算非叶子节点的Hash</span>        sha256 <span class="token operator">=</span> hashlib<span class="token punctuation">.</span>sha256<span class="token punctuation">(</span><span class="token punctuation">)</span>                <span class="token keyword">while</span> node_index <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">:</span>            sha256<span class="token punctuation">.</span>update<span class="token punctuation">(</span>self<span class="token punctuation">.</span>Merkle_tree<span class="token punctuation">[</span>node_index<span class="token punctuation">]</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span> <span class="token operator">+</span> self<span class="token punctuation">.</span>Merkle_tree<span class="token punctuation">[</span>node_index <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            self<span class="token punctuation">.</span>Merkle_tree<span class="token punctuation">[</span>node_index <span class="token operator">//</span> <span class="token number">2</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> sha256<span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span>            node_index <span class="token operator">-=</span> <span class="token number">2</span>            <span class="token keyword">def</span> <span class="token function">show_yourself</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">for</span> each <span class="token keyword">in</span> self<span class="token punctuation">.</span>Merkle_tree<span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>each<span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    values <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>  <span class="token comment"># 测试数据</span>    values<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token string">"Terence"</span><span class="token punctuation">)</span>    values<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token string">"Terence1023"</span><span class="token punctuation">)</span>    values<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token string">"TerenceCai"</span><span class="token punctuation">)</span>values<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token string">"Don't forget me, I beg"</span><span class="token punctuation">)</span>     values<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token string">"I'll remember you said"</span><span class="token punctuation">)</span>     values<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token string">"Sometime it lasts in love"</span><span class="token punctuation">)</span>     values<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token string">"But sometimes it hurts instead"</span><span class="token punctuation">)</span>        tree <span class="token operator">=</span> Merkle<span class="token punctuation">(</span>values<span class="token operator">=</span>values<span class="token punctuation">)</span>    tree<span class="token punctuation">.</span>merkel_yourself<span class="token punctuation">(</span><span class="token punctuation">)</span>    tree<span class="token punctuation">.</span>show_yourself<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>    main<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="非对称加密技术"><a href="#非对称加密技术" class="headerlink" title="非对称加密技术"></a>非对称加密技术</h4><p>非对称加密技术使用两个非对称密钥：公钥和私钥。公钥和私钥具有两个特点：</p><ol><li>通过其中一个密钥加密信息后，使用另一个密钥才能解开</li><li>公钥一般可以公开，私钥则保密</li></ol><p>在区块链中，非对称加密技术主要用于信息加密、数字签名和登录认证。在信息加密场景中，信息发送者A使用接收者B提供的公钥对信息进行加密，B收到加密的信息后再通过自己的私钥进行解密。再数字签名场景中，发送者A通过自己的私钥对信息进行加密，其他人通过A提供的公钥来对信息进行验证，证明信息确实是由A发出。在登录认证场景中，客户端使用私钥加密登录信息后进行发送，其他人通过客户端公钥来认证登录信息。</p><ul><li><p>RSA 算法</p><p>​        RSA加密算法是最常用的非对称加密算法，CFCA在证书服务中离不了它。但是有不少新来的同事对它不太了解，恰好看到一本书中作者用实例对它进行了简化而生动的描述，使得高深的数学理论能够被容易地理解。<br>​       RSA是第一个比较完善的公开密钥算法，它既能用于加密，也能用于数字签名。RSA以它的三个发明者Ron Rivest, Adi Shamir, Leonard Adleman的名字首字母命名，这个算法经受住了多年深入的密码分析，虽然密码分析者既不能证明也不能否定RSA的安全性，但这恰恰说明该算法有一定的可信性，目前它已经成为最流行的公开密钥算法。<br>　　RSA的安全基于大数分解的难度。其公钥和私钥是一对大素数（100到200位十进制数或更大）的函数。从一个公钥和密文恢复出明文的难度，等价于分解两个大素数之积（这是公认的数学难题）。 </p></li><li><p>ECC 椭圆曲线算法</p><p>具体可以参见此文章：<a href="https://zhuanlan.zhihu.com/p/36326221">ECC椭圆曲线加密算法：介绍</a></p></li></ul><h3 id="1-3-5、非对称加密技术——RSA-算法"><a href="#1-3-5、非对称加密技术——RSA-算法" class="headerlink" title="1.3.5、非对称加密技术——RSA 算法"></a>1.3.5、非对称加密技术——RSA 算法</h3><p>所谓非对称加密，其实很简单，就是加密和解密需要两把钥匙：一把公钥和一把私钥。</p><p><img src="http://www.ruanyifeng.com/blogimg/asset/2018/bg2018010403.png" alt=""></p><p>公钥是公开的，任何人都可以获取。私钥是保密的，只有拥有者才能使用。他人使用你的公钥加密信息，然后发送给你，你用私钥解密，取出信息。反过来，你也可以用私钥加密信息，别人用你的公钥解开，从而证明这个信息确实是你发出的，且未被篡改，这叫做数字签名。</p><h4 id="RSA-算法原理"><a href="#RSA-算法原理" class="headerlink" title="RSA 算法原理"></a>RSA 算法原理</h4><h5 id="1-加密历史"><a href="#1-加密历史" class="headerlink" title="1.加密历史"></a>1.加密历史</h5><p>1976年以前，所有的加密方法都是同一种模式：</p><blockquote><p>　　（1）甲方选择某一种加密规则，对信息进行加密；</p><p>　　（2）乙方使用同一种规则，对信息进行解密。</p></blockquote><p>由于加密和解密使用同样规则（简称”密钥”），这被称为<a href="http://zh.wikipedia.org/zh-cn/对等加密">“对称加密算法”</a>（Symmetric-key algorithm）。</p><p>这种加密模式有一个最大弱点：甲方必须把加密规则告诉乙方，否则无法解密。保存和传递密钥，就成了最头疼的问题。</p><p><img src="https://www.ruanyifeng.com/blogimg/asset/201306/bg2013062703.jpg" alt=""></p><p>1976年，两位美国计算机学家Whitfield Diffie 和 Martin Hellman，提出了一种崭新构思，可以在不直接传递密钥的情况下，完成解密。这被称为<a href="http://en.wikipedia.org/wiki/Diffie–Hellman_key_exchange">“Diffie-Hellman密钥交换算法”</a>。这个算法启发了其他科学家。人们认识到，加密和解密可以使用不同的规则，只要这两种规则之间存在某种对应关系即可，这样就避免了直接传递密钥。</p><p>这种新的加密模式被称为”非对称加密算法”。</p><blockquote><p>　　（1）乙方生成两把密钥（公钥和私钥）。公钥是公开的，任何人都可以获得，私钥则是保密的。</p><p>　　（2）甲方获取乙方的公钥，然后用它对信息加密。</p><p>　　（3）乙方得到加密后的信息，用私钥解密。</p></blockquote><p>如果公钥加密的信息只有私钥解得开，那么只要私钥不泄漏，通信就是安全的。</p><p><img src="https://www.ruanyifeng.com/blogimg/asset/201306/bg2013062702.jpg" alt=""></p><p>1977年，三位数学家Rivest、Shamir 和 Adleman 设计了一种算法，可以实现非对称加密。这种算法用他们三个人的名字命名，叫做<a href="http://zh.wikipedia.org/zh-cn/RSA加密算法">RSA算法</a>。从那时直到现在，RSA算法一直是最广为使用的”非对称加密算法”。毫不夸张地说，只要有计算机网络的地方，就有RSA算法。</p><p>这种算法非常<a href="http://en.wikipedia.org/wiki/RSA_Factoring_Challenge">可靠</a>，密钥越长，它就越难破解。根据已经披露的文献，目前被破解的最长RSA密钥是768个二进制位。也就是说，长度超过768位的密钥，还无法破解（至少没人公开宣布）。因此可以认为，1024位的RSA密钥基本安全，2048位的密钥极其安全。</p><p>下面，我就进入正题，解释RSA算法的原理。文章共分成两部分，今天是第一部分，介绍要用到的四个数学概念。你可以看到，RSA算法并不难，只需要一点<a href="http://jeremykun.com/2011/07/30/number-theory-a-primer/">数论知识</a>就可以理解。</p><h5 id="2-互质关系"><a href="#2-互质关系" class="headerlink" title="2.互质关系"></a>2.互质关系</h5><p>如果两个正整数，除了1以外，没有其他公因子，我们就称这两个数是<a href="http://zh.wikipedia.org/zh-cn/互素">互质关系</a>（coprime）。比如，15和32没有公因子，所以它们是互质关系。这说明，不是质数也可以构成互质关系。</p><p>关于互质关系，不难得到以下结论：</p><blockquote><p>　　1. 任意两个质数构成互质关系，比如13和61。</p><p>　　2. 一个数是质数，另一个数只要不是前者的倍数，两者就构成互质关系，比如3和10。</p><p>　　3. 如果两个数之中，较大的那个数是质数，则两者构成互质关系，比如97和57。</p><p>　　4. 1和任意一个自然数是都是互质关系，比如1和99。</p><p>　　5. p是大于1的整数，则p和p-1构成互质关系，比如57和56。</p><p>　　6. p是大于1的奇数，则p和p-2构成互质关系，比如17和15。</p></blockquote><h5 id="3-欧拉函数"><a href="#3-欧拉函数" class="headerlink" title="3.欧拉函数"></a>3.欧拉函数</h5><p>请思考以下问题：</p><blockquote><p>　　任意给定正整数n，请问在小于等于n的正整数之中，有多少个与n构成互质关系？（比如，在1到8之中，有多少个数与8构成互质关系？）</p></blockquote><p>计算这个值的方法就叫做<a href="http://zh.wikipedia.org/wiki/欧拉函数">欧拉函数</a>，以φ(n)表示。在1到8之中，与8形成互质关系的是1、3、5、7，所以 φ(n) = 4。</p><p>φ(n) 的计算方法并不复杂，但是为了得到最后那个公式，需要一步步讨论。</p><p><strong>第一种情况</strong></p><p>如果n=1，则 φ(1) = 1 。因为1与任何数（包括自身）都构成互质关系。</p><p><strong>第二种情况</strong></p><p>如果n是质数，则 φ(n)=n-1 。因为质数与小于它的每一个数，都构成互质关系。比如5与1、2、3、4都构成互质关系。</p><p><strong>第三种情况</strong></p><p>如果n是质数的某一个次方，即 n = p^k (p为质数，k为大于等于1的整数)，则</p><script type="math/tex; mode=display">\phi\left(p^{k}\right)=p^{k}-p^{k-1}</script><p>比如 φ(8) = φ(2^3) =2^3 - 2^2 = 8 -4 = 4。</p><p>这是因为只有当一个数不包含质数p，才可能与n互质。而包含质数p的数一共有p^(k-1)个，即1×p、2×p、3×p、…、p^(k-1)×p，把它们去除，剩下的就是与n互质的数。</p><p>上面的式子还可以写成下面的形式：</p><script type="math/tex; mode=display">\phi\left(p^{k}\right)=p^{k}-p^{k-1}=p^{k}\left(1-\frac{1}{p}\right)</script><p>可以看出，上面的第二种情况是 k=1 时的特例。</p><p><strong>第四种情况</strong></p><p>如果n可以分解成两个互质的整数之积，</p><blockquote><p>　　n = p1 × p2</p></blockquote><p>则</p><blockquote><p>　　φ(n) = φ(p1p2) = φ(p1)φ(p2)</p></blockquote><p>即积的欧拉函数等于各个因子的欧拉函数之积。比如，φ(56)=φ(8×7)=φ(8)×φ(7)=4×6=24。</p><p>这一条的证明要用到<a href="http://en.wikipedia.org/wiki/Chinese_remainder_theorem">“中国剩余定理”</a>，这里就不展开了，只简单说一下思路：如果a与p1互质(a&lt;p1)，b与p2互质(b&lt;p2)，c与p1p2互质(c&lt;p1p2)，则c与数对 (a,b) 是一一对应关系。由于a的值有φ(p1)种可能，b的值有φ(p2)种可能，则数对 (a,b) 有φ(p1)φ(p2)种可能，而c的值有φ(p1p2)种可能，所以φ(p1p2)就等于φ(p1)φ(p2)。</p><p><strong>第五种情况</strong></p><p>因为任意一个大于1的正整数，都可以写成一系列质数的积。</p><script type="math/tex; mode=display">n=p_{1}^{k_{1}} p_{2}^{k_{2} \ldots } p_{r}^{k_{r}}</script><p>根据第4条的结论，得到</p><script type="math/tex; mode=display">\phi(n)=\phi\left(p_{1}^{k_{1}}\right) \phi\left(p_{2}^{k_{2}}\right) \ldots \phi\left(p_{r}^{k_{r}}\right)</script><p>再根据第3条的结论，得到</p><script type="math/tex; mode=display">\phi(n)=p_{1}^{k_{1}} p_{2}^{k_{2} \ldots} p_{r}^{k_{r}}\left(1-\frac{1}{p_{1}}\right)\left(1-\frac{1}{p_{2}}\right) \ldots\left(1-\frac{1}{p_{r}}\right)</script><p>也就等于</p><script type="math/tex; mode=display">\phi(n)=n\left(1-\frac{1}{p_{1}}\right)\left(1-\frac{1}{p_{2}}\right) \ldots\left(1-\frac{1}{p_{r}}\right)</script><p>这就是欧拉函数的通用计算公式。比如，1323的欧拉函数，计算过程如下：</p><script type="math/tex; mode=display">\phi(1323)=\phi\left(3^{3} \times 7^{2}\right)=1323\left(1-\frac{1}{3}\right)\left(1-\frac{1}{7}\right)=756</script><h5 id="4-欧拉定理"><a href="#4-欧拉定理" class="headerlink" title="4.欧拉定理"></a>4.欧拉定理</h5><p>欧拉函数的用处，在于<a href="http://zh.wikipedia.org/wiki/欧拉定理_(数论">欧拉定理</a>)。”欧拉定理”指的是：</p><blockquote><p>如果两个正整数a和n互质，则n的欧拉函数 φ(n) 可以让下面的等式成立：</p><script type="math/tex; mode=display">a^{\phi(n)} \equiv 1(\bmod n)</script></blockquote><p>也就是说，a的φ(n)次方被n除的余数为1。或者说，a的φ(n)次方减去1，可以被n整除。比如，3和7互质，而7的欧拉函数φ(7)等于6，所以3的6次方（729）减去1，可以被7整除（728/7=104）。</p><p>欧拉定理的证明比较复杂，这里就省略了。我们只要记住它的结论就行了。</p><p>欧拉定理可以大大简化某些运算。比如，7和10互质，根据欧拉定理，</p><script type="math/tex; mode=display">7^{\phi(10)} \equiv 1(\bmod 10)</script><p>已知 φ(10) 等于4，所以马上得到7的4倍数次方的个位数肯定是1。</p><script type="math/tex; mode=display">7^{4 k} \equiv 1(\bmod 10)</script><p>因此，7的任意次方的个位数（例如7的222次方），心算就可以算出来。</p><p>欧拉定理有一个特殊情况。</p><blockquote><p>假设正整数a与质数p互质，因为质数p的φ(p)等于p-1，则欧拉定理可以写成</p><script type="math/tex; mode=display">a^{p-1} \equiv 1(\bmod p)</script></blockquote><p>这就是著名的<a href="http://zh.wikipedia.org/wiki/费马小定理">费马小定理</a>。它是欧拉定理的特例。</p><p>欧拉定理是RSA算法的核心。理解了这个定理，就可以理解RSA。</p><h5 id="5-模反元素"><a href="#5-模反元素" class="headerlink" title="5.模反元素"></a>5.模反元素</h5><p>还剩下最后一个概念：</p><blockquote><p>如果两个正整数a和n互质，那么一定可以找到整数b，使得 ab-1 被n整除，或者说ab被n除的余数是1。</p><script type="math/tex; mode=display">a b \equiv 1(\bmod n)</script><p>这时，b就叫做a的<a href="http://zh.wikipedia.org/wiki/模反元素">“模反元素”</a>。</p></blockquote><p>比如，3和11互质，那么3的模反元素就是4，因为 (3 × 4)-1 可以被11整除。显然，模反元素不止一个， 4加减11的整数倍都是3的模反元素 {…,-18,-7,4,15,26,…}，即如果b是a的模反元素，则 b+kn 都是a的模反元素。</p><p>欧拉定理可以用来证明模反元素必然存在。</p><script type="math/tex; mode=display">a^{\phi(n)} =aa^{\phi(n)-1}\equiv 1(\bmod n)</script><p>可以看到，a的 φ(n)-1 次方，就是a的模反元素。</p><h5 id="6-密钥生成的步骤"><a href="#6-密钥生成的步骤" class="headerlink" title="6.密钥生成的步骤"></a>6.密钥生成的步骤</h5><p>我们通过一个例子，来理解RSA算法。假设<a href="http://zh.wikipedia.org/wiki/爱丽丝与鲍伯">爱丽丝</a>要与鲍勃进行加密通信，她该怎么生成公钥和私钥呢？</p><p><img src="http://www.ruanyifeng.com/blogimg/asset/201307/bg2013070302.png" alt=""></p><p><strong>第一步，随机选择两个不相等的质数p和q。</strong></p><p>爱丽丝选择了61和53。（实际应用中，这两个质数越大，就越难破解。）</p><p><strong>第二步，计算p和q的乘积n。</strong></p><p>爱丽丝就把61和53相乘。</p><blockquote><p>　　n = 61×53 = 3233</p></blockquote><p>n的长度就是密钥长度。3233写成二进制是110010100001，一共有12位，所以这个密钥就是12位。实际应用中，RSA密钥一般是1024位，重要场合则为2048位。</p><p><strong>第三步，计算n的欧拉函数φ(n)。</strong></p><p>根据公式：</p><blockquote><p>　　φ(n) = (p-1)(q-1)</p></blockquote><p>爱丽丝算出φ(3233)等于60×52，即3120。</p><p><strong>第四步，随机选择一个整数e，条件是1&lt; e &lt; φ(n)，且e与φ(n) 互质。</strong></p><p>爱丽丝就在1到3120之间，随机选择了17。（实际应用中，常常选择65537。）</p><p><strong>第五步，计算e对于φ(n)的模反元素d。</strong></p><p>所谓<a href="http://zh.wikipedia.org/wiki/模反元素">“模反元素”</a>就是指有一个整数d，可以使得ed被φ(n)除的余数为1。</p><blockquote><p>　　ed ≡ 1 (mod φ(n))</p></blockquote><p>这个式子等价于</p><blockquote><p>　　ed - 1 = kφ(n)</p></blockquote><p>于是，找到模反元素d，实质上就是对下面这个二元一次方程求解。</p><blockquote><script type="math/tex; mode=display">e x+\varphi(n) y=1</script></blockquote><p>已知 e=17, φ(n)=3120，</p><blockquote><p>　　17x + 3120y = 1</p></blockquote><p>这个方程可以用<a href="http://zh.wikipedia.org/wiki/扩展欧几里得算法">“扩展欧几里得算法”</a>求解，此处省略具体过程。总之，爱丽丝算出一组整数解为 (x,y)=(2753,-15)，即 d=2753。</p><p>至此所有计算完成。</p><p><strong>第六步，将n和e封装成公钥，n和d封装成私钥。</strong></p><p>在爱丽丝的例子中，n=3233，e=17，d=2753，所以公钥就是 (3233,17)，私钥就是（3233, 2753）。</p><p>实际应用中，公钥和私钥的数据都采用<a href="http://zh.wikipedia.org/zh-cn/ASN.1">ASN.1</a>格式表达（<a href="http://hi.baidu.com/mathack/item/d0ad4cc1514a3663f7c95da2">实例</a>）。</p><h5 id="7-RSA算法的可靠性"><a href="#7-RSA算法的可靠性" class="headerlink" title="7.RSA算法的可靠性"></a>7.RSA算法的可靠性</h5><p>回顾上面的密钥生成步骤，一共出现六个数字：</p><blockquote><p>　　p<br>　　q<br>　　n<br>　　φ(n)<br>　　e<br>　　d</p></blockquote><p>这六个数字之中，公钥用到了两个（n和e），其余四个数字都是不公开的。其中最关键的是d，因为n和d组成了私钥，一旦d泄漏，就等于私钥泄漏。</p><p><strong>那么，有无可能在已知n和e的情况下，推导出d？</strong></p><blockquote><p>　　（1）ed≡1 (mod φ(n))。只有知道e和φ(n)，才能算出d。</p><p>　　（2）φ(n)=(p-1)(q-1)。只有知道p和q，才能算出φ(n)。</p><p>　　（3）n=pq。只有将n因数分解，才能算出p和q。</p></blockquote><p><strong>结论：如果n可以被因数分解，d就可以算出，也就意味着私钥被破解。</strong></p><p>可是，大整数的因数分解，是一件非常困难的事情。目前，除了暴力破解，还没有发现别的有效方法。维基百科这样写道：</p><blockquote><p>　　“对极大整数做因数分解的难度决定了RSA算法的可靠性。换言之，对一极大整数做因数分解愈困难，RSA算法愈可靠。</p><p>　　假如有人找到一种快速因数分解的算法，那么RSA的可靠性就会极度下降。但找到这样的算法的可能性是非常小的。今天只有短的RSA密钥才可能被暴力破解。到2008年为止，世界上还没有任何可靠的攻击RSA算法的方式。</p><p>　　只要密钥长度足够长，用RSA加密的信息实际上是不能被解破的。”</p></blockquote><p>举例来说，你可以对3233进行因数分解（61×53），但是你没法对下面这个整数进行因数分解。</p><blockquote><p>　　12301866845301177551304949<br>　　58384962720772853569595334<br>　　79219732245215172640050726<br>　　36575187452021997864693899<br>　　56474942774063845925192557<br>　　32630345373154826850791702<br>　　61221429134616704292143116<br>　　02221240479274737794080665<br>　　351419597459856902143413</p></blockquote><p>它等于这样两个质数的乘积：</p><blockquote><p>　　33478071698956898786044169<br>　　84821269081770479498371376<br>　　85689124313889828837938780<br>　　02287614711652531743087737<br>　　814467999489<br>　　　　×<br>　　36746043666799590428244633<br>　　79962795263227915816434308<br>　　76426760322838157396665112<br>　　79233373417143396810270092<br>　　798736308917</p></blockquote><p>事实上，这大概是人类已经分解的最大整数（232个十进制位，768个二进制位）。比它更大的因数分解，还没有被报道过，因此目前被破解的最长RSA密钥就是768位。</p><h5 id="8-加密和解密"><a href="#8-加密和解密" class="headerlink" title="8.加密和解密"></a>8.加密和解密</h5><p>有了公钥和密钥，就能进行加密和解密了。</p><p><strong>（1）加密要用公钥 (n,e)</strong></p><p>假设鲍勃要向爱丽丝发送加密信息m，他就要用爱丽丝的公钥 (n,e) 对m进行加密。这里需要注意，m必须是整数（字符串可以取ascii值或unicode值），且m必须小于n。</p><p>所谓”加密”，就是算出下式的c：</p><blockquote><p>　　me ≡ c (mod n)</p></blockquote><p>爱丽丝的公钥是 (3233, 17)，鲍勃的m假设是65，那么可以算出下面的等式：</p><blockquote><p>　　6517 ≡ 2790 (mod 3233)</p></blockquote><p>于是，c等于2790，鲍勃就把2790发给了爱丽丝。</p><p><strong>（2）解密要用私钥(n,d)</strong></p><p>爱丽丝拿到鲍勃发来的2790以后，就用自己的私钥(3233, 2753) 进行解密。可以证明，下面的等式一定成立：</p><blockquote><p>　　cd ≡ m (mod n)</p></blockquote><p>也就是说，c的d次方除以n的余数为m。现在，c等于2790，私钥是(3233, 2753)，那么，爱丽丝算出</p><blockquote><p>　　27902753 ≡ 65 (mod 3233)</p></blockquote><p>因此，爱丽丝知道了鲍勃加密前的原文就是65。</p><p>至此，”加密—解密”的整个过程全部完成。</p><p>我们可以看到，如果不知道d，就没有办法从c求出m。而前面已经说过，要知道d就必须分解n，这是极难做到的，所以RSA算法保证了通信安全。</p><p>你可能会问，公钥(n,e) 只能加密小于n的整数m，那么如果要加密大于n的整数，该怎么办？有两种解决方法：一种是把长信息分割成若干段短消息，每段分别加密；另一种是先选择一种”对称性加密算法”（比如<a href="https://zh.wikipedia.org/wiki/资料加密标准">DES</a>），用这种算法的密钥加密信息，再用RSA公钥加密DES密钥。</p><p><strong>九、私钥解密的证明</strong></p><p>最后，我们来证明，为什么用私钥解密，一定可以正确地得到m。也就是证明下面这个式子：</p><blockquote><p>　　cd ≡ m (mod n)</p></blockquote><p>因为，根据加密规则</p><blockquote><p>　　ｍe ≡ c (mod n)</p></blockquote><p>于是，c可以写成下面的形式：</p><blockquote><p>　　c = me - kn</p></blockquote><p>将c代入要我们要证明的那个解密规则：</p><blockquote><p>　　(me - kn)d ≡ m (mod n)</p></blockquote><p>它等同于求证</p><blockquote><p>　　med ≡ m (mod n)</p></blockquote><p>由于</p><blockquote><p>　　ed ≡ 1 (mod φ(n))</p></blockquote><p>所以</p><blockquote><p>　　ed = hφ(n)+1</p></blockquote><p>将ed代入：</p><blockquote><p>　　mhφ(n)+1 ≡ m (mod n)</p></blockquote><p>接下来，分成两种情况证明上面这个式子。</p><p><strong>（1）m与n互质。</strong></p><p>根据欧拉定理，此时</p><blockquote><p>　　mφ(n) ≡ 1 (mod n)</p></blockquote><p>得到</p><blockquote><p>　　(mφ(n))h × m ≡ m (mod n)</p></blockquote><p>原式得到证明。</p><p><strong>（2）m与n不是互质关系。</strong></p><p>此时，由于n等于质数p和q的乘积，所以m必然等于kp或kq。</p><p>以 m = kp为例，考虑到这时k与q必然互质，则根据欧拉定理，下面的式子成立：</p><blockquote><p>　　(kp)q-1 ≡ 1 (mod q)</p></blockquote><p>进一步得到</p><blockquote><p>　　[(kp)q-1]h(p-1) × kp ≡ kp (mod q)</p></blockquote><p>即</p><blockquote><p>　　(kp)ed ≡ kp (mod q)</p></blockquote><p>将它改写成下面的等式</p><blockquote><p>　　(kp)ed = tq + kp</p></blockquote><p>这时t必然能被p整除，即 t=t’p</p><blockquote><p>　　(kp)ed = t’pq + kp</p></blockquote><p>因为 m=kp，n=pq，所以</p><blockquote><p>　　med ≡ m (mod n)</p></blockquote><p>原式得到证明。</p><h4 id="数字签名"><a href="#数字签名" class="headerlink" title="数字签名"></a>数字签名</h4><p><strong>数字签名是什么？</strong></p><p>作者：David Youd</p><p>翻译：阮一峰</p><p>原文网址：<a href="http://www.youdzone.com/signature.html">http://www.youdzone.com/signature.html</a></p><p>1.</p><p><img src="http://www.ruanyifeng.com/blogimg/asset/201108/bg2011080901.png" alt=""></p><p>鲍勃有两把钥匙，一把是公钥，另一把是私钥。</p><p>2.</p><p><img src="http://www.ruanyifeng.com/blogimg/asset/201108/bg2011080902.png" alt=""></p><p>鲍勃把公钥送给他的朋友们——帕蒂、道格、苏珊——每人一把。</p><p>3.</p><p><img src="http://www.ruanyifeng.com/blogimg/asset/201108/bg2011080903.png" alt=""></p><p>苏珊要给鲍勃写一封保密的信。她写完后用鲍勃的公钥加密，就可以达到保密的效果。</p><p>4.</p><p><img src="http://www.ruanyifeng.com/blogimg/asset/201108/bg2011080904.png" alt=""></p><p>鲍勃收信后，用私钥解密，就看到了信件内容。这里要强调的是，只要鲍勃的私钥不泄露，这封信就是安全的，即使落在别人手里，也无法解密。</p><p>5.</p><p><img src="http://www.ruanyifeng.com/blogimg/asset/201108/bg2011080905.png" alt=""></p><p>鲍勃给苏珊回信，决定采用”数字签名”。他写完后先用Hash函数，生成信件的摘要（digest）。</p><p>6.</p><p><img src="http://www.ruanyifeng.com/blogimg/asset/201108/bg2011080906.png" alt=""></p><p>然后，鲍勃使用私钥，对这个摘要加密，生成”数字签名”（signature）。</p><p>7.</p><p><img src="http://www.ruanyifeng.com/blogimg/asset/201108/bg2011080907.png" alt=""></p><p>鲍勃将这个签名，附在信件下面，一起发给苏珊。</p><p>8.</p><p><img src="http://www.ruanyifeng.com/blogimg/asset/201108/bg2011080908.png" alt=""></p><p>苏珊收信后，取下数字签名，用鲍勃的公钥解密，得到信件的摘要。由此证明，这封信确实是鲍勃发出的。</p><p>9.</p><p><img src="http://www.ruanyifeng.com/blogimg/asset/201108/bg2011080909.png" alt=""></p><p>苏珊再对信件本身使用Hash函数，将得到的结果，与上一步得到的摘要进行对比。如果两者一致，就证明这封信未被修改过。</p><p>10.</p><p><img src="http://www.ruanyifeng.com/blogimg/asset/201108/bg2011080910.png" alt=""></p><p>复杂的情况出现了。道格想欺骗苏珊，他偷偷使用了苏珊的电脑，用自己的公钥换走了鲍勃的公钥。此时，苏珊实际拥有的是道格的公钥，但是还以为这是鲍勃的公钥。因此，道格就可以冒充鲍勃，用自己的私钥做成”数字签名”，写信给苏珊，让苏珊用假的鲍勃公钥进行解密。</p><p>11.</p><p><img src="http://www.ruanyifeng.com/blogimg/asset/201108/bg2011080911.png" alt=""></p><p>后来，苏珊感觉不对劲，发现自己无法确定公钥是否真的属于鲍勃。她想到了一个办法，要求鲍勃去找”证书中心”（certificate authority，简称CA），为公钥做认证。证书中心用自己的私钥，对鲍勃的公钥和一些相关信息一起加密，生成”数字证书”（Digital Certificate）。</p><p>12.</p><p><img src="http://www.ruanyifeng.com/blogimg/asset/201108/bg2011080912.png" alt=""></p><p>鲍勃拿到数字证书以后，就可以放心了。以后再给苏珊写信，只要在签名的同时，再附上数字证书就行了。</p><p>13.</p><p><img src="http://www.ruanyifeng.com/blogimg/asset/201108/bg2011080913.png" alt=""></p><p>苏珊收信后，用CA的公钥解开数字证书，就可以拿到鲍勃真实的公钥了，然后就能证明”数字签名”是否真的是鲍勃签的。</p><p>14.</p><p><img src="http://www.ruanyifeng.com/blogimg/asset/201108/bg2011080914.jpg" alt=""></p><p>下面，我们看一个应用”数字证书”的实例：https协议。这个协议主要用于网页加密。</p><p>15.</p><p><img src="http://www.ruanyifeng.com/blogimg/asset/201108/bg2011080915.png" alt=""></p><p>首先，客户端向服务器发出加密请求。</p><p>16.</p><p><img src="http://www.ruanyifeng.com/blogimg/asset/201108/bg2011080916.png" alt=""></p><p>服务器用自己的私钥加密网页以后，连同本身的数字证书，一起发送给客户端。</p><p>17.</p><p><img src="http://www.ruanyifeng.com/blogimg/asset/201108/bg2011080917.png" alt=""></p><p>客户端（浏览器）的”证书管理器”，有”受信任的根证书颁发机构”列表。客户端会根据这张列表，查看解开数字证书的公钥是否在列表之内。</p><p>18.</p><p><img src="http://www.ruanyifeng.com/blogimg/asset/201108/bg2011080918.png" alt=""></p><p>如果数字证书记载的网址，与你正在浏览的网址不一致，就说明这张证书可能被冒用，浏览器会发出警告。</p><p>19.</p><p><img src="http://www.ruanyifeng.com/blogimg/asset/201108/bg2011080919.jpg" alt=""></p><p>如果这张数字证书不是由受信任的机构颁发的，浏览器会发出另一种警告。</p><p>20.</p><p><img src="http://www.ruanyifeng.com/blogimg/asset/201108/bg2011080920.png" alt=""></p><p>如果数字证书是可靠的，客户端就可以使用证书中的服务器公钥，对信息进行加密，然后与服务器交换加密信息。</p><h3 id="1-3-6、共识机制"><a href="#1-3-6、共识机制" class="headerlink" title="1.3.6、共识机制"></a>1.3.6、共识机制</h3><p>区块链系统是一个分布式系统，分布式系统要解决都首要问题就是一致性问题，也就是如何使多个孤立的节点达成共识。在中心化系统中，由于有一个中心服务器这样的“领导”来统一各个节点，因此达成一致性几乎没有问题。但在去中心化场景下，由于各个节点是相互独立的，就可能会出现许多不一致的问题，例如由于网络状况等因素部分节点可能会有延迟、故障甚至宕机，造成节点之间通信的不可靠，因此一致性问题是分布式系统中一个很令人头疼的问题。</p><p>由 Eirc Brewer 提出，Lynch 等人证明的 CAP 定理为解决分布式系统中的一致性问题提供了思路。CAP 定理的描述如下：在分布式系统中，<strong>一致性</strong>、<strong>可用性</strong>和<strong>分区容错性</strong>三者不可兼得。这三个术语的解释如下：</p><ul><li>一致性（<strong>C</strong>onsistency）：所有节点在同一时刻拥有同样的值（等同于所有节点访问同一份最新的数据副本</li><li>可用性（<strong>A</strong>vailability）：每个请求都可以在有限时间内收到确定其是否成功的响应</li><li>分区容错性（<strong>P</strong>artition tolerance）：分区是指部分节点因为网络原因无法与其他节点达成一致。分区容错性是指由网络原因导致的系统分区不影响系统的正常运行。例如，由于网络原因系统被分为 A, B, C, D 四个区，A, B 中的节点无法正常工作，但 C, D 组成的分区仍能提供正常服务。</li></ul><p>在某些场景下，对一致性、可用性和分区容错性中的某一个特性要求不高时，就可以考虑弱化该特性，来保证整个系统的容错能力。区块链中常见的共识机制的基本思路正是来自 CAP 定理，部分区块链应用中用到的共识机制如下表：</p><div class="table-container"><table><thead><tr><th>共识机制</th><th>应用</th></tr></thead><tbody><tr><td>PoW</td><td>比特币、莱特币、以太坊的前三个阶段</td></tr><tr><td>PoS</td><td>PeerCoin、NXT、以太坊的第四个阶段</td></tr><tr><td>PBFT</td><td>Hyperledger Fabric</td></tr></tbody></table></div><h5 id="PoW（Proof-of-Work，工作量证明）"><a href="#PoW（Proof-of-Work，工作量证明）" class="headerlink" title="PoW（Proof of Work，工作量证明）"></a>PoW（Proof of Work，工作量证明）</h5><p>PoW 机制的大致流程如下：</p><ol><li>向所有节点广播新交易和一个数学问题</li><li>最先解决了数学问题的节点将交易打包成区块，对全网广播</li><li>其他节点验证广播区块的节点是否解决了数学问题（完成了一定的工作量），验证通过则接受该区块，并将该区块的哈希值放入下一个区块中，表示承认该区块</li></ol><p>由于在 PoW 机制中，区块的产生需要解决一个数学问题，也就是所谓的<strong>挖矿</strong>，这往往要消耗较大的算力和电力，因此节点们倾向于在<strong>最长的链</strong>的基础上添加区块，因为如果节点想在自己的链上添加新的区块，那么就需要重新计算 1 个或 $n$ 个这样的数学问题（每添加一个区块就需要计算一个）。因此在比特币中最长的链被认为是合法的链，这样节点间就形成了一套“共识”。</p><p>PoW 机制的优点是完全去中心化，缺点是需要依赖数学运算，资源的消耗会比其他的共识机制高，可监管性弱，同时每次达成共识需要全网共同参与运算，性能较低。</p><h5 id="PoS（Proof-of-Stack，股权证明）"><a href="#PoS（Proof-of-Stack，股权证明）" class="headerlink" title="PoS（Proof of Stack，股权证明）"></a>PoS（Proof of Stack，股权证明）</h5><p>PoS 针对 PoW 的缺点做出了改进。PoS 要求参与者预先放置一些货币在区块链上用于换取“股权”，从而成为<strong>验证者（Validator）</strong>，验证者具有产生区块的权利。PoS 机制会按照存放货币的量和时间给验证者分配相应的利息，同时还引入了奖惩机制，打包错误区块的验证者将失去他的股权——即投入的货币以及产生区块的权利。PoS 机制的大致流程如下：</p><ol><li>加入 PoS 机制的都是持币人，称为验证者</li><li>PoS 算法根据验证者持币的多少在验证者中挑选出一个给予产生区块的权利</li><li>如果一定时间内没有产生区块，PoS 就挑选下一个验证者，给予产生区块的权利</li><li>如果某个验证者打包了一份欺诈性交易，PoS 将剥夺他的股权</li></ol><p>PoS 的优点在于：</p><ol><li>引入了利息，使得像比特币这样发币总数有限的通货紧缩系统在一定时间后不会“无币可发”</li><li>引入了奖惩机制使节点的运行更加可控，同时更好地防止攻击</li><li>与 PoW 相比，不需要为了生成新区块而消耗大量电力和算力</li><li>与 PoW 相比，缩短了达成共识所需的时间</li></ol><p>由于 PoS 机制需要用户已经持有一定数量的货币，没有提供在区块链应用创立初始阶段处理数字货币的方法，因此使用 PoS 机制的区块链应用会在发布时预先出售货币，或在初期采用 PoW，让矿工获得货币后再转换成 PoS，例如以太坊现阶段采用的是 PoW 机制，在第四阶段“宁静”（Serenity）中将过渡到 PoS。</p><h5 id="拜占庭将军问题（Byzantine-Generals-Problem）"><a href="#拜占庭将军问题（Byzantine-Generals-Problem）" class="headerlink" title="拜占庭将军问题（Byzantine Generals Problem）"></a>拜占庭将军问题（Byzantine Generals Problem）</h5><p>拜占庭将军问题是分布式网络中的通信容错问题，可以描述为：</p><blockquote><p>一组拜占庭将军各领一支队伍共同围困一座城市。各支军队的行动策略限定为进攻或撤离两种。因为部分军队进攻而部分军队撤离可能会造成灾难性的后果，因此各将军决定通过投标来达成一致策略，即“共进退”。因为各将军位于城市不同方向，他们只能通过信使互相联系。在投票过程中每位将军都将自己的选择（进攻或撤退）通过信使分别通知其他所有将军，这样一来每位将军根据自己的投票和其他所有将军送来的信息就可以知道共同投票的结果，进而做出行动。</p></blockquote><center class="half">    <img src="/2021/03/17/task1-qu-kuai-lian-jian-jie-yu-yi-tai-fang-ru-men-jie-shao/image1.png" width="500"></center><p>拜占庭将军的问题在于，将军中可能出现叛徒。假设3名将军中有1名叛徒，2名忠诚将军一人投进攻票，一人投撤退票，这时叛徒可能会故意给投进攻的将军投进攻票，而给投撤退的将军投撤退票。这就导致一名将军带队发起进攻，而另外一名将军带队撤退。</p><p>另外，由于将军之间通过信使进行通讯，即使所有将军都忠诚，也不能排除信使被敌人截杀，甚至信使叛变等情况。</p><p>假设存在叛变将军或信使出问题等情况，如果忠诚将军仍然能够通过投票来决定他们的战略，便称系统达到了<strong>拜占庭容错（Byzantine Fault Tolerance）</strong>。</p><p>拜占庭问题对应到区块链中，将军就是节点，信使就是网络等通信系统，要解决的是存在恶意节点、网络错误等情况下系统的一致性问题。</p><p><strong>PBFT（Practical Byzantine Fault Tolerance）</strong> 是第一个得到广泛应用且比较高效的拜占庭容错算法，能够在节点数量不小于 $n=3f+1$ 的情况下容忍 $f$ 个拜占庭节点（恶意节点）。</p><h2 id="1-4、区块链的分叉"><a href="#1-4、区块链的分叉" class="headerlink" title="1.4、区块链的分叉"></a>1.4、区块链的分叉</h2><p>即使区块链是可靠的，现在还有一个问题没有解决：如果两个人同时向区块链写入数据，也就是说，同时有两个区块加入，因为它们都连着前一个区块，就形成了分叉。这时应该采纳哪一个区块呢？</p><p><img src="http://www.ruanyifeng.com/blogimg/asset/2017/bg2017122709.png" alt=""></p><p>现在的规则是，新节点总是采用最长的那条区块链。如果区块链有分叉，将看哪个分支在分叉点后面，先达到6个新区块（称为”六次确认”）。按照10分钟一个区块计算，一小时就可以确认。</p><p><img src="http://www.ruanyifeng.com/blogimg/asset/2017/bg2017122710.png" alt=""></p><p>由于新区块的生成速度由计算能力决定，所以这条规则就是说，拥有大多数计算能力的那条分支，就是正宗的区块链。</p><h2 id="1-5、总结"><a href="#1-5、总结" class="headerlink" title="1.5、总结"></a>1.5、总结</h2><p>区块链作为无人管理的分布式数据库，从2009年开始已经运行了12年，没有出现大的问题。这证明它是可行的。</p><p>但是，为了保证数据的可靠性，区块链也有自己的代价。一是效率，数据写入区块链，最少要等待十分钟，所有节点都同步数据，则需要更多的时间；二是能耗，区块的生成需要矿工进行无数无意义的计算，这是非常耗费能源的。</p><p>因此，区块链的适用场景，其实非常有限。</p><blockquote><ol><li>不存在所有成员都信任的管理当局</li><li>写入的数据不要求实时使用</li><li>挖矿的收益能够弥补本身的成本</li></ol></blockquote><p>如果无法满足上述的条件，那么传统的数据库是更好的解决方案。</p><p><img src="http://www.ruanyifeng.com/blogimg/asset/2017/bg2017122711.png" alt=""></p><h1 id="二、以太坊介绍"><a href="#二、以太坊介绍" class="headerlink" title="二、以太坊介绍"></a>二、以太坊介绍</h1><h2 id="2-1、以太坊简介"><a href="#2-1、以太坊简介" class="headerlink" title="2.1、以太坊简介"></a>2.1、以太坊简介</h2><p>以太坊是一个开放的<code>区块链平台</code>，允许任何人在平台中建立和使用通过区块链技术运行的去中心化应用，同比特币一样，以太坊由全球范围的很多人共同创建，不受任何个人控制。</p><h3 id="2-1-1、下一代区块链"><a href="#2-1-1、下一代区块链" class="headerlink" title="2.1.1、下一代区块链"></a>2.1.1、下一代区块链</h3><p>区块链技术是比特币的底层技术。在比特币中，分布式数据库被设想为一个<code>账户余额表（总账）</code>，交易通过比特币的转移来实现个体之间无需信任基础的金融活动。以太坊试图实现一个总体上完全无需信任基础的智能合约平台。</p><h3 id="2-1-2、以太坊虚拟机"><a href="#2-1-2、以太坊虚拟机" class="headerlink" title="2.1.2、以太坊虚拟机"></a>2.1.2、以太坊虚拟机</h3><p>以太坊是<code>可编程</code>的区块链，不会给用户一系列预先设置好的操作，允许用户自定义复杂的操作。以太坊狭义上是指一系列定义去中心化应用平台的协议，核心是<code>以太坊虚拟机（EVM）</code>，其可以执行任意复杂算法的编码。以太坊是<code>图灵完备</code>的。</p><p>以太坊也有一个点对点的网络协议，以太坊区块链数据库由各网络节点来维护和更新，每个节点运行以太坊虚拟机并执行相同的指令，保证区块链的一致性。</p><h3 id="2-1-3、以太坊工作原理"><a href="#2-1-3、以太坊工作原理" class="headerlink" title="2.1.3、以太坊工作原理"></a>2.1.3、以太坊工作原理</h3><p>比特币可以看作是关于交易的列表，而以太坊的基础单元是<code>账户</code>。以太坊跟踪每个账户的状态，以太坊上所有状态转换都是账户之间价值和信息的转换。</p><p>账户分为两类：</p><ul><li>外部账户（EOA）：由私人密钥控制</li><li>合约账户：由合约代码控制，只能由外部账户“激活”。</li></ul><p><code>智能合约</code>：指合约账户中的编码，即交易被发送给该账户时所运行的程序。用户可以通过在区块链中部署编码来创建新的合约。</p><p>只有当外部账户发出指令时，合约账户才会执行相应的操作，是为了保证正确执行所有操作。</p><p>和比特币一样，以太坊用户需要向网络支付少量的交易费用，通过<code>以太币</code>的形式支付。这样避免受到类似DDos的攻击。</p><p>交易费用由节点收集，节点使网络生效。“矿工”就是以太坊网络中收集、传播、确认和执行交易的节点。矿工将交易打包，打包的数据成为区块，打包的过程就是将以太坊中<code>账户的状态</code>更新的过程。矿工们相互竞争挖矿，成功挖矿的可以得到以太币的奖励。</p><h3 id="2-1-4、幽灵协议"><a href="#2-1-4、幽灵协议" class="headerlink" title="2.1.4、幽灵协议"></a>2.1.4、幽灵协议</h3><p>幽灵合约的英文是“Greedy Heaviest Observed Subtree” (GHOST) protocol，在介绍幽灵协议之前，先介绍以太坊中的叔区块、叔块奖励和叔块引用奖励这三个概念。</p><center class="half">    <img src="/2021/03/17/task1-qu-kuai-lian-jian-jie-yu-yi-tai-fang-ru-men-jie-shao/image5.png" width="400"></center><p>假设目前以太坊区块链中的区块高度（区块链上的区块个数）为6，现在产生了一笔新的交易，矿工A先将该笔交易打包成了区块 Block 7，在矿工A将 Block 7 广播到其他节点的这段时间里，矿工B和矿工C又分别产生了 Block 8 和 Block 9。Block 7、Block 8、Block 9 都指向 Block 6，即 Block 6 是他们的父区块。由于 Block 7 是最先产生的，因此 Block 7 被认为是有效区块，Block 8 和 Block 9 就是<strong>叔区块</strong>（作废区块）。</p><center class="half">    <img src="/2021/03/17/task1-qu-kuai-lian-jian-jie-yu-yi-tai-fang-ru-men-jie-shao/image6.png" width="300"></center><p>现在链上的区块高度为7，在这基础上又产生了新的交易，并被打包成了 Block 10。在以太坊中，Block 10 除了可以引用它的父区块 Block 7 外，还可以引用叔区块 Block 8 和 Block 9。并且，Block 8 和 Block 9 的矿工会因此获得一笔奖励，称为<strong>叔块奖励</strong>，Block 10 的矿工除了基础奖励之外，由于引用了叔区块，还会获得一笔额外的<strong>叔块引用奖励</strong>。</p><p><strong>幽灵协议</strong>是以太坊的一大创新。由于在比特币中的出块时间被设计为10分钟，而以太坊为了提高出块速度，将出块时间设计为12秒（实际14~15秒左右），这样的高速出块意味着高速确认，高速确认会带来区块的<strong>高作废率</strong>和<strong>低安全性</strong>。因为区块需要花一定的时间才能广播至全网，如果矿工 A 挖出了一个区块，而矿工 B 碰巧在 A 的区块扩散至 B 之前挖出了另一个区块，矿工 B 的区块就会作废并且没有对区块链的网络安全做出贡献。此外，这样的高速确认还会带来<strong>中心化</strong>的问题：如果 A 拥有全网 30% 的算力而 B 拥有 10% 的算力，那么 A 将会在 70% 的时间内都在产生作废区块，而 B 在 90% 的时间内都在产生作废区块，这样，B 永远追不上 A，后果是 A 通过其算力份额拥有对挖矿过程实际上的控制权，出现了算力垄断，弱化了去中心化。</p><p>幽灵协议正是为了解决上述问题而引入的，协议的主要内容如下：</p><ul><li>计算最长链时，不仅包括当前区块的父区块和祖区块，还包括祖先块的作废的后代区块（叔区块），将它们综合考虑来计算哪一个区块拥有支持其的最大工作量证明。这解决了网络安全性的问题</li><li>以太坊付给以“叔区块”身份为新块确认作出贡献的废区块87.5%的奖励（叔块奖励），把它们纳入计算的“侄子区块”将获得奖励的12.5%（叔块引用奖励）。这就使得即使产生作废区块的矿工也能够参与区块链网络贡献并获得奖励，解决了中心化倾向的问题</li><li>叔区块最深可以被其父母的第二代至第七代后辈区块引用。这样做是为了：<ul><li>降低引用叔区块的计算复杂性</li><li>过多的叔块引用奖励会剥夺矿工在主链上挖矿的激励，使得矿工有转向公开攻击者链上挖矿的倾向（即公开攻击者可能会恶意产生大量作废区块，无限引用将会诱使矿工转移到攻击者的链上，从而抛弃合法的主链）</li><li>计算表明带有激励的五层幽灵协议即使在出块时间为15s的情况下也实现了了95%以上的效率，而拥有25%算力的矿工从中心化得到的益处小于3%</li></ul></li></ul><h3 id="2-1-5、以太坊的组成部分"><a href="#2-1-5、以太坊的组成部分" class="headerlink" title="2.1.5、以太坊的组成部分"></a>2.1.5、以太坊的组成部分</h3><p>在以太坊中，包括了 P2P 网络、共识机制、交易、状态机、客户端这几个组成部分。</p><ul><li>P2P 网络：在以太坊主网上运行，可通过TCP端口30303访问，并运行称为 ÐΞVp2p 的协议。</li><li>共识机制：以太坊目前使用名为 Ethash 的 POW 算法，计划在将来会过渡到称为 Casper 的 POS 算法。</li><li>交易：以太坊中的交易本质上是网络消息，包括发送者、接收者、值和数据载荷（payload）。</li><li>状态机：以太坊的状态转移由以太坊虚拟机（Ethereum Virtual Machine，EVM）处理，EVM 能够将智能合约编译成机器码并执行。</li><li>客户端：用于用户和以太坊进行交互操作的软件实现，最突出的是 Go-Ethereum(Geth) 和 Parity。</li></ul><h3 id="2-1-6、以太坊中的概念"><a href="#2-1-6、以太坊中的概念" class="headerlink" title="2.1.6、以太坊中的概念"></a>2.1.6、以太坊中的概念</h3><ul><li>账户：以太坊中的账户类似于银行账户、应用账户，每个账户有一个20字节的地址。账户又分为<strong>普通账户</strong>（又叫外部账户，External Owned Account, EOA）和<strong>合约账户</strong>（Contract）。普通账户是由以太坊使用者创建的账户，包含地址、余额和随机数；合约账户是创建智能合约时建立的账户，包含存储空间和合约代码</li><li>状态：状态是由账户和两个账户之间价值的转移以及信息的状态转换构成的</li><li>地址：地址是一个账户 ECDSA 公钥的 Keccak 散列最右边的160位，通过地址可以在以太坊上接收或发送交易。在 Etherscan 上，可以通过地址来查询一个账户的信息</li><li>交易：以太坊中的交易不仅包括发送和接收以太币，还包括向合约账户发送交易来调用合约代码、向空用户发送交易来生成以交易信息为代码块的合约账户</li><li>Gas：Gas 是以太坊中的一种机制，用于执行智能合约或交易操作的虚拟燃料。由于以太坊是图灵完备的，为了避免开发者无意或恶意编写出死循环等浪费资源或滥用资源的情况，以太坊中的每一笔交易都需支付一定的 Gas （燃料费），即需支付一定的以太币作为 Gas。Gas 的金额通常是由交易的发起者指定并支付的</li><li>挖矿：和比特币类似，以太坊同样通过挖矿来产生区块。在以太坊目前的 PoW 机制下，每当一笔交易发出并广播，就会吸引矿工来将该交易打包成区块。每产生一个区块都会有一笔<strong>固定奖励</strong>给矿工，目前的固定奖励是3个以太。同时，区块中所有操作所需的 Gas 也会作为奖励给矿工。与比特币不同的是，以太坊中产生叔块的矿工可能会获得叔块奖励，引用叔块的矿工会获得叔块引用奖励</li><li>DApp（去中心化应用）：通过智能合约，开发者能够设计想要的逻辑，相当于是网站的后端。而 DApp 则相当于是一个完整的网站（前端+后端），因此 DApp = 智能合约 + Web 前端。以太坊提供了一个名为 web3.js 的 Javascript 库，通过 web3.js 可以实现 Web 与以太坊区块链的交互和与智能合约的交互，方便开发者创建 DApp</li></ul><h2 id="2-2、以太坊账户管理"><a href="#2-2、以太坊账户管理" class="headerlink" title="2.2、以太坊账户管理"></a>2.2、以太坊账户管理</h2><h3 id="2-2-1、账户"><a href="#2-2-1、账户" class="headerlink" title="2.2.1、账户"></a>2.2.1、账户</h3><p>以太坊有两种账户类型：</p><ul><li>外部账户（EOA）</li><li>合约账户</li></ul><p>所有账户的状态代表以太坊网络的状态，以太坊网络会和每一个区块一起更新，网络需要达成关于以太坊的共识。账户代表外部代理人的身份，账户运用非对称加密的私钥来签署交易，以便以太坊虚拟机可以安全验证交易发送者的身份。</p><h3 id="2-2-2、钥匙文件-Keyfiles"><a href="#2-2-2、钥匙文件-Keyfiles" class="headerlink" title="2.2.2、钥匙文件(Keyfiles)"></a>2.2.2、钥匙文件(Keyfiles)</h3><p>每个账户都由一对密钥来定义，包括公钥和私钥。账户以地址为索引，地址由公钥生成，每对私钥/地址都编码在一个钥匙文件（JSON文件）中，其中最重要的为账户私钥，通常用创建账户时的密码加密。可以在以太坊节点数据目录的<code>keystore</code>子目录下找到钥匙文件。</p><h3 id="2-2-3、创建账户"><a href="#2-2-3、创建账户" class="headerlink" title="2.2.3、创建账户"></a>2.2.3、创建账户</h3><p>为了从账户发送交易包括以太币，需要拥有<code>Keyfiles</code>和密码。需要记住并备份钥匙文件，没有“找回密码”的选项。</p><h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><p><a href="https://github.com/datawhalechina/team-learning-program/blob/master/Blockchain/part1_%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%E4%BB%8B%E7%BB%8D.md">DataWhale 区块链教程</a></p><p><a href="https://www.ruanyifeng.com/blog/2017/12/blockchain-tutorial.html">区块链入门教程</a></p><p><a href="https://www.ruanyifeng.com/blog/2013/06/rsa_algorithm_part_one.html">RSA算法原理（一）</a></p><p><a href="http://www.ruanyifeng.com/blog/2013/07/rsa_algorithm_part_two.html">RSA算法原理（二）</a></p><p><a href="http://www.ruanyifeng.com/blog/2018/01/bitcoin-tutorial.html">比特币入门教程</a></p><p><a href="http://www.ruanyifeng.com/blog/2006/12/notes_on_cryptography.html">密码学笔记</a></p><p><a href="http://www.ruanyifeng.com/blog/2011/08/what_is_a_digital_signature.html">数字签名是什么？</a></p><p><a href="https://medium.freecodecamp.org/how-does-blockchain-really-work-i-built-an-app-to-show-you-6b70cd4caf7d">How does blockchain really work?</a>, by Sean Han</p><p><a href="http://www.righto.com/2014/02/bitcoin-mining-hard-way-algorithms.html">Bitcoin mining the hard way: the algorithms, protocols, and bytes</a>, by Ken Shirriff</p><p><a href="https://azhuge233.com/merkle-tree%E5%8F%8A%E5%85%B6%E5%AE%9E%E7%8E%B0/">Merkle Tree及其实现</a></p><p><a href="https://www.huweihuang.com/blockchain-notes/ethereum/ethereum-introduction.html">以太坊系列（一）之以太坊介绍</a></p><p><a href="https://www.huweihuang.com/blockchain-notes/ethereum/ethereum-account-management.html">以太坊系列（二）之账户管理</a></p><p><a href="https://www.huweihuang.com/">胡伟煌个人博客</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> DataWhale </tag>
            
            <tag> BlockChain </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Task1 DeepCrossing</title>
      <link href="2021/03/16/task1-deepcrossing/"/>
      <url>2021/03/16/task1-deepcrossing/</url>
      
        <content type="html"><![CDATA[<h1 id="DeepCrossing"><a href="#DeepCrossing" class="headerlink" title="DeepCrossing"></a>DeepCrossing</h1><ul><li>该文主要记录<a href="https://github.com/datawhalechina/team-learning-rs/tree/master/DeepRecommendationModel"><code>深度推荐模型|DataWhale</code></a>学习内容，记录 Coding 过程和思路，代码格式上并不规范</li></ul><p>Deep Crossing模型是由微软研究院在论文《Deep Crossing: Web-Scale Modeling without Manually Crafted Combinatorial Features》中提出的，它主要是用来解决大规模特征自动组合问题，从而减轻或者避免手工进行特征组合的开销。Deep Crossing可以说是深度学习CTR模型的最典型和基础性的模型。</p><p><img src="/2021/03/16/task1-deepcrossing/pic1.png" alt="Model"></p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> warningswarnings<span class="token punctuation">.</span>filterwarnings<span class="token punctuation">(</span><span class="token string">"ignore"</span><span class="token punctuation">)</span><span class="token keyword">import</span> itertools<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np<span class="token keyword">from</span> tqdm <span class="token keyword">import</span> tqdm<span class="token keyword">from</span> collections <span class="token keyword">import</span> namedtuple<span class="token keyword">import</span> tensorflow <span class="token keyword">as</span> tf<span class="token keyword">from</span> tensorflow <span class="token keyword">import</span> keras <span class="token keyword">from</span> tensorflow<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>layers <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> tensorflow<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>models <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>model_selection <span class="token keyword">import</span> train_test_split<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>preprocessing <span class="token keyword">import</span>  MinMaxScaler<span class="token punctuation">,</span> LabelEncoder<span class="token keyword">from</span> deepctr<span class="token punctuation">.</span>feature_column <span class="token keyword">import</span> SparseFeat<span class="token punctuation">,</span> DenseFeat<span class="token punctuation">,</span> VarLenSparseFeat<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 设置GPU显存使用，tensorflow不然会报错</span>gpus <span class="token operator">=</span> tf<span class="token punctuation">.</span>config<span class="token punctuation">.</span>experimental<span class="token punctuation">.</span>list_physical_devices<span class="token punctuation">(</span><span class="token string">'GPU'</span><span class="token punctuation">)</span><span class="token keyword">if</span> gpus<span class="token punctuation">:</span>    <span class="token keyword">try</span><span class="token punctuation">:</span>        <span class="token comment"># Currently, memory growth needs to be the same across GPUs</span>        <span class="token keyword">for</span> gpu <span class="token keyword">in</span> gpus<span class="token punctuation">:</span>            tf<span class="token punctuation">.</span>config<span class="token punctuation">.</span>experimental<span class="token punctuation">.</span>set_memory_growth<span class="token punctuation">(</span>gpu<span class="token punctuation">,</span> <span class="token boolean">True</span><span class="token punctuation">)</span>        logical_gpus <span class="token operator">=</span> tf<span class="token punctuation">.</span>config<span class="token punctuation">.</span>experimental<span class="token punctuation">.</span>list_logical_devices<span class="token punctuation">(</span><span class="token string">'GPU'</span><span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>gpus<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"Physical GPUs,"</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>logical_gpus<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"Logical GPUs"</span><span class="token punctuation">)</span>    <span class="token keyword">except</span> RuntimeError <span class="token keyword">as</span> e<span class="token punctuation">:</span>        <span class="token comment"># Memory growth must be set before GPUs have been initialized</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token number">1</span> Physical GPUs<span class="token punctuation">,</span> <span class="token number">1</span> Logical GPUs<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="一、Load-Dataset"><a href="#一、Load-Dataset" class="headerlink" title="一、Load Dataset"></a>一、Load Dataset</h2><pre class="line-numbers language-python" data-language="python"><code class="language-python">data <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">"./代码/data/criteo_sample.txt"</span><span class="token punctuation">)</span>columns <span class="token operator">=</span> data<span class="token punctuation">.</span>columns<span class="token punctuation">.</span>valuescolumns<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'label'</span><span class="token punctuation">,</span> <span class="token string">'I1'</span><span class="token punctuation">,</span> <span class="token string">'I2'</span><span class="token punctuation">,</span> <span class="token string">'I3'</span><span class="token punctuation">,</span> <span class="token string">'I4'</span><span class="token punctuation">,</span> <span class="token string">'I5'</span><span class="token punctuation">,</span> <span class="token string">'I6'</span><span class="token punctuation">,</span> <span class="token string">'I7'</span><span class="token punctuation">,</span> <span class="token string">'I8'</span><span class="token punctuation">,</span> <span class="token string">'I9'</span><span class="token punctuation">,</span>       <span class="token string">'I10'</span><span class="token punctuation">,</span> <span class="token string">'I11'</span><span class="token punctuation">,</span> <span class="token string">'I12'</span><span class="token punctuation">,</span> <span class="token string">'I13'</span><span class="token punctuation">,</span> <span class="token string">'C1'</span><span class="token punctuation">,</span> <span class="token string">'C2'</span><span class="token punctuation">,</span> <span class="token string">'C3'</span><span class="token punctuation">,</span> <span class="token string">'C4'</span><span class="token punctuation">,</span> <span class="token string">'C5'</span><span class="token punctuation">,</span> <span class="token string">'C6'</span><span class="token punctuation">,</span>       <span class="token string">'C7'</span><span class="token punctuation">,</span> <span class="token string">'C8'</span><span class="token punctuation">,</span> <span class="token string">'C9'</span><span class="token punctuation">,</span> <span class="token string">'C10'</span><span class="token punctuation">,</span> <span class="token string">'C11'</span><span class="token punctuation">,</span> <span class="token string">'C12'</span><span class="token punctuation">,</span> <span class="token string">'C13'</span><span class="token punctuation">,</span> <span class="token string">'C14'</span><span class="token punctuation">,</span> <span class="token string">'C15'</span><span class="token punctuation">,</span> <span class="token string">'C16'</span><span class="token punctuation">,</span>       <span class="token string">'C17'</span><span class="token punctuation">,</span> <span class="token string">'C18'</span><span class="token punctuation">,</span> <span class="token string">'C19'</span><span class="token punctuation">,</span> <span class="token string">'C20'</span><span class="token punctuation">,</span> <span class="token string">'C21'</span><span class="token punctuation">,</span> <span class="token string">'C22'</span><span class="token punctuation">,</span> <span class="token string">'C23'</span><span class="token punctuation">,</span> <span class="token string">'C24'</span><span class="token punctuation">,</span> <span class="token string">'C25'</span><span class="token punctuation">,</span>       <span class="token string">'C26'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span><span class="token builtin">object</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 划分 dense 和 sparse 特征</span>dense_features <span class="token operator">=</span> <span class="token punctuation">[</span>i <span class="token keyword">for</span> i <span class="token keyword">in</span> columns <span class="token keyword">if</span> <span class="token string">'I'</span> <span class="token keyword">in</span> i<span class="token punctuation">]</span>sparse_features <span class="token operator">=</span> <span class="token punctuation">[</span>i <span class="token keyword">for</span> i <span class="token keyword">in</span> columns <span class="token keyword">if</span> <span class="token string">'C'</span> <span class="token keyword">in</span> i<span class="token punctuation">]</span><span class="token keyword">print</span><span class="token punctuation">(</span>dense_features<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>sparse_features<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token punctuation">[</span><span class="token string">'I1'</span><span class="token punctuation">,</span> <span class="token string">'I2'</span><span class="token punctuation">,</span> <span class="token string">'I3'</span><span class="token punctuation">,</span> <span class="token string">'I4'</span><span class="token punctuation">,</span> <span class="token string">'I5'</span><span class="token punctuation">,</span> <span class="token string">'I6'</span><span class="token punctuation">,</span> <span class="token string">'I7'</span><span class="token punctuation">,</span> <span class="token string">'I8'</span><span class="token punctuation">,</span> <span class="token string">'I9'</span><span class="token punctuation">,</span> <span class="token string">'I10'</span><span class="token punctuation">,</span> <span class="token string">'I11'</span><span class="token punctuation">,</span> <span class="token string">'I12'</span><span class="token punctuation">,</span> <span class="token string">'I13'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string">'C1'</span><span class="token punctuation">,</span> <span class="token string">'C2'</span><span class="token punctuation">,</span> <span class="token string">'C3'</span><span class="token punctuation">,</span> <span class="token string">'C4'</span><span class="token punctuation">,</span> <span class="token string">'C5'</span><span class="token punctuation">,</span> <span class="token string">'C6'</span><span class="token punctuation">,</span> <span class="token string">'C7'</span><span class="token punctuation">,</span> <span class="token string">'C8'</span><span class="token punctuation">,</span> <span class="token string">'C9'</span><span class="token punctuation">,</span> <span class="token string">'C10'</span><span class="token punctuation">,</span> <span class="token string">'C11'</span><span class="token punctuation">,</span> <span class="token string">'C12'</span><span class="token punctuation">,</span> <span class="token string">'C13'</span><span class="token punctuation">,</span> <span class="token string">'C14'</span><span class="token punctuation">,</span> <span class="token string">'C15'</span><span class="token punctuation">,</span> <span class="token string">'C16'</span><span class="token punctuation">,</span> <span class="token string">'C17'</span><span class="token punctuation">,</span> <span class="token string">'C18'</span><span class="token punctuation">,</span> <span class="token string">'C19'</span><span class="token punctuation">,</span> <span class="token string">'C20'</span><span class="token punctuation">,</span> <span class="token string">'C21'</span><span class="token punctuation">,</span> <span class="token string">'C22'</span><span class="token punctuation">,</span> <span class="token string">'C23'</span><span class="token punctuation">,</span> <span class="token string">'C24'</span><span class="token punctuation">,</span> <span class="token string">'C25'</span><span class="token punctuation">,</span> <span class="token string">'C26'</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">data<span class="token punctuation">[</span>dense_features<span class="token punctuation">]</span><span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }    .dataframe tbody tr th {        vertical-align: top;    }    .dataframe thead th {        text-align: right;    }</style><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>I1</th>      <th>I2</th>      <th>I3</th>      <th>I4</th>      <th>I5</th>      <th>I6</th>      <th>I7</th>      <th>I8</th>      <th>I9</th>      <th>I10</th>      <th>I11</th>      <th>I12</th>      <th>I13</th>    </tr>  </thead>  <tbody>    <tr>      <th>0</th>      <td>NaN</td>      <td>3</td>      <td>260.0</td>      <td>NaN</td>      <td>17668.0</td>      <td>NaN</td>      <td>NaN</td>      <td>33.0</td>      <td>NaN</td>      <td>NaN</td>      <td>NaN</td>      <td>0.0</td>      <td>NaN</td>    </tr>    <tr>      <th>1</th>      <td>NaN</td>      <td>-1</td>      <td>19.0</td>      <td>35.0</td>      <td>30251.0</td>      <td>247.0</td>      <td>1.0</td>      <td>35.0</td>      <td>160.0</td>      <td>NaN</td>      <td>1.0</td>      <td>NaN</td>      <td>35.0</td>    </tr>    <tr>      <th>2</th>      <td>0.0</td>      <td>0</td>      <td>2.0</td>      <td>12.0</td>      <td>2013.0</td>      <td>164.0</td>      <td>6.0</td>      <td>35.0</td>      <td>523.0</td>      <td>0.0</td>      <td>3.0</td>      <td>NaN</td>      <td>18.0</td>    </tr>    <tr>      <th>3</th>      <td>NaN</td>      <td>13</td>      <td>1.0</td>      <td>4.0</td>      <td>16836.0</td>      <td>200.0</td>      <td>5.0</td>      <td>4.0</td>      <td>29.0</td>      <td>NaN</td>      <td>2.0</td>      <td>NaN</td>      <td>4.0</td>    </tr>    <tr>      <th>4</th>      <td>0.0</td>      <td>0</td>      <td>104.0</td>      <td>27.0</td>      <td>1990.0</td>      <td>142.0</td>      <td>4.0</td>      <td>32.0</td>      <td>37.0</td>      <td>0.0</td>      <td>1.0</td>      <td>NaN</td>      <td>27.0</td>    </tr>  </tbody></table></div><pre class="line-numbers language-python" data-language="python"><code class="language-python">data<span class="token punctuation">[</span>sparse_features<span class="token punctuation">]</span><span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }    .dataframe tbody tr th {        vertical-align: top;    }    .dataframe thead th {        text-align: right;    }</style><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>C1</th>      <th>C2</th>      <th>C3</th>      <th>C4</th>      <th>C5</th>      <th>C6</th>      <th>C7</th>      <th>C8</th>      <th>C9</th>      <th>C10</th>      <th>...</th>      <th>C17</th>      <th>C18</th>      <th>C19</th>      <th>C20</th>      <th>C21</th>      <th>C22</th>      <th>C23</th>      <th>C24</th>      <th>C25</th>      <th>C26</th>    </tr>  </thead>  <tbody>    <tr>      <th>0</th>      <td>05db9164</td>      <td>08d6d899</td>      <td>9143c832</td>      <td>f56b7dd5</td>      <td>25c83c98</td>      <td>7e0ccccf</td>      <td>df5c2d18</td>      <td>0b153874</td>      <td>a73ee510</td>      <td>8f48ce11</td>      <td>...</td>      <td>e5ba7672</td>      <td>87c6f83c</td>      <td>NaN</td>      <td>NaN</td>      <td>0429f84b</td>      <td>NaN</td>      <td>3a171ecb</td>      <td>c0d61a5c</td>      <td>NaN</td>      <td>NaN</td>    </tr>    <tr>      <th>1</th>      <td>68fd1e64</td>      <td>04e09220</td>      <td>95e13fd4</td>      <td>a1e6a194</td>      <td>25c83c98</td>      <td>fe6b92e5</td>      <td>f819e175</td>      <td>062b5529</td>      <td>a73ee510</td>      <td>ab9456b4</td>      <td>...</td>      <td>d4bb7bd8</td>      <td>6fc84bfb</td>      <td>NaN</td>      <td>NaN</td>      <td>5155d8a3</td>      <td>NaN</td>      <td>be7c41b4</td>      <td>ded4aac9</td>      <td>NaN</td>      <td>NaN</td>    </tr>    <tr>      <th>2</th>      <td>05db9164</td>      <td>38a947a1</td>      <td>3f55fb72</td>      <td>5de245c7</td>      <td>30903e74</td>      <td>7e0ccccf</td>      <td>b72ec13d</td>      <td>1f89b562</td>      <td>a73ee510</td>      <td>acce978c</td>      <td>...</td>      <td>e5ba7672</td>      <td>675c9258</td>      <td>NaN</td>      <td>NaN</td>      <td>2e01979f</td>      <td>NaN</td>      <td>bcdee96c</td>      <td>6d5d1302</td>      <td>NaN</td>      <td>NaN</td>    </tr>    <tr>      <th>3</th>      <td>05db9164</td>      <td>8084ee93</td>      <td>02cf9876</td>      <td>c18be181</td>      <td>25c83c98</td>      <td>NaN</td>      <td>e14874c9</td>      <td>0b153874</td>      <td>7cc72ec2</td>      <td>2462946f</td>      <td>...</td>      <td>e5ba7672</td>      <td>52e44668</td>      <td>NaN</td>      <td>NaN</td>      <td>e587c466</td>      <td>NaN</td>      <td>32c7478e</td>      <td>3b183c5c</td>      <td>NaN</td>      <td>NaN</td>    </tr>    <tr>      <th>4</th>      <td>05db9164</td>      <td>207b2d81</td>      <td>5d076085</td>      <td>862b5ba0</td>      <td>25c83c98</td>      <td>fbad5c96</td>      <td>17c22666</td>      <td>0b153874</td>      <td>a73ee510</td>      <td>534fc986</td>      <td>...</td>      <td>e5ba7672</td>      <td>25c88e42</td>      <td>21ddcdc9</td>      <td>b1252a9d</td>      <td>0e8585d2</td>      <td>NaN</td>      <td>32c7478e</td>      <td>0d4a6d1a</td>      <td>001f3601</td>      <td>92c878de</td>    </tr>  </tbody></table><p>5 rows × 26 columns</p></div><pre class="line-numbers language-python" data-language="python"><code class="language-python">data<span class="token punctuation">[</span><span class="token string">"C1"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>shape<span class="token punctuation">,</span><span class="token builtin">type</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token string">"C1"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token punctuation">,</span> pandas<span class="token punctuation">.</span>core<span class="token punctuation">.</span>series<span class="token punctuation">.</span>Series<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="二、Data-Process-and-LabelEncoder"><a href="#二、Data-Process-and-LabelEncoder" class="headerlink" title="二、Data Process and LabelEncoder"></a>二、Data Process and LabelEncoder</h2><h3 id="sklearn-preprocessing-LabelEncoder"><a href="#sklearn-preprocessing-LabelEncoder" class="headerlink" title="sklearn.preprocessing.LabelEncoder"></a><a href="https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.LabelEncoder.html">sklearn.preprocessing.LabelEncoder</a></h3><p>Encode target labels with value between 0 and n_classes-1.</p><p>This transformer should be used to encode target values, <em>i.e.</em> <code>y</code>, and not the input <code>X</code>.</p><p>Examples</p><p><code>LabelEncoder</code> can be used to normalize labels.</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> <span class="token keyword">from</span> sklearn <span class="token keyword">import</span> preprocessing<span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> le <span class="token operator">=</span> preprocessing<span class="token punctuation">.</span>LabelEncoder<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> le<span class="token punctuation">.</span>fit<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">)</span>LabelEncoder<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> le<span class="token punctuation">.</span>classes_array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> le<span class="token punctuation">.</span>transform<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">)</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> le<span class="token punctuation">.</span>inverse_transform<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>It can also be used to transform non-numerical labels (as long as they are hashable and comparable) to numerical labels.</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> le <span class="token operator">=</span> preprocessing<span class="token punctuation">.</span>LabelEncoder<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> le<span class="token punctuation">.</span>fit<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"paris"</span><span class="token punctuation">,</span> <span class="token string">"paris"</span><span class="token punctuation">,</span> <span class="token string">"tokyo"</span><span class="token punctuation">,</span> <span class="token string">"amsterdam"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>LabelEncoder<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> <span class="token builtin">list</span><span class="token punctuation">(</span>le<span class="token punctuation">.</span>classes_<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'amsterdam'</span><span class="token punctuation">,</span> <span class="token string">'paris'</span><span class="token punctuation">,</span> <span class="token string">'tokyo'</span><span class="token punctuation">]</span><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> le<span class="token punctuation">.</span>transform<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"tokyo"</span><span class="token punctuation">,</span> <span class="token string">"tokyo"</span><span class="token punctuation">,</span> <span class="token string">"paris"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> <span class="token builtin">list</span><span class="token punctuation">(</span>le<span class="token punctuation">.</span>inverse_transform<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'tokyo'</span><span class="token punctuation">,</span> <span class="token string">'tokyo'</span><span class="token punctuation">,</span> <span class="token string">'paris'</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>Methods</p><div class="table-container"><table><thead><tr><th><a href="https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.LabelEncoder.html#sklearn.preprocessing.LabelEncoder.fit"><code>fit</code></a>(y)</th><th>Fit label encoder.</th></tr></thead><tbody><tr><td><a href="https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.LabelEncoder.html#sklearn.preprocessing.LabelEncoder.fit_transform"><code>fit_transform</code></a>(y)</td><td>Fit label encoder and return encoded labels.</td></tr><tr><td><a href="https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.LabelEncoder.html#sklearn.preprocessing.LabelEncoder.get_params"><code>get_params</code></a>([deep])</td><td>Get parameters for this estimator.</td></tr><tr><td><a href="https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.LabelEncoder.html#sklearn.preprocessing.LabelEncoder.inverse_transform"><code>inverse_transform</code></a>(y)</td><td>Transform labels back to original encoding.</td></tr><tr><td><a href="https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.LabelEncoder.html#sklearn.preprocessing.LabelEncoder.set_params"><code>set_params</code></a>(**params)</td><td>Set the parameters of this estimator.</td></tr><tr><td><a href="https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.LabelEncoder.html#sklearn.preprocessing.LabelEncoder.transform"><code>transform</code></a>(y)</td><td>Transform labels to normalized encoding.</td></tr></tbody></table></div><pre class="line-numbers language-python" data-language="python"><code class="language-python">data<span class="token punctuation">[</span>dense_features<span class="token punctuation">]</span> <span class="token operator">=</span> data<span class="token punctuation">[</span>dense_features<span class="token punctuation">]</span><span class="token punctuation">.</span>fillna<span class="token punctuation">(</span><span class="token number">0.0</span><span class="token punctuation">)</span><span class="token keyword">for</span> i <span class="token keyword">in</span> dense_features<span class="token punctuation">:</span>    data<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> data<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> np<span class="token punctuation">.</span>log<span class="token punctuation">(</span>x<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">if</span> x<span class="token operator">&gt;</span><span class="token operator">-</span><span class="token number">1</span> <span class="token keyword">else</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>data<span class="token punctuation">[</span>sparse_features<span class="token punctuation">]</span> <span class="token operator">=</span> data<span class="token punctuation">[</span>sparse_features<span class="token punctuation">]</span><span class="token punctuation">.</span>fillna<span class="token punctuation">(</span><span class="token string">"-1"</span><span class="token punctuation">)</span><span class="token keyword">for</span> i <span class="token keyword">in</span> sparse_features<span class="token punctuation">:</span>    lbe <span class="token operator">=</span> LabelEncoder<span class="token punctuation">(</span><span class="token punctuation">)</span>    data<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> lbe<span class="token punctuation">.</span>fit_transform<span class="token punctuation">(</span>data<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">data<span class="token punctuation">[</span>dense_features<span class="token punctuation">]</span><span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }    .dataframe tbody tr th {        vertical-align: top;    }    .dataframe thead th {        text-align: right;    }</style><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>I1</th>      <th>I2</th>      <th>I3</th>      <th>I4</th>      <th>I5</th>      <th>I6</th>      <th>I7</th>      <th>I8</th>      <th>I9</th>      <th>I10</th>      <th>I11</th>      <th>I12</th>      <th>I13</th>    </tr>  </thead>  <tbody>    <tr>      <th>0</th>      <td>0.0</td>      <td>0.625800</td>      <td>1.058373</td>      <td>0.000000</td>      <td>1.217181</td>      <td>0.000000</td>      <td>0.000000</td>      <td>0.920250</td>      <td>0.000000</td>      <td>0.0</td>      <td>0.000000</td>      <td>0.0</td>      <td>0.000000</td>    </tr>    <tr>      <th>1</th>      <td>0.0</td>      <td>-1.000000</td>      <td>0.869294</td>      <td>0.925237</td>      <td>1.231491</td>      <td>1.055658</td>      <td>0.423036</td>      <td>0.925237</td>      <td>1.031488</td>      <td>0.0</td>      <td>0.423036</td>      <td>0.0</td>      <td>0.925237</td>    </tr>    <tr>      <th>2</th>      <td>0.0</td>      <td>0.000000</td>      <td>0.554618</td>      <td>0.820286</td>      <td>1.148252</td>      <td>1.032922</td>      <td>0.732569</td>      <td>0.925237</td>      <td>1.092790</td>      <td>0.0</td>      <td>0.625800</td>      <td>0.0</td>      <td>0.863863</td>    </tr>    <tr>      <th>3</th>      <td>0.0</td>      <td>0.829305</td>      <td>0.423036</td>      <td>0.672503</td>      <td>1.215852</td>      <td>1.044182</td>      <td>0.706395</td>      <td>0.672503</td>      <td>0.909015</td>      <td>0.0</td>      <td>0.554618</td>      <td>0.0</td>      <td>0.672503</td>    </tr>    <tr>      <th>4</th>      <td>0.0</td>      <td>0.000000</td>      <td>1.005164</td>      <td>0.902628</td>      <td>1.147829</td>      <td>1.024444</td>      <td>0.672503</td>      <td>0.917610</td>      <td>0.929876</td>      <td>0.0</td>      <td>0.423036</td>      <td>0.0</td>      <td>0.902628</td>    </tr>  </tbody></table></div><pre class="line-numbers language-python" data-language="python"><code class="language-python">data<span class="token punctuation">[</span>sparse_features<span class="token punctuation">]</span><span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }    .dataframe tbody tr th {        vertical-align: top;    }    .dataframe thead th {        text-align: right;    }</style><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>C1</th>      <th>C2</th>      <th>C3</th>      <th>C4</th>      <th>C5</th>      <th>C6</th>      <th>C7</th>      <th>C8</th>      <th>C9</th>      <th>C10</th>      <th>...</th>      <th>C17</th>      <th>C18</th>      <th>C19</th>      <th>C20</th>      <th>C21</th>      <th>C22</th>      <th>C23</th>      <th>C24</th>      <th>C25</th>      <th>C26</th>    </tr>  </thead>  <tbody>    <tr>      <th>0</th>      <td>0</td>      <td>4</td>      <td>96</td>      <td>146</td>      <td>1</td>      <td>4</td>      <td>163</td>      <td>1</td>      <td>1</td>      <td>72</td>      <td>...</td>      <td>8</td>      <td>66</td>      <td>0</td>      <td>0</td>      <td>3</td>      <td>0</td>      <td>1</td>      <td>96</td>      <td>0</td>      <td>0</td>    </tr>    <tr>      <th>1</th>      <td>11</td>      <td>1</td>      <td>98</td>      <td>98</td>      <td>1</td>      <td>6</td>      <td>179</td>      <td>0</td>      <td>1</td>      <td>89</td>      <td>...</td>      <td>7</td>      <td>52</td>      <td>0</td>      <td>0</td>      <td>47</td>      <td>0</td>      <td>7</td>      <td>112</td>      <td>0</td>      <td>0</td>    </tr>    <tr>      <th>2</th>      <td>0</td>      <td>18</td>      <td>39</td>      <td>52</td>      <td>3</td>      <td>4</td>      <td>140</td>      <td>2</td>      <td>1</td>      <td>93</td>      <td>...</td>      <td>8</td>      <td>49</td>      <td>0</td>      <td>0</td>      <td>25</td>      <td>0</td>      <td>6</td>      <td>53</td>      <td>0</td>      <td>0</td>    </tr>    <tr>      <th>3</th>      <td>0</td>      <td>45</td>      <td>7</td>      <td>117</td>      <td>1</td>      <td>0</td>      <td>164</td>      <td>1</td>      <td>0</td>      <td>20</td>      <td>...</td>      <td>8</td>      <td>37</td>      <td>0</td>      <td>0</td>      <td>156</td>      <td>0</td>      <td>0</td>      <td>32</td>      <td>0</td>      <td>0</td>    </tr>    <tr>      <th>4</th>      <td>0</td>      <td>11</td>      <td>59</td>      <td>77</td>      <td>1</td>      <td>5</td>      <td>18</td>      <td>1</td>      <td>1</td>      <td>45</td>      <td>...</td>      <td>8</td>      <td>14</td>      <td>5</td>      <td>3</td>      <td>9</td>      <td>0</td>      <td>0</td>      <td>5</td>      <td>1</td>      <td>47</td>    </tr>  </tbody></table><p>5 rows × 26 columns</p></div><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 源代码使用的 data_process（） 处理，</span><span class="token comment"># 需要留意 python 浅拷贝和深拷贝，源数据本身也会被操作</span>train_data <span class="token operator">=</span> datatrain_data<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }    .dataframe tbody tr th {        vertical-align: top;    }    .dataframe thead th {        text-align: right;    }</style><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>label</th>      <th>I1</th>      <th>I2</th>      <th>I3</th>      <th>I4</th>      <th>I5</th>      <th>I6</th>      <th>I7</th>      <th>I8</th>      <th>I9</th>      <th>...</th>      <th>C17</th>      <th>C18</th>      <th>C19</th>      <th>C20</th>      <th>C21</th>      <th>C22</th>      <th>C23</th>      <th>C24</th>      <th>C25</th>      <th>C26</th>    </tr>  </thead>  <tbody>    <tr>      <th>0</th>      <td>0</td>      <td>0.0</td>      <td>0.625800</td>      <td>1.058373</td>      <td>0.000000</td>      <td>1.217181</td>      <td>0.000000</td>      <td>0.000000</td>      <td>0.920250</td>      <td>0.000000</td>      <td>...</td>      <td>8</td>      <td>66</td>      <td>0</td>      <td>0</td>      <td>3</td>      <td>0</td>      <td>1</td>      <td>96</td>      <td>0</td>      <td>0</td>    </tr>    <tr>      <th>1</th>      <td>0</td>      <td>0.0</td>      <td>-1.000000</td>      <td>0.869294</td>      <td>0.925237</td>      <td>1.231491</td>      <td>1.055658</td>      <td>0.423036</td>      <td>0.925237</td>      <td>1.031488</td>      <td>...</td>      <td>7</td>      <td>52</td>      <td>0</td>      <td>0</td>      <td>47</td>      <td>0</td>      <td>7</td>      <td>112</td>      <td>0</td>      <td>0</td>    </tr>    <tr>      <th>2</th>      <td>0</td>      <td>0.0</td>      <td>0.000000</td>      <td>0.554618</td>      <td>0.820286</td>      <td>1.148252</td>      <td>1.032922</td>      <td>0.732569</td>      <td>0.925237</td>      <td>1.092790</td>      <td>...</td>      <td>8</td>      <td>49</td>      <td>0</td>      <td>0</td>      <td>25</td>      <td>0</td>      <td>6</td>      <td>53</td>      <td>0</td>      <td>0</td>    </tr>    <tr>      <th>3</th>      <td>0</td>      <td>0.0</td>      <td>0.829305</td>      <td>0.423036</td>      <td>0.672503</td>      <td>1.215852</td>      <td>1.044182</td>      <td>0.706395</td>      <td>0.672503</td>      <td>0.909015</td>      <td>...</td>      <td>8</td>      <td>37</td>      <td>0</td>      <td>0</td>      <td>156</td>      <td>0</td>      <td>0</td>      <td>32</td>      <td>0</td>      <td>0</td>    </tr>    <tr>      <th>4</th>      <td>0</td>      <td>0.0</td>      <td>0.000000</td>      <td>1.005164</td>      <td>0.902628</td>      <td>1.147829</td>      <td>1.024444</td>      <td>0.672503</td>      <td>0.917610</td>      <td>0.929876</td>      <td>...</td>      <td>8</td>      <td>14</td>      <td>5</td>      <td>3</td>      <td>9</td>      <td>0</td>      <td>0</td>      <td>5</td>      <td>1</td>      <td>47</td>    </tr>  </tbody></table><p>5 rows × 40 columns</p></div><pre class="line-numbers language-python" data-language="python"><code class="language-python">train_data<span class="token punctuation">.</span>shape<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="三、特征表示的统一"><a href="#三、特征表示的统一" class="headerlink" title="三、特征表示的统一"></a>三、特征表示的统一</h2><p>看过DeepCTR源码的人可能就会知道，项目中输入分成三大类，分别是SparseFeat, DenseFeat, VarLenSparseFeat，并且使用类进行了封装，其中也考虑到效率的问题做了一些优化，这里不说具体的类的实现及优化是什么，我先来思考一下使用这三类特征可以表示大多数推荐场景下的特征嘛？</p><ul><li><p>SparseFeat: 稀疏特征的标记，一般是用来表示id类特征</p></li><li><p>DenseFeat: 表示数值型特征，可以是一维的也可以是多维的</p></li><li><p>VarLenSparseFeat:  可变长的id类特征，就是id序列特征</p></li></ul><p>这三类特征在实际的推荐系统应用中包含了绝大多数的特征类型，在石塔西大佬的<a href="https://zhuanlan.zhihu.com/p/336643635">推荐算法的”五环之歌”</a>中也说到，类别特征才是推荐系统中的一等公民，也就是说大部分的特征都是类别特征，也可能会有一些其他的比如图像、视频等其它特征，虽然实际存不存在，但是我感觉如果要是用这些特征就需要将其转换成向量的形式去使用，也就是DenseFeat多维度的情况。</p><p>那么有了这三个统一的标志有什么用呢？答案是用来更好的构建输入层！</p><h3 id="SparseFeat"><a href="#SparseFeat" class="headerlink" title="SparseFeat"></a>SparseFeat</h3><pre class="line-numbers language-none"><code class="language-none">SparseFeat is a namedtuple with signature SparseFeat(name, vocabulary_size, embedding_dim, use_hash, dtype, embeddings_initializer, embedding_name, group_name, trainable)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li>name : feature name</li><li>vocabulary_size : number of unique feature values for sprase feature or hashing space when <code>use_hash=True</code></li><li>embedding_dim : embedding dimension</li><li>use_hash : defualt <code>False</code>.If <code>True</code> the input will be hashed to space of size <code>vocabulary_size</code>.</li><li>dtype : default <code>int32</code>.dtype of input tensor.</li><li>embeddings_initializer : initializer for the <code>embeddings</code> matrix.</li><li>embedding_name : default <code>None</code>. If None, the embedding_name will be same as <code>name</code>.</li><li>group_name : feature group of this feature.</li><li>trainable: default <code>True</code>.Whether or not the embedding is trainable.</li></ul><h3 id="DenseFeat"><a href="#DenseFeat" class="headerlink" title="DenseFeat"></a>DenseFeat</h3><pre class="line-numbers language-none"><code class="language-none">DenseFeat is a namedtuple with signature DenseFeat(name, dimension, dtype, transform_fn)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li>name : feature name</li><li>dimension : dimension of dense feature vector.</li><li>dtype : default <code>float32</code>.dtype of input tensor.</li><li>transform_fn : If not <code>None</code> , a function that can be used to transform values of the feature. the function takes the input Tensor as its argument, and returns the output Tensor. (e.g. <code>lambda x: (x - 3.0) / 4.2)</code>.</li></ul><h3 id="VarLenSparseFeat"><a href="#VarLenSparseFeat" class="headerlink" title="VarLenSparseFeat"></a>VarLenSparseFeat</h3><pre class="line-numbers language-none"><code class="language-none">VarLenSparseFeat is a namedtuple with signature VarLenSparseFeat(sparsefeat, maxlen, combiner, length_name, weight_name,weight_norm)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><ul><li>sparsefeat : a instance of <code>SparseFeat</code></li><li>maxlen : maximum length of this feature for all samples</li><li>combiner : pooling method,can be <code>sum</code>,<code>mean</code> or <code>max</code></li><li>length_name : feature length name,if <code>None</code>, value 0 in feature is for padding.</li><li>weight_name : default <code>None</code>. If not None, the sequence feature will be multiplyed by the feature whose name is <code>weight_name</code>.</li><li>weight_norm : default <code>True</code>. Whether normalize the weight score or not.</li></ul><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 对特征做标记，并确定 vocabulary_size、embedding，注意 SpareFeat 和 DenseFeat 不同</span>dnn_feature_columns <span class="token operator">=</span> <span class="token punctuation">[</span>SparseFeat<span class="token punctuation">(</span>feat<span class="token punctuation">,</span> vocabulary_size<span class="token operator">=</span>data<span class="token punctuation">[</span>feat<span class="token punctuation">]</span><span class="token punctuation">.</span>nunique<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>\                        embedding_dim<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token keyword">for</span> feat <span class="token keyword">in</span> sparse_features<span class="token punctuation">]</span><span class="token operator">+</span>\                    <span class="token punctuation">[</span>DenseFeat<span class="token punctuation">(</span>feat<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">for</span> feat <span class="token keyword">in</span> dense_features<span class="token punctuation">]</span><span class="token keyword">print</span><span class="token punctuation">(</span>dnn_feature_columns<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token builtin">len</span><span class="token punctuation">(</span>dnn_feature_columns<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token builtin">type</span><span class="token punctuation">(</span>dnn_feature_columns<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token builtin">type</span><span class="token punctuation">(</span>dnn_feature_columns<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">SparseFeat<span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">'C2'</span><span class="token punctuation">,</span> vocabulary_size<span class="token operator">=</span><span class="token number">92</span><span class="token punctuation">,</span> embedding_dim<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span> use_hash<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span><span class="token string">'int32'</span><span class="token punctuation">,</span> embeddings_initializer<span class="token operator">=</span><span class="token operator">&lt;</span>tensorflow<span class="token punctuation">.</span>python<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>initializers<span class="token punctuation">.</span>initializers_v1<span class="token punctuation">.</span>RandomNormal <span class="token builtin">object</span> at <span class="token number">0x0000027092099520</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> embedding_name<span class="token operator">=</span><span class="token string">'C2'</span><span class="token punctuation">,</span> group_name<span class="token operator">=</span><span class="token string">'default_group'</span><span class="token punctuation">,</span> trainable<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token punctuation">(</span><span class="token number">39</span><span class="token punctuation">,</span> <span class="token builtin">list</span><span class="token punctuation">,</span> deepctr<span class="token punctuation">.</span>feature_column<span class="token punctuation">.</span>SparseFeat<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="Explain"><a href="#Explain" class="headerlink" title="Explain"></a>Explain</h3><ul><li>for C26 example, vocabulary_size 90 means data[“C26”] unique numbers.</li></ul><pre class="line-numbers language-python" data-language="python"><code class="language-python">SparseFeat<span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">'C26'</span><span class="token punctuation">,</span> vocabulary_size<span class="token operator">=</span><span class="token number">90</span><span class="token punctuation">,</span> embedding_dim<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">,</span> use_hash<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span><span class="token string">'int32'</span><span class="token punctuation">,</span> embeddings_initializer<span class="token operator">=</span><span class="token operator">&lt;</span>tensorflow<span class="token punctuation">.</span>python<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>initializers<span class="token punctuation">.</span>initializers_v1<span class="token punctuation">.</span>RandomNormal <span class="token builtin">object</span> at <span class="token number">0x000001F64210D040</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> embedding_name<span class="token operator">=</span><span class="token string">'C26'</span><span class="token punctuation">,</span> group_name<span class="token operator">=</span><span class="token string">'default_group'</span><span class="token punctuation">,</span> trainable<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># test</span>train_data<span class="token punctuation">[</span>train_data<span class="token punctuation">[</span><span class="token string">"C26"</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">89</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }    .dataframe tbody tr th {        vertical-align: top;    }    .dataframe thead th {        text-align: right;    }</style><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>label</th>      <th>I1</th>      <th>I2</th>      <th>I3</th>      <th>I4</th>      <th>I5</th>      <th>I6</th>      <th>I7</th>      <th>I8</th>      <th>I9</th>      <th>...</th>      <th>C17</th>      <th>C18</th>      <th>C19</th>      <th>C20</th>      <th>C21</th>      <th>C22</th>      <th>C23</th>      <th>C24</th>      <th>C25</th>      <th>C26</th>    </tr>  </thead>  <tbody>    <tr>      <th>121</th>      <td>1</td>      <td>0.554618</td>      <td>0.423036</td>      <td>0.869294</td>      <td>0.87437</td>      <td>0.423036</td>      <td>0.87437</td>      <td>0.554618</td>      <td>0.837467</td>      <td>0.87437</td>      <td>...</td>      <td>0</td>      <td>64</td>      <td>28</td>      <td>1</td>      <td>94</td>      <td>0</td>      <td>0</td>      <td>12</td>      <td>16</td>      <td>89</td>    </tr>  </tbody></table><p>1 rows × 40 columns</p></div><h2 id="四、构建多输入模型"><a href="#四、构建多输入模型" class="headerlink" title="四、构建多输入模型"></a>四、构建多输入模型</h2><p>先说答案：将输入的数据转换成字典的形式，定义输入层的时候让输入层的name和字典中特征的key一致，就可以使得输入的数据和对应的Input层对应，后面搭建模型就是和上面介绍的一样的了。</p><p><img src="http://ryluo.oss-cn-chengdu.aliyuncs.com/图片image-20210226175546548.png" alt="dict for x" style="zoom: 50%;"></p><p>直接看个例子：</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> keras<span class="token punctuation">.</span>models <span class="token keyword">import</span> Model<span class="token keyword">from</span> keras<span class="token punctuation">.</span>layers <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> keras<span class="token punctuation">.</span>utils <span class="token keyword">import</span> plot_model<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np<span class="token comment"># 定义三维特征</span>x <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">'f1'</span><span class="token punctuation">:</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>random<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    <span class="token string">'f2'</span><span class="token punctuation">:</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>random<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>   <span class="token string">'f3'</span><span class="token punctuation">:</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>random<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span>y <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token comment"># 定义输入层：这里层的名称和特征的名称是相同的，所以在模型训练的时候直接输入这个</span><span class="token comment"># 字典形式的数据就可以</span>inputs <span class="token operator">=</span> <span class="token punctuation">[</span>Input<span class="token punctuation">(</span>shape<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token punctuation">)</span><span class="token punctuation">,</span> name<span class="token operator">=</span>key<span class="token punctuation">)</span> <span class="token keyword">for</span> key<span class="token punctuation">,</span> _ <span class="token keyword">in</span> x<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token comment"># 将多个输入拼接之后，在经过一个Dense层输出</span>concat_feat <span class="token operator">=</span> Concatenate<span class="token punctuation">(</span>axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">(</span>inputs<span class="token punctuation">)</span><span class="token comment"># 将输入特征映射成1维</span>output <span class="token operator">=</span> Dense<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> activation<span class="token operator">=</span><span class="token string">'sigmoid'</span><span class="token punctuation">)</span><span class="token punctuation">(</span>concat_feat<span class="token punctuation">)</span><span class="token comment"># 构建模型</span>model <span class="token operator">=</span> Model<span class="token punctuation">(</span>inputs<span class="token punctuation">,</span> output<span class="token punctuation">)</span>model<span class="token punctuation">.</span>summary<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment"># 编译模型</span>model<span class="token punctuation">.</span><span class="token builtin">compile</span><span class="token punctuation">(</span>optimizer<span class="token operator">=</span><span class="token string">'adam'</span><span class="token punctuation">,</span> loss<span class="token operator">=</span><span class="token string">'binary_crossentropy'</span><span class="token punctuation">,</span> metrics<span class="token operator">=</span><span class="token string">'acc'</span><span class="token punctuation">)</span><span class="token comment"># 模型训练和验证</span>model<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> batch_size<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> epochs<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> validation_split<span class="token operator">=</span><span class="token number">0.2</span><span class="token punctuation">)</span><span class="token comment"># 将模型的结构画出来</span>keras<span class="token punctuation">.</span>utils<span class="token punctuation">.</span>plot_model<span class="token punctuation">(</span>model<span class="token punctuation">,</span> <span class="token string">"multi_input_and_output_model.png"</span><span class="token punctuation">,</span> show_shapes<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="http://ryluo.oss-cn-chengdu.aliyuncs.com/图片image-20210226181357167.png" alt="model structure"></p><p>上面就是举了个简单的例子说明，当多输入特别多的时候，构建模型我们可以将数据转换成字典的形式，然后字典中特征的名称与其对应的Input层的名称一致就行，这里是为了后面搭建复杂模型打基础。</p><h2 id="五、通过特征标记构造输入层"><a href="#五、通过特征标记构造输入层" class="headerlink" title="五、通过特征标记构造输入层"></a>五、通过特征标记构造输入层</h2><p>在前面的函数式API构建模型最后说到过，可以使用字典的形式构建输入，最后只要将对应Input层的名字与字典中特征的key相对应就可以。在定义Input层的时候，除了name以外还有一个重要的属性就是shape</p><p>然而所有特征Input层的shape其实只有4种情况：</p><ol><li>数值特征，1维的数值特征shape=(1, )</li><li>多维的数值特征shape=(dimension, )</li><li>类别特征，shape=(1,), 为什么类别特征的shape维度是1呢，因为输入的就是一个id，在类别型特征的Input后面还需要接一个Embedding层，将id转化成稠密的向量</li><li>可变长的序列特征，shape=(maxlen, 1), 序列的输入往往需要定义一个最大长度，这样不至于序列长度之间相差太大，这个最大长度可以是实际数据中的最大长度，也可以是根据经验定义的最大长度。需要注意的是，序列特征中的每个元素其实也是一个id类特征，在最后转换成Embedding的时候，不是一个Embedding向量，而是一个矩阵。</li></ol><p><strong>上面说了Input层的四种情况有什么用呢？</strong></p><p>当特征维度特别多的时候，比如成百上千维特征，如果没有这种标记的话，我们就需要挨个定义每个特征对应的Input层，当然有人可能会说可以提前分组然后再给不同的Input层，其实本质上是一样的。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 构建输入层</span><span class="token keyword">def</span> <span class="token function">build_input_layers</span><span class="token punctuation">(</span>feature_columns<span class="token punctuation">)</span><span class="token punctuation">:</span>    dense_input_dict<span class="token punctuation">,</span> sparse_input_dict <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token punctuation">}</span>    <span class="token keyword">for</span> fc <span class="token keyword">in</span> feature_columns<span class="token punctuation">:</span>        <span class="token keyword">if</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>fc<span class="token punctuation">,</span> SparseFeat<span class="token punctuation">)</span><span class="token punctuation">:</span>            sparse_input_dict<span class="token punctuation">[</span>fc<span class="token punctuation">.</span>name<span class="token punctuation">]</span> <span class="token operator">=</span> Input<span class="token punctuation">(</span>shape<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token punctuation">)</span><span class="token punctuation">,</span> name<span class="token operator">=</span>fc<span class="token punctuation">.</span>name<span class="token punctuation">)</span>        <span class="token comment"># DenseFeat(name='I1', dimension=1, dtype='float32', transform_fn=None)</span>        <span class="token keyword">elif</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>fc<span class="token punctuation">,</span> DenseFeat<span class="token punctuation">)</span><span class="token punctuation">:</span>            dense_input_dict<span class="token punctuation">[</span>fc<span class="token punctuation">.</span>name<span class="token punctuation">]</span> <span class="token operator">=</span> Input<span class="token punctuation">(</span>shape<span class="token operator">=</span><span class="token punctuation">(</span>fc<span class="token punctuation">.</span>dimension<span class="token punctuation">,</span> <span class="token punctuation">)</span><span class="token punctuation">,</span> name<span class="token operator">=</span>fc<span class="token punctuation">.</span>name<span class="token punctuation">)</span>    <span class="token keyword">return</span> dense_input_dict<span class="token punctuation">,</span> sparse_input_dictdense_input_dict<span class="token punctuation">,</span> sparse_input_dict <span class="token operator">=</span> build_input_layers<span class="token punctuation">(</span>dnn_feature_columns<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>dense_input_dict<span class="token punctuation">[</span><span class="token string">"I1"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>sparse_input_dict<span class="token punctuation">[</span><span class="token string">"C1"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">KerasTensor<span class="token punctuation">(</span>type_spec<span class="token operator">=</span>TensorSpec<span class="token punctuation">(</span>shape<span class="token operator">=</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span>tf<span class="token punctuation">.</span>float32<span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">'I1'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">'I1'</span><span class="token punctuation">,</span> description<span class="token operator">=</span><span class="token string">"created by layer 'I1'"</span><span class="token punctuation">)</span>KerasTensor<span class="token punctuation">(</span>type_spec<span class="token operator">=</span>TensorSpec<span class="token punctuation">(</span>shape<span class="token operator">=</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span>tf<span class="token punctuation">.</span>float32<span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">'C1'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">'C1'</span><span class="token punctuation">,</span> description<span class="token operator">=</span><span class="token string">"created by layer 'C1'"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">input_layers <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>dense_input_dict<span class="token punctuation">.</span>values<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token builtin">list</span><span class="token punctuation">(</span>sparse_input_dict<span class="token punctuation">.</span>values<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token builtin">type</span><span class="token punctuation">(</span>input_layers<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token builtin">len</span><span class="token punctuation">(</span>input_layers<span class="token punctuation">)</span><span class="token punctuation">,</span>input_layers<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">,</span> <span class="token number">39</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span>KerasTensor<span class="token punctuation">:</span> shape<span class="token operator">=</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> dtype<span class="token operator">=</span>float32 <span class="token punctuation">(</span>created by layer <span class="token string">'I1'</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h2 id="六、Embedding-Layer"><a href="#六、Embedding-Layer" class="headerlink" title="六、Embedding Layer"></a>六、Embedding Layer</h2><p>将稀疏的类别型特征转成稠密的Embedding向量，Embedding的维度会远小于原始的稀疏特征向量。 Embedding是NLP里面常用的一种技术，这里的Feature #1表示的类别特征(one-hot编码后的稀疏特征向量）， Feature #2是数值型特征，不用embedding， 直接到了Stacking Layer。关于Embedding Layer的实现， 往往一个全连接层即可，Tensorflow中有实现好的层可以直接用。和NLP里面的embedding技术异曲同工， 比如Word2Vec， 语言模型等。</p><h3 id="Python3-filter-函数"><a href="#Python3-filter-函数" class="headerlink" title="Python3 filter() 函数"></a>Python3 filter() 函数</h3><p>描述</p><p><strong>filter()</strong> 函数用于过滤序列，过滤掉不符合条件的元素，返回一个迭代器对象，如果要转换为列表，可以使用 <strong>list()</strong> 来转换。<br>该接收两个参数，第一个为函数，第二个为序列，序列的每个元素作为参数传递给函数进行判断，然后返回 True 或 False，最后将返回 True 的元素放到新列表中。</p><p>语法</p><p>以下是 filter() 方法的语法:</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token builtin">filter</span><span class="token punctuation">(</span>function<span class="token punctuation">,</span> iterable<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>参数</p><ul><li>function — 判断函数。</li><li>iterable — 可迭代对象。</li></ul><p>返回值</p><p>返回一个迭代器对象</p><p>实例</p><p>以下展示了使用 filter 函数的实例：</p><p>过滤出列表中的所有奇数：</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">is_odd</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">return</span> n <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">==</span> <span class="token number">1</span>  tmplist <span class="token operator">=</span> <span class="token builtin">filter</span><span class="token punctuation">(</span>is_odd<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">)</span> newlist <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>tmplist<span class="token punctuation">)</span> <span class="token keyword">print</span><span class="token punctuation">(</span>newlist<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>输出结果 ：</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 将所有的 dense 进行 embedding 操作</span><span class="token keyword">def</span> <span class="token function">build_embedding_layers</span><span class="token punctuation">(</span>feature_columns<span class="token punctuation">,</span> is_linear<span class="token punctuation">)</span><span class="token punctuation">:</span>    embedding_layers_dict <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>    sparse_feature_columns <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">filter</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> SparseFeat<span class="token punctuation">)</span><span class="token punctuation">,</span> feature_columns<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">if</span> feature_columns <span class="token keyword">else</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>        <span class="token keyword">if</span> is_linear<span class="token punctuation">:</span>        <span class="token keyword">for</span> fc <span class="token keyword">in</span> sparse_feature_columns<span class="token punctuation">:</span>            embedding_layers_dict<span class="token punctuation">[</span>fc<span class="token punctuation">.</span>name<span class="token punctuation">]</span> <span class="token operator">=</span> Embedding<span class="token punctuation">(</span>fc<span class="token punctuation">.</span>vocabulary_size<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span>name<span class="token operator">=</span><span class="token string">"1d_emb_"</span><span class="token operator">+</span>fc<span class="token punctuation">.</span>name<span class="token punctuation">)</span>    <span class="token comment"># SparseFeat(name='C26', vocabulary_size=90, embedding_dim=4, use_hash=False, </span>    <span class="token comment"># dtype='int32', embedding_name='C26', group_name='default_group', trainable=True)</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token keyword">for</span> fc <span class="token keyword">in</span> sparse_feature_columns<span class="token punctuation">:</span>            embedding_layers_dict<span class="token punctuation">[</span>fc<span class="token punctuation">.</span>name<span class="token punctuation">]</span> <span class="token operator">=</span> Embedding<span class="token punctuation">(</span>fc<span class="token punctuation">.</span>vocabulary_size<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span> fc<span class="token punctuation">.</span>embedding_dim<span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">"kd_emb_"</span><span class="token operator">+</span>fc<span class="token punctuation">.</span>name<span class="token punctuation">)</span>        <span class="token keyword">return</span> embedding_layers_dict<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">embedding_layer_dict <span class="token operator">=</span> build_embedding_layers<span class="token punctuation">(</span>dnn_feature_columns<span class="token punctuation">,</span>is_linear<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>embedding_layer_dict<span class="token punctuation">[</span><span class="token string">"C1"</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token operator">&lt;</span>tensorflow<span class="token punctuation">.</span>python<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>layers<span class="token punctuation">.</span>embeddings<span class="token punctuation">.</span>Embedding at <span class="token number">0x270ae3209d0</span><span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="七、Stacking-Layer"><a href="#七、Stacking-Layer" class="headerlink" title="七、Stacking Layer"></a>七、Stacking Layer</h2><p>这个层是把不同的Embedding特征和数值型特征拼接在一起，形成新的包含全部特征的特征向量，该层通常也称为连接层, 具体的实现如下，先将所有的数值特征拼接起来，然后将所有的Embedding拼接起来，最后将数值特征和Embedding特征拼接起来作为DNN的输入，这里TF是通过Concatnate层进行拼接。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 将所有的 sparse 特征 embedding 拼接</span><span class="token keyword">def</span> <span class="token function">concat_embedding_list</span><span class="token punctuation">(</span>feature_columns<span class="token punctuation">,</span> input_layer_dict<span class="token punctuation">,</span> embedding_layer_dict<span class="token punctuation">,</span> flatten<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    sparse_feature_columns <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">filter</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> SparseFeat<span class="token punctuation">)</span><span class="token punctuation">,</span> feature_columns<span class="token punctuation">)</span><span class="token punctuation">)</span>        embedding_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> fc <span class="token keyword">in</span> sparse_feature_columns<span class="token punctuation">:</span>        _input <span class="token operator">=</span> input_layer_dict<span class="token punctuation">[</span>fc<span class="token punctuation">.</span>name<span class="token punctuation">]</span>        _embed <span class="token operator">=</span> embedding_layer_dict<span class="token punctuation">[</span>fc<span class="token punctuation">.</span>name<span class="token punctuation">]</span>        embed <span class="token operator">=</span> _embed<span class="token punctuation">(</span>_input<span class="token punctuation">)</span>                <span class="token keyword">if</span> flatten<span class="token punctuation">:</span>            embed <span class="token operator">=</span> Flatten<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span>embed<span class="token punctuation">)</span>        embedding_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span>embed<span class="token punctuation">)</span>    <span class="token keyword">return</span> embedding_list<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 拼接所有的 dense</span>dense_dnn_list <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>dense_input_dict<span class="token punctuation">.</span>values<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>dense_dnn_inputs <span class="token operator">=</span> Concatenate<span class="token punctuation">(</span>axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">(</span>dense_dnn_list<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>dense_dnn_inputs<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>dense_dnn_list<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token builtin">type</span><span class="token punctuation">(</span>dense_dnn_inputs<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">KerasTensor<span class="token punctuation">(</span>type_spec<span class="token operator">=</span>TensorSpec<span class="token punctuation">(</span>shape<span class="token operator">=</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">)</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span>tf<span class="token punctuation">.</span>float32<span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">'concatenate_6/concat:0'</span><span class="token punctuation">,</span> description<span class="token operator">=</span><span class="token string">"created by layer 'concatenate_6'"</span><span class="token punctuation">)</span><span class="token number">13</span> <span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token string">'tensorflow.python.keras.engine.keras_tensor.KerasTensor'</span><span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 拼接所有的 sparse</span>sparse_dnn_list <span class="token operator">=</span> concat_embedding_list<span class="token punctuation">(</span>dnn_feature_columns<span class="token punctuation">,</span> sparse_input_dict<span class="token punctuation">,</span> embedding_layer_dict<span class="token punctuation">,</span> flatten<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>sparse_dnn_inputs <span class="token operator">=</span> Concatenate<span class="token punctuation">(</span>axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">(</span>sparse_dnn_list<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>sparse_dnn_inputs<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>sparse_dnn_list<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token builtin">type</span><span class="token punctuation">(</span>sparse_dnn_inputs<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">KerasTensor<span class="token punctuation">(</span>type_spec<span class="token operator">=</span>TensorSpec<span class="token punctuation">(</span>shape<span class="token operator">=</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">104</span><span class="token punctuation">)</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span>tf<span class="token punctuation">.</span>float32<span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">,</span> name<span class="token operator">=</span><span class="token string">'concatenate_7/concat:0'</span><span class="token punctuation">,</span> description<span class="token operator">=</span><span class="token string">"created by layer 'concatenate_7'"</span><span class="token punctuation">)</span><span class="token number">26</span> <span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token string">'tensorflow.python.keras.engine.keras_tensor.KerasTensor'</span><span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">dnn_inputs <span class="token operator">=</span> Concatenate<span class="token punctuation">(</span>axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">[</span>dense_dnn_inputs<span class="token punctuation">,</span> sparse_dnn_inputs<span class="token punctuation">]</span><span class="token punctuation">)</span>dnn_inputs<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token operator">&lt;</span>KerasTensor<span class="token punctuation">:</span> shape<span class="token operator">=</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">117</span><span class="token punctuation">)</span> dtype<span class="token operator">=</span>float32 <span class="token punctuation">(</span>created by layer <span class="token string">'concatenate_11'</span><span class="token punctuation">)</span><span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="八、Multiple-Residual-Units-Layer"><a href="#八、Multiple-Residual-Units-Layer" class="headerlink" title="八、Multiple Residual Units Layer"></a>八、Multiple Residual Units Layer</h2><p>该层的主要结构是MLP， 但DeepCrossing采用了残差网络进行的连接。通过多层残差网络对特征向量各个维度充分的交叉组合， 使得模型能够抓取更多的非线性特征和组合特征信息， 增加模型的表达能力。</p><p>Deep Crossing模型使用稍微修改过的残差单元，它不使用卷积内核，改为了两层神经网络。我们可以看到，残差单元是通过两层ReLU变换再将原输入特征相加回来实现的。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># units:  64</span><span class="token comment"># out_dim:  117</span><span class="token comment"># inputs:  Tensor("Placeholder:0", shape=(None, 117), dtype=float32)</span><span class="token comment"># dnn1: Tensor("residual_block_6/dense/Relu:0", shape=(None, 64), dtype=float32)</span><span class="token comment"># dnn2: Tensor("residual_block_6/dense_1/Relu:0", shape=(None, 117), dtype=float32)</span><span class="token comment"># units:  64</span><span class="token comment"># out_dim:  117</span><span class="token comment"># inputs:  Tensor("Placeholder:0", shape=(None, 117), dtype=float32)</span><span class="token comment"># dnn1: Tensor("residual_block_7/dense/Relu:0", shape=(None, 64), dtype=float32)</span><span class="token comment"># dnn2: Tensor("residual_block_7/dense_1/Relu:0", shape=(None, 117), dtype=float32)</span><span class="token keyword">class</span> <span class="token class-name">ResidualBlock</span><span class="token punctuation">(</span>Layer<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> units<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token builtin">super</span><span class="token punctuation">(</span>ResidualBlock<span class="token punctuation">,</span> self<span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>units <span class="token operator">=</span> units        <span class="token comment"># print("units: ",self.units)</span>    <span class="token keyword">def</span> <span class="token function">build</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> input_shape<span class="token punctuation">)</span><span class="token punctuation">:</span>        out_dim <span class="token operator">=</span> input_shape<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>        <span class="token comment"># print("out_dim: ",out_dim)</span>        self<span class="token punctuation">.</span>dnn1 <span class="token operator">=</span> Dense<span class="token punctuation">(</span>self<span class="token punctuation">.</span>units<span class="token punctuation">,</span> activation<span class="token operator">=</span><span class="token string">"relu"</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>dnn2 <span class="token operator">=</span> Dense<span class="token punctuation">(</span>out_dim<span class="token punctuation">,</span> activation<span class="token operator">=</span><span class="token string">"relu"</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">call</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> inputs<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token comment"># print("inputs: ",inputs)</span>        x <span class="token operator">=</span> inputs        x <span class="token operator">=</span> self<span class="token punctuation">.</span>dnn1<span class="token punctuation">(</span>x<span class="token punctuation">)</span>        <span class="token comment"># print("dnn1:",x)</span>        x <span class="token operator">=</span> self<span class="token punctuation">.</span>dnn2<span class="token punctuation">(</span>x<span class="token punctuation">)</span>        <span class="token comment"># print("dnn2:",x)</span>        x <span class="token operator">=</span> Activation<span class="token punctuation">(</span><span class="token string">"relu"</span><span class="token punctuation">)</span><span class="token punctuation">(</span>x <span class="token operator">+</span> inputs<span class="token punctuation">)</span>        <span class="token keyword">return</span> x<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="九、Scoring-Layer"><a href="#九、Scoring-Layer" class="headerlink" title="九、Scoring Layer"></a>九、Scoring Layer</h2><p>这个作为输出层，为了拟合优化目标存在。 对于CTR预估二分类问题， Scoring往往采用逻辑回归，模型通过叠加多个残差块加深网络的深度，最后将结果转换成一个概率值输出。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">get_dnn_logits</span><span class="token punctuation">(</span>dnn_inputs<span class="token punctuation">,</span> block_nums<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    dnn_out <span class="token operator">=</span> dnn_inputs    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>block_nums<span class="token punctuation">)</span><span class="token punctuation">:</span>        dnn_out <span class="token operator">=</span> ResidualBlock<span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">)</span><span class="token punctuation">(</span>dnn_out<span class="token punctuation">)</span>    dnn_logits <span class="token operator">=</span> Dense<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> activation<span class="token operator">=</span><span class="token string">"sigmoid"</span><span class="token punctuation">)</span><span class="token punctuation">(</span>dnn_out<span class="token punctuation">)</span>        <span class="token keyword">return</span> dnn_logits<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>从模型的代码结构上来看，DeepCrossing的模型输入主要由数值特征和类别特征组成，并将经过Embedding之后的类别特征及类别特征拼接在一起，详细的拼接代码如Staking Layer所示，下面是构建模型的核心代码</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">DeepCrossing</span><span class="token punctuation">(</span>dnn_feature_columns<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token comment"># 构建输入层，即所有特征对应的Input()层，这里使用字典的形式返回，方便后续构建模型</span>    dense_input_dict<span class="token punctuation">,</span> sparse_input_dict <span class="token operator">=</span> build_input_layers<span class="token punctuation">(</span>dnn_feature_columns<span class="token punctuation">)</span>    input_layers <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>dense_input_dict<span class="token punctuation">.</span>values<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token builtin">list</span><span class="token punctuation">(</span>sparse_input_dict<span class="token punctuation">.</span>values<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token comment"># 构建维度为k的embedding层，这里使用字典的形式返回，方便后面搭建模型</span>    embedding_layer_dict <span class="token operator">=</span> build_embedding_layers<span class="token punctuation">(</span>dnn_feature_columns<span class="token punctuation">,</span> is_linear<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>        <span class="token comment"># 拼接所有的 dense 特征</span>    <span class="token comment"># dense_dnn_list: &lt;KerasTensor: shape=(None, 13) dtype=float32 &gt;</span>    dense_dnn_list <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>dense_input_dict<span class="token punctuation">.</span>values<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    dense_dnn_inputs <span class="token operator">=</span> Concatenate<span class="token punctuation">(</span>axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">(</span>dense_dnn_list<span class="token punctuation">)</span><span class="token comment"># B x n (n表示数值特征的数量13)</span>        <span class="token comment"># 拼接所有的 sparse 特征，需要 Flatten</span>    <span class="token comment"># sparse_dnn_inputs: &lt;KerasTensor: shape=(None, 104) dtype=float32&gt;</span>    <span class="token comment"># 26(C1-C26) * 4(fc.embedding_dim=4) = 104</span>    sparse_dnn_list <span class="token operator">=</span> concat_embedding_list<span class="token punctuation">(</span>dnn_feature_columns<span class="token punctuation">,</span> sparse_input_dict<span class="token punctuation">,</span> embedding_layer_dict<span class="token punctuation">,</span> flatten<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>    sparse_dnn_inputs <span class="token operator">=</span> Concatenate<span class="token punctuation">(</span>axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">(</span>sparse_dnn_list<span class="token punctuation">)</span>        <span class="token comment"># 拼接 dense ＆ sparse (None, 104+13)</span>    <span class="token comment"># dnn_inputs:&lt;KerasTensor: shape=(None, 117) dtype=float32&gt;</span>    dnn_inputs <span class="token operator">=</span> Concatenate<span class="token punctuation">(</span>axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">[</span>dense_dnn_inputs<span class="token punctuation">,</span> sparse_dnn_inputs<span class="token punctuation">]</span><span class="token punctuation">)</span>        output_layer <span class="token operator">=</span> get_dnn_logits<span class="token punctuation">(</span>dnn_inputs<span class="token punctuation">,</span> block_nums<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">)</span>    model <span class="token operator">=</span> Model<span class="token punctuation">(</span>input_layers<span class="token punctuation">,</span> output_layer<span class="token punctuation">)</span>        <span class="token keyword">return</span> model<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">history <span class="token operator">=</span> DeepCrossing<span class="token punctuation">(</span>dnn_feature_columns<span class="token punctuation">)</span>history<span class="token punctuation">.</span>summary<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">Model<span class="token punctuation">:</span> <span class="token string">"model"</span>__________________________________________________________________________________________________Layer <span class="token punctuation">(</span><span class="token builtin">type</span><span class="token punctuation">)</span>                    Output Shape         Param <span class="token comment">#     Connected to                     </span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span>C1 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                 <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________C2 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                 <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________C3 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                 <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________C4 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                 <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________C5 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                 <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________C6 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                 <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________C7 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                 <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________C8 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                 <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________C9 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                 <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________C10 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________C11 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________C12 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________C13 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________C14 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________C15 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________C16 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________C17 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________C18 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________C19 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________C20 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________C21 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________C22 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________C23 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________C24 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________C25 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________C26 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________kd_emb_C1 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>           <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>         <span class="token number">112</span>         C1<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                         __________________________________________________________________________________________________kd_emb_C2 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>           <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>         <span class="token number">372</span>         C2<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                         __________________________________________________________________________________________________kd_emb_C3 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>           <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>         <span class="token number">692</span>         C3<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                         __________________________________________________________________________________________________kd_emb_C4 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>           <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>         <span class="token number">632</span>         C4<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                         __________________________________________________________________________________________________kd_emb_C5 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>           <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>         <span class="token number">52</span>          C5<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                         __________________________________________________________________________________________________kd_emb_C6 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>           <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>         <span class="token number">32</span>          C6<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                         __________________________________________________________________________________________________kd_emb_C7 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>           <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>         <span class="token number">736</span>         C7<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                         __________________________________________________________________________________________________kd_emb_C8 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>           <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>         <span class="token number">80</span>          C8<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                         __________________________________________________________________________________________________kd_emb_C9 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>           <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>         <span class="token number">12</span>          C9<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                         __________________________________________________________________________________________________kd_emb_C10 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>          <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>         <span class="token number">572</span>         C10<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                        __________________________________________________________________________________________________kd_emb_C11 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>          <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>         <span class="token number">696</span>         C11<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                        __________________________________________________________________________________________________kd_emb_C12 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>          <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>         <span class="token number">684</span>         C12<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                        __________________________________________________________________________________________________kd_emb_C13 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>          <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>         <span class="token number">668</span>         C13<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                        __________________________________________________________________________________________________kd_emb_C14 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>          <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>         <span class="token number">60</span>          C14<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                        __________________________________________________________________________________________________kd_emb_C15 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>          <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>         <span class="token number">684</span>         C15<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                        __________________________________________________________________________________________________kd_emb_C16 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>          <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>         <span class="token number">676</span>         C16<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                        __________________________________________________________________________________________________kd_emb_C17 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>          <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>         <span class="token number">40</span>          C17<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                        __________________________________________________________________________________________________kd_emb_C18 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>          <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>         <span class="token number">512</span>         C18<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                        __________________________________________________________________________________________________kd_emb_C19 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>          <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>         <span class="token number">180</span>         C19<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                        __________________________________________________________________________________________________kd_emb_C20 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>          <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>         <span class="token number">20</span>          C20<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                        __________________________________________________________________________________________________kd_emb_C21 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>          <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>         <span class="token number">680</span>         C21<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                        __________________________________________________________________________________________________kd_emb_C22 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>          <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>         <span class="token number">28</span>          C22<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                        __________________________________________________________________________________________________kd_emb_C23 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>          <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>         <span class="token number">44</span>          C23<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                        __________________________________________________________________________________________________kd_emb_C24 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>          <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>         <span class="token number">504</span>         C24<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                        __________________________________________________________________________________________________kd_emb_C25 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>          <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>         <span class="token number">84</span>          C25<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                        __________________________________________________________________________________________________kd_emb_C26 <span class="token punctuation">(</span>Embedding<span class="token punctuation">)</span>          <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>         <span class="token number">364</span>         C26<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                        __________________________________________________________________________________________________I1 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                 <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________I2 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                 <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________I3 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                 <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________I4 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                 <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________I5 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                 <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________I6 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                 <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________I7 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                 <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________I8 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                 <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________I9 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                 <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________I10 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________I11 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________I12 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________I13 <span class="token punctuation">(</span>InputLayer<span class="token punctuation">)</span>                <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>          <span class="token number">0</span>                                            __________________________________________________________________________________________________flatten_78 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>            <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>            <span class="token number">0</span>           kd_emb_C1<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                  __________________________________________________________________________________________________flatten_79 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>            <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>            <span class="token number">0</span>           kd_emb_C2<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                  __________________________________________________________________________________________________flatten_80 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>            <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>            <span class="token number">0</span>           kd_emb_C3<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                  __________________________________________________________________________________________________flatten_81 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>            <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>            <span class="token number">0</span>           kd_emb_C4<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                  __________________________________________________________________________________________________flatten_82 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>            <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>            <span class="token number">0</span>           kd_emb_C5<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                  __________________________________________________________________________________________________flatten_83 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>            <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>            <span class="token number">0</span>           kd_emb_C6<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                  __________________________________________________________________________________________________flatten_84 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>            <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>            <span class="token number">0</span>           kd_emb_C7<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                  __________________________________________________________________________________________________flatten_85 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>            <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>            <span class="token number">0</span>           kd_emb_C8<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                  __________________________________________________________________________________________________flatten_86 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>            <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>            <span class="token number">0</span>           kd_emb_C9<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                  __________________________________________________________________________________________________flatten_87 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>            <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>            <span class="token number">0</span>           kd_emb_C10<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                 __________________________________________________________________________________________________flatten_88 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>            <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>            <span class="token number">0</span>           kd_emb_C11<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                 __________________________________________________________________________________________________flatten_89 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>            <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>            <span class="token number">0</span>           kd_emb_C12<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                 __________________________________________________________________________________________________flatten_90 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>            <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>            <span class="token number">0</span>           kd_emb_C13<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                 __________________________________________________________________________________________________flatten_91 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>            <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>            <span class="token number">0</span>           kd_emb_C14<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                 __________________________________________________________________________________________________flatten_92 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>            <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>            <span class="token number">0</span>           kd_emb_C15<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                 __________________________________________________________________________________________________flatten_93 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>            <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>            <span class="token number">0</span>           kd_emb_C16<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                 __________________________________________________________________________________________________flatten_94 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>            <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>            <span class="token number">0</span>           kd_emb_C17<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                 __________________________________________________________________________________________________flatten_95 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>            <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>            <span class="token number">0</span>           kd_emb_C18<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                 __________________________________________________________________________________________________flatten_96 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>            <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>            <span class="token number">0</span>           kd_emb_C19<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                 __________________________________________________________________________________________________flatten_97 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>            <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>            <span class="token number">0</span>           kd_emb_C20<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                 __________________________________________________________________________________________________flatten_98 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>            <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>            <span class="token number">0</span>           kd_emb_C21<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                 __________________________________________________________________________________________________flatten_99 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>            <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>            <span class="token number">0</span>           kd_emb_C22<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                 __________________________________________________________________________________________________flatten_100 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>           <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>            <span class="token number">0</span>           kd_emb_C23<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                 __________________________________________________________________________________________________flatten_101 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>           <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>            <span class="token number">0</span>           kd_emb_C24<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                 __________________________________________________________________________________________________flatten_102 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>           <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>            <span class="token number">0</span>           kd_emb_C25<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                 __________________________________________________________________________________________________flatten_103 <span class="token punctuation">(</span>Flatten<span class="token punctuation">)</span>           <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span>            <span class="token number">0</span>           kd_emb_C26<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                 __________________________________________________________________________________________________concatenate_12 <span class="token punctuation">(</span>Concatenate<span class="token punctuation">)</span>    <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">)</span>           <span class="token number">0</span>           I1<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                          I2<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                          I3<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                          I4<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                          I5<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                          I6<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                          I7<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                          I8<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                          I9<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                          I10<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                         I11<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                         I12<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                         I13<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                        __________________________________________________________________________________________________concatenate_13 <span class="token punctuation">(</span>Concatenate<span class="token punctuation">)</span>    <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">104</span><span class="token punctuation">)</span>          <span class="token number">0</span>           flatten_78<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  flatten_79<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  flatten_80<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  flatten_81<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  flatten_82<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  flatten_83<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  flatten_84<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  flatten_85<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  flatten_86<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  flatten_87<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  flatten_88<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  flatten_89<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  flatten_90<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  flatten_91<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  flatten_92<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  flatten_93<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  flatten_94<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  flatten_95<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  flatten_96<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  flatten_97<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  flatten_98<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  flatten_99<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                  flatten_100<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                 flatten_101<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                 flatten_102<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                                 flatten_103<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                __________________________________________________________________________________________________concatenate_14 <span class="token punctuation">(</span>Concatenate<span class="token punctuation">)</span>    <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">117</span><span class="token punctuation">)</span>          <span class="token number">0</span>           concatenate_12<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>                                                                              concatenate_13<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>             __________________________________________________________________________________________________residual_block <span class="token punctuation">(</span>ResidualBlock<span class="token punctuation">)</span>  <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">117</span><span class="token punctuation">)</span>          <span class="token number">15157</span>       concatenate_14<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>             __________________________________________________________________________________________________residual_block_1 <span class="token punctuation">(</span>ResidualBlock <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">117</span><span class="token punctuation">)</span>          <span class="token number">15157</span>       residual_block<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>             __________________________________________________________________________________________________residual_block_2 <span class="token punctuation">(</span>ResidualBlock <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">117</span><span class="token punctuation">)</span>          <span class="token number">15157</span>       residual_block_1<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>           __________________________________________________________________________________________________dense <span class="token punctuation">(</span>Dense<span class="token punctuation">)</span>                   <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>            <span class="token number">118</span>         residual_block_2<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>           <span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span>Total params<span class="token punctuation">:</span> <span class="token number">54</span><span class="token punctuation">,</span><span class="token number">805</span>Trainable params<span class="token punctuation">:</span> <span class="token number">54</span><span class="token punctuation">,</span><span class="token number">805</span>Non<span class="token operator">-</span>trainable params<span class="token punctuation">:</span> <span class="token number">0</span>__________________________________________________________________________________________________<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">history<span class="token punctuation">.</span><span class="token builtin">compile</span><span class="token punctuation">(</span>optimizer<span class="token operator">=</span><span class="token string">"adam"</span><span class="token punctuation">,</span>loss<span class="token operator">=</span><span class="token string">"binary_crossentropy"</span><span class="token punctuation">,</span>metrics<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">"binary_crossentropy"</span>\                            <span class="token punctuation">,</span> tf<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>metrics<span class="token punctuation">.</span>AUC<span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">"auc"</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">train_model_input <span class="token operator">=</span> <span class="token punctuation">{</span>name<span class="token punctuation">:</span> data<span class="token punctuation">[</span>name<span class="token punctuation">]</span> <span class="token keyword">for</span> name <span class="token keyword">in</span> dense_features <span class="token operator">+</span> sparse_features<span class="token punctuation">}</span>history<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>train_model_input<span class="token punctuation">,</span> train_data<span class="token punctuation">[</span><span class="token string">"label"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>values<span class="token punctuation">,</span> batch_size<span class="token operator">=</span><span class="token number">128</span><span class="token punctuation">,</span> epochs<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span>validation_split<span class="token operator">=</span><span class="token number">0.2</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">Epoch <span class="token number">1</span><span class="token operator">/</span><span class="token number">10</span><span class="token number">2</span><span class="token operator">/</span><span class="token number">2</span> <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token punctuation">]</span> <span class="token operator">-</span> 4s 622ms<span class="token operator">/</span>step <span class="token operator">-</span> loss<span class="token punctuation">:</span> <span class="token number">0.8003</span> <span class="token operator">-</span> binary_crossentropy<span class="token punctuation">:</span> <span class="token number">0.8003</span> <span class="token operator">-</span> auc<span class="token punctuation">:</span> <span class="token number">0.4711</span> <span class="token operator">-</span> val_loss<span class="token punctuation">:</span> <span class="token number">0.6696</span> <span class="token operator">-</span> val_binary_crossentropy<span class="token punctuation">:</span> <span class="token number">0.6696</span> <span class="token operator">-</span> val_auc<span class="token punctuation">:</span> <span class="token number">0.4744</span>Epoch <span class="token number">2</span><span class="token operator">/</span><span class="token number">10</span><span class="token number">2</span><span class="token operator">/</span><span class="token number">2</span> <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token punctuation">]</span> <span class="token operator">-</span> 0s 70ms<span class="token operator">/</span>step <span class="token operator">-</span> loss<span class="token punctuation">:</span> <span class="token number">0.6390</span> <span class="token operator">-</span> binary_crossentropy<span class="token punctuation">:</span> <span class="token number">0.6390</span> <span class="token operator">-</span> auc<span class="token punctuation">:</span> <span class="token number">0.4995</span> <span class="token operator">-</span> val_loss<span class="token punctuation">:</span> <span class="token number">0.6319</span> <span class="token operator">-</span> val_binary_crossentropy<span class="token punctuation">:</span> <span class="token number">0.6319</span> <span class="token operator">-</span> val_auc<span class="token punctuation">:</span> <span class="token number">0.5285</span>Epoch <span class="token number">3</span><span class="token operator">/</span><span class="token number">10</span><span class="token number">2</span><span class="token operator">/</span><span class="token number">2</span> <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token punctuation">]</span> <span class="token operator">-</span> 0s 70ms<span class="token operator">/</span>step <span class="token operator">-</span> loss<span class="token punctuation">:</span> <span class="token number">0.5572</span> <span class="token operator">-</span> binary_crossentropy<span class="token punctuation">:</span> <span class="token number">0.5572</span> <span class="token operator">-</span> auc<span class="token punctuation">:</span> <span class="token number">0.5066</span> <span class="token operator">-</span> val_loss<span class="token punctuation">:</span> <span class="token number">0.6401</span> <span class="token operator">-</span> val_binary_crossentropy<span class="token punctuation">:</span> <span class="token number">0.6401</span> <span class="token operator">-</span> val_auc<span class="token punctuation">:</span> <span class="token number">0.5427</span>Epoch <span class="token number">4</span><span class="token operator">/</span><span class="token number">10</span><span class="token number">2</span><span class="token operator">/</span><span class="token number">2</span> <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token punctuation">]</span> <span class="token operator">-</span> 0s 70ms<span class="token operator">/</span>step <span class="token operator">-</span> loss<span class="token punctuation">:</span> <span class="token number">0.5400</span> <span class="token operator">-</span> binary_crossentropy<span class="token punctuation">:</span> <span class="token number">0.5400</span> <span class="token operator">-</span> auc<span class="token punctuation">:</span> <span class="token number">0.5880</span> <span class="token operator">-</span> val_loss<span class="token punctuation">:</span> <span class="token number">0.6674</span> <span class="token operator">-</span> val_binary_crossentropy<span class="token punctuation">:</span> <span class="token number">0.6674</span> <span class="token operator">-</span> val_auc<span class="token punctuation">:</span> <span class="token number">0.5855</span>Epoch <span class="token number">5</span><span class="token operator">/</span><span class="token number">10</span><span class="token number">2</span><span class="token operator">/</span><span class="token number">2</span> <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token punctuation">]</span> <span class="token operator">-</span> 0s 69ms<span class="token operator">/</span>step <span class="token operator">-</span> loss<span class="token punctuation">:</span> <span class="token number">0.5422</span> <span class="token operator">-</span> binary_crossentropy<span class="token punctuation">:</span> <span class="token number">0.5422</span> <span class="token operator">-</span> auc<span class="token punctuation">:</span> <span class="token number">0.5959</span> <span class="token operator">-</span> val_loss<span class="token punctuation">:</span> <span class="token number">0.6974</span> <span class="token operator">-</span> val_binary_crossentropy<span class="token punctuation">:</span> <span class="token number">0.6974</span> <span class="token operator">-</span> val_auc<span class="token punctuation">:</span> <span class="token number">0.6140</span>Epoch <span class="token number">6</span><span class="token operator">/</span><span class="token number">10</span><span class="token number">2</span><span class="token operator">/</span><span class="token number">2</span> <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token punctuation">]</span> <span class="token operator">-</span> 0s 72ms<span class="token operator">/</span>step <span class="token operator">-</span> loss<span class="token punctuation">:</span> <span class="token number">0.5431</span> <span class="token operator">-</span> binary_crossentropy<span class="token punctuation">:</span> <span class="token number">0.5431</span> <span class="token operator">-</span> auc<span class="token punctuation">:</span> <span class="token number">0.6414</span> <span class="token operator">-</span> val_loss<span class="token punctuation">:</span> <span class="token number">0.7074</span> <span class="token operator">-</span> val_binary_crossentropy<span class="token punctuation">:</span> <span class="token number">0.7074</span> <span class="token operator">-</span> val_auc<span class="token punctuation">:</span> <span class="token number">0.6510</span>Epoch <span class="token number">7</span><span class="token operator">/</span><span class="token number">10</span><span class="token number">2</span><span class="token operator">/</span><span class="token number">2</span> <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token punctuation">]</span> <span class="token operator">-</span> 0s 70ms<span class="token operator">/</span>step <span class="token operator">-</span> loss<span class="token punctuation">:</span> <span class="token number">0.5186</span> <span class="token operator">-</span> binary_crossentropy<span class="token punctuation">:</span> <span class="token number">0.5186</span> <span class="token operator">-</span> auc<span class="token punctuation">:</span> <span class="token number">0.7036</span> <span class="token operator">-</span> val_loss<span class="token punctuation">:</span> <span class="token number">0.6900</span> <span class="token operator">-</span> val_binary_crossentropy<span class="token punctuation">:</span> <span class="token number">0.6900</span> <span class="token operator">-</span> val_auc<span class="token punctuation">:</span> <span class="token number">0.6909</span>Epoch <span class="token number">8</span><span class="token operator">/</span><span class="token number">10</span><span class="token number">2</span><span class="token operator">/</span><span class="token number">2</span> <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token punctuation">]</span> <span class="token operator">-</span> 0s 70ms<span class="token operator">/</span>step <span class="token operator">-</span> loss<span class="token punctuation">:</span> <span class="token number">0.5130</span> <span class="token operator">-</span> binary_crossentropy<span class="token punctuation">:</span> <span class="token number">0.5130</span> <span class="token operator">-</span> auc<span class="token punctuation">:</span> <span class="token number">0.7707</span> <span class="token operator">-</span> val_loss<span class="token punctuation">:</span> <span class="token number">0.6581</span> <span class="token operator">-</span> val_binary_crossentropy<span class="token punctuation">:</span> <span class="token number">0.6581</span> <span class="token operator">-</span> val_auc<span class="token punctuation">:</span> <span class="token number">0.7350</span>Epoch <span class="token number">9</span><span class="token operator">/</span><span class="token number">10</span><span class="token number">2</span><span class="token operator">/</span><span class="token number">2</span> <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token punctuation">]</span> <span class="token operator">-</span> 0s 71ms<span class="token operator">/</span>step <span class="token operator">-</span> loss<span class="token punctuation">:</span> <span class="token number">0.5084</span> <span class="token operator">-</span> binary_crossentropy<span class="token punctuation">:</span> <span class="token number">0.5084</span> <span class="token operator">-</span> auc<span class="token punctuation">:</span> <span class="token number">0.8042</span> <span class="token operator">-</span> val_loss<span class="token punctuation">:</span> <span class="token number">0.6325</span> <span class="token operator">-</span> val_binary_crossentropy<span class="token punctuation">:</span> <span class="token number">0.6325</span> <span class="token operator">-</span> val_auc<span class="token punctuation">:</span> <span class="token number">0.7393</span>Epoch <span class="token number">10</span><span class="token operator">/</span><span class="token number">10</span><span class="token number">2</span><span class="token operator">/</span><span class="token number">2</span> <span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token punctuation">]</span> <span class="token operator">-</span> 0s 69ms<span class="token operator">/</span>step <span class="token operator">-</span> loss<span class="token punctuation">:</span> <span class="token number">0.4865</span> <span class="token operator">-</span> binary_crossentropy<span class="token punctuation">:</span> <span class="token number">0.4865</span> <span class="token operator">-</span> auc<span class="token punctuation">:</span> <span class="token number">0.8240</span> <span class="token operator">-</span> val_loss<span class="token punctuation">:</span> <span class="token number">0.6163</span> <span class="token operator">-</span> val_binary_crossentropy<span class="token punctuation">:</span> <span class="token number">0.6163</span> <span class="token operator">-</span> val_auc<span class="token punctuation">:</span> <span class="token number">0.7479</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token operator">&lt;</span>tensorflow<span class="token punctuation">.</span>python<span class="token punctuation">.</span>keras<span class="token punctuation">.</span>callbacks<span class="token punctuation">.</span>History at <span class="token number">0x270be4a3730</span><span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="疑问"><a href="#疑问" class="headerlink" title="疑问"></a>疑问</h2><p>模型训练时，助教代码给的是使用 data 数据集，但我一直认为 data 并没有被改变，还是原来读取初始数据的变量，但是并不影响运行，于是我进行了两步判断，输出 data 结果；其次判断 data 和 train_data 是否相同。验证结果如下。</p><h3 id="Python-直接赋值、浅拷贝和深度拷贝解析"><a href="#Python-直接赋值、浅拷贝和深度拷贝解析" class="headerlink" title="Python 直接赋值、浅拷贝和深度拷贝解析"></a>Python 直接赋值、浅拷贝和深度拷贝解析</h3><ul><li><strong>直接赋值：</strong>其实就是对象的引用（别名）。</li><li><strong>浅拷贝(copy)：</strong>拷贝父对象，不会拷贝对象的内部的子对象。</li><li><strong>深拷贝(deepcopy)：</strong> copy 模块的 deepcopy 方法，完全拷贝了父对象及其子对象。</li></ul><p>字典浅拷贝实例</p><p>实例</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span>a <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">}</span> <span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> b <span class="token operator">=</span> a<span class="token punctuation">.</span>copy<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> a<span class="token punctuation">,</span> b <span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> a<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> a<span class="token punctuation">,</span> b <span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><strong>深度拷贝需要引入 copy 模块：</strong></p><p>实例</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span><span class="token keyword">import</span> copy <span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> c <span class="token operator">=</span> copy<span class="token punctuation">.</span>deepcopy<span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> a<span class="token punctuation">,</span> c <span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> a<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token operator">&gt;&gt;</span><span class="token operator">&gt;</span> a<span class="token punctuation">,</span> c <span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>解析</p><p><strong>1、b = a:</strong> 赋值引用，a 和 b 都指向同一个对象。</p><p><img src="https://www.runoob.com/wp-content/uploads/2017/03/1489720931-7116-4AQC6.png" alt="b=a"></p><p><strong>2、b = a.copy():</strong> 浅拷贝, a 和 b 是一个独立的对象，但他们的子对象还是指向统一对象（是引用）。</p><p><img src="https://www.runoob.com/wp-content/uploads/2017/03/1489720930-6827-Vtk4m.png" alt="b=a.copy()"></p><p><strong>3、b = copy.deepcopy(a):</strong> 深度拷贝, a 和 b 完全拷贝了父对象及其子对象，两者是完全独立的。</p><p><img src="https://www.runoob.com/wp-content/uploads/2017/03/1489720930-5882-BO4qO.png" alt="b=copy.deepcopy(a)"></p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 可以发现当前的 data 数据值已经被改变</span>data<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token punctuation">.</span>dataframe tbody tr th <span class="token punctuation">&#123;</span>    vertical<span class="token operator">-</span>align<span class="token punctuation">:</span> top<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token punctuation">.</span>dataframe thead th <span class="token punctuation">&#123;</span>    text<span class="token operator">-</span>align<span class="token punctuation">:</span> right<span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></style><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>label</th>      <th>I1</th>      <th>I2</th>      <th>I3</th>      <th>I4</th>      <th>I5</th>      <th>I6</th>      <th>I7</th>      <th>I8</th>      <th>I9</th>      <th>...</th>      <th>C17</th>      <th>C18</th>      <th>C19</th>      <th>C20</th>      <th>C21</th>      <th>C22</th>      <th>C23</th>      <th>C24</th>      <th>C25</th>      <th>C26</th>    </tr>  </thead>  <tbody>    <tr>      <th>0</th>      <td>0</td>      <td>0.0</td>      <td>0.625800</td>      <td>1.058373</td>      <td>0.000000</td>      <td>1.217181</td>      <td>0.000000</td>      <td>0.000000</td>      <td>0.920250</td>      <td>0.000000</td>      <td>...</td>      <td>8</td>      <td>66</td>      <td>0</td>      <td>0</td>      <td>3</td>      <td>0</td>      <td>1</td>      <td>96</td>      <td>0</td>      <td>0</td>    </tr>    <tr>      <th>1</th>      <td>0</td>      <td>0.0</td>      <td>-1.000000</td>      <td>0.869294</td>      <td>0.925237</td>      <td>1.231491</td>      <td>1.055658</td>      <td>0.423036</td>      <td>0.925237</td>      <td>1.031488</td>      <td>...</td>      <td>7</td>      <td>52</td>      <td>0</td>      <td>0</td>      <td>47</td>      <td>0</td>      <td>7</td>      <td>112</td>      <td>0</td>      <td>0</td>    </tr>    <tr>      <th>2</th>      <td>0</td>      <td>0.0</td>      <td>0.000000</td>      <td>0.554618</td>      <td>0.820286</td>      <td>1.148252</td>      <td>1.032922</td>      <td>0.732569</td>      <td>0.925237</td>      <td>1.092790</td>      <td>...</td>      <td>8</td>      <td>49</td>      <td>0</td>      <td>0</td>      <td>25</td>      <td>0</td>      <td>6</td>      <td>53</td>      <td>0</td>      <td>0</td>    </tr>    <tr>      <th>3</th>      <td>0</td>      <td>0.0</td>      <td>0.829305</td>      <td>0.423036</td>      <td>0.672503</td>      <td>1.215852</td>      <td>1.044182</td>      <td>0.706395</td>      <td>0.672503</td>      <td>0.909015</td>      <td>...</td>      <td>8</td>      <td>37</td>      <td>0</td>      <td>0</td>      <td>156</td>      <td>0</td>      <td>0</td>      <td>32</td>      <td>0</td>      <td>0</td>    </tr>    <tr>      <th>4</th>      <td>0</td>      <td>0.0</td>      <td>0.000000</td>      <td>1.005164</td>      <td>0.902628</td>      <td>1.147829</td>      <td>1.024444</td>      <td>0.672503</td>      <td>0.917610</td>      <td>0.929876</td>      <td>...</td>      <td>8</td>      <td>14</td>      <td>5</td>      <td>3</td>      <td>9</td>      <td>0</td>      <td>0</td>      <td>5</td>      <td>1</td>      <td>47</td>    </tr>  </tbody></table><p>5 rows × 40 columns</p></div><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 检验两者是否相同，结果为 True</span>data <span class="token keyword">is</span> train_data<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token boolean">True</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><ul><li><a href="https://github.com/datawhalechina/team-learning-rs/blob/master/DeepRecommendationModel/DeepCrossing.md">DeepCrossing</a></li><li><a href="https://www.bookstack.cn/read/huaxiaozhuan-ai/spilt.4.5fb26f9d30c55109.md">AI算法工程师手册</a></li><li><a href="https://github.com/shenweichen/DeepCTR">deepctr</a></li><li><a href="https://www.kdd.org/kdd2016/papers/files/adf0975-shanA.pdf">论文原文</a></li><li><a href="https://zhuanlan.zhihu.com/p/320196402">无中生有：论推荐算法中的Embedding思想</a></li><li><a href="https://blog.csdn.net/wuzhongqiang/article/details/108948440">AI上推荐 之 AutoRec与Deep Crossing模型(改变神经网络的复杂程度）</a></li><li><a href="https://blog.csdn.net/binlin199012/article/details/112346140">embedding层和全连接层的区别是什么？</a></li><li><a href="https://forums.fast.ai/t/what-is-the-difference-between-embeddings-and-pca/10948">What is the difference between embeddings and pca?</a></li><li><a href="https://www.quora.com/What-is-the-connection-between-PCA-and-Word2Vec-in-terms-of-word-embedding-Is-there-an-empiric-superiority-between-the-two">What is the connection between PCA and Word2Vec in terms of word embedding? Is there an empiric superiority between the two?</a></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> DataWhale </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ubuntu 20.04 中文输入法安装</title>
      <link href="2021/03/04/ubuntu-20-04-zhong-wen-shu-ru-fa-an-zhuang/"/>
      <url>2021/03/04/ubuntu-20-04-zhong-wen-shu-ru-fa-an-zhuang/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>links-杂</title>
      <link href="2021/03/03/links-za/"/>
      <url>2021/03/03/links-za/</url>
      
        <content type="html"><![CDATA[<p><a href="https://blog.csdn.net/Yaokai_AssultMaster/article/details/79492190">树状数组（Binary Indexed Tree），看这一篇就够了</a></p><p><a href="https://leetcode-cn.com/problems/create-sorted-array-through-instructions/">1649. 通过指令创建有序数组</a></p><p><a href="https://blog.csdn.net/a805607966/article/details/105874756">ubuntu 20.04中文输入法安装</a></p><p><a href="https://deali.gitee.io/Linux/Linux%EF%BC%9A%E6%8F%90%E9%AB%98%E9%BC%A0%E6%A0%87%E6%BB%9A%E8%BD%AE%E7%9A%84%E9%80%9F%E5%BA%A6/">Linux：提高鼠标滚轮的速度</a></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>树状数组(Binary Indexed Tree)</title>
      <link href="2021/03/03/shu-zhuang-shu-zu-binary-indexed-tree/"/>
      <url>2021/03/03/shu-zhuang-shu-zu-binary-indexed-tree/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Data Science 比赛汇总</title>
      <link href="2021/02/24/data-science-bi-sai-hui-zong/"/>
      <url>2021/02/24/data-science-bi-sai-hui-zong/</url>
      
        <content type="html"><![CDATA[<p>搜索汇总网址：<a href="https://coggle.club/">https://coggle.club/</a></p><p><strong>1. kaggle</strong></p><p>一个比较权威的全球性的数据竞赛平台，也是一个很好的技术和数据分享社区。可以找到各个领域的比赛和数据，最重要的是可以找到很多有用的经验贴和一个开源的代码，可以帮助小白前进，小编做个几个比赛，该平台对我的帮助很大，学到很多东西。该平台的比赛工作面试时认可度比较大。链接：<a href="https://www.kaggle.com">https://www.kaggle.com</a></p><p><strong>2.天池</strong></p><p>天池是阿里云创建的数据竞赛平台，它和 Kaggle 很像。各个领域的比赛都有，赛制持续时间较长，会有一些直播教程和专业课程，比较利于新手入门。链接：<a href="https://tianchi.aliyun.com/competition/gameList/activeList">https://tianchi.aliyun.com/competition/gameList/activeList</a></p><p><strong>3.DataCastle</strong></p><p>平台上多为企业的或者政府的比赛，包含数据算法各个方向，数据量方面相对天池较少，参赛人数也次之。平台上也有类似 kaggle 的名人堂和和数据集，平台的社区活跃度不高。链接：<a href="https://www.dcjingsai.com/common/cmptIndex.html">https://www.dcjingsai.com/common/cmptIndex.html</a></p><p><strong>4.Datafountain</strong></p><p>DataFountain(DF)平台是 CCF 大数据与计算智能大赛指定的平台。CCF 大数据与计算智能大赛(BigData &amp; Computing Intelligence Contest,简称“BDCI”)是由中国计算机学会主办的大数据及人工智能领域算法挑战及应用创新大型赛事。链接：<a href="https://www.datafountain.cn">https://www.datafountain.cn</a></p><p><strong>5.科赛-Kesci</strong></p><p>科赛(Kesci.com)是聚合数据人才和行业问题的在线社区。平台 2019 年初开始转型，接的比赛项目奖金较高，一些大型比赛会有一些培训指南。链接：<a href="https://www.kesci.com">https://www.kesci.com</a></p><p><strong>6.biendata</strong></p><p>Biendata.com 是一个人工智能竞赛学习平台，用户可通过该平台报名并参加人工智能领域各类赛事，奖金较丰富。链接：<a href="https://biendata.com">https://biendata.com</a></p><p><strong>7.华为云</strong></p><p>华为云平台的比赛多是基于华为的业务，有的是直接面向校招，比赛项目较多，包含软件、AI、芯片等，奖金较多，有免费的 gpu 算力。链接：<a href="https://competition.huaweicloud.com/competitions">https://competition.huaweicloud.com/competitions</a></p><p><strong>7.其它平台</strong></p><ul><li>百度点石：<a href="http://dianshi.bce.baidu.com/competition">http://dianshi.bce.baidu.com/competition</a></li><li>JDATA：<a href="https://jdata.jd.com">https://jdata.jd.com</a></li><li>京东大赛 : <a href="https://jdder.jd.com">https://jdder.jd.com</a></li><li>腾讯广告算法大赛：<a href="https://algo.qq.com">https://algo.qq.com</a></li><li>爱奇艺 ai 竞赛平台(多为视频比赛) : <a href="http://challenge.ai.iqiyi.com">http://challenge.ai.iqiyi.com</a></li><li>图灵联邦: <a href="https://www.turingtopia.com/competitionnew">https://www.turingtopia.com/competitionnew</a></li><li>讯飞开放平台：<a href="http://challenge.xfyun.cn">http://challenge.xfyun.cn</a></li><li>Flyai:<a href="https://www.flyai.com">https://www.flyai.com</a></li><li>蚂蚁金服：<a href="https://dc.cloud.alipay.com">https://dc.cloud.alipay.com</a></li><li>TinyMind: <a href="https://www.tinymind.cn/competitions/ai">https://www.tinymind.cn/competitions/ai</a></li><li>拍拍贷：<a href="https://ai.ppdai.com">https://ai.ppdai.com</a></li><li>睡前 Futurelab（只针对在校生）：<a href="https://ai.futurelab.tv/contest/all">https://ai.futurelab.tv/contest/all</a></li><li>国外医学图像相关：<a href="https://grand-challenge.org/challenges">https://grand-challenge.org/challenges</a></li><li>数睿思：<a href="http://www.tipdm.org/bdrace/jingsa">http://www.tipdm.org/bdrace/jingsa</a></li><li>数愿：<a href="http://www.datadreams.org/#/raceList">http://www.datadreams.org/#/raceList</a></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> data science </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Top 90 Data Science Blogs, Websites &amp; Influencers in 2021</title>
      <link href="2021/02/07/top-90-data-science-blogs-websites-influencers-in-2021/"/>
      <url>2021/02/07/top-90-data-science-blogs-websites-influencers-in-2021/</url>
      
        <content type="html"><![CDATA[<h1 id="Top-90-Data-Science-Blogs-Websites-amp-Influencers-in-2021"><a href="#Top-90-Data-Science-Blogs-Websites-amp-Influencers-in-2021" class="headerlink" title="Top 90 Data Science Blogs, Websites &amp; Influencers in 2021"></a><a href="https://blog.feedspot.com/data_science_blogs/">Top 90 Data Science Blogs, Websites &amp; Influencers in 2021</a></h1><p>Last Updated Feb 4, 2021</p><p><strong>Contents</strong> [hide] ⋅<strong>About this list &amp; ranking</strong></p><ol><li>Data Science Blogs<ol><li><a href="https://blog.feedspot.com/data_science_blogs/#h972655">Data Science Central</a></li><li><a href="https://blog.feedspot.com/data_science_blogs/#h3800693">KDnuggets</a></li><li><a href="https://blog.feedspot.com/data_science_blogs/#h4558463">Reddit » Data Science</a></li><li><a href="https://blog.feedspot.com/data_science_blogs/#h4575696">Analytics Vidhya</a></li><li><a href="https://blog.feedspot.com/data_science_blogs/#h4557867">DataCamp Blog</a></li><li><a href="https://blog.feedspot.com/data_science_blogs/#h4163854">Data Science 101</a></li><li><a href="https://blog.feedspot.com/data_science_blogs/#h4562803">Kaggle | Data Science News No Free Hunch</a></li><li><a href="https://blog.feedspot.com/data_science_blogs/#h5197562">Data Double Confirm</a></li><li><a href="https://blog.feedspot.com/data_science_blogs/#h4557869">Datascience@Berkeley | Online Learning Blog</a></li><li><a href="https://blog.feedspot.com/data_science_blogs/#h4342187">Dataquest Blog</a></li><li><a href="https://blog.feedspot.com/data_science_blogs/#h4558215">UC San Diego’s Data Science Blog Center for Computational Biology &amp; Bioinformatics</a></li><li><a href="https://blog.feedspot.com/data_science_blogs/#h4342188">Codementor » Data Science Tutorials</a></li><li><a href="https://blog.feedspot.com/data_science_blogs/#h4729978">Analytics Insight</a></li><li><a href="https://blog.feedspot.com/data_science_blogs/#h4558162">Data Science made in Switzerland</a></li><li><a href="https://blog.feedspot.com/data_science_blogs/#h4563135">DataRobot | Machine Learning Software</a></li><li><a href="https://blog.feedspot.com/data_science_blogs/#h596438">Command Line Tips</a></li><li><a href="https://blog.feedspot.com/data_science_blogs/#h5124478">365 Data Science » Q&amp;A Hub</a></li><li><a href="https://blog.feedspot.com/data_science_blogs/#h4562335">Chris Albon - Data Science, Machine Learning, and Artificial Intelligence</a></li><li><a href="https://blog.feedspot.com/data_science_blogs/#h5065808">Data Science Blog | AI, ML, big data analytics</a></li><li><a href="https://blog.feedspot.com/data_science_blogs/#h4557870">Domino Data Science Blog</a></li><li><a href="https://blog.feedspot.com/data_science_blogs/#h4372080">The Data Incubator</a></li><li><a href="https://blog.feedspot.com/data_science_blogs/#h57631">Revolutions</a></li><li><a href="https://blog.feedspot.com/data_science_blogs/#h5134987">Stats and R</a></li><li><a href="https://blog.feedspot.com/data_science_blogs/#h4785825">InnoArchiTech</a></li><li><a href="https://blog.feedspot.com/data_science_blogs/#h4557881">Insight Data</a></li><li><a href="https://blog.feedspot.com/data_science_blogs/#h4954371">Little Miss Data</a></li><li><a href="https://blog.feedspot.com/data_science_blogs/#h4558170">Data Science Association blog</a></li><li><a href="https://blog.feedspot.com/data_science_blogs/#h4726425">Appsilon Blog | End­ to­ End Data Science Solutions</a></li><li><a href="https://blog.feedspot.com/data_science_blogs/#h4558183">Data Science Blog (English only)</a></li><li><a href="https://blog.feedspot.com/data_science_blogs/#h5003657">DataMites Blog</a></li><li><a href="https://blog.feedspot.com/data_science_blogs/#h4558488">Dataaspirant</a></li><li><a href="https://blog.feedspot.com/data_science_blogs/#h5221768">Predictive Hacks</a></li><li><a href="https://blog.feedspot.com/data_science_blogs/#h4523799">Data Skeptic</a></li><li><a href="https://blog.feedspot.com/data_science_blogs/#h4623719">mlwhiz</a></li><li><a href="https://blog.feedspot.com/data_science_blogs/#h4558138">b.telligent - Data Science Blog</a></li><li><a href="https://blog.feedspot.com/data_science_blogs/#h5119284">Verra Mobility</a></li><li><a href="https://blog.feedspot.com/data_science_blogs/#h4562827">Data Elixir</a></li><li><a href="https://blog.feedspot.com/data_science_blogs/#h5237885">jbencook</a></li><li><a href="https://blog.feedspot.com/data_science_blogs/#h4557874">Ujjwal Karn - The Data Science blog</a></li><li><a href="https://blog.feedspot.com/data_science_blogs/#h4500397">data science ish</a></li><li><a href="https://blog.feedspot.com/data_science_blogs/#h4558492">Insight Extractor Blog</a></li><li><a href="https://blog.feedspot.com/data_science_blogs/#h5162211">Data Science PR</a></li><li><a href="https://blog.feedspot.com/data_science_blogs/#h4558445">Data Piques</a></li><li><a href="https://blog.feedspot.com/data_science_blogs/#h5202715">Datamahadev.com</a></li><li><a href="https://blog.feedspot.com/data_science_blogs/#h4291989">Mad (Data) Scientist</a></li><li><a href="https://blog.feedspot.com/data_science_blogs/#h5069805">Blue Orange</a></li><li><a href="https://blog.feedspot.com/data_science_blogs/#h4557872">SV Data Science</a></li><li><a href="https://blog.feedspot.com/data_science_blogs/#h4563069">Data Science, Database, Tools and QA Learning’s</a></li><li><a href="https://blog.feedspot.com/data_science_blogs/#h352718">Neural Market Trends</a></li><li><a href="https://blog.feedspot.com/data_science_blogs/#h4562669">Yanir Seroussi | Data science and beyond</a></li><li><a href="https://blog.feedspot.com/data_science_blogs/#h4462887">Yhat: The Yhat (Pronounced Y-hat) Blog</a></li><li><a href="https://blog.feedspot.com/data_science_blogs/#h5148111">9TO5SAS</a></li><li><a href="https://blog.feedspot.com/data_science_blogs/#h4973186">Data Science Review | Learning Data Science Right</a></li><li><a href="https://blog.feedspot.com/data_science_blogs/#h4990229">Socrates Data Science Blog</a></li><li><a href="https://blog.feedspot.com/data_science_blogs/#h4563061">Data Science Unicorn</a></li><li><a href="https://blog.feedspot.com/data_science_blogs/#h4557882">Oracle Data Science Blog</a></li><li><a href="https://blog.feedspot.com/data_science_blogs/#h4562411">The Data Science Community</a></li><li><a href="https://blog.feedspot.com/data_science_blogs/#h4558552">Data Science Consulting LLC</a></li><li><a href="https://blog.feedspot.com/data_science_blogs/#h4562447">Datalore Labs Blog</a></li><li><a href="https://blog.feedspot.com/data_science_blogs/#h4563107">AnalytiXon</a></li><li><a href="https://blog.feedspot.com/data_science_blogs/#h4558437">Perfect Price Blog</a></li><li><a href="https://blog.feedspot.com/data_science_blogs/#h4558548">FOXY DATA SCIENCE</a></li><li><a href="https://blog.feedspot.com/data_science_blogs/#h4563090">Data Science Diary</a></li><li><a href="https://blog.feedspot.com/data_science_blogs/#h4558479">Datapolitan</a></li><li><a href="https://blog.feedspot.com/data_science_blogs/#h5185675">Dr. Shahin Rostami</a></li><li><a href="https://blog.feedspot.com/data_science_blogs/#h4562376">ikigomu</a></li><li><a href="https://blog.feedspot.com/data_science_blogs/#h4558165">DSI Analytics - Data Science Insights</a></li><li><a href="https://blog.feedspot.com/data_science_blogs/#h4562359">ERDataDoc</a></li><li><a href="https://blog.feedspot.com/data_science_blogs/#h4681198">Carlo Carandang - Data Science</a></li><li><a href="https://blog.feedspot.com/data_science_blogs/#h5132765">Hi! I am Nagdev</a></li><li><a href="https://blog.feedspot.com/data_science_blogs/#h4558467">Nina B. Zumel | Data Science</a></li><li><a href="https://blog.feedspot.com/data_science_blogs/#h4337309">DATAVERSITY » Data Science News, Articles, &amp; Education</a></li><li><a href="https://blog.feedspot.com/data_science_blogs/#h4558456">Dimensionless Technologies Blog | Data Science &amp; Business Analytics</a></li><li><a href="https://blog.feedspot.com/data_science_blogs/#h4558483">My Data Science and Big Data blog</a></li><li><a href="https://blog.feedspot.com/data_science_blogs/#h4558152">Data Science for Social Good</a></li><li><a href="https://blog.feedspot.com/data_science_blogs/#h4791017">Dimensionless</a></li><li><a href="https://blog.feedspot.com/data_science_blogs/#h4558211">The Data Blogger</a></li><li><a href="https://blog.feedspot.com/data_science_blogs/#h5064909">Hevo Blog | Transformative ideas and real insights on all things Data</a></li><li><a href="https://blog.feedspot.com/data_science_blogs/#h109790">Win-Vector Blog</a></li><li><a href="https://blog.feedspot.com/data_science_blogs/#h4557889">Data Plus Science</a></li><li><a href="https://blog.feedspot.com/data_science_blogs/#h5150380">Perceptrons</a></li><li><a href="https://blog.feedspot.com/data_science_blogs/#h4557886">DataScience@SMU - Southern Methodist University</a></li><li><a href="https://blog.feedspot.com/data_science_blogs/#h5134714">Remix Institute</a></li><li><a href="https://blog.feedspot.com/data_science_blogs/#h4352416">Backyard Data Science | Precision Guesswork While You Wait</a></li><li><a href="https://blog.feedspot.com/data_science_blogs/#h4342192">Becoming A Data Scientist</a></li><li><a href="https://blog.feedspot.com/data_science_blogs/#h4557877">Data Science at NIH</a></li><li><a href="https://blog.feedspot.com/data_science_blogs/#h4372120">District Data Labs</a></li><li><a href="https://blog.feedspot.com/data_science_blogs/#h4562329">NYU Center for Data Science</a></li></ol></li></ol><h2 id="Data-Science-Blogs"><a href="#Data-Science-Blogs" class="headerlink" title="Data Science Blogs"></a>Data Science Blogs</h2><p>View Latest Posts⋅Get Bloggers Contacts</p><h3 id="1-Data-Science-Central"><a href="#1-Data-Science-Central" class="headerlink" title="1. Data Science Central"></a>1. <a href="https://www.feedspot.com/infiniterss.php?_src=feed_title&amp;followfeedid=972655&amp;q=site:http%3A%2F%2Ffeeds.feedburner.com%2FFeaturedBlogPosts-DataScienceCentral">Data Science Central</a></h3><p><img src="https://i1.feedspot.com/972655.jpg" alt="Data Science Central">Los Angeles, California, United States <strong>About Blog</strong> Data Science Central is the industry’s online resource for Big Data practitioners. From Analytics to Data Integration to Visualization, we provide a community experience that includes a robust editorial platform, social interaction, forum-based technical support, the latest in technology tools and trends and industry job opportunities. <strong>Frequency</strong> 2 posts / day <strong>Also in</strong> <a href="https://blog.feedspot.com/data_analytics_blogs/">Data Analytics &amp; Data Mining Blogs</a> <strong>Blog</strong> <a href="https://www.datasciencecentral.com/">datasciencecentral.com</a><a href="https://www.feedspot.com/infiniterss.php?_src=followbtn&amp;followfeedid=972655&amp;q=site:http%3A%2F%2Ffeeds.feedburner.com%2FFeaturedBlogPosts-DataScienceCentral">+ Follow</a><br>Twitter followers 179.9K ⋅ Social Engagement 23<strong>ⓘ</strong> ⋅ Domain Authority 70<strong>ⓘ</strong> ⋅ Alexa Rank 74.8K<strong>ⓘ</strong>View Latest Posts⋅Get Email Contact</p><p>Follow on Feedspot<strong>ⓘ</strong></p><h3 id="Get-Influential-Bloggers-Contacts"><a href="#Get-Influential-Bloggers-Contacts" class="headerlink" title="Get Influential Bloggers Contacts"></a>Get Influential Bloggers Contacts</h3><p>Doing blogger outreach and want to connect with new influencers in niche markets? Feedspot media database has over 100K Influential Bloggers in 1500 niche categories. Email us the type of bloggers you want to reach out for your marketing campaign.</p><p><a href="mailto:anuj@feedspot.com?subject=Feedspot Blogger Outreach">Email us</a></p><h3 id="2-KDnuggets"><a href="#2-KDnuggets" class="headerlink" title="2. KDnuggets"></a>2. <a href="https://www.feedspot.com/infiniterss.php?_src=feed_title&amp;followfeedid=3800693&amp;q=site:http%3A%2F%2Fwww.kdnuggets.com%2Ffeed">KDnuggets</a></h3><p><img src="https://i1.feedspot.com/3800693.jpg" alt="KDnuggets"><a href="https://blog.feedspot.com/brookline_ma_influencers/">Brookline</a>, <a href="https://blog.feedspot.com/massachusetts_us_influencers/">Massachusetts</a>, United States<strong>About Blog</strong> KDnuggets is a leading site on Business Analytics, Big Data, Data Mining, and Data Science. It is managed by Gregory Piatetsky-Shapiro, a leading expert in the field. <strong>Frequency</strong> 8 posts / day<strong>Also in</strong> <a href="https://blog.feedspot.com/**/">Brooklin Blogs</a> <strong>Blog</strong> <a href="https://www.kdnuggets.com/news/index.html">kdnuggets.com/news/index.html</a><a href="https://www.feedspot.com/infiniterss.php?_src=followbtn&amp;followfeedid=3800693&amp;q=site:http%3A%2F%2Fwww.kdnuggets.com%2Ffeed">+ Follow</a><br>Facebook fans 28.2K ⋅ Twitter followers 163K ⋅ Social Engagement 27<strong>ⓘ</strong> ⋅ Domain Authority 69<strong>ⓘ</strong> ⋅ Alexa Rank 21K<strong>ⓘ</strong>View Latest Posts⋅Get Email Contact</p><p>Follow on Feedspot<strong>ⓘ</strong></p><h3 id="3-Reddit-»-Data-Science"><a href="#3-Reddit-»-Data-Science" class="headerlink" title="3. Reddit » Data Science"></a>3. <a href="https://www.feedspot.com/infiniterss.php?_src=feed_title&amp;followfeedid=4558463&amp;q=site:https%3A%2F%2Fwww.reddit.com%2Fr%2Fdatascience%2F.rss">Reddit » Data Science</a></h3><p><img src="https://i1.feedspot.com/200/4558463.jpg?t=1610975905" alt="Reddit » Data Science ">San Francisco, California, United States<strong>About Blog</strong> A place to discuss data, data science, becoming a data scientist, data munging, and more! <strong>Frequency</strong> 19 posts / day <strong>Since</strong> Aug 2011 <strong>Also in</strong> <a href="https://blog.feedspot.com/data_science_forums/">Data Science Forums</a> <strong>Blog</strong> <a href="https://www.reddit.com/r/datascience/">reddit.com/r/datascience</a><a href="https://www.feedspot.com/infiniterss.php?_src=followbtn&amp;followfeedid=4558463&amp;q=site:https%3A%2F%2Fwww.reddit.com%2Fr%2Fdatascience%2F.rss">+ Follow</a><br>Facebook fans 1.5M ⋅ Twitter followers 673.9K ⋅ Social Engagement 12<strong>ⓘ</strong> ⋅ Domain Authority 91<strong>ⓘ</strong> ⋅ Alexa Rank 18<strong>ⓘ</strong>View Latest Posts⋅Get Email Contact</p><p>Follow on Feedspot<strong>ⓘ</strong></p><h3 id="4-Analytics-Vidhya"><a href="#4-Analytics-Vidhya" class="headerlink" title="4. Analytics Vidhya"></a>4. <a href="https://www.feedspot.com/infiniterss.php?_src=feed_title&amp;followfeedid=4575696&amp;q=site:https%3A%2F%2Fwww.analyticsvidhya.com%2Ffeed%2F">Analytics Vidhya</a></h3><p><img src="https://i1.feedspot.com/4575696.jpg?t=1574839212" alt="Analytics Vidhya"><a href="https://blog.feedspot.com/gurgaon_hr_influencers/">Gurgaon</a>, <a href="https://blog.feedspot.com/haryana_in_influencers/">Haryana</a>, <a href="https://blog.feedspot.com/indian_blogs/">India</a><strong>About Blog</strong> Analytics Vidhya is a passionate community to learn every aspect of Analytics from web analytics to big data, advanced predictive modeling techniques and application of analytics in business. Follow our blog that focuses on machine learning, artificial intelligence, business analytics, data science, big data, data visualization tools, and techniques. <strong>Frequency</strong> 1 post / day <strong>Since</strong> Apr 2013 <strong>Also in</strong> <a href="https://blog.feedspot.com/analytics_blogs/">Analytics Blogs</a> <strong>Blog</strong> <a href="https://www.analyticsvidhya.com/blog/">analyticsvidhya.com/blog</a><a href="https://www.feedspot.com/infiniterss.php?_src=followbtn&amp;followfeedid=4575696&amp;q=site:https%3A%2F%2Fwww.analyticsvidhya.com%2Ffeed%2F">+ Follow</a><br>Facebook fans 58.5K ⋅ Twitter followers 23.3K ⋅ Social Engagement 21<strong>ⓘ</strong> ⋅ Domain Authority 60<strong>ⓘ</strong> ⋅ Alexa Rank 9.1K<strong>ⓘ</strong>View Latest Posts⋅Get Email Contact</p><p>Follow on Feedspot<strong>ⓘ</strong></p><h3 id="5-DataCamp-Blog"><a href="#5-DataCamp-Blog" class="headerlink" title="5. DataCamp Blog"></a>5. <a href="https://www.feedspot.com/infiniterss.php?_src=feed_title&amp;followfeedid=4557867&amp;q=site:https%3A%2F%2Fwww.datacamp.com%2Fcommunity%2Fblog%2Ffeed.rss">DataCamp Blog</a></h3><p><img src="https://i1.feedspot.com/4557867.jpeg" alt="DataCamp Blog">New York, United States<strong>About Blog</strong> Free data science articles, infographics, and tutorials. Learn how to become a Data Scientist from the comfort of your browser with DataCamp’s data science blog! See why over 460,000 Data Scientists love DataCamp! <strong>Frequency</strong> 2 posts / week <strong>Blog</strong> <a href="https://www.datacamp.com/community/blog">datacamp.com/community/blog</a><a href="https://www.feedspot.com/infiniterss.php?_src=followbtn&amp;followfeedid=4557867&amp;q=site:https%3A%2F%2Fwww.datacamp.com%2Fcommunity%2Fblog%2Ffeed.rss">+ Follow</a><br>Facebook fans 934K ⋅ Twitter followers 45.8K ⋅ Social Engagement 15<strong>ⓘ</strong> ⋅ Domain Authority 61<strong>ⓘ</strong> ⋅ Alexa Rank 3.5K<strong>ⓘ</strong>View Latest Posts⋅Get Email Contact</p><p>Follow on Feedspot<strong>ⓘ</strong></p><h3 id="6-Data-Science-101"><a href="#6-Data-Science-101" class="headerlink" title="6. Data Science 101"></a>6. <a href="https://www.feedspot.com/infiniterss.php?_src=feed_title&amp;followfeedid=4163854&amp;q=site:https%3A%2F%2F101.datascience.community%2Ffeed%2F">Data Science 101</a></h3><p><img src="https://i1.feedspot.com/4163854.jpg?t=1602687115" alt="Data Science 101">South Dakota, United States<strong>About Blog</strong> Learning To Be A Data Scientist <strong>Frequency</strong> 1 post / day <strong>Blog</strong> <a href="https://101.datascience.community/">101.datascience.community</a><a href="https://www.feedspot.com/infiniterss.php?_src=followbtn&amp;followfeedid=4163854&amp;q=site:https%3A%2F%2F101.datascience.community%2Ffeed%2F">+ Follow</a><br>Facebook fans 23.7K ⋅ Twitter followers 2.5K ⋅ Instagram Followers 221 ⋅ Social Engagement 1<strong>ⓘ</strong> ⋅ Domain Authority 45<strong>ⓘ</strong> ⋅ Alexa Rank 954.9K<strong>ⓘ</strong>View Latest Posts⋅Get Email Contact</p><p>Follow on Feedspot<strong>ⓘ</strong></p><h3 id="7-Kaggle-Data-Science-News-No-Free-Hunch"><a href="#7-Kaggle-Data-Science-News-No-Free-Hunch" class="headerlink" title="7. Kaggle | Data Science News No Free Hunch"></a>7. <a href="https://www.feedspot.com/infiniterss.php?_src=feed_title&amp;followfeedid=4562803&amp;q=site:https%3A%2F%2Fmedium.com%2Ffeed%2Fkaggle-blog">Kaggle | Data Science News No Free Hunch</a></h3><p><img src="https://i1.feedspot.com/4562803.jpg?t=1536236771" alt="Kaggle | Data Science News No Free Hunch">San Francisco, California, United States<strong>About Blog</strong> Kaggle is a platform for data-related competitions. The platform allows companies, researchers, government and other organizations to post their modeling problems and have data professionals and researchers compete to produce the best solutions. <strong>Frequency</strong> 28 posts / year <strong>Blog</strong> <a href="https://medium.com/kaggle-blog">medium.com/kaggle-blog</a><a href="https://www.feedspot.com/infiniterss.php?_src=followbtn&amp;followfeedid=4562803&amp;q=site:https%3A%2F%2Fmedium.com%2Ffeed%2Fkaggle-blog">+ Follow</a><br>Facebook fans 59.7K ⋅ Twitter followers 202.2K ⋅ Domain Authority 95 ⋅ Alexa Rank 101View Latest Posts⋅Get Email Contact</p><p>Follow on Feedspot</p><h3 id="8-Data-Double-Confirm"><a href="#8-Data-Double-Confirm" class="headerlink" title="8. Data Double Confirm"></a>8. <a href="https://www.feedspot.com/infiniterss.php?_src=feed_title&amp;followfeedid=5197562&amp;q=site:https%3A%2F%2Fprojectosyo.wixsite.com%2Fdatadoubleconfirm%2Ffeed.xml">Data Double Confirm</a></h3><p><img src="https://i1.feedspot.com/200/5197562.jpg?t=1600422531" alt="Data Double Confirm"><strong>About Blog</strong> Hui Xiang Chua graduated with a B.Sc.(Hons) in Statistics and M.Sc. in Business Analytics from National University of Singapore in 2012 and 2016 respectively, and was an instructor with General Assembly. She is a Data Science for Social Good fellow and has over six years of experience solving problems using data in the public service as a research analyst. DATA DOUBLE CONFIRM documents her learning journey and doubles up as a starter kit for those interested to learn more about data science. <strong>Frequency</strong> 3 posts / quarter <strong>Since</strong> Nov 2017 <strong>Blog</strong> <a href="https://projectosyo.wixsite.com/datadoubleconfirm">projectosyo.wixsite.com/data..</a><a href="https://www.feedspot.com/infiniterss.php?_src=followbtn&amp;followfeedid=5197562&amp;q=site:https%3A%2F%2Fprojectosyo.wixsite.com%2Fdatadoubleconfirm%2Ffeed.xml">+ Follow</a><br>Domain Authority 16 ⋅ Alexa Rank 364View Latest Posts⋅Get Email Contact</p><p>Follow on Feedspot</p><h3 id="9-Datascience-Berkeley-Online-Learning-Blog"><a href="#9-Datascience-Berkeley-Online-Learning-Blog" class="headerlink" title="9. Datascience@Berkeley | Online Learning Blog"></a>9. <a href="https://www.feedspot.com/infiniterss.php?_src=feed_title&amp;followfeedid=4557869&amp;q=site:https%3A%2F%2Fdatascience.berkeley.edu%2Fblog%2Frecent.atom%2F%3Fformat%3Dxml">Datascience@Berkeley | Online Learning Blog</a></h3><p><img src="https://i1.feedspot.com/4557869.jpeg" alt="Datascience@Berkeley | Online Learning Blog"><a href="https://blog.feedspot.com/berkeley_ca_influencers/">Berkeley</a>, California, United States<strong>About Blog</strong> Learn more about DataScience@Berkeley, the first and only professional Master of Information and Data Science (MIDS) delivered fully online from the University of California-Berkeley. <strong>Frequency</strong> 1 post / year <strong>Blog</strong> <a href="https://datascience.berkeley.edu/blog/">datascience.berkeley.edu/blog</a><a href="https://www.feedspot.com/infiniterss.php?_src=followbtn&amp;followfeedid=4557869&amp;q=site:https%3A%2F%2Fdatascience.berkeley.edu%2Fblog%2Frecent.atom%2F%3Fformat%3Dxml">+ Follow</a><br>Facebook fans 19K ⋅ Twitter followers 15.2K ⋅ Domain Authority 93 ⋅ Alexa Rank 1.8KView Latest Posts⋅Get Email Contact</p><p>Follow on Feedspot</p><h3 id="10-Dataquest-Blog"><a href="#10-Dataquest-Blog" class="headerlink" title="10. Dataquest Blog"></a>10. <a href="https://www.feedspot.com/infiniterss.php?_src=feed_title&amp;followfeedid=4342187&amp;q=site:https%3A%2F%2Fwww.dataquest.io%2Fblog%2Ffeed%2F">Dataquest Blog</a></h3><p><img src="https://i1.feedspot.com/4342187.jpg" alt="Dataquest Blog">Boston, Massachusetts, United States<strong>About Blog</strong> Writings about data science, from the makers of Dataquest.io. Read articles about Python and R, learning data science, interviews with data scientists, and more. <strong>Frequency</strong> 2 posts / week <strong>Blog</strong> <a href="https://www.dataquest.io/blog/">dataquest.io/blog</a><a href="https://www.feedspot.com/infiniterss.php?_src=followbtn&amp;followfeedid=4342187&amp;q=site:https%3A%2F%2Fwww.dataquest.io%2Fblog%2Ffeed%2F">+ Follow</a><br>Facebook fans 66K ⋅ Twitter followers 11.6K ⋅ Social Engagement 231 ⋅ Domain Authority 55 ⋅ Alexa Rank 9.8KView Latest Posts⋅Get Email Contact</p><p>Follow on Feedspot</p><h3 id="11-UC-San-Diego’s-Data-Science-Blog-Center-for-Computational-Biology-amp-Bioinformatics"><a href="#11-UC-San-Diego’s-Data-Science-Blog-Center-for-Computational-Biology-amp-Bioinformatics" class="headerlink" title="11. UC San Diego’s Data Science Blog Center for Computational Biology &amp; Bioinformatics"></a>11. <a href="https://www.feedspot.com/infiniterss.php?_src=feed_title&amp;followfeedid=4558215&amp;q=site:http%3A%2F%2Fcompbio.ucsd.edu%2Foutreach%2Fdata-science-blog%2Ffeed%2F">UC San Diego’s Data Science Blog Center for Computational Biology &amp; Bioinformatics</a></h3><p><img src="https://i1.feedspot.com/4558215.jpeg" alt="UC San Diego's Data Science Blog Center for Computational Biology &amp; Bioinformatics">San Diego, California, United States<strong>About Blog</strong> A data science and bioinformatics blog written and maintained by UCSD’s Center for Computational Biology &amp; Bioinformatics <strong>Blog</strong> <a href="http://compbio.ucsd.edu/outreach/data-science-blog/">compbio.ucsd.edu/outreach/da..</a><a href="https://www.feedspot.com/infiniterss.php?_src=followbtn&amp;followfeedid=4558215&amp;q=site:http%3A%2F%2Fcompbio.ucsd.edu%2Foutreach%2Fdata-science-blog%2Ffeed%2F">+ Follow</a><br>Twitter followers 714 ⋅ Domain Authority 90 ⋅ Alexa Rank 3.8KView Latest Posts⋅Get Email Contact</p><p>Follow on Feedspot</p><h3 id="12-Codementor-»-Data-Science-Tutorials"><a href="#12-Codementor-»-Data-Science-Tutorials" class="headerlink" title="12. Codementor » Data Science Tutorials"></a>12. <a href="https://www.feedspot.com/infiniterss.php?_src=feed_title&amp;followfeedid=4342188&amp;q=site:https%3A%2F%2Fwww.codementor.io%2Fcommunity%2Ftopic%2Fdata-science%2Ffeed">Codementor » Data Science Tutorials</a></h3><p><img src="https://i1.feedspot.com/4342188.jpg" alt="Codementor » Data Science Tutorials"><strong>About Blog</strong> Codementor is the largest community for developer mentorship and an on-demand marketplace for software developers. Get instant coding help, build projects faster, and read programming tutorials from our community of developers. Follow this blog to get the latest trends in Data Science, tutorials, posts, and insights from top Data Science experts and developers. <strong>Frequency</strong> 2 posts / week <strong>Blog</strong> <a href="https://www.codementor.io/community/topic/data-science">codementor.io/community/topi..</a><a href="https://www.feedspot.com/infiniterss.php?_src=followbtn&amp;followfeedid=4342188&amp;q=site:https%3A%2F%2Fwww.codementor.io%2Fcommunity%2Ftopic%2Fdata-science%2Ffeed">+ Follow</a><br>Facebook fans 14.4K ⋅ Twitter followers 21.8K ⋅ Domain Authority 60 ⋅ Alexa Rank 8KView Latest Posts⋅Get Email Contact</p><p>Follow on Feedspot</p><h3 id="13-Analytics-Insight"><a href="#13-Analytics-Insight" class="headerlink" title="13. Analytics Insight"></a>13. <a href="https://www.feedspot.com/infiniterss.php?_src=feed_title&amp;followfeedid=4729978&amp;q=site:http%3A%2F%2Ffeeds.feedburner.com%2Fanalyticsinsight%2FijEZ">Analytics Insight</a></h3><p><img src="https://i1.feedspot.com/4729978.jpg?t=1504078958" alt="Analytics Insight"><a href="https://blog.feedspot.com/hyderabad_blogs/">Hyderabad</a>, Telangana, India<strong>About Blog</strong> The blog provides the latest insights on big data, data science and business analytics. <strong>Frequency</strong> 9 posts / day <strong>Blog</strong> <a href="https://www.analyticsinsight.net/">analyticsinsight.net</a><a href="https://www.feedspot.com/infiniterss.php?_src=followbtn&amp;followfeedid=4729978&amp;q=site:http%3A%2F%2Ffeeds.feedburner.com%2Fanalyticsinsight%2FijEZ">+ Follow</a><br>Facebook fans 19.3K ⋅ Twitter followers 5.5K ⋅ Social Engagement 48 ⋅ Domain Authority 48 ⋅ Alexa Rank 15.6KView Latest Posts⋅Get Email Contact</p><p>Follow on Feedspot</p><h3 id="14-Data-Science-made-in-Switzerland"><a href="#14-Data-Science-made-in-Switzerland" class="headerlink" title="14. Data Science made in Switzerland"></a>14. <a href="https://www.feedspot.com/infiniterss.php?_src=feed_title&amp;followfeedid=4558162&amp;q=site:https%3A%2F%2Fblog.zhaw.ch%2Fdatascience%2Ffeed%2F">Data Science made in Switzerland</a></h3><p><img src="https://i1.feedspot.com/4558162.jpeg?t=1606194678" alt="Data Science made in Switzerland">Winterthur, Zurich, Switzerland<strong>About Blog</strong> The ZHAW Data Science Laboratory is the place to transform deep data science know how into innovative research projects and vibrant teaching in Switzerland. <strong>Frequency</strong> 5 posts / year <strong>Blog</strong> <a href="https://blog.zhaw.ch/datascience/">blog.zhaw.ch/datascience</a><a href="https://www.feedspot.com/infiniterss.php?_src=followbtn&amp;followfeedid=4558162&amp;q=site:https%3A%2F%2Fblog.zhaw.ch%2Fdatascience%2Ffeed%2F">+ Follow</a><br>Facebook fans 9.5K ⋅ Twitter followers 460 ⋅ Social Engagement 1 ⋅ Domain Authority 64 ⋅ Alexa Rank 44KView Latest Posts⋅Get Email Contact</p><p>Follow on Feedspot</p><h3 id="15-DataRobot-Machine-Learning-Software"><a href="#15-DataRobot-Machine-Learning-Software" class="headerlink" title="15. DataRobot | Machine Learning Software"></a>15. <a href="https://www.feedspot.com/infiniterss.php?_src=feed_title&amp;followfeedid=4563135&amp;q=site:https%3A%2F%2Fwww.datarobot.com%2Fblog%2Ffeed">DataRobot | Machine Learning Software</a></h3><p><img src="https://i1.feedspot.com/4563135.jpg?t=1573633871" alt="DataRobot | Machine Learning Software">Boston, Massachusetts, United States<strong>About Blog</strong> The most advanced machine learning platform built by the world’s best data scientists. Mission is to help data scientists of all levels build and deploy better predictive models, faster. <strong>Frequency</strong> 30 posts / year<strong>Also in</strong> <a href="https://blog.feedspot.com/ai_blogs/">Artificial Intelligence Blogs</a> <strong>Blog</strong> <a href="https://blog.datarobot.com/">blog.datarobot.com</a><a href="https://www.feedspot.com/infiniterss.php?_src=followbtn&amp;followfeedid=4563135&amp;q=site:https%3A%2F%2Fwww.datarobot.com%2Fblog%2Ffeed">+ Follow</a><br>Facebook fans 4.2K ⋅ Twitter followers 17.3K ⋅ Instagram Followers 1.1K ⋅ Social Engagement 6 ⋅ Domain Authority 59 ⋅ Alexa Rank 49.5KView Latest Posts⋅Get Email Contact</p><p>Follow on Feedspot</p><h3 id="16-Command-Line-Tips"><a href="#16-Command-Line-Tips" class="headerlink" title="16. Command Line Tips"></a>16. <a href="https://www.feedspot.com/infiniterss.php?_src=feed_title&amp;followfeedid=596438&amp;q=site:https%3A%2F%2Fcmdlinetips.com%2Ffeed%2F">Command Line Tips</a></h3><p><img src="https://i1.feedspot.com/596438.jpg" alt="Command Line Tips"><strong>About Blog</strong> Python Tips, R Tips, Linux Tips, Command Line Tips, Python for Data Science, R for Data Science, Data Science <strong>Frequency</strong> 1 post / month <strong>Blog</strong> <a href="http://cmdlinetips.com/">cmdlinetips.com</a><a href="https://www.feedspot.com/infiniterss.php?_src=followbtn&amp;followfeedid=596438&amp;q=site:https%3A%2F%2Fcmdlinetips.com%2Ffeed%2F">+ Follow</a><br>Twitter followers 330 ⋅ Domain Authority 23 ⋅ Alexa Rank 76.7KView Latest Posts⋅Get Email Contact</p><p>Follow on Feedspot</p><h3 id="17-365-Data-Science-»-Q-amp-A-Hub"><a href="#17-365-Data-Science-»-Q-amp-A-Hub" class="headerlink" title="17. 365 Data Science » Q&amp;A Hub"></a>17. <a href="https://www.feedspot.com/infiniterss.php?_src=feed_title&amp;followfeedid=5124478&amp;q=site:https%3A%2F%2F365datascience.com%2Ffeed">365 Data Science » Q&amp;A Hub</a></h3><p><img src="https://i1.feedspot.com/5124478.jpg?t=1605962660" alt="365 Data Science » Q&amp;A Hub">Mumbai, Maharashtra, India<strong>About Blog</strong> 365datascience.com is an educational career website, designed for aspiring marketing analysts, BI analysts, data analysts and data scientists. The 365 DataScience blog is devoted to explaining the data science world. You will find data science interviews, tutorials, news and much more. <strong>Frequency</strong> 3 posts / month <strong>Blog</strong> <a href="https://365datascience.com/qa-hub/">365datascience.com/qa-hub</a><a href="https://www.feedspot.com/infiniterss.php?_src=followbtn&amp;followfeedid=5124478&amp;q=site:https%3A%2F%2F365datascience.com%2Ffeed">+ Follow</a><br>Facebook fans 1.7K ⋅ Twitter followers 2.7K ⋅ Social Engagement 6 ⋅ Domain Authority 32 ⋅ Alexa Rank 84.1KView Latest Posts⋅Get Email Contact</p><p>Follow on Feedspot</p><h3 id="18-Chris-Albon-Data-Science-Machine-Learning-and-Artificial-Intelligence"><a href="#18-Chris-Albon-Data-Science-Machine-Learning-and-Artificial-Intelligence" class="headerlink" title="18. Chris Albon - Data Science, Machine Learning, and Artificial Intelligence"></a>18. <a href="https://www.feedspot.com/infiniterss.php?_src=feed_title&amp;followfeedid=4562335&amp;q=site:https%3A%2F%2Fchrisalbon.com%2Ffeeds%2Fall.rss.xml">Chris Albon - Data Science, Machine Learning, and Artificial Intelligence</a></h3><p><img src="https://i1.feedspot.com/4562335.jpg?t=1536235468" alt="Chris Albon - Data Science, Machine Learning, and Artificial Intelligence">United States<strong>About Blog</strong> Blog about Data Science for Political and Social Phenomena. Chris is a data scientist with a Ph.D. in quantitative political science and a decade of experience working in statistical learning, artificial intelligence, and software engineering. <strong>Blog</strong> <a href="https://chrisalbon.com/">chrisalbon.com</a><a href="https://www.feedspot.com/infiniterss.php?_src=followbtn&amp;followfeedid=4562335&amp;q=site:https%3A%2F%2Fchrisalbon.com%2Ffeeds%2Fall.rss.xml">+ Follow</a><br>Twitter followers 53.7K ⋅ Domain Authority 41 ⋅ Alexa Rank 108.4KView Latest Posts⋅Get Email Contact</p><p>Follow on Feedspot</p><h3 id="19-Data-Science-Blog-AI-ML-big-data-analytics"><a href="#19-Data-Science-Blog-AI-ML-big-data-analytics" class="headerlink" title="19. Data Science Blog | AI, ML, big data analytics"></a>19. <a href="https://www.feedspot.com/infiniterss.php?_src=feed_title&amp;followfeedid=5065808&amp;q=site:https%3A%2F%2Fblog.datasciencedojo.com%2Frss%2F">Data Science Blog | AI, ML, big data analytics</a></h3><p><img src="https://i1.feedspot.com/5065808.jpeg?t=1571814232" alt="Data Science Blog | AI, ML, big data analytics">Seattle, Washington, United States<strong>About Blog</strong> Learn data science, data engineering, big data analytics, AI, and machine learning through featured tutorials and articles. <strong>Frequency</strong> 3 posts / quarter <strong>Blog</strong> <a href="https://blog.datasciencedojo.com/">blog.datasciencedojo.com</a><a href="https://www.feedspot.com/infiniterss.php?_src=followbtn&amp;followfeedid=5065808&amp;q=site:https%3A%2F%2Fblog.datasciencedojo.com%2Frss%2F">+ Follow</a><br>Twitter followers 7.3K ⋅ Social Engagement 33 ⋅ Domain Authority 42 ⋅ Alexa Rank 237.6KView Latest Posts⋅Get Email Contact</p><p>Follow on Feedspot</p><h3 id="20-Domino-Data-Science-Blog"><a href="#20-Domino-Data-Science-Blog" class="headerlink" title="20. Domino Data Science Blog"></a>20. <a href="https://www.feedspot.com/infiniterss.php?_src=feed_title&amp;followfeedid=4557870&amp;q=site:https%3A%2F%2Fblog.dominodatalab.com%2Ffeed%2F">Domino Data Science Blog</a></h3><p><img src="https://i1.feedspot.com/4557870.jpg" alt="Domino Data Science Blog">San Francisco, California, United States<strong>About Blog</strong> The Domino Data Science Blog features news and in-depth articles on data science best practices, trends, and tools. <strong>Frequency</strong> 1 post / week <strong>Blog</strong> <a href="https://blog.dominodatalab.com/">blog.dominodatalab.com</a><a href="https://www.feedspot.com/infiniterss.php?_src=followbtn&amp;followfeedid=4557870&amp;q=site:https%3A%2F%2Fblog.dominodatalab.com%2Ffeed%2F">+ Follow</a><br>Facebook fans 645 ⋅ Twitter followers 8.5K ⋅ Social Engagement 20 ⋅ Domain Authority 51 ⋅ Alexa Rank 274KView Latest Posts⋅Get Email Contact</p><p>Follow on Feedspot</p><h3 id="21-The-Data-Incubator"><a href="#21-The-Data-Incubator" class="headerlink" title="21. The Data Incubator"></a>21. <a href="https://www.feedspot.com/infiniterss.php?_src=feed_title&amp;followfeedid=4372080&amp;q=site:https%3A%2F%2Fblog.thedataincubator.com%2Ffeed%2F">The Data Incubator</a></h3><p><img src="https://i1.feedspot.com/4372080.jpg?t=1536237198" alt="The Data Incubator">New York, United States<strong>About Blog</strong> The Data Incubator is an intensive 8 week fellowship that prepares the best scientists and engineers with advanced degrees to work as data scientists and quants. <strong>Frequency</strong> 4 posts / year <strong>Blog</strong> <a href="https://blog.thedataincubator.com/">blog.thedataincubator.com</a><a href="https://www.feedspot.com/infiniterss.php?_src=followbtn&amp;followfeedid=4372080&amp;q=site:https%3A%2F%2Fblog.thedataincubator.com%2Ffeed%2F">+ Follow</a><br>Facebook fans 4.4K ⋅ Twitter followers 9.5K ⋅ Social Engagement 1 ⋅ Domain Authority 49 ⋅ Alexa Rank 282.9KView Latest Posts⋅Get Email Contact</p><p>Follow on Feedspot</p><h3 id="22-Revolutions"><a href="#22-Revolutions" class="headerlink" title="22. Revolutions"></a>22. <a href="https://www.feedspot.com/infiniterss.php?_src=feed_title&amp;followfeedid=57631&amp;q=site:https%3A%2F%2Fblog.revolutionanalytics.com%2Fatom.xml">Revolutions</a></h3><p><img src="https://i1.feedspot.com/57631.jpg" alt="Revolutions">Chicago, Illinois, United States<strong>About Blog</strong> Revolutions is a blog dedicated to news and information of interest to members of the R community. Follow to keep up with daily news about using open source R for data analysis, predictive modeling, data science, and visualization. <strong>Frequency</strong> 1 post / week <strong>Since</strong> Jul 2017 <strong>Also in</strong> <a href="https://blog.feedspot.com/statistics_blogs/">Statistics Blogs</a>, <a href="https://blog.feedspot.com/data_visualization_blogs/">Data Visualization Blogs</a>, <a href="https://blog.feedspot.com/r_programming_blogs/">R Programming Blogs</a> <strong>Blog</strong> <a href="https://blog.revolutionanalytics.com/">blog.revolutionanalytics.com</a><a href="https://www.feedspot.com/infiniterss.php?_src=followbtn&amp;followfeedid=57631&amp;q=site:https%3A%2F%2Fblog.revolutionanalytics.com%2Fatom.xml">+ Follow</a><br>Twitter followers 31.5K ⋅ Social Engagement 231 ⋅ Domain Authority 59 ⋅ Alexa Rank 300KView Latest Posts⋅Get Email Contact</p><p>Follow on Feedspot</p><h3 id="23-Stats-and-R"><a href="#23-Stats-and-R" class="headerlink" title="23. Stats and R"></a>23. <a href="https://www.feedspot.com/infiniterss.php?_src=feed_title&amp;followfeedid=5134987&amp;q=site:https%3A%2F%2Fwww.statsandr.com%2Findex.xml">Stats and R</a></h3><p><img src="https://i1.feedspot.com/5134987.jpg?t=1588405000" alt="Stats and R">Brussels, Belgium<strong>About Blog</strong> A blog on statistics and R aiming at helping academics and professionals working with data to grasp important concepts in statistics and to apply them in R. <strong>Frequency</strong> 1 post / day <strong>Blog</strong> <a href="https://www.statsandr.com/">statsandr.com</a><a href="https://www.feedspot.com/infiniterss.php?_src=followbtn&amp;followfeedid=5134987&amp;q=site:https%3A%2F%2Fwww.statsandr.com%2Findex.xml">+ Follow</a><br>Twitter followers 400 ⋅ Social Engagement 107 ⋅ Domain Authority 16 ⋅ Alexa Rank 313KView Latest Posts⋅Get Email Contact</p><p>Follow on Feedspot</p><h3 id="24-InnoArchiTech"><a href="#24-InnoArchiTech" class="headerlink" title="24. InnoArchiTech"></a>24. <a href="https://www.feedspot.com/infiniterss.php?_src=feed_title&amp;followfeedid=4785825&amp;q=site:https%3A%2F%2Fwww.innoarchitech.com%2Fblog%3Fformat%3Drss">InnoArchiTech</a></h3><p><img src="https://i1.feedspot.com/4785825.jpg" alt="InnoArchiTech ">Chicago, Illinois, United States<strong>About Blog</strong> InnoArchiTech was founded by Alex Castrounis. We provide consulting, education, writing, and speaking services focused on leveraging advanced analytics to transform data into value. Areas of expertise include artificial intelligence, machine learning, data science, and IoT. <strong>Frequency</strong> 2 posts / month <strong>Blog</strong> <a href="https://www.innoarchitech.com/blog">innoarchitech.com/blog</a><a href="https://www.feedspot.com/infiniterss.php?_src=followbtn&amp;followfeedid=4785825&amp;q=site:https%3A%2F%2Fwww.innoarchitech.com%2Fblog%3Fformat%3Drss">+ Follow</a><br>Twitter followers 23 ⋅ Domain Authority 40 ⋅ Alexa Rank 323.6KView Latest Posts⋅Get Email Contact</p><p>Follow on Feedspot</p><h3 id="25-Insight-Data"><a href="#25-Insight-Data" class="headerlink" title="25. Insight Data"></a>25. <a href="https://www.feedspot.com/infiniterss.php?_src=feed_title&amp;followfeedid=4557881&amp;q=site:https%3A%2F%2Fblog.insightdatascience.com%2Ffeed">Insight Data</a></h3><p><img src="https://i1.feedspot.com/4557881.jpeg" alt="Insight Data">Palo Alto, California, United States<strong>About Blog</strong> Insight Fellows Program —Your bridge to careers in Data Science and Data Engineering. - Medium <strong>Frequency</strong> 7 posts / quarter <strong>Blog</strong> <a href="https://blog.insightdatascience.com/">blog.insightdatascience.com</a><a href="https://www.feedspot.com/infiniterss.php?_src=followbtn&amp;followfeedid=4557881&amp;q=site:https%3A%2F%2Fblog.insightdatascience.com%2Ffeed">+ Follow</a><br>Facebook fans 5.1K ⋅ Social Engagement 4 ⋅ Domain Authority 52 ⋅ Alexa Rank 400.8KView Latest Posts⋅Get Email Contact</p><p>Follow on Feedspot</p><h3 id="26-Little-Miss-Data"><a href="#26-Little-Miss-Data" class="headerlink" title="26. Little Miss Data"></a>26. <a href="https://www.feedspot.com/infiniterss.php?_src=feed_title&amp;followfeedid=4954371&amp;q=site:https%3A%2F%2Fwww.littlemissdata.com%2Fblog%3Fformat%3DRSS">Little Miss Data</a></h3><p><img src="https://i1.feedspot.com/4954371.jpeg?t=1538561525" alt="Little Miss Data">Texas, United States<strong>About Blog</strong> A website dedicated to general musings about all things data and analytics. <strong>Frequency</strong> 7 posts / year <strong>Blog</strong> <a href="https://www.littlemissdata.com/">littlemissdata.com</a><a href="https://www.feedspot.com/infiniterss.php?_src=followbtn&amp;followfeedid=4954371&amp;q=site:https%3A%2F%2Fwww.littlemissdata.com%2Fblog%3Fformat%3DRSS">+ Follow</a><br>Twitter followers 5.1K ⋅ Instagram Followers 592 ⋅ Social Engagement 9 ⋅ Domain Authority 27 ⋅ Alexa Rank 442.3KView Latest Posts⋅Get Email Contact</p><p>Follow on Feedspot</p><h3 id="27-Data-Science-Association-blog"><a href="#27-Data-Science-Association-blog" class="headerlink" title="27. Data Science Association blog"></a>27. <a href="https://www.feedspot.com/infiniterss.php?_src=feed_title&amp;followfeedid=4558170&amp;q=site:http%3A%2F%2Fwww.datascienceassn.org%2Fblog%2Ffeed">Data Science Association blog</a></h3><p><img src="https://i1.feedspot.com/4558170.jpeg?t=1536237294" alt="Data Science Association blog">Denver, Colorado, United States<strong>About Blog</strong> The Data Science Association is a non-profit professional group that offers education, professional certification, a ‘Data Science Code of Professional Conduct’ and conferences / meetups to discuss data science (e.g. predictive / prescriptive analytics, algorithm design and execution, applied machine learning, statistical modeling, and data visualization). <strong>Frequency</strong> 4 posts / month <strong>Blog</strong> <a href="http://www.datascienceassn.org/blog">datascienceassn.org/blog</a><a href="https://www.feedspot.com/infiniterss.php?_src=followbtn&amp;followfeedid=4558170&amp;q=site:http%3A%2F%2Fwww.datascienceassn.org%2Fblog%2Ffeed">+ Follow</a><br>Twitter followers 334 ⋅ Domain Authority 49 ⋅ Alexa Rank 708.5KView Latest Posts⋅Get Email Contact</p><p>Follow on Feedspot</p><h3 id="28-Appsilon-Blog-End­-to­-End-Data-Science-Solutions"><a href="#28-Appsilon-Blog-End­-to­-End-Data-Science-Solutions" class="headerlink" title="28. Appsilon Blog | End­ to­ End Data Science Solutions"></a>28. <a href="https://www.feedspot.com/infiniterss.php?_src=feed_title&amp;followfeedid=4726425&amp;q=site:https%3A%2F%2Fappsilon.com%2Ffeed%2F">Appsilon Blog | End­ to­ End Data Science Solutions</a></h3><p><img src="https://i1.feedspot.com/4726425.jpg?t=1608623633" alt="Appsilon Blog | End­ to­ End Data Science Solutions">Warsaw, Mazowieckie, Poland<strong>About Blog</strong> Appsilon is a team of world class engineers taking up the hardest challenges. To deliver novel insights and create data science solutions that increase growth and push companies to higher technological literacy. Checkout Shiny dashboard tutorials, data science and machine learning insights, open-source announcements, and developer community news. <strong>Frequency</strong> 1 post / week <strong>Blog</strong> <a href="https://appsilon.com/blog/">appsilon.com/blog</a><a href="https://www.feedspot.com/infiniterss.php?_src=followbtn&amp;followfeedid=4726425&amp;q=site:https%3A%2F%2Fappsilon.com%2Ffeed%2F">+ Follow</a><br>Twitter followers 970 ⋅ Social Engagement 4 ⋅ Domain Authority 37 ⋅ Alexa Rank 641.3KView Latest Posts⋅Get Email Contact</p><p>Follow on Feedspot</p><h3 id="29-Data-Science-Blog-English-only"><a href="#29-Data-Science-Blog-English-only" class="headerlink" title="29. Data Science Blog (English only)"></a>29. <a href="https://www.feedspot.com/infiniterss.php?_src=feed_title&amp;followfeedid=4558183&amp;q=site:https%3A%2F%2Fdata-science-blog.com%2Fen%2Ffeed%2F">Data Science Blog (English only)</a></h3><p><img src="https://i1.feedspot.com/4558183.jpg?t=1550226502" alt="Data Science Blog (English only)"><a href="https://blog.feedspot.com/berlin_blogs/">Berlin</a>, <a href="https://blog.feedspot.com/germany_blogs/">Germany</a><strong>About Blog</strong> Applied Data Science Blog <strong>Frequency</strong> 1 post / day <strong>Blog</strong> <a href="https://data-science-blog.com/en/">data-science-blog.com/en</a><a href="https://www.feedspot.com/infiniterss.php?_src=followbtn&amp;followfeedid=4558183&amp;q=site:https%3A%2F%2Fdata-science-blog.com%2Fen%2Ffeed%2F">+ Follow</a><br>Facebook fans 276 ⋅ Twitter followers 903 ⋅ Domain Authority 37 ⋅ Alexa Rank 626.9KView Latest Posts⋅Get Email Contact</p><p>Follow on Feedspot</p><h3 id="30-DataMites-Blog"><a href="#30-DataMites-Blog" class="headerlink" title="30. DataMites Blog"></a>30. <a href="https://www.feedspot.com/infiniterss.php?_src=feed_title&amp;followfeedid=5003657&amp;q=site:https%3A%2F%2Fdatamites.com%2Fblog%2Ffeed">DataMites Blog</a></h3><p><img src="https://i1.feedspot.com/5003657.jpg" alt="DataMites Blog"><a href="https://blog.feedspot.com/bangalore_blogs/">Bangalore</a>, <a href="https://blog.feedspot.com/karnataka_in_influencers/">Karnataka</a>, India<strong>About Blog</strong> Datamites is a leading training institute for all kind of the data science courses in Bangalore. <strong>Frequency</strong> 1 post / week <strong>Blog</strong> <a href="https://datamites.com/blog/">datamites.com/blog</a><a href="https://www.feedspot.com/infiniterss.php?_src=followbtn&amp;followfeedid=5003657&amp;q=site:https%3A%2F%2Fdatamites.com%2Fblog%2Ffeed">+ Follow</a><br>Facebook fans 32.7K ⋅ Twitter followers 103 ⋅ Social Engagement 1 ⋅ Domain Authority 17 ⋅ Alexa Rank 718.7KView Latest Posts⋅Get Email Contact</p><p>Follow on Feedspot</p><h3 id="31-Dataaspirant"><a href="#31-Dataaspirant" class="headerlink" title="31. Dataaspirant"></a>31. <a href="https://www.feedspot.com/infiniterss.php?_src=feed_title&amp;followfeedid=4558488&amp;q=site:https%3A%2F%2Fdataaspirant.com%2Ffeed%2F">Dataaspirant</a></h3><p><img src="https://i1.feedspot.com/4558488.jpg?t=1536237400" alt="Dataaspirant">India<strong>About Blog</strong> A Data Science Portal For Beginners <strong>Frequency</strong> 6 posts / month <strong>Blog</strong> <a href="https://dataaspirant.com/">dataaspirant.com</a><a href="https://www.feedspot.com/infiniterss.php?_src=followbtn&amp;followfeedid=4558488&amp;q=site:https%3A%2F%2Fdataaspirant.com%2Ffeed%2F">+ Follow</a><br>Facebook fans 3.4K ⋅ Twitter followers 493 ⋅ Social Engagement 44 ⋅ Domain Authority 41 ⋅ Alexa Rank 662.9KView Latest Posts⋅Get Email Contact</p><p>Follow on Feedspot</p><h3 id="32-Predictive-Hacks"><a href="#32-Predictive-Hacks" class="headerlink" title="32. Predictive Hacks"></a>32. <a href="https://www.feedspot.com/infiniterss.php?_src=feed_title&amp;followfeedid=5221768&amp;q=site:https%3A%2F%2Fpredictivehacks.com%2Ffeed%2F">Predictive Hacks</a></h3><p><img src="https://i1.feedspot.com/200/5221768.jpg?t=1606888459" alt="Predictive Hacks"><strong>About Blog</strong> We’re a team of Data Scientists, passionate about what we are doing and we love getting our hands dirty. The blog acts as a resource with insights, tutorials, and case studies. Our goal is to contribute to the Data Science community by helping people find valuable tips and answers in the data, effectively and quickly. <strong>Frequency</strong> 1 post / day <strong>Since</strong> Aug 2020 <strong>Blog</strong> <a href="https://predictivehacks.com/">predictivehacks.com</a><a href="https://www.feedspot.com/infiniterss.php?_src=followbtn&amp;followfeedid=5221768&amp;q=site:https%3A%2F%2Fpredictivehacks.com%2Ffeed%2F">+ Follow</a><br>Facebook fans 1.4K ⋅ Twitter followers 372 ⋅ Social Engagement 3 ⋅ Domain Authority 17 ⋅ Alexa Rank 616.8KView Latest Posts⋅Get Email Contact</p><p>Follow on Feedspot</p><h3 id="33-Data-Skeptic"><a href="#33-Data-Skeptic" class="headerlink" title="33. Data Skeptic"></a>33. <a href="https://www.feedspot.com/infiniterss.php?_src=feed_title&amp;followfeedid=4523799&amp;q=site:http%3A%2F%2Fdataskeptic.com%2Ffeed.rss">Data Skeptic</a></h3><p><img src="https://i1.feedspot.com/4523799.jpg?t=1550123555" alt="Data Skeptic">Los Angeles, California, United States<strong>About Blog</strong> The intersection of data science, artificial intelligence, machine learning, statistics, and scientific skepticism <strong>Frequency</strong> 1 post / week <strong>Blog</strong> <a href="http://dataskeptic.com/blog">dataskeptic.com/blog</a><a href="https://www.feedspot.com/infiniterss.php?_src=followbtn&amp;followfeedid=4523799&amp;q=site:http%3A%2F%2Fdataskeptic.com%2Ffeed.rss">+ Follow</a><br>Facebook fans 1.6K ⋅ Twitter followers 7.5K ⋅ Domain Authority 44 ⋅ Alexa Rank 897KView Latest Posts⋅Get Email Contact</p><p>Follow on Feedspot</p><h3 id="34-mlwhiz"><a href="#34-mlwhiz" class="headerlink" title="34. mlwhiz"></a>34. <a href="https://www.feedspot.com/infiniterss.php?_src=feed_title&amp;followfeedid=4623719&amp;q=site:https%3A%2F%2Fmlwhiz.com%2Fatom.xml%3Fformat%3Dxml">mlwhiz</a></h3><p><img src="https://i1.feedspot.com/4623719.jpeg?t=1550123562" alt="mlwhiz">Bangalore, Karnataka, India<strong>About Blog</strong> A Data Science Learning Resource to learn about AI, Deep Learning, NLP <strong>Frequency</strong> 30 posts / year <strong>Blog</strong> <a href="https://mlwhiz.com/">mlwhiz.com</a><a href="https://www.feedspot.com/infiniterss.php?_src=followbtn&amp;followfeedid=4623719&amp;q=site:https%3A%2F%2Fmlwhiz.com%2Fatom.xml%3Fformat%3Dxml">+ Follow</a><br>Twitter followers 1.9K ⋅ Domain Authority 33 ⋅ Alexa Rank 870.3KView Latest Posts⋅Get Email Contact</p><p>Follow on Feedspot</p><h3 id="35-b-telligent-Data-Science-Blog"><a href="#35-b-telligent-Data-Science-Blog" class="headerlink" title="35. b.telligent - Data Science Blog"></a>35. <a href="https://www.feedspot.com/infiniterss.php?_src=feed_title&amp;followfeedid=4558138&amp;q=site:https%3A%2F%2Fwww.btelligent.com%2Fen%2Fblogs%2Fdata-science-blog%2Frss.xml">b.telligent - Data Science Blog</a></h3><p><img src="https://i1.feedspot.com/4558138.jpg" alt="b.telligent - Data Science Blog">Munich, Bayern, Germany<strong>About Blog</strong> b.telligent is a consulting company specialized in establishing and improving business intelligence for enterprise segment clients with a large customer base. <strong>Blog</strong> <a href="https://www.btelligent.com/en/blogs/data-science-blog/">btelligent.com/en/blogs/data..</a><a href="https://www.feedspot.com/infiniterss.php?_src=followbtn&amp;followfeedid=4558138&amp;q=site:https%3A%2F%2Fwww.btelligent.com%2Fen%2Fblogs%2Fdata-science-blog%2Frss.xml">+ Follow</a><br>Facebook fans 274 ⋅ Twitter followers 513 ⋅ Instagram Followers 160 ⋅ Domain Authority 31 ⋅ Alexa Rank 1.5MView Latest Posts⋅Get Email Contact</p><p>Follow on Feedspot</p><h3 id="36-Verra-Mobility"><a href="#36-Verra-Mobility" class="headerlink" title="36. Verra Mobility"></a>36. <a href="https://www.feedspot.com/infiniterss.php?_src=feed_title&amp;followfeedid=5119284&amp;q=site:https%3A%2F%2Fwww.verramobility.com%2Ffeed">Verra Mobility</a></h3><p><img src="https://i1.feedspot.com/5119284.jpg" alt="Verra Mobility"><a href="https://blog.feedspot.com/mesa_blogs/">Mesa</a>, Arizona, United States<strong>About Blog</strong> Verra Mobility is committed to developing and using the latest in technology and data intelligence to help make transportation safer and easier. <strong>Frequency</strong> 1 post / month <strong>Blog</strong> <a href="https://www.verramobility.com/">verramobility.com</a><a href="https://www.feedspot.com/infiniterss.php?_src=followbtn&amp;followfeedid=5119284&amp;q=site:https%3A%2F%2Fwww.verramobility.com%2Ffeed">+ Follow</a><br>Facebook fans 95.7K ⋅ Social Engagement 13 ⋅ Domain Authority 47 ⋅ Alexa Rank 1MView Latest Posts⋅Get Email Contact</p><p>Follow on Feedspot</p><h3 id="37-Data-Elixir"><a href="#37-Data-Elixir" class="headerlink" title="37. Data Elixir"></a>37. <a href="https://www.feedspot.com/infiniterss.php?_src=feed_title&amp;followfeedid=4562827&amp;q=site:https%3A%2F%2Fdataelixir.com%2Fissues.rss">Data Elixir</a></h3><p><img src="https://i1.feedspot.com/4562827.jpeg" alt="Data Elixir"><strong>About Blog</strong> Data Elixir is a weekly newsletter of curated data science news and resources from around the web. Free for data lovers. <strong>Frequency</strong> 1 post / day <strong>Blog</strong> <a href="https://dataelixir.com/">dataelixir.com</a><a href="https://www.feedspot.com/infiniterss.php?_src=followbtn&amp;followfeedid=4562827&amp;q=site:https%3A%2F%2Fdataelixir.com%2Fissues.rss">+ Follow</a><br>Facebook fans 2.3K ⋅ Twitter followers 5.8K ⋅ Social Engagement 695 ⋅ Domain Authority 40 ⋅ Alexa Rank 1.1MView Latest Posts⋅Get Email Contact</p><p>Follow on Feedspot</p><h3 id="38-jbencook"><a href="#38-jbencook" class="headerlink" title="38. jbencook"></a>38. <a href="https://www.feedspot.com/infiniterss.php?_src=feed_title&amp;followfeedid=5237885&amp;q=site:https%3A%2F%2Fjbencook.com%2Ffeed.xml">jbencook</a></h3><p><img src="https://i1.feedspot.com/200/5237885.jpg?t=1611142668" alt="jbencook"><strong>About Blog</strong> The goal of this website is to help people who want to become better data scientists become better programmers - anyone on a journey like mine. I mostly do this with bite-sized tricks, solutions, and quick starts. I hope you like it! <strong>Frequency</strong> 3 posts / week <strong>Since</strong> Feb 2017 <strong>Blog</strong> <a href="https://jbencook.com/">jbencook.com</a><a href="https://www.feedspot.com/infiniterss.php?_src=followbtn&amp;followfeedid=5237885&amp;q=site:https%3A%2F%2Fjbencook.com%2Ffeed.xml">+ Follow</a><br>Twitter followers 5 ⋅ Social Engagement 6 ⋅ Domain Authority 3 ⋅ Alexa Rank 1.8MView Latest Posts⋅Get Email Contact</p><p>Follow on Feedspot</p><h3 id="39-Ujjwal-Karn-The-Data-Science-blog"><a href="#39-Ujjwal-Karn-The-Data-Science-blog" class="headerlink" title="39. Ujjwal Karn - The Data Science blog"></a>39. <a href="https://www.feedspot.com/infiniterss.php?_src=feed_title&amp;followfeedid=4557874&amp;q=site:https%3A%2F%2Fujjwalkarn.me%2Ffeed%2F">Ujjwal Karn - The Data Science blog</a></h3><p><img src="https://i1.feedspot.com/4557874.jpeg" alt="Ujjwal Karn - The Data Science blog"> About Blog machine learning, deep learning, nlp, data science <strong>Blog</strong> <a href="https://ujjwalkarn.me/">ujjwalkarn.me</a><a href="https://www.feedspot.com/infiniterss.php?_src=followbtn&amp;followfeedid=4557874&amp;q=site:https%3A%2F%2Fujjwalkarn.me%2Ffeed%2F">+ Follow</a><br>Facebook fans 119.1K ⋅ Twitter followers 730 ⋅ Domain Authority 38 ⋅ Alexa Rank 1.4MView Latest Posts⋅Get Email Contact</p><p>Follow on Feedspot</p><h3 id="40-data-science-ish"><a href="#40-data-science-ish" class="headerlink" title="40. data science ish"></a>40. <a href="https://www.feedspot.com/infiniterss.php?_src=feed_title&amp;followfeedid=4500397&amp;q=site:https%3A%2F%2Fjuliasilge.com%2Ffeed.xml">data science ish</a></h3><p><img src="https://i1.feedspot.com/4500397.jpg" alt="data science ish"><a href="https://blog.feedspot.com/salt_lake_city_ut_influencers/">Salt Lake City</a>, Utah, United States <strong>About Blog</strong> My name is Julia Silge and I am a data scientist at Stack Overflow. I work in data science where my background in astronomy, physics, and education has given me a strong foundation for using data to answer interesting questions. <strong>Frequency</strong> 2 posts / month <strong>Blog</strong> <a href="https://juliasilge.com/blog/">juliasilge.com/blog</a><a href="https://www.feedspot.com/infiniterss.php?_src=followbtn&amp;followfeedid=4500397&amp;q=site:https%3A%2F%2Fjuliasilge.com%2Ffeed.xml">+ Follow</a><br>Twitter followers 37.2K ⋅ Social Engagement 35 ⋅ Domain Authority 45 ⋅ Alexa Rank 2.7MView Latest Posts⋅Get Email Contact</p><p>Follow on Feedspot</p><h3 id="41-Insight-Extractor-Blog"><a href="#41-Insight-Extractor-Blog" class="headerlink" title="41. Insight Extractor Blog"></a>41. <a href="https://www.feedspot.com/infiniterss.php?_src=feed_title&amp;followfeedid=4558492&amp;q=site:https%3A%2F%2Finsightextractor.com%2Ffeed%2F">Insight Extractor Blog</a></h3><p><img src="https://i1.feedspot.com/4558492.jpeg" alt="Insight Extractor Blog">United States <strong>About Blog</strong> Paras Doshi’s Blog on Analytics, Data Science &amp; Business Intelligence. <strong>Frequency</strong> 1 post / month <strong>Blog</strong> <a href="http://insightextractor.com/">insightextractor.com</a><a href="https://www.feedspot.com/infiniterss.php?_src=followbtn&amp;followfeedid=4558492&amp;q=site:https%3A%2F%2Finsightextractor.com%2Ffeed%2F">+ Follow</a><br>Facebook fans 471 ⋅ Twitter followers 859 ⋅ Social Engagement 1 ⋅ Domain Authority 23 ⋅ Alexa Rank 1.9MView Latest Posts⋅Get Email Contact</p><p>Follow on Feedspot</p><h3 id="42-Data-Science-PR"><a href="#42-Data-Science-PR" class="headerlink" title="42. Data Science PR"></a>42. <a href="https://www.feedspot.com/infiniterss.php?_src=feed_title&amp;followfeedid=5162211&amp;q=site:https%3A%2F%2Fdatasciencepr.com%2Ffeed">Data Science PR</a></h3><p><img src="https://i1.feedspot.com/5162211.jpg?t=1592230366" alt="Data Science PR"><strong>About Blog</strong> Data Science PR is the leading global niche data science press release services provider. <strong>Frequency</strong> 2 posts / day <strong>Blog</strong> <a href="https://datasciencepr.com/">datasciencepr.com</a><a href="https://www.feedspot.com/infiniterss.php?_src=followbtn&amp;followfeedid=5162211&amp;q=site:https%3A%2F%2Fdatasciencepr.com%2Ffeed">+ Follow</a><br>Facebook fans 6.8K ⋅ Twitter followers 21 ⋅ Social Engagement 1 ⋅ Domain Authority 2 ⋅ Alexa Rank 3.1MView Latest Posts⋅Get Email Contact</p><p>Follow on Feedspot</p><h3 id="43-Data-Piques"><a href="#43-Data-Piques" class="headerlink" title="43. Data Piques"></a>43. <a href="https://www.feedspot.com/infiniterss.php?_src=feed_title&amp;followfeedid=4558445&amp;q=site:https%3A%2F%2Fwww.ethanrosenthal.com%2Findex.xml">Data Piques</a></h3><p><img src="https://i1.feedspot.com/4558445.jpg" alt="Data Piques">New York, United States<strong>About Blog</strong> Blog by Data Scientist Ethan Rosenthal. <strong>Frequency</strong> 1 post / month <strong>Blog</strong> <a href="https://www.ethanrosenthal.com/">ethanrosenthal.com</a><a href="https://www.feedspot.com/infiniterss.php?_src=followbtn&amp;followfeedid=4558445&amp;q=site:https%3A%2F%2Fwww.ethanrosenthal.com%2Findex.xml">+ Follow</a><br>Twitter followers 1.2K ⋅ Social Engagement 386 ⋅ Domain Authority 32 ⋅ Alexa Rank 2.6MView Latest Posts⋅Get Email Contact</p><p>Follow on Feedspot</p><h3 id="44-Datamahadev-com"><a href="#44-Datamahadev-com" class="headerlink" title="44. Datamahadev.com"></a>44. <a href="https://www.feedspot.com/infiniterss.php?_src=feed_title&amp;followfeedid=5202715&amp;q=site:https%3A%2F%2Fdatamahadev.com%2Ffeed">Datamahadev.com</a></h3><p><img src="https://i1.feedspot.com/200/5202715.jpg?t=1601549308" alt="Datamahadev.com ">Lucknow, Uttar Pradesh, India<strong>About Blog</strong> Hi there! I’m a Digital Marketing professional, an Artificial Intelligence-Data Science evangelist &amp; enthusiast. I live in Lucknow, India, and I have a penchant for Machine Learning and Deep Learning for the past three years. I invite all the aspiring or current Data Scientists to join us and share their ideas, research papers, code, hackathons, and experiences in the field of AI and Data Sciences. <strong>Frequency</strong> 3 posts / week <strong>Blog</strong> <a href="https://datamahadev.com/">datamahadev.com</a><a href="https://www.feedspot.com/infiniterss.php?_src=followbtn&amp;followfeedid=5202715&amp;q=site:https%3A%2F%2Fdatamahadev.com%2Ffeed">+ Follow</a><br>Facebook fans 71 ⋅ Twitter followers 11 ⋅ Alexa Rank 1.7MView Latest Posts⋅Get Email Contact</p><p>Follow on Feedspot</p><h3 id="45-Mad-Data-Scientist"><a href="#45-Mad-Data-Scientist" class="headerlink" title="45. Mad (Data) Scientist"></a>45. <a href="https://www.feedspot.com/infiniterss.php?_src=feed_title&amp;followfeedid=4291989&amp;q=site:https%3A%2F%2Fmatloff.wordpress.com%2Ffeed%2F">Mad (Data) Scientist</a></h3><p><img src="https://i1.feedspot.com/4291989.jpg" alt="Mad (Data) Scientist"><strong>About Blog</strong> Musings, useful code etc. on R and data science. Blog authored by Norm Matloff. <strong>Frequency</strong> 1 post / quarter <strong>Blog</strong> <a href="https://matloff.wordpress.com/">matloff.wordpress.com</a><a href="https://www.feedspot.com/infiniterss.php?_src=followbtn&amp;followfeedid=4291989&amp;q=site:https%3A%2F%2Fmatloff.wordpress.com%2Ffeed%2F">+ Follow</a><br>Social Engagement 7 ⋅ Domain Authority 32 ⋅ Alexa Rank 2.8MView Latest Posts⋅Get Email Contact</p><p>Follow on Feedspot</p><h3 id="46-Blue-Orange"><a href="#46-Blue-Orange" class="headerlink" title="46. Blue Orange"></a>46. <a href="https://www.feedspot.com/infiniterss.php?_src=feed_title&amp;followfeedid=5069805&amp;q=site:https%3A%2F%2Fblueorange.digital%2Ffeed%2F">Blue Orange</a></h3><p><img src="https://i1.feedspot.com/5069805.jpeg?t=1573284346" alt="Blue Orange"><a href="https://blog.feedspot.com/new_york_city_ny_influencers/">New York City</a>, New York, United States<strong>About Blog</strong> Blue Orange is a data science, machine learning, and data visualization firm. We work with businesses to implement data-driven analytic techniques derived from statistical modeling and data science. We are a team of passionate data engineers, PhDs, data scientists, and visualization experts. <strong>Frequency</strong> 1 post / month <strong>Blog</strong> <a href="https://blueorange.digital/blog/">blueorange.digital/blog</a><a href="https://www.feedspot.com/infiniterss.php?_src=followbtn&amp;followfeedid=5069805&amp;q=site:https%3A%2F%2Fblueorange.digital%2Ffeed%2F">+ Follow</a><br>Domain Authority 24 ⋅ Alexa Rank 3.2MView Latest Posts⋅Get Email Contact</p><p>Follow on Feedspot</p><h3 id="47-SV-Data-Science"><a href="#47-SV-Data-Science" class="headerlink" title="47. SV Data Science"></a>47. <a href="https://www.feedspot.com/infiniterss.php?_src=feed_title&amp;followfeedid=4557872&amp;q=site:https%3A%2F%2Fwww.svds.com%2Fblog%2Ffeed%2F">SV Data Science</a></h3><p><img src="https://i1.feedspot.com/4557872.jpeg" alt="SV Data Science">California, United States<strong>About Blog</strong> Silicon Valley Data Science is a data science consulting company specializing in agile and business-focused solutions. <strong>Blog</strong> <a href="https://www.svds.com/blog/">svds.com/blog</a><a href="https://www.feedspot.com/infiniterss.php?_src=followbtn&amp;followfeedid=4557872&amp;q=site:https%3A%2F%2Fwww.svds.com%2Fblog%2Ffeed%2F">+ Follow</a><br>Twitter followers 2.8K ⋅ Domain Authority 48 ⋅ Alexa Rank 4.5MView Latest Posts⋅Get Email Contact</p><p>Follow on Feedspot</p><h3 id="48-Data-Science-Database-Tools-and-QA-Learning’s"><a href="#48-Data-Science-Database-Tools-and-QA-Learning’s" class="headerlink" title="48. Data Science, Database, Tools and QA Learning’s"></a>48. <a href="https://www.feedspot.com/infiniterss.php?_src=feed_title&amp;followfeedid=4563069&amp;q=site:http%3A%2F%2Ffeeds.feedburner.com%2Fblogspot%2FyBntD">Data Science, Database, Tools and QA Learning’s</a></h3><p><img src="https://i1.feedspot.com/4563069.jpg?t=1546235318" alt="Data Science, Database, Tools and QA Learning's">Bangalore, Karnataka, India<strong>About Blog</strong> Started Primarily for SQL Learning’s later extended to accommodate Data Science, QA, Domain, Tech related learning’s. <strong>Frequency</strong> 2 posts / month <strong>Blog</strong> <a href="https://sqlandsiva.blogspot.com/">sqlandsiva.blogspot.com</a><a href="https://www.feedspot.com/infiniterss.php?_src=followbtn&amp;followfeedid=4563069&amp;q=site:http%3A%2F%2Ffeeds.feedburner.com%2Fblogspot%2FyBntD">+ Follow</a><br>Domain Authority 9 ⋅ Alexa Rank 3.5MView Latest Posts⋅Get Email Contact</p><p>Follow on Feedspot</p><h3 id="49-Neural-Market-Trends"><a href="#49-Neural-Market-Trends" class="headerlink" title="49. Neural Market Trends"></a>49. <a href="https://www.feedspot.com/infiniterss.php?_src=feed_title&amp;followfeedid=352718&amp;q=site:https%3A%2F%2Fwww.neuralmarkettrends.com%2Ffeeds%2Fall.atom.xml">Neural Market Trends</a></h3><p><img src="https://i1.feedspot.com/352718.jpg" alt="Neural Market Trends">New Jersey, United States<strong>About Blog</strong> Machine Learning, Data Science, Tutorials, and Marketing blog from Data Analytic &amp; Rapidminer Evangelist Thomas Ott. <strong>Frequency</strong> 2 posts / week <strong>Blog</strong> <a href="https://www.neuralmarkettrends.com/">neuralmarkettrends.com</a><a href="https://www.feedspot.com/infiniterss.php?_src=followbtn&amp;followfeedid=352718&amp;q=site:https%3A%2F%2Fwww.neuralmarkettrends.com%2Ffeeds%2Fall.atom.xml">+ Follow</a><br>Facebook fans 298 ⋅ Twitter followers 3K ⋅ Domain Authority 32 ⋅ Alexa Rank 5.6MView Latest Posts⋅Get Email Contact</p><p>Follow on Feedspot</p><h3 id="50-Yanir-Seroussi-Data-science-and-beyond"><a href="#50-Yanir-Seroussi-Data-science-and-beyond" class="headerlink" title="50. Yanir Seroussi | Data science and beyond"></a>50. <a href="https://www.feedspot.com/infiniterss.php?_src=feed_title&amp;followfeedid=4562669&amp;q=site:https%3A%2F%2Fyanirseroussi.com%2Ffeed%2F">Yanir Seroussi | Data science and beyond</a></h3><p><img src="https://i1.feedspot.com/4562669.jpg" alt="Yanir Seroussi | Data science and beyond"><strong>About Blog</strong> My name is Yanir Seroussi. This website/blog is mostly meant to group together stuff I write in various places. It’s mainly focused on data science. <strong>Frequency</strong> 1 post / year <strong>Blog</strong> <a href="https://yanirseroussi.com/">yanirseroussi.com</a><a href="https://www.feedspot.com/infiniterss.php?_src=followbtn&amp;followfeedid=4562669&amp;q=site:https%3A%2F%2Fyanirseroussi.com%2Ffeed%2F">+ Follow</a><br>Twitter followers 675 ⋅ Domain Authority 38 ⋅ Alexa Rank 5.1MView Latest Posts⋅Get Email Contact</p><p>Follow on Feedspot</p><h3 id="51-Yhat-The-Yhat-Pronounced-Y-hat-Blog"><a href="#51-Yhat-The-Yhat-Pronounced-Y-hat-Blog" class="headerlink" title="51. Yhat: The Yhat (Pronounced Y-hat) Blog"></a>51. <a href="https://www.feedspot.com/infiniterss.php?_src=feed_title&amp;followfeedid=4462887&amp;q=site:http%3A%2F%2Fblog.yhat.com%2Frss.xml">Yhat: The Yhat (Pronounced Y-hat) Blog</a></h3><p><img src="https://i1.feedspot.com/4462887.jpeg" alt="Yhat: The Yhat (Pronounced Y-hat) Blog">Brooklyn, New York, United States<strong>About Blog</strong> Insightful thoughts and amusing tidbits about predictive analytics, machine learning and engineering. Yhat allows data scientists to programmatically deploy R and Python models into production applications via REST API endpoints. <strong>Blog</strong> <a href="http://blog.yhat.com/">blog.yhat.com</a><a href="https://www.feedspot.com/infiniterss.php?_src=followbtn&amp;followfeedid=4462887&amp;q=site:http%3A%2F%2Fblog.yhat.com%2Frss.xml">+ Follow</a><br>Facebook fans 206 ⋅ Twitter followers 9.5K ⋅ Domain Authority 49 ⋅View Latest Posts⋅Get Email Contact</p><p>Follow on Feedspot</p><h3 id="52-9TO5SAS"><a href="#52-9TO5SAS" class="headerlink" title="52. 9TO5SAS"></a>52. <a href="https://www.feedspot.com/infiniterss.php?_src=feed_title&amp;followfeedid=5148111&amp;q=site:https%3A%2F%2Fwww.9to5sas.com%2Ffeed">9TO5SAS</a></h3><p><img src="https://i1.feedspot.com/5148111.jpg" alt="9TO5SAS">Bangalore, Karnataka, India<strong>About Blog</strong> Learn about Base SAS, Advanced SAS, SAS Macros, Proc SQL, data analytics, statistics tools and techniques. <strong>Frequency</strong> 3 posts / week <strong>Blog</strong> <a href="https://www.9to5sas.com/">9to5sas.com</a><a href="https://www.feedspot.com/infiniterss.php?_src=followbtn&amp;followfeedid=5148111&amp;q=site:https%3A%2F%2Fwww.9to5sas.com%2Ffeed">+ Follow</a><br>Facebook fans 65 ⋅ Twitter followers 5 ⋅ Instagram Followers 17 ⋅ Domain Authority 4 ⋅View Latest Posts⋅Get Email Contact</p><p>Follow on Feedspot</p><h3 id="53-Data-Science-Review-Learning-Data-Science-Right"><a href="#53-Data-Science-Review-Learning-Data-Science-Right" class="headerlink" title="53. Data Science Review | Learning Data Science Right"></a>53. <a href="https://www.feedspot.com/infiniterss.php?_src=feed_title&amp;followfeedid=4973186&amp;q=site:https%3A%2F%2Fdatasciencereview.com%2Ffeed%2F">Data Science Review | Learning Data Science Right</a></h3><p><img src="https://i1.feedspot.com/4973186.jpg?t=1544256193" alt="Data Science Review | Learning Data Science Right">New York, United States<strong>About Blog</strong> My name is Jim Cochrane, and I created this website for you. If you are looking to find resources to help you learn about data science, this is the right place for you. I will be keeping on top of the latest developments in data science. I will evaluate and review programs that are geared toward helping data science practitioners or those who want to become practitioners. <strong>Frequency</strong> 2 posts / month <strong>Blog</strong> <a href="https://datasciencereview.com/">datasciencereview.com</a><a href="https://www.feedspot.com/infiniterss.php?_src=followbtn&amp;followfeedid=4973186&amp;q=site:https%3A%2F%2Fdatasciencereview.com%2Ffeed%2F">+ Follow</a><br>Facebook fans 41 ⋅ Twitter followers 64 ⋅ Domain Authority 10 ⋅View Latest Posts⋅Get Email Contact</p><p>Follow on Feedspot</p><h3 id="54-Socrates-Data-Science-Blog"><a href="#54-Socrates-Data-Science-Blog" class="headerlink" title="54. Socrates Data Science Blog"></a>54. <a href="https://www.feedspot.com/infiniterss.php?_src=feed_title&amp;followfeedid=4990229&amp;q=site:http%3A%2F%2Fblog.socratesk.com%2Fatom.xml">Socrates Data Science Blog</a></h3><p><img src="https://i1.feedspot.com/4990229.jpeg?t=1550569855" alt="Socrates Data Science Blog"><strong>About Blog</strong> In this Blog you will find evidence of my journey towards becoming a Data Scientist including the challenges I faced and addressed, Data Science competitions, tools, and tips &amp; tricks. <strong>Frequency</strong> 1 post / year <strong>Since</strong> Sep 2015 <strong>Blog</strong> <a href="http://blog.socratesk.com/">blog.socratesk.com</a><a href="https://www.feedspot.com/infiniterss.php?_src=followbtn&amp;followfeedid=4990229&amp;q=site:http%3A%2F%2Fblog.socratesk.com%2Fatom.xml">+ Follow</a><br>Twitter followers 13 ⋅ Domain Authority 2 ⋅View Latest Posts⋅Get Email Contact</p><p>Follow on Feedspot</p><h3 id="55-Data-Science-Unicorn"><a href="#55-Data-Science-Unicorn" class="headerlink" title="55. Data Science Unicorn"></a>55. <a href="https://www.feedspot.com/infiniterss.php?_src=feed_title&amp;followfeedid=4563061&amp;q=site:https%3A%2F%2Fdatascienceunicorn.tumblr.com%2Frss">Data Science Unicorn</a></h3><p><img src="https://i1.feedspot.com/4563061.jpg" alt="Data Science Unicorn"><strong>About Blog</strong> This is my collection of interesting, noteworthy and useful links to articles, blogs and resources in all areas of data science. <strong>Frequency</strong> 2 posts / month <strong>Blog</strong> <a href="https://datascienceunicorn.tumblr.com/">datascienceunicorn.tumblr.com</a><a href="https://www.feedspot.com/infiniterss.php?_src=followbtn&amp;followfeedid=4563061&amp;q=site:https%3A%2F%2Fdatascienceunicorn.tumblr.com%2Frss">+ Follow</a><br>Facebook fans 76 ⋅ Domain Authority 8 ⋅View Latest Posts⋅Get Email Contact</p><p>Follow on Feedspot</p><h3 id="56-Oracle-Data-Science-Blog"><a href="#56-Oracle-Data-Science-Blog" class="headerlink" title="56. Oracle Data Science Blog"></a>56. <a href="https://www.feedspot.com/infiniterss.php?_src=feed_title&amp;followfeedid=4557882&amp;q=site:https%3A%2F%2Fblogs.oracle.com%2Fdatascience%2Frss">Oracle Data Science Blog</a></h3><p><img src="https://i1.feedspot.com/4557882.jpg?t=1579848238" alt="Oracle Data Science Blog">Los Angeles, California, United States<strong>About Blog</strong> Learn about data science and machine learning best practices from our team and contributing experts. Sign up to get data science insights in your inbox! <strong>Frequency</strong> 2 posts / week <strong>Blog</strong> <a href="https://blogs.oracle.com/datascience/">blogs.oracle.com/datascience</a><a href="https://www.feedspot.com/infiniterss.php?_src=followbtn&amp;followfeedid=4557882&amp;q=site:https%3A%2F%2Fblogs.oracle.com%2Fdatascience%2Frss">+ Follow</a><br>Facebook fans 2.9M ⋅ Twitter followers 777.7K ⋅ Instagram Followers 211.4K ⋅ Social Engagement 16 ⋅ Domain Authority 93 ⋅View Latest Posts⋅Get Email Contact</p><p>Follow on Feedspot</p><h3 id="57-The-Data-Science-Community"><a href="#57-The-Data-Science-Community" class="headerlink" title="57. The Data Science Community"></a>57. <a href="https://www.feedspot.com/infiniterss.php?_src=feed_title&amp;followfeedid=4562411&amp;q=site:https%3A%2F%2Fdatasciencebe.com%2Ffeed%2F">The Data Science Community</a></h3><p><img src="https://i1.feedspot.com/4562411.jpg" alt="The Data Science Community">Brussels, Belgium<strong>About Blog</strong> The European Knowledge Hub for BigData and DataScience <strong>Frequency</strong> 3 posts / year <strong>Blog</strong> <a href="https://datasciencebe.com/">datasciencebe.com</a><a href="https://www.feedspot.com/infiniterss.php?_src=followbtn&amp;followfeedid=4562411&amp;q=site:https%3A%2F%2Fdatasciencebe.com%2Ffeed%2F">+ Follow</a><br>Facebook fans 4.8K ⋅ Twitter followers 6.1K ⋅ Social Engagement 2 ⋅ Domain Authority 30 ⋅View Latest Posts⋅Get Email Contact</p><p>Follow on Feedspot</p><h3 id="58-Data-Science-Consulting-LLC"><a href="#58-Data-Science-Consulting-LLC" class="headerlink" title="58. Data Science Consulting LLC"></a>58. <a href="https://www.feedspot.com/infiniterss.php?_src=feed_title&amp;followfeedid=4558552&amp;q=site:http%3A%2F%2Fdatadscllc.com%2Fblog%2Ffeed%2F">Data Science Consulting LLC</a></h3><p><img src="https://i1.feedspot.com/4558552.jpg?t=1536584673" alt="Data Science Consulting LLC"><strong>About Blog</strong> Headquartered in Lakewood Ranch, Florida, we provide data science and analytics solutions to solve problems. We discover hidden trends and find value in the data you already have. From a descriptive data assessment to cutting edge machine learning predictive models we have the Data Scientists to meet your needs. <strong>Blog</strong> <a href="http://datadscllc.com/blog/">datadscllc.com/blog</a><a href="https://www.feedspot.com/infiniterss.php?_src=followbtn&amp;followfeedid=4558552&amp;q=site:http%3A%2F%2Fdatadscllc.com%2Fblog%2Ffeed%2F">+ Follow</a><br>Facebook fans 25 ⋅ Twitter followers 4 ⋅ Domain Authority 5 ⋅View Latest Posts⋅Get Email Contact</p><p>Follow on Feedspot</p><h3 id="59-Datalore-Labs-Blog"><a href="#59-Datalore-Labs-Blog" class="headerlink" title="59. Datalore Labs Blog"></a>59. <a href="https://www.feedspot.com/infiniterss.php?_src=feed_title&amp;followfeedid=4562447&amp;q=site:http%3A%2F%2Fblog.datalorelabs.com%2Ffeed">Datalore Labs Blog</a></h3><p><img src="https://i1.feedspot.com/4562447.jpeg" alt="Datalore Labs Blog"><strong>About Blog</strong> Data Science Simplified <strong>Blog</strong> <a href="http://blog.datalorelabs.com/">blog.datalorelabs.com</a><a href="https://www.feedspot.com/infiniterss.php?_src=followbtn&amp;followfeedid=4562447&amp;q=site:http%3A%2F%2Fblog.datalorelabs.com%2Ffeed">+ Follow</a><br>Facebook fans 1K ⋅ Twitter followers 65 ⋅ Domain Authority 1 ⋅View Latest Posts⋅Get Email Contact</p><p>Follow on Feedspot</p><h3 id="60-AnalytiXon"><a href="#60-AnalytiXon" class="headerlink" title="60. AnalytiXon"></a>60. <a href="https://www.feedspot.com/infiniterss.php?_src=feed_title&amp;followfeedid=4563107&amp;q=site:https%3A%2F%2Fanalytixon.com%2Ffeed%2F">AnalytiXon</a></h3><p><img src="https://i1.feedspot.com/4563107.jpg?t=1574843109" alt="AnalytiXon"><strong>About Blog</strong> Follow AnalytiXon blog that covers topics such as Data Science, Data Mining, Text Mining, Machine Learning, Statistical Learning, Statistics, Analytics Modeling, Business Analytics, Knowledge Discovery, Soft Computing, Natural Language Processing, Data Aggregation, Econometrics, Visualization &amp; related Programming. <strong>Frequency</strong> 10 posts / week <strong>Since</strong> Jan 2015 <strong>Blog</strong> <a href="https://analytixon.com/">analytixon.com</a><a href="https://www.feedspot.com/infiniterss.php?_src=followbtn&amp;followfeedid=4563107&amp;q=site:https%3A%2F%2Fanalytixon.com%2Ffeed%2F">+ Follow</a><br>Domain Authority 17 ⋅View Latest Posts⋅Get Email Contact</p><p>Follow on Feedspot</p><h3 id="61-Perfect-Price-Blog"><a href="#61-Perfect-Price-Blog" class="headerlink" title="61. Perfect Price Blog"></a>61. <a href="https://www.feedspot.com/infiniterss.php?_src=feed_title&amp;followfeedid=4558437&amp;q=site:https%3A%2F%2Fwww.perfectprice.com%2Fblog%2Frss.xml">Perfect Price Blog</a></h3><p><img src="https://i1.feedspot.com/4558437.jpeg?t=1606198122" alt="Perfect Price Blog">San Francisco, California, United States<strong>About Blog</strong> Drive continuous business growth through price optimization. Perfect Price drives consistent profit and revenue growth for companies around the world. Get the latest on machine learning and pricing science delivered to your inbox. <strong>Frequency</strong> 4 posts / quarter <strong>Blog</strong> <a href="https://www.perfectprice.com/blog">perfectprice.com/blog</a><a href="https://www.feedspot.com/infiniterss.php?_src=followbtn&amp;followfeedid=4558437&amp;q=site:https%3A%2F%2Fwww.perfectprice.com%2Fblog%2Frss.xml">+ Follow</a><br>Twitter followers 106 ⋅ Domain Authority 35 ⋅View Latest Posts⋅Get Email Contact</p><p>Follow on Feedspot</p><h3 id="62-FOXY-DATA-SCIENCE"><a href="#62-FOXY-DATA-SCIENCE" class="headerlink" title="62. FOXY DATA SCIENCE"></a>62. <a href="https://www.feedspot.com/infiniterss.php?_src=feed_title&amp;followfeedid=4558548&amp;q=site:http%3A%2F%2Fwww.foxydatascience.com%2F1%2Ffeed">FOXY DATA SCIENCE</a></h3><p><img src="https://i1.feedspot.com/4558548.jpg?t=1550226623" alt="FOXY DATA SCIENCE">Greece<strong>About Blog</strong> A modern blog about data science and artificial intelligence for out-of-the-box thinkers of all levels, by a passionate data scientist with a foxy mindset. Educational posts for data science enthusiasts of all levels are also available. <strong>Frequency</strong> 2 posts / week <strong>Blog</strong> <a href="http://www.foxydatascience.com/">foxydatascience.com</a><a href="https://www.feedspot.com/infiniterss.php?_src=followbtn&amp;followfeedid=4558548&amp;q=site:http%3A%2F%2Fwww.foxydatascience.com%2F1%2Ffeed">+ Follow</a><br>Domain Authority 8 ⋅View Latest Posts⋅Get Email Contact</p><p>Follow on Feedspot</p><h3 id="63-Data-Science-Diary"><a href="#63-Data-Science-Diary" class="headerlink" title="63. Data Science Diary"></a>63. <a href="https://www.feedspot.com/infiniterss.php?_src=feed_title&amp;followfeedid=4563090&amp;q=site:https%3A%2F%2Fdatasciensediary.tumblr.com%2Frss">Data Science Diary</a></h3><p><img src="https://i1.feedspot.com/4563090.jpeg" alt="Data Science Diary"><strong>About Blog</strong> Learn Humbly | Think Critically | Improve Continuously <strong>Blog</strong> <a href="https://datasciensediary.tumblr.com/">datasciensediary.tumblr.com</a><a href="https://www.feedspot.com/infiniterss.php?_src=followbtn&amp;followfeedid=4563090&amp;q=site:https%3A%2F%2Fdatasciensediary.tumblr.com%2Frss">+ Follow</a><br>Domain Authority 4 ⋅View Latest Posts⋅Get Email Contact</p><p>Follow on Feedspot</p><h3 id="64-Datapolitan"><a href="#64-Datapolitan" class="headerlink" title="64. Datapolitan"></a>64. <a href="https://www.feedspot.com/infiniterss.php?_src=feed_title&amp;followfeedid=4558479&amp;q=site:https%3A%2F%2Fblog.datapolitan.com%2Ffeed%2F">Datapolitan</a></h3><p><img src="https://i1.feedspot.com/4558479.jpeg?t=1536238508" alt="Datapolitan">New York, United States<strong>About Blog</strong> Thoughts on data, statistics, computer science, and those other things people call life. <strong>Blog</strong> <a href="https://blog.datapolitan.com/">blog.datapolitan.com</a><a href="https://www.feedspot.com/infiniterss.php?_src=followbtn&amp;followfeedid=4558479&amp;q=site:https%3A%2F%2Fblog.datapolitan.com%2Ffeed%2F">+ Follow</a><br>Twitter followers 1.4K ⋅ Domain Authority 26 ⋅View Latest Posts⋅Get Email Contact</p><p>Follow on Feedspot</p><h3 id="65-Dr-Shahin-Rostami"><a href="#65-Dr-Shahin-Rostami" class="headerlink" title="65. Dr. Shahin Rostami"></a>65. <a href="https://www.feedspot.com/infiniterss.php?_src=feed_title&amp;followfeedid=5185675&amp;q=site:https%3A%2F%2Fdatacrayon.com%2Frss.xml">Dr. Shahin Rostami</a></h3><p><img src="https://i1.feedspot.com/200/5185675.jpg?t=1598271076" alt="Dr. Shahin Rostami">Bournemouth, England, United Kingdom<strong>About Blog</strong> Dr. Shahin Rostami is a Senior Academic (Associate Professor) and Consultant in Data Science and Artificial Intelligence, with applications in the areas of Healthcare and Defence. As a Senior Fellow of the Higher Education Academy and Programme Leader for many postgraduate programmes, he aims to contribute openly available learning resources through this website. <strong>Frequency</strong> 1 post / month<strong>Also in</strong> <a href="https://blog.feedspot.com/technology_blogs/">Technology Blogs</a> <strong>Blog</strong> <a href="https://datacrayon.com/">datacrayon.com</a><a href="https://www.feedspot.com/infiniterss.php?_src=followbtn&amp;followfeedid=5185675&amp;q=site:https%3A%2F%2Fdatacrayon.com%2Frss.xml">+ Follow</a><br>Twitter followers 489 ⋅ Social Engagement 4 ⋅View Latest Posts⋅Get Email Contact</p><p>Follow on Feedspot</p><h3 id="66-ikigomu"><a href="#66-ikigomu" class="headerlink" title="66. ikigomu"></a>66. <a href="https://www.feedspot.com/infiniterss.php?_src=feed_title&amp;followfeedid=4562376&amp;q=site:http%3A%2F%2Fikigomu.com%2F%3Ffeed%3Drss2">ikigomu</a></h3><p><img src="https://i1.feedspot.com/4562376.jpg" alt="ikigomu">New York City, New York, United States<strong>About Blog</strong> A Data Science, NLP and personal blog by Matthew Ruttley. Ikigomu is a new Japanese Language learning website that uses NLP and Data Mining techniques to personalize your studies! <strong>Blog</strong> <a href="http://ikigomu.com/">ikigomu.com</a><a href="https://www.feedspot.com/infiniterss.php?_src=followbtn&amp;followfeedid=4562376&amp;q=site:http%3A%2F%2Fikigomu.com%2F%3Ffeed%3Drss2">+ Follow</a><br>Twitter followers 225 ⋅ Domain Authority 19 ⋅View Latest Posts⋅Get Email Contact</p><p>Follow on Feedspot</p><h3 id="67-DSI-Analytics-Data-Science-Insights"><a href="#67-DSI-Analytics-Data-Science-Insights" class="headerlink" title="67. DSI Analytics - Data Science Insights"></a>67. <a href="https://www.feedspot.com/infiniterss.php?_src=feed_title&amp;followfeedid=4558165&amp;q=site:http%3A%2F%2Fdsianalytics.com%2Ffeed">DSI Analytics - Data Science Insights</a></h3><p><img src="https://i1.feedspot.com/4558165.jpg?t=1536237914" alt="DSI Analytics - Data Science Insights">Amsterdam, Noord-Holland, Netherlands<strong>About Blog</strong> Helping executives envision and execute new ways to use data and data science to grow their business. Blog by David Stephenson - Data Science and Big Data Analytics expert and keynote speaker. <strong>Frequency</strong> 2 posts / year <strong>Blog</strong> <a href="http://dsianalytics.com/">dsianalytics.com</a><a href="https://www.feedspot.com/infiniterss.php?_src=followbtn&amp;followfeedid=4558165&amp;q=site:http%3A%2F%2Fdsianalytics.com%2Ffeed">+ Follow</a><br>Twitter followers 769 ⋅ Domain Authority 24 ⋅View Latest Posts⋅Get Email Contact</p><p>Follow on Feedspot</p><h3 id="68-ERDataDoc"><a href="#68-ERDataDoc" class="headerlink" title="68. ERDataDoc"></a>68. <a href="https://www.feedspot.com/infiniterss.php?_src=feed_title&amp;followfeedid=4562359&amp;q=site:https%3A%2F%2Ferdatadoc.com%2Ffeed%2F">ERDataDoc</a></h3><p><img src="https://i1.feedspot.com/4562359.jpg" alt="ERDataDoc"><a href="https://blog.feedspot.com/billings_blogs/">Billings</a>, Montana, United States<strong>About Blog</strong> My blog about becoming a Healthcare Data Scientist, Healthcare Big Data and Analytics, Healthcare Predictive Analytics, Infographics, and assorted Emergency Medicine/Learning Health System/Complexity Science topics. <strong>Blog</strong> <a href="https://erdatadoc.com/">erdatadoc.com</a><a href="https://www.feedspot.com/infiniterss.php?_src=followbtn&amp;followfeedid=4562359&amp;q=site:https%3A%2F%2Ferdatadoc.com%2Ffeed%2F">+ Follow</a><br>Twitter followers 474 ⋅ Domain Authority 7 ⋅View Latest Posts⋅Get Email Contact</p><p>Follow on Feedspot</p><h3 id="69-Carlo-Carandang-Data-Science"><a href="#69-Carlo-Carandang-Data-Science" class="headerlink" title="69. Carlo Carandang - Data Science"></a>69. <a href="https://www.feedspot.com/infiniterss.php?_src=feed_title&amp;followfeedid=4681198&amp;q=site:https%3A%2F%2Fcarlocarandang.com%2Fcategory%2Fdata-science%2Ffeed%2F">Carlo Carandang - Data Science</a></h3><p><img src="https://i1.feedspot.com/4681198.jpg" alt="Carlo Carandang - Data Science ">Canada<strong>About Blog</strong> Blogs on Data Science | Digital Health by Carlo Carandang. <strong>Frequency</strong> 3 posts / year <strong>Blog</strong> <a href="https://carlocarandang.com/category/data-science/">carlocarandang.com/category/..</a><a href="https://www.feedspot.com/infiniterss.php?_src=followbtn&amp;followfeedid=4681198&amp;q=site:https%3A%2F%2Fcarlocarandang.com%2Fcategory%2Fdata-science%2Ffeed%2F">+ Follow</a><br>Twitter followers 1K ⋅ Social Engagement 2 ⋅ Domain Authority 11 ⋅View Latest Posts⋅Get Email Contact</p><p>Follow on Feedspot</p><h3 id="70-Hi-I-am-Nagdev"><a href="#70-Hi-I-am-Nagdev" class="headerlink" title="70. Hi! I am Nagdev"></a>70. <a href="https://www.feedspot.com/infiniterss.php?_src=feed_title&amp;followfeedid=5132765&amp;q=site:https%3A%2F%2Fiamnagdev.com%2Ffeed">Hi! I am Nagdev</a></h3><p><img src="https://i1.feedspot.com/5132765.jpeg" alt="Hi! I am Nagdev"><strong>About Blog</strong> A personal Blog to express my free thoughts in the inner webs. <strong>Frequency</strong> 30 posts / year <strong>Blog</strong> <a href="https://iamnagdev.com/">iamnagdev.com</a><a href="https://www.feedspot.com/infiniterss.php?_src=followbtn&amp;followfeedid=5132765&amp;q=site:https%3A%2F%2Fiamnagdev.com%2Ffeed">+ Follow</a><br>Social Engagement 2 ⋅View Latest Posts⋅Get Email Contact</p><p>Follow on Feedspot</p><h3 id="71-Nina-B-Zumel-Data-Science"><a href="#71-Nina-B-Zumel-Data-Science" class="headerlink" title="71. Nina B. Zumel | Data Science"></a>71. <a href="https://www.feedspot.com/infiniterss.php?_src=feed_title&amp;followfeedid=4558467&amp;q=site:https%3A%2F%2Fninazumel.com%2Fposts%2Ffeed%2F">Nina B. Zumel | Data Science</a></h3><p><img src="https://i1.feedspot.com/4558467.jpg" alt="Nina B. Zumel | Data Science">San Francisco, California, United States<strong>About Blog</strong> I am a Principal Consultant with Win-Vector LLC, a data science consulting firm based in San Francisco. My technical interests include data science, statistics, statistical learning, and data visualization. <strong>Frequency</strong> 1 post / year <strong>Blog</strong> <a href="https://ninazumel.com/posts/">ninazumel.com/posts</a><a href="https://www.feedspot.com/infiniterss.php?_src=followbtn&amp;followfeedid=4558467&amp;q=site:https%3A%2F%2Fninazumel.com%2Fposts%2Ffeed%2F">+ Follow</a><br>Twitter followers 2.3K ⋅ Domain Authority 21 ⋅View Latest Posts⋅Get Email Contact</p><p>Follow on Feedspot</p><h3 id="72-DATAVERSITY-»-Data-Science-News-Articles-amp-Education"><a href="#72-DATAVERSITY-»-Data-Science-News-Articles-amp-Education" class="headerlink" title="72. DATAVERSITY » Data Science News, Articles, &amp; Education"></a>72. <a href="https://www.feedspot.com/infiniterss.php?_src=feed_title&amp;followfeedid=4337309&amp;q=site:https%3A%2F%2Fwww.dataversity.net%2Fcategory%2Fdata-topics%2Fdata-science-data-topics%2Ffeed%2F">DATAVERSITY » Data Science News, Articles, &amp; Education</a></h3><p><img src="https://i1.feedspot.com/4337309.jpg?t=1550123535" alt="DATAVERSITY » Data Science News, Articles, &amp; Education">United States<strong>About Blog</strong> Learn Data Management at DATAVERSITY <strong>Frequency</strong> 1 post / quarter <strong>Blog</strong> <a href="https://www.dataversity.net/category/data-topics/data-science-data-topics/">dataversity.net/category/dat..</a><a href="https://www.feedspot.com/infiniterss.php?_src=followbtn&amp;followfeedid=4337309&amp;q=site:https%3A%2F%2Fwww.dataversity.net%2Fcategory%2Fdata-topics%2Fdata-science-data-topics%2Ffeed%2F">+ Follow</a><br>Facebook fans 6.4K ⋅ Twitter followers 22.3K ⋅ Social Engagement 7 ⋅ Domain Authority 58 ⋅View Latest Posts⋅Get Email Contact</p><p>Follow on Feedspot</p><h3 id="73-Dimensionless-Technologies-Blog-Data-Science-amp-Business-Analytics"><a href="#73-Dimensionless-Technologies-Blog-Data-Science-amp-Business-Analytics" class="headerlink" title="73. Dimensionless Technologies Blog | Data Science &amp; Business Analytics"></a>73. <a href="https://www.feedspot.com/infiniterss.php?_src=feed_title&amp;followfeedid=4558456&amp;q=site:https%3A%2F%2Fdimensionless.in%2Ffeed%2F">Dimensionless Technologies Blog | Data Science &amp; Business Analytics</a></h3><p><img src="https://i1.feedspot.com/4558456.jpg" alt="Dimensionless Technologies Blog | Data Science &amp; Business Analytics">Mumbai, Maharashtra, India<strong>About Blog</strong> Read Articles on Data Science and Business Analytics on our blog. Beware of latest industry trends and demand. <strong>Frequency</strong> 2 posts / year <strong>Blog</strong> <a href="https://dimensionless.in/blog/">dimensionless.in/blog</a><a href="https://www.feedspot.com/infiniterss.php?_src=followbtn&amp;followfeedid=4558456&amp;q=site:https%3A%2F%2Fdimensionless.in%2Ffeed%2F">+ Follow</a><br>Twitter followers 158 ⋅ Social Engagement 7 ⋅ Domain Authority 30 ⋅ Alexa Rank 1.3MView Latest Posts⋅Get Email Contact</p><p>Follow on Feedspot</p><h3 id="74-My-Data-Science-and-Big-Data-blog"><a href="#74-My-Data-Science-and-Big-Data-blog" class="headerlink" title="74. My Data Science and Big Data blog"></a>74. <a href="https://www.feedspot.com/infiniterss.php?_src=feed_title&amp;followfeedid=4558483&amp;q=site:https%3A%2F%2Fjbaquerot.tumblr.com%2Frss">My Data Science and Big Data blog</a></h3><p><img src="https://i1.feedspot.com/4558483.jpeg" alt="My Data Science and Big Data blog"><strong>About Blog</strong> Would you like to find the needle in the haystack of the Big Data news? Follow me and I will keep you up to date on the most important news of Data Science and Big Data. <strong>Blog</strong> <a href="https://jbaquerot.tumblr.com/">jbaquerot.tumblr.com</a><a href="https://www.feedspot.com/infiniterss.php?_src=followbtn&amp;followfeedid=4558483&amp;q=site:https%3A%2F%2Fjbaquerot.tumblr.com%2Frss">+ Follow</a><br>Twitter followers 452 ⋅ Domain Authority 13 ⋅View Latest Posts⋅Get Email Contact</p><p>Follow on Feedspot</p><h3 id="75-Data-Science-for-Social-Good"><a href="#75-Data-Science-for-Social-Good" class="headerlink" title="75. Data Science for Social Good"></a>75. <a href="https://www.feedspot.com/infiniterss.php?_src=feed_title&amp;followfeedid=4558152&amp;q=site:http%3A%2F%2Fwww.dssgfellowship.org%2Ffeed%2F">Data Science for Social Good</a></h3><p><img src="https://i1.feedspot.com/4558152.jpg" alt="Data Science for Social Good">Chicago, Illinois, United States<strong>About Blog</strong> The Data Science for Social Good fellowship is a full-time summer program to train aspiring data scientists to work on machine learning, data science, and AI projects with social impact in a fair and equitable manner. <strong>Blog</strong> <a href="http://www.dssgfellowship.org//blog/">dssgfellowship.org//blog</a><a href="https://www.feedspot.com/infiniterss.php?_src=followbtn&amp;followfeedid=4558152&amp;q=site:http%3A%2F%2Fwww.dssgfellowship.org%2Ffeed%2F">+ Follow</a><br>Twitter followers 29.1K ⋅ Domain Authority 49 ⋅View Latest Posts⋅Get Email Contact</p><p>Follow on Feedspot</p><h3 id="76-Dimensionless"><a href="#76-Dimensionless" class="headerlink" title="76. Dimensionless"></a>76. <a href="https://www.feedspot.com/infiniterss.php?_src=feed_title&amp;followfeedid=4791017&amp;q=site:https%3A%2F%2Fdimensionless.in%2Ffeed">Dimensionless</a></h3><p><img src="https://i1.feedspot.com/4791017.jpg?t=1550569214" alt="Dimensionless">Mumbai, Maharashtra, <a href="https://blog.feedspot.com/indian_blogs/">India</a><strong>About Blog</strong> Dimensionless Technologies is an education company which provides live online courses in the data science field. <strong>Frequency</strong> 2 posts / year <strong>Since</strong> Feb 2016<strong>Blog</strong> <a href="https://dimensionless.in/blog/[+">https://dimensionless.in/blog/[+</a> Follow](<a href="https://www.feedspot.com/infiniterss.php?_src=followbtn&amp;followfeedid=4791017&amp;q=site:https%3A%2F%2Fdimensionless.in%2Ffeed">https://www.feedspot.com/infiniterss.php?_src=followbtn&amp;followfeedid=4791017&amp;q=site:https%3A%2F%2Fdimensionless.in%2Ffeed</a> rel=)<br>Twitter followers 158 ⋅ Social Engagement 7 ⋅ Domain Authority 30 ⋅ Alexa Rank 1.3MView Latest Posts⋅Get Email ContactFollow on Feedspot</p><h3 id="77-The-Data-Blogger"><a href="#77-The-Data-Blogger" class="headerlink" title="77. The Data Blogger"></a>77. <a href="https://www.feedspot.com/infiniterss.php?_src=feed_title&amp;followfeedid=4558211&amp;q=site:https%3A%2F%2Fwebserver.data-blogger.com%2Ffeed%2F">The Data Blogger</a></h3><p><img src="https://i1.feedspot.com/4558211.jpeg" alt="The Data Blogger"><strong>About Blog</strong> An interesting blog with tutorials and articles on Data Science. Authored by Kevin Jacobs. <strong>Frequency</strong> 3 posts / year <strong>Blog</strong> <a href="https://www.data-blogger.com/[+">https://www.data-blogger.com/[+</a> Follow](<a href="https://www.feedspot.com/infiniterss.php?_src=followbtn&amp;followfeedid=4558211&amp;q=site:https%3A%2F%2Fwebserver.data-blogger.com%2Ffeed%2F">https://www.feedspot.com/infiniterss.php?_src=followbtn&amp;followfeedid=4558211&amp;q=site:https%3A%2F%2Fwebserver.data-blogger.com%2Ffeed%2F</a> rel=)<br>Social Engagement 2 ⋅ Domain Authority 29 ⋅ Alexa Rank 1.6MView Latest Posts⋅Get Email ContactFollow on Feedspot</p><h3 id="78-Hevo-Blog-Transformative-ideas-and-real-insights-on-all-things-Data"><a href="#78-Hevo-Blog-Transformative-ideas-and-real-insights-on-all-things-Data" class="headerlink" title="78. Hevo Blog | Transformative ideas and real insights on all things Data"></a>78. <a href="https://www.feedspot.com/infiniterss.php?_src=feed_title&amp;followfeedid=5064909&amp;q=site:https%3A%2F%2Fhevodata.com%2Fblog%2Ffeed%2F">Hevo Blog | Transformative ideas and real insights on all things Data</a></h3><p><img src="https://i1.feedspot.com/5064909.jpg" alt="Hevo Blog | Transformative ideas and real insights on all things Data">San Francisco, California, United States<strong>About Blog</strong> Get the latest stories and practical tips on all technologies that concern Data Analytics, Big Data Management, Data Migration, Data Integration, Data Pipelines, Data Modelling, and more. <strong>Frequency</strong> 30 posts / year <strong>Blog</strong> <a href="https://hevodata.com/blog/[+">https://hevodata.com/blog/[+</a> Follow](<a href="https://www.feedspot.com/infiniterss.php?_src=followbtn&amp;followfeedid=5064909&amp;q=site:https%3A%2F%2Fhevodata.com%2Fblog%2Ffeed%2F">https://www.feedspot.com/infiniterss.php?_src=followbtn&amp;followfeedid=5064909&amp;q=site:https%3A%2F%2Fhevodata.com%2Fblog%2Ffeed%2F</a> rel=)<br>Facebook fans 137 ⋅ Twitter followers 247 ⋅ Domain Authority 32 ⋅ Alexa Rank 51.1KView Latest Posts⋅Get Email ContactFollow on Feedspot</p><h3 id="79-Win-Vector-Blog"><a href="#79-Win-Vector-Blog" class="headerlink" title="79. Win-Vector Blog"></a>79. <a href="https://www.feedspot.com/infiniterss.php?_src=feed_title&amp;followfeedid=109790&amp;q=site:http%3A%2F%2Fwww.win-vector.com%2Fblog%2Ffeed%2F">Win-Vector Blog</a></h3><p><img src="https://i1.feedspot.com/200/109790.jpg?t=1612588523" alt="Win-Vector Blog">San Francisco, California, United States<strong>About Blog</strong> Win-Vector Blog is a data science blog which gives tips and tricks for using R programming in data science. <strong>Frequency</strong> 30 posts / year <strong>Since</strong> Jun 2007<strong>Blog</strong> <a href="http://www.win-vector.com/blog/[+">http://www.win-vector.com/blog/[+</a> Follow](<a href="https://www.feedspot.com/infiniterss.php?_src=followbtn&amp;followfeedid=109790&amp;q=site:http%3A%2F%2Fwww.win-vector.com%2Fblog%2Ffeed%2F">https://www.feedspot.com/infiniterss.php?_src=followbtn&amp;followfeedid=109790&amp;q=site:http%3A%2F%2Fwww.win-vector.com%2Fblog%2Ffeed%2F</a> rel=)<br>Twitter followers 2.3K ⋅ Social Engagement 13 ⋅ Domain Authority 46 ⋅ Alexa Rank 936.1KView Latest Posts⋅Get Email ContactFollow on Feedspot</p><h3 id="80-Data-Plus-Science"><a href="#80-Data-Plus-Science" class="headerlink" title="80. Data Plus Science"></a>80. <a href="https://www.feedspot.com/infiniterss.php?_src=feed_title&amp;followfeedid=4557889&amp;q=site:http%3A%2F%2Fwww.dataplusscience.com%2FRSSfeed.xml">Data Plus Science</a></h3><p><img src="https://i1.feedspot.com/200/4557889.jpg?t=1612619274" alt="Data Plus Science">Cincinnati, <a href="https://blog.feedspot.com/ohio_blogs/">Ohio</a>, United States<strong>About Blog</strong> Welcome to Data Plus Science by Jeffrey A. Shaffer. He is a regular speaker at conferences, symposiums, universities and corporate training programs on the topic of data visualization, data mining, and Tableau. <strong>Frequency</strong> 1 post / quarter <strong>Since</strong> Apr 2011<strong>Blog</strong> <a href="https://www.dataplusscience.com/insights.html[+">https://www.dataplusscience.com/insights.html[+</a> Follow](<a href="https://www.feedspot.com/infiniterss.php?_src=followbtn&amp;followfeedid=4557889&amp;q=site:http%3A%2F%2Fwww.dataplusscience.com%2FRSSfeed.xml">https://www.feedspot.com/infiniterss.php?_src=followbtn&amp;followfeedid=4557889&amp;q=site:http%3A%2F%2Fwww.dataplusscience.com%2FRSSfeed.xml</a> rel=)<br>Facebook fans 3.3K ⋅ Twitter followers 36.5K ⋅ Social Engagement 2 ⋅ Domain Authority 37 ⋅ Alexa Rank 1.4MView Latest Posts⋅Get Email ContactFollow on Feedspot</p><h3 id="81-Perceptrons"><a href="#81-Perceptrons" class="headerlink" title="81. Perceptrons"></a>81. <a href="https://www.feedspot.com/infiniterss.php?_src=feed_title&amp;followfeedid=5150380&amp;q=site:https%3A%2F%2Fperceptrons.ai%2Fblog%2Ffeed">Perceptrons</a></h3><p><img src="https://pbs.twimg.com/profile_images/1258102808772882432/31MIbZAR.png" alt="Perceptrons"><a href="https://blog.feedspot.com/bangalore_blogs/">Bangalore</a>, <a href="https://blog.feedspot.com/karnataka_in_influencers/">Karnataka</a>, India<strong>About Blog</strong> Learn Data Science, Artificial Intelligence, Big Data Analytics and Tableau. We provide data science classroom and live online training courses. <strong>Frequency</strong> 5 posts / year <strong>Blog</strong> <a href="https://perceptrons.ai/blog/[+">https://perceptrons.ai/blog/[+</a> Follow](<a href="https://www.feedspot.com/infiniterss.php?_src=followbtn&amp;followfeedid=5150380&amp;q=site:https%3A%2F%2Fperceptrons.ai%2Fblog%2Ffeed">https://www.feedspot.com/infiniterss.php?_src=followbtn&amp;followfeedid=5150380&amp;q=site:https%3A%2F%2Fperceptrons.ai%2Fblog%2Ffeed</a> rel=)<br>Facebook fans 582 ⋅ Domain Authority 8 ⋅ Alexa Rank 2.1MView Latest Posts⋅Get Email ContactFollow on Feedspot</p><h3 id="82-DataScience-SMU-Southern-Methodist-University"><a href="#82-DataScience-SMU-Southern-Methodist-University" class="headerlink" title="82. DataScience@SMU - Southern Methodist University"></a>82. <a href="https://www.feedspot.com/infiniterss.php?_src=feed_title&amp;followfeedid=4557886&amp;q=site:https%3A%2F%2Fdatascience.smu.edu%2Fblog%2Frecent.atom%2F%3Fformat%3Dxml">DataScience@SMU - Southern Methodist University</a></h3><p><img src="https://i1.feedspot.com/4557886.jpeg" alt="DataScience@SMU - Southern Methodist University"><strong>About Blog</strong> DataScience@SMU prepares data science professionals to understand, manage &amp; analyze large data sets, as well as communicate the results. <strong>Frequency</strong> 1 post / year <strong>Blog</strong> <a href="https://datascience.smu.edu/blog/[+">https://datascience.smu.edu/blog/[+</a> Follow](<a href="https://www.feedspot.com/infiniterss.php?_src=followbtn&amp;followfeedid=4557886&amp;q=site:https%3A%2F%2Fdatascience.smu.edu%2Fblog%2Frecent.atom%2F%3Fformat%3Dxml">https://www.feedspot.com/infiniterss.php?_src=followbtn&amp;followfeedid=4557886&amp;q=site:https%3A%2F%2Fdatascience.smu.edu%2Fblog%2Frecent.atom%2F%3Fformat%3Dxml</a> rel=)<br>Facebook fans 3.9K ⋅ Twitter followers 863 ⋅ Domain Authority 77 ⋅ Alexa Rank 27.9KView Latest Posts⋅Get Email ContactFollow on Feedspot</p><h3 id="83-Remix-Institute"><a href="#83-Remix-Institute" class="headerlink" title="83. Remix Institute"></a>83. <a href="https://www.feedspot.com/infiniterss.php?_src=feed_title&amp;followfeedid=5134714&amp;q=site:https%3A%2F%2Fwww.remixinstitute.com%2Ffeed">Remix Institute</a></h3><p><img src="https://i1.feedspot.com/5134714.jpg?t=1585996347" alt="Remix Institute">Miami, Florida, United States<strong>About Blog</strong> Remix Institute is a technology firm that focuses of data science, machine learning, and AI for business via services, training, and our RemixAutoML software. <strong>Blog</strong> <a href="https://www.remixinstitute.com/[+">https://www.remixinstitute.com/[+</a> Follow](<a href="https://www.feedspot.com/infiniterss.php?_src=followbtn&amp;followfeedid=5134714&amp;q=site:https%3A%2F%2Fwww.remixinstitute.com%2Ffeed">https://www.feedspot.com/infiniterss.php?_src=followbtn&amp;followfeedid=5134714&amp;q=site:https%3A%2F%2Fwww.remixinstitute.com%2Ffeed</a> rel=)<br>Twitter followers 26 ⋅ Social Engagement 7 ⋅ Domain Authority 16 ⋅ Alexa Rank 1.3MView Latest Posts⋅Get Email ContactFollow on Feedspot</p><h3 id="84-Backyard-Data-Science-Precision-Guesswork-While-You-Wait"><a href="#84-Backyard-Data-Science-Precision-Guesswork-While-You-Wait" class="headerlink" title="84. Backyard Data Science | Precision Guesswork While You Wait"></a>84. <a href="https://www.feedspot.com/infiniterss.php?_src=feed_title&amp;followfeedid=4352416&amp;q=site:https%3A%2F%2Fbuckwoody.wordpress.com%2Ffeed%2F">Backyard Data Science | Precision Guesswork While You Wait</a></h3><p><img src="https://i1.feedspot.com/4352416.jpeg" alt="Backyard Data Science | Precision Guesswork While You Wait"><strong>About Blog</strong> Blog on Data Science by Buck Woody. <strong>Blog</strong> <a href="https://buckwoody.wordpress.com/[+">https://buckwoody.wordpress.com/[+</a> Follow](<a href="https://www.feedspot.com/infiniterss.php?_src=followbtn&amp;followfeedid=4352416&amp;q=site:https%3A%2F%2Fbuckwoody.wordpress.com%2Ffeed%2F">https://www.feedspot.com/infiniterss.php?_src=followbtn&amp;followfeedid=4352416&amp;q=site:https%3A%2F%2Fbuckwoody.wordpress.com%2Ffeed%2F</a> rel=)<br>Twitter followers 5.2K ⋅ Social Engagement 4 ⋅ Domain Authority 27 ⋅View Latest Posts⋅Get Email ContactFollow on Feedspot</p><h3 id="85-Becoming-A-Data-Scientist"><a href="#85-Becoming-A-Data-Scientist" class="headerlink" title="85. Becoming A Data Scientist"></a>85. <a href="https://www.feedspot.com/infiniterss.php?_src=feed_title&amp;followfeedid=4342192&amp;q=site:http%3A%2F%2Fwww.becomingadatascientist.com%2Ffeed%2F">Becoming A Data Scientist</a></h3><p><img src="https://i1.feedspot.com/4342192.jpeg" alt="Becoming A Data Scientist"><a href="https://blog.feedspot.com/harrisonburg_va_influencers/">Harrisonburg</a>, Virginia, United States<strong>About Blog</strong> Becoming A Data Scientist | Documenting my path from “SQL Data Analyst pursuing an Engineering Master’s Degree” to “Data Scientist” <strong>Blog</strong> <a href="http://www.becomingadatascientist.com/[+">http://www.becomingadatascientist.com/[+</a> Follow](<a href="https://www.feedspot.com/infiniterss.php?_src=followbtn&amp;followfeedid=4342192&amp;q=site:http%3A%2F%2Fwww.becomingadatascientist.com%2Ffeed%2F">https://www.feedspot.com/infiniterss.php?_src=followbtn&amp;followfeedid=4342192&amp;q=site:http%3A%2F%2Fwww.becomingadatascientist.com%2Ffeed%2F</a> rel=)<br>Twitter followers 60.3K ⋅ Social Engagement 3 ⋅ Domain Authority 43 ⋅ Alexa Rank 794.5KView Latest Posts⋅Get Email ContactFollow on Feedspot</p><h3 id="86-Data-Science-at-NIH"><a href="#86-Data-Science-at-NIH" class="headerlink" title="86. Data Science at NIH"></a>86. <a href="https://www.feedspot.com/infiniterss.php?_src=feed_title&amp;followfeedid=4557877&amp;q=site:https%3A%2F%2Fdatascience.nih.gov%2Fblog%2Frss">Data Science at NIH</a></h3><p><img src="https://i1.feedspot.com/4557877.jpeg?t=1536577457" alt="Data Science at NIH">Bethesda, Maryland, United States<strong>About Blog</strong> Official website of Data science at NIH, harnessing Big Data to advance research in biomedical sciences coordinated by the NIH Scientific Data Council and the NIH Office of the Associate Director for Data Science (ADDS). <strong>Blog</strong> <a href="https://datascience.nih.gov/blog[+">https://datascience.nih.gov/blog[+</a> Follow](<a href="https://www.feedspot.com/infiniterss.php?_src=followbtn&amp;followfeedid=4557877&amp;q=site:https%3A%2F%2Fdatascience.nih.gov%2Fblog%2Frss">https://www.feedspot.com/infiniterss.php?_src=followbtn&amp;followfeedid=4557877&amp;q=site:https%3A%2F%2Fdatascience.nih.gov%2Fblog%2Frss</a> rel=)<br>Domain Authority 95 ⋅ Alexa Rank 121View Latest Posts⋅Get Email ContactFollow on Feedspot</p><h3 id="87-District-Data-Labs"><a href="#87-District-Data-Labs" class="headerlink" title="87. District Data Labs"></a>87. <a href="https://www.feedspot.com/infiniterss.php?_src=feed_title&amp;followfeedid=4372120&amp;q=site:http%3A%2F%2Fdistrictdatalabs.silvrback.com%2Ffeed">District Data Labs</a></h3><p><img src="https://i1.feedspot.com/4372120.jpeg" alt="District Data Labs">Washington, District Of Columbia, United States<strong>About Blog</strong> Hands-on data science tutorials, lessons, and other awesome content. <strong>Blog</strong> <a href="https://districtdatalabs.silvrback.com/[+">https://districtdatalabs.silvrback.com/[+</a> Follow](<a href="https://www.feedspot.com/infiniterss.php?_src=followbtn&amp;followfeedid=4372120&amp;q=site:http%3A%2F%2Fdistrictdatalabs.silvrback.com%2Ffeed">https://www.feedspot.com/infiniterss.php?_src=followbtn&amp;followfeedid=4372120&amp;q=site:http%3A%2F%2Fdistrictdatalabs.silvrback.com%2Ffeed</a> rel=)<br>Twitter followers 2.9K ⋅ Domain Authority 50 ⋅ Alexa Rank 687.1KView Latest Posts⋅Get Email ContactFollow on Feedspot</p><h3 id="88-NYU-Center-for-Data-Science"><a href="#88-NYU-Center-for-Data-Science" class="headerlink" title="88. NYU Center for Data Science"></a>88. <a href="https://www.feedspot.com/infiniterss.php?_src=feed_title&amp;followfeedid=4562329&amp;q=site:https%3A%2F%2Fcds.nyu.edu%2Ffeed%2F">NYU Center for Data Science</a></h3><p><img src="https://i1.feedspot.com/4562329.jpg" alt="NYU Center for Data Science">New York, United States<strong>About Blog</strong> The NYU Center for Data Science is a focal point for New York University’s university-wide initiative in data science and statistics. <strong>Blog</strong> <a href="https://cds.nyu.edu/[+">https://cds.nyu.edu/[+</a> Follow](<a href="https://www.feedspot.com/infiniterss.php?_src=followbtn&amp;followfeedid=4562329&amp;q=site:https%3A%2F%2Fcds.nyu.edu%2Ffeed%2F">https://www.feedspot.com/infiniterss.php?_src=followbtn&amp;followfeedid=4562329&amp;q=site:https%3A%2F%2Fcds.nyu.edu%2Ffeed%2F</a> rel=)<br>Facebook fans 8.2K ⋅ Twitter followers 15.6K ⋅ Domain Authority 91 ⋅ Alexa Rank 2.6KView Latest Posts⋅Get Email ContactFollow on Feedspot</p><p>Tags: <a href="https://blog.feedspot.com/data_science_rss_feeds/"><strong>data science rss feeds</strong></a>, <a href="https://www.feedspot.com/news/data_science"><strong>data science news</strong></a>, <a href="https://blog.feedspot.com/data_science_forums/"><strong>data science forums</strong></a></p>]]></content>
      
      
      
        <tags>
            
            <tag> blog </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>THE BEST DATA SCIENCE BLOGS TO FOLLOW IN 2021</title>
      <link href="2021/02/07/the-best-data-science-blogs-to-follow-in-2021/"/>
      <url>2021/02/07/the-best-data-science-blogs-to-follow-in-2021/</url>
      
        <content type="html"><![CDATA[<h1 id="THE-BEST-DATA-SCIENCE-BLOGS-TO-FOLLOW-IN-2021"><a href="#THE-BEST-DATA-SCIENCE-BLOGS-TO-FOLLOW-IN-2021" class="headerlink" title="THE BEST DATA SCIENCE BLOGS TO FOLLOW IN 2021"></a><a href="https://builtin.com/data-science/best-data-science-company-blogs-machine-learning">THE BEST DATA SCIENCE BLOGS TO FOLLOW IN 2021</a></h1><p>The decision by data-driven companies to offer a peek behind the curtain through their blogs has been a win-win. By publishing instructive tutorials and case studies, companies engage a specialized audience who in turn reap the benefits of learning from the best in the field. It’s the antithesis of what, in a worse universe, could have been mere content-marketing chum.</p><p>Through these blogs, many companies carry on the long-term trend toward democratization in data-science education, as seen elsewhere in community competitions, MOOCs and other freely accessible resources. They often favor a combination of approachability and technical or academic rigor, and many companies publish handy primers of emerging concepts or approaches.</p><p>Below you’ll find a cross-section of longstanding must-reads, and several promising newcomers. There are tons of blogs worth following out there, but these 20 entries hopefully offer a good starting point.</p><h2 id="DATA-SCIENCE-AND-MACHINE-LEARNING"><a href="#DATA-SCIENCE-AND-MACHINE-LEARNING" class="headerlink" title="DATA SCIENCE AND MACHINE LEARNING"></a>DATA SCIENCE AND MACHINE LEARNING</h2><h3 id="TENSORFLOW-BLOG"><a href="#TENSORFLOW-BLOG" class="headerlink" title="TENSORFLOW BLOG"></a><img src="https://builtin.com/sites/default/files/styles/ckeditor_optimize/public/inline-images/tensorflow-data-science-company-blogs.png" alt="tensorflow data science company blogs">TENSORFLOW BLOG</h3><p>The official blog of Google’s powerful machine-learning library is regularly updated with digestible how to’s, creative use-case spotlights and introductions to new open-source packages. Whimsical case-study spotlights should engage general-interest readers, while rollout explainers — like the recent <a href="https://blog.tensorflow.org/search?label=TensorFlow+Recommenders&amp;max-results=20">series</a> focused on the new, low-lift TensorFlow Recommender package — will appeal to working data scientists and machine-learning engineers.</p><h3 id="STITCH-FIX’S-MULTITHREADED"><a href="#STITCH-FIX’S-MULTITHREADED" class="headerlink" title="STITCH FIX’S MULTITHREADED"></a><img src="https://builtin.com/sites/default/files/styles/ckeditor_optimize/public/inline-images/stitch-fix-data-science-company-blogs.jpeg" alt="stitch fix data science company blogs">STITCH FIX’S MULTITHREADED</h3><p>The online personal styling service was a trailblazer in data-driven retail, and its <a href="https://multithreaded.stitchfix.com/">MultiThreaded blog</a> reliably keeps a finger on the pulse of real-world data science applications. Posts about the <a href="https://multithreaded.stitchfix.com/blog/2019/03/11/FullStackDS-Generalists/">specialist-vs.-generalist debate</a>, <a href="https://multithreaded.stitchfix.com/blog/2019/05/21/maintainable-etls/">ETL structure</a> and (more recently) <a href="https://multithreaded.stitchfix.com/blog/2020/08/05/bandits/">multi-armed bandits</a> all stirred conversation in data circles. And years after it was published, the company’s Algorithms Tour is still a relevant scrollytelling explainer of how Stitch Fix leverages its 145-plus (!) data scientists for recommender systems, demand modeling, style development and other business facets.</p><p>RELATED<a href="https://builtin.com/data-science/data-science-podcasts">18 Must-Subscribe Data Science Podcasts</a></p><h3 id="INSTACART-MACHINE-LEARNING"><a href="#INSTACART-MACHINE-LEARNING" class="headerlink" title="INSTACART MACHINE LEARNING"></a><img src="https://builtin.com/sites/default/files/styles/ckeditor_optimize/public/inline-images/instacart-data-science-company-blogs.jpeg" alt="instacart data science company blogs">INSTACART MACHINE LEARNING</h3><p>Instacart’s three-million-order <a href="https://www.instacart.com/datasets/grocery-shopping-2017">data set</a> remains a Kaggle-competition go-to and a handy resource for anyone diving into product purchasing analysis. So perhaps it’s no surprise that the grocery service’s <a href="https://tech.instacart.com/">tech blog</a> sports some thoughtful, instructive peeks behind the curtain into its work in <a href="https://tech.instacart.com/tagged/machine-learning">machine learning</a> and <a href="https://tech.instacart.com/tagged/data-science">data science</a>.</p><h3 id="SPOTIFY-R-amp-D-ENGINEERING"><a href="#SPOTIFY-R-amp-D-ENGINEERING" class="headerlink" title="SPOTIFY R&amp;D: ENGINEERING"></a><img src="https://builtin.com/sites/default/files/styles/ckeditor_optimize/public/inline-images/spotify-data-science-company-blogs.jpg" alt="spotify data science company blogs">SPOTIFY R&amp;D: ENGINEERING</h3><p>You won’t find a recipe for Spotify’s recommendation-system secret sauce — a hybrid of content-based and collaborative filtering that’s been crucial to the streaming app’s success — on the company’s blog. But deep-dive contextual explainers of Spotify’s various new frameworks — like <a href="https://engineering.atspotify.com/2020/02/27/how-we-improved-data-discovery-for-data-scientists-at-spotify/">Lexikon</a>, for data discovery, and its new “The Experimentation Platform,” a more data-friendly alternative to traditional A/B testing — are reliably informative reads. Keep an eye on Spotify’s design blog, too, which has interesting data science-related reads like <a href="https://spotify.design/article/designing-data-science-tools-at-spotify">this one</a>.</p><p><a href="https://builtin.com/jobs/data-analytics">View 2389 Jobs</a></p><p>Find out who’s hiring.</p><p>See all <strong>Data + Analytics</strong> jobs at top tech companies &amp; startups</p><p><a href="https://builtin.com/jobs/data-analytics">VIEW 2389 JOBS</a></p><h3 id="NETFLIX-TECHNOLOGY-BLOG"><a href="#NETFLIX-TECHNOLOGY-BLOG" class="headerlink" title="NETFLIX TECHNOLOGY BLOG"></a><img src="https://builtin.com/sites/default/files/styles/ckeditor_optimize/public/inline-images/netflix-data-science-company-blogs.jpg" alt="netflix data science company blogs">NETFLIX TECHNOLOGY BLOG</h3><p>Netflix’s surfeit of user data has allowed for analytics-driven decisions both small (<a href="https://netflixtechblog.com/artwork-personalization-c589f074ad76">algorithmically personalized thumbnail art</a>) and large (<a href="https://netflixtechblog.com/supporting-content-decision-makers-with-machine-learning-995b7b76006f">whether or not a production or title buy is greenlighted</a>). It also means that, whenever Netflix reveals something about the inner workings of its data team, it’s usually worth a look. Recent technical highlights include <a href="https://netflixtechblog.com/bulldozer-batch-data-moving-from-data-warehouse-to-online-key-value-stores-41bac13863f8">how</a> the company batch-moves data from data warehouses to key-value databases and — no biggie — the introduction of a new interdisciplinary field, dubbed <a href="https://netflixtechblog.com/computational-causal-inference-at-netflix-293591691c62">computational causal inference</a>.</p><h3 id="AIRBNB-ENGINEERING-amp-DATA-SCIENCE"><a href="#AIRBNB-ENGINEERING-amp-DATA-SCIENCE" class="headerlink" title="AIRBNB ENGINEERING &amp; DATA SCIENCE"></a><img src="https://builtin.com/sites/default/files/styles/ckeditor_optimize/public/inline-images/airbnb-data-science-company-blogs.jpeg" alt="airbnb data science company blogs">AIRBNB ENGINEERING &amp; DATA SCIENCE</h3><p>The home-rental pioneer was also a data front runner: it famously <a href="https://medium.com/airbnb-engineering/at-airbnb-data-science-belongs-everywhere-917250c6beba">incorporated</a> data science from the outset at a time when few companies did, and it runs an internal data literacy “<a href="https://medium.com/airbnb-engineering/how-airbnb-democratizes-data-science-with-data-university-3eccc71e073a">university</a>” for employees. Not surprisingly, a new <a href="https://medium.com/airbnb-engineering/ai/home">AI/ML</a> or <a href="https://medium.com/airbnb-engineering/data/home">data science</a> blog post from the company often attracts attention. A recent highlight is the <a href="https://medium.com/airbnb-engineering/data-quality-at-airbnb-e582465f3ef7">two</a>-<a href="https://medium.com/airbnb-engineering/data-quality-at-airbnb-870d03080469">part</a> dive into data quality, but we also recommend checking out the classic <a href="https://medium.com/@rchang/a-beginners-guide-to-data-engineering-part-i-4227c5c457d7">A Beginner’s Guide to Data Engineering</a>, which helped define the role as now commonly understood.</p><h3 id="FACEBOOK-AI"><a href="#FACEBOOK-AI" class="headerlink" title="FACEBOOK AI"></a><img src="https://builtin.com/sites/default/files/styles/ckeditor_optimize/public/inline-images/facebook-data-science-company-blogs.png" alt="facebook data science company blogs">FACEBOOK AI</h3><p>Facebook’s engineering blog has consistently noteworthy updates (such as the recent unveiling of the company’s <a href="https://engineering.fb.com/2020/10/09/data-infrastructure/nemo/">data-discovery solution</a>), but the really eye-widening stuff is over on the <a href="https://ai.facebook.com/">AI blog</a>, where Facebook posts its research and academic publications — all of which have big implications far beyond social media. Recent notable entries include <a href="https://ai.facebook.com/blog/fastmri-breakthrough-shows-ai-accelerated-mris-interchangeable-with-slow-traditional-mris/">AI-accelerated MRI tech</a>, <a href="https://research.fb.com/blog/2020/07/introducing-neural-supersampling-for-real-time-rendering/">ML-turbocharged effect-rendering</a> and the <a href="https://ai.facebook.com/research/publications/groknet-unified-computer-vision-model-trunk-and-embeddings-for-commerce/">object-recognition system GrokNet</a>.</p><h3 id="PYTORCH"><a href="#PYTORCH" class="headerlink" title="PYTORCH"></a><img src="https://builtin.com/sites/default/files/styles/ckeditor_optimize/public/inline-images/pytorch-data-science-company-blogs.png" alt="pytorch data science company blogs">PYTORCH</h3><p>Speaking of Facebook Research, perhaps the most notable tool to emerge from FB R&amp;D — the deep-learning framework PyTorch — sports a host of relevant content on its dedicated <a href="https://medium.com/@pytorch">blog</a>. There are plenty of interesting case studies (from <a href="https://medium.com/pytorch/how-datarock-is-using-pytorch-for-more-intelligent-decision-making-d5d1694ba170">Datarock</a> to <a href="https://medium.com/pytorch/how-disney-uses-pytorch-for-animated-character-recognition-a1722a182627">Disney</a>), and a plethora of resources and community support for building and productionizing neural networks.</p><h3 id="WAYFAIR"><a href="#WAYFAIR" class="headerlink" title="WAYFAIR"></a><img src="https://builtin.com/sites/default/files/styles/ckeditor_optimize/public/inline-images/wayfair-data-science-company-blogs.jpeg" alt="wayfair data science company blogs">WAYFAIR</h3><p>Wayfair may have only just recently <a href="https://fortune.com/2020/08/05/wayfair-profitable-profits-covid-19-spending-surge-coronavirus-shopping-furniture/">posted a profit</a>, but the digital-only furniture retailer’s early bet on data appears to have paid dividends on personalization, price modeling, computer vision-driven categorization and other key areas. Unfortunately, the <a href="https://tech.wayfair.com/data-science/blog/">blog</a> updates don’t come as often as they did in the past, it seems. Nevertheless, 2020 highlights like <a href="https://tech.wayfair.com/data-science/2020/02/how-to-enable-data-scientists-to-stop-managing-etl-pipelines-and-get-back-to-doing-data-science-part-i/">an ETL automation guide</a> and <a href="https://tech.wayfair.com/data-science/2020/01/bayesian-product-ranking-at-wayfair/">a breakdown of its Bayesian approach</a> to determining what furniture will have the broadest appeal prove there’s still plenty of useful, day-to-day-data-science content in the pipeline.</p><p><a href="https://builtin.com/jobs/data-analytics">View 2389 Jobs</a></p><p>Find out who’s hiring.</p><p>See all <strong>Data + Analytics</strong> jobs at top tech companies &amp; startups</p><p><a href="https://builtin.com/jobs/data-analytics">VIEW 2389 JOBS</a></p><h3 id="UBER-ENGINEERING"><a href="#UBER-ENGINEERING" class="headerlink" title="UBER ENGINEERING"></a><img src="https://builtin.com/sites/default/files/styles/ckeditor_optimize/public/inline-images/uber-data-science-company-blogs.png" alt="uber data science company blogs">UBER ENGINEERING</h3><p>Even though the ride-hailing company has discontinued its Uber AI Labs division and offloaded its self-driving-car focus, its ample computer vision and neural network research remains available <a href="https://eng.uber.com/">here</a>, along with regularly published updates under the <a href="https://eng.uber.com/category/articles/ai/">AI</a> and <a href="https://eng.uber.com/category/articles/uberdata/">Uber Data</a> categories. It was here that Uber popularized the concept of <a href="https://eng.uber.com/michelangelo-machine-learning-platform/">feature stores</a> and made waves with its Postgres-to-MySQL migration <a href="https://eng.uber.com/postgres-to-mysql-migration/">announcement</a>.</p><h3 id="SHOPIFY-DATA-SCIENCE-amp-ENGINEERING"><a href="#SHOPIFY-DATA-SCIENCE-amp-ENGINEERING" class="headerlink" title="SHOPIFY DATA SCIENCE &amp; ENGINEERING"></a><img src="https://builtin.com/sites/default/files/styles/ckeditor_optimize/public/inline-images/shopify-data-science-company-blogs.png" alt="shopify data science company blogs">SHOPIFY DATA SCIENCE &amp; ENGINEERING</h3><p>Updated monthly, <a href="https://shopify.engineering/topics/data-science-engineering">the data science section</a> of Shopify’s engineering blog offers readable, actionable lessons learned from the payment platform’s dramatic, <a href="https://builtin.com/software-engineering-perspectives/data-engineering">data-driven rise</a>. A walkthrough post about <a href="https://shopify.engineering/solving-data-discovery-challenges-shopify">data documentation</a> — a thorny challenge that teams often have to self-solve — and a high-level overview of Shopify’s foundational data and engineering <a href="https://shopify.engineering/shopifys-data-science-engineering-foundations">principles</a> were both widely shared and discussed in data engineering and data science circles.</p><p>RELATED<a href="https://builtin.com/data-science/free-datasets">18 Free, Skill-Building Data Sets, Recommended by Experts</a></p><h3 id="TECTON"><a href="#TECTON" class="headerlink" title="TECTON"></a><img src="https://builtin.com/sites/default/files/styles/ckeditor_optimize/public/inline-images/tecton-data-science-company-blogs.png" alt="tecton data science company blogs">TECTON</h3><p>Speaking of Uber and feature stores, three of the engineers who built Michelangelo eventually went on to found Tecton. It offers an ML platform that transforms and stores raw data as feature values. Since emerging from stealth in mid-2020, the Andreessen Horowitz- and Sequoia Capital-funded startup has also been <a href="https://www.tecton.ai/blog/">publishing</a> informative, engaging posts about machine learning and model reproducibility. Missives on <a href="https://www.tecton.ai/blog/devops-ml-data/">MLOps</a>, <a href="https://www.tecton.ai/blog/what-is-a-feature-store/">feature stores</a> and <a href="https://www.tecton.ai/blog/time-travel-in-ml/">data leakage</a> are all well worth a read.</p><h3 id="THE-SIGNAL-BY-MIXPANEL"><a href="#THE-SIGNAL-BY-MIXPANEL" class="headerlink" title="THE SIGNAL BY MIXPANEL"></a><img src="https://builtin.com/sites/default/files/styles/ckeditor_optimize/public/inline-images/mixpanel-data-science-company-blogs.png" alt="mixpanel data science company blogs">THE SIGNAL BY MIXPANEL</h3><p>An early prominent rebuke of vanity metrics — or, as dubbed here — “<a href="https://mixpanel.com/blog/bs-metrics/">bullshit metrics</a>” came courtesy of analytics platform Mixpanel. Years later, <a href="https://mixpanel.com/blog/">The Signal</a> still regularly dishes up digestible advice on product data, product metrics and long- and short-term growth — often from a business-intelligence perspective.</p><h3 id="JUPYTER-BLOG"><a href="#JUPYTER-BLOG" class="headerlink" title="JUPYTER BLOG"></a><img src="https://builtin.com/sites/default/files/styles/ckeditor_optimize/public/inline-images/jupyter-data-science-company-blogs.png" alt="jupyter data science company blogs">JUPYTER BLOG</h3><p>Not a company blog per se, but the <a href="https://blog.jupyter.org/">official blog</a> of the non-profit Project Jupyter is something of a focal point for the game-changing, data-access computational notebook. Readers will find community announcements, novel use cases and — most notably — must-know release updates, kernel debuts and assorted new tools.</p><h3 id="FLOYDHUB-BLOG"><a href="#FLOYDHUB-BLOG" class="headerlink" title="FLOYDHUB BLOG"></a><img src="https://builtin.com/sites/default/files/styles/ckeditor_optimize/public/inline-images/floydhub-data-science-company-blogs.jpeg" alt="floydhub data science company blogs">FLOYDHUB BLOG</h3><p>The regularly updated, reliably informative <a href="https://blog.floydhub.com/">blog</a> at this deep learning platform and Y Combinator alum has solidified itself as a trusted resource over the last three years. Penned by the company’s own data scientists and a roster of knowledgeable outside contributors (from organizations such as Microsoft Research, Intercom and Cognizant), posts are visualization-dense, code-snippet-packed deep dives on DL and ML concepts and approaches. Be sure to catch the ongoing “<a href="https://blog.floydhub.com/tag/humans-of-ml/">Humans of Machine Learning</a>” series — Q&amp;As with ML notables, by turns philosophical and instructional.</p><h3 id="DOMINO-DATA-LAB"><a href="#DOMINO-DATA-LAB" class="headerlink" title="DOMINO DATA LAB"></a><img src="https://builtin.com/sites/default/files/styles/ckeditor_optimize/public/inline-images/domino-data-science-company-blogs.jpeg" alt="domino data science company blogs">DOMINO DATA LAB</h3><p>Domino’s stated editorial mission is to remain “hyper focused on learning and understanding how to help data scientists accelerate their work,” and its frequently updated <a href="https://blog.dominodatalab.com/">blog</a> offers a deep and wide sampler of professional development-focused content. Topics range from high-level (causal inference, dealing with disappointing model outcomes) to granular (GAN evaluation, data drift detection in image classification), and the tone is a thoughtful blend of technical and approachable.</p><h2 id="DATA-VISUALIZATION"><a href="#DATA-VISUALIZATION" class="headerlink" title="DATA VISUALIZATION"></a>DATA VISUALIZATION</h2><h3 id="TABLEAU-BLOG"><a href="#TABLEAU-BLOG" class="headerlink" title="TABLEAU BLOG"></a><img src="https://builtin.com/sites/default/files/styles/ckeditor_optimize/public/inline-images/tableau-data-science-company-blogs.png" alt="tableau data science company blogs">TABLEAU BLOG</h3><p>Approachable and frequently updated, the Tableau <a href="https://www.tableau.com/about/blog">blog</a> covers data-viz topics ranging from product updates to data literacy to COVID-19, which cast into stark relief the importance of data-visualization clarity. Regular contributors include CTO Andrew Beers and (noted <a href="https://builtin.com/data-science/bar-chart-races">bar-chart-race skeptic</a>) Andy Cotgreave. The <a href="https://engineering.tableau.com/">Engineering blog</a> is worth a look too. A standout entry: the <a href="https://engineering.tableau.com/truncating-the-y-axis-threat-or-menace-d0bce66d4d08">companion blog</a> to a paper that Tableau researchers authored on the eternally debated question of whether truncating a graph’s y-axis is ever acceptable.</p><h3 id="CHARTABLE-BY-DATAWRAPPER"><a href="#CHARTABLE-BY-DATAWRAPPER" class="headerlink" title="CHARTABLE BY DATAWRAPPER"></a><img src="https://builtin.com/sites/default/files/styles/ckeditor_optimize/public/inline-images/datawrapper-data-science-company-blogs.jpeg" alt="datawrapper data science company blogs">CHARTABLE BY DATAWRAPPER</h3><p><a href="https://blog.datawrapper.de/">Chartable</a> (not to be confused with the podcast-analytics startup with which it shares a name) gathers in-house data-visualization service journalism in its <a href="https://blog.datawrapper.de/category/thoughts-how-to-s/">How To’s</a> — including a Data Vis Book Club — while also posting and dissecting a new weekly chart. Those range from important, historical-minded <a href="https://blog.datawrapper.de/weekly-chart-presidential-elections/">voting analysis</a> to fun toy projects, like <a href="https://blog.datawrapper.de/weekly-ridgeline-plot/">charting the data set</a> visualized on Joy Division’s <em>Unknown Pleasures</em> album.</p><h3 id="OBSERVABLE’S-NOTEBOOKS"><a href="#OBSERVABLE’S-NOTEBOOKS" class="headerlink" title="OBSERVABLE’S NOTEBOOKS"></a><img src="https://builtin.com/sites/default/files/styles/ckeditor_optimize/public/inline-images/observable-data-science-company-blogs.png" alt="observable data science company blogs">OBSERVABLE’S NOTEBOOKS</h3><p>This visualization platform, co-founded by former <em>New York Times</em> data journalist Mike Bostock, has become a favored platform for data visualization practitioners who desire more code-friendly customization than plug-and-play alternatives. Meanwhile, Observable’s own <a href="https://observablehq.com/@observablehq">profile</a> serves as a repository for staff-pick highlights, creator spotlights, how-to demos, forkable notebooks created by staff and the occasional critical explainer — like <a href="https://observablehq.com/@observablehq/why-use-a-radial-data-visualization">this excellent entry</a> on when it might make sense to use the oft-derided radial visualization.</p><h3 id="PLOTLY"><a href="#PLOTLY" class="headerlink" title="PLOTLY"></a><img src="https://builtin.com/sites/default/files/styles/ckeditor_optimize/public/inline-images/plotly-data-science-company-blogs.png" alt="plotly data science company blogs">PLOTLY</h3><p>Not surprisingly, several posts on Plotly’s page spotlight updates and thorough pairing tutorials for its flagship offering, Dash (recent walkthroughs include using Dash with <a href="https://medium.com/plotly/introducing-dash-holoviews-6a05c088ebe5">HoloViews</a> and <a href="https://medium.com/plotly/building-and-deploying-explainable-ai-dashboards-using-dash-and-shap-8e0a0a45beb6">SHAP</a>). At the same time, it stays varied with broader-interest (for the ML-practitioner crowd, anyway) posts, such as <a href="https://medium.com/plotly/the-history-of-autonomous-vehicle-datasets-and-3-open-source-python-apps-for-visualizing-them-afee9d13f58a">a history of autonomous-vehicle data sets</a>, <a href="https://medium.com/plotly/understanding-word-embedding-arithmetic-why-theres-no-single-answer-to-king-man-woman-cd2760e2cb7f">word-embedding logic</a> and — per Plotly’s metier — <a href="https://medium.com/plotly/data-visualization-for-artificial-intelligence-and-vice-versa-a38869065d88">data visualization for AI</a>.</p><p>RELATED<a href="https://builtin.com/artificial-intelligence/emotion-ai">Emotion AI Has Great Promise (When Used Responsibly)</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> blog </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>18 MUST-SUBSCRIBE DATA SCIENCE PODCASTS</title>
      <link href="2021/02/07/18-must-subscribe-data-science-podcasts/"/>
      <url>2021/02/07/18-must-subscribe-data-science-podcasts/</url>
      
        <content type="html"><![CDATA[<h1 id="18-MUST-SUBSCRIBE-DATA-SCIENCE-PODCASTS"><a href="#18-MUST-SUBSCRIBE-DATA-SCIENCE-PODCASTS" class="headerlink" title="18 MUST-SUBSCRIBE DATA SCIENCE PODCASTS"></a>18 MUST-SUBSCRIBE DATA SCIENCE PODCASTS</h1><p>The best listens for data science, data visualization, machine learning and artificial intelligence.</p><p>Stephen Gossett</p><p>November 10, 2020</p><p>Updated: January 27, 2021</p><p><a href="https://builtin.com/#linkedin">LinkedIn</a><a href="https://builtin.com/#hacker_news">Hacker News</a><a href="https://builtin.com/#reddit">Reddit</a><a href="https://builtin.com/#twitter">Twitter</a><a href="https://builtin.com/#facebook">Facebook</a></p><p>The podcast boom and the rise of data and analytics roughly coincided, so it follows that there’d be a plethora of data science podcasts out there. At the same time, the landscape has shifted a fair amount in recent years, with promising newcomers arriving and several old favorites hanging up the mic. (RIP Linear Digressions.)</p><p>In our attempt to round up the best data science podcasts out there, we cast a wide net. We looked at data science, plus its more glamorous siblings machine learning and artificial intelligence, while also making room for a few broad-appeal wildcards. There are plenty more data podcasts out there, to be sure, but this list should help give you a sense of what you like.</p><h2 id="GENERAL-INTEREST"><a href="#GENERAL-INTEREST" class="headerlink" title="GENERAL INTEREST"></a>GENERAL INTEREST</h2><h3 id="FIVETHIRTYEIGHT-POLITICS"><a href="#FIVETHIRTYEIGHT-POLITICS" class="headerlink" title="FIVETHIRTYEIGHT POLITICS"></a><img src="https://builtin.com/sites/default/files/styles/ckeditor_optimize/public/inline-images/fivethirtyeight.png" alt="fivethirtyeight">FIVETHIRTYEIGHT POLITICS</h3><p>“Probabilities have gone mainstream,” said FiveThirtyEight senior political writer Clare Malone on a November episode ahead of the 2020 presidential election. No outlet has done more to make that so than Nate Silver’s home for data-driven political analysis, and its flagship podcast — which reliably ranks in Apple’s Top Charts — has played a major role in that.</p><p><strong>Listen</strong>: <a href="https://open.spotify.com/show/3C0iP88KSoGZk5KNWmuyF1">Spotify</a>, <a href="https://podcasts.apple.com/us/podcast/fivethirtyeight-politics/id1077418457">Apple</a></p><h3 id="HOT-TAKEDOWN"><a href="#HOT-TAKEDOWN" class="headerlink" title="HOT TAKEDOWN"></a><img src="https://builtin.com/sites/default/files/styles/ckeditor_optimize/public/inline-images/hot-takedown.png" alt="hot takedown">HOT TAKEDOWN</h3><p>Before diving into political models, Nate Silver made his data-analysis bones in baseball, developing the PECOTA forecasting system. Turns out, FiveThirtyEight remains a great resource for analytics-minded sports coverage. As the name implies, Hot Takedown challenges hot-take narratives with (approachable) stats-rooted skepticism and ends with fun, edifying tangents in the Rabbit Hole segment.</p><p><strong>Listen</strong>: <a href="https://open.spotify.com/show/08dOnBbIivij3aWDZS3uwW">Spotify</a>, <a href="https://podcasts.apple.com/us/podcast/hot-takedown/id1456065200">Apple</a></p><p><a href="https://builtin.com/jobs/data-analytics">View 2389 Jobs</a></p><p>Find out who’s hiring.</p><p>See all <strong>Data + Analytics</strong> jobs at top tech companies &amp; startups</p><p><a href="https://builtin.com/jobs/data-analytics">VIEW 2389 JOBS</a></p><h3 id="FREAKONOMICS-RADIO"><a href="#FREAKONOMICS-RADIO" class="headerlink" title="FREAKONOMICS RADIO"></a><img src="https://builtin.com/sites/default/files/styles/ckeditor_optimize/public/inline-images/freakonomics-radio.png" alt="freakonomics radio">FREAKONOMICS RADIO</h3><p>Coupled with the book from which it was spun, Freakonomics Radio — for better or worse — ushered in a new wave of pop statistics and sociology. (Host Stephen J. Dubner co-wrote the podcast’s 2005 bestseller namesake.) At its best, the show, which debuted in 2010 and also airs on NPR, blends data and accessible storytelling to reveal unexpected findings and connections — “the hidden side of everything,” as the tagline goes.</p><p><strong>Listen</strong>: <a href="https://open.spotify.com/show/6z4NLXyHPga1UmSJsPK7G1">Spotify</a>, <a href="https://podcasts.apple.com/us/podcast/freakonomics-radio/id354668519">Apple</a></p><h3 id="IN-MACHINES-WE-TRUST"><a href="#IN-MACHINES-WE-TRUST" class="headerlink" title="IN MACHINES WE TRUST"></a><img src="https://builtin.com/sites/default/files/styles/ckeditor_optimize/public/inline-images/in-machines-we-trust.jpg" alt="in machines we trust">IN MACHINES WE TRUST</h3><p>Produced by <em>MIT Technology Review</em>, this recently launched podcast tackles some of the biggest-headline issues related to artificial intelligence today, with approachable framing and deep reporting. Host Jennifer Strong has probed misinformation with Twitter’s CTO, self-driving-car distrust with the head of UX at Waymo, and — in a four-part series about facial recognition — the head of the notorious Clearview AI.</p><p><strong>Listen</strong>: <a href="https://open.spotify.com/show/6QefEeY1IKYVn5w6nUV83Y">Spotify</a>, <a href="https://podcasts.apple.com/us/podcast/in-machines-we-trust/id1523584878">Apple</a></p><p>RELATED<a href="https://builtin.com/machine-learning/library-congress">Machine Learning Will Push Library of Congress Research Forward</a></p><h2 id="DEEPER-INTO-DATA-SCIENCE"><a href="#DEEPER-INTO-DATA-SCIENCE" class="headerlink" title="DEEPER INTO DATA SCIENCE"></a>DEEPER INTO DATA SCIENCE</h2><h3 id="NOT-SO-STANDARD-DEVIATIONS"><a href="#NOT-SO-STANDARD-DEVIATIONS" class="headerlink" title="NOT SO STANDARD DEVIATIONS"></a><img src="https://builtin.com/sites/default/files/styles/ckeditor_optimize/public/inline-images/not-so-standard-deviations.png" alt="not so standard deviations">NOT SO STANDARD DEVIATIONS</h3><p>This podcast is hosted by Hilary Parker — formerly of Stitch Fix and Etsy, now heading Joe Biden’s data team — and Roger Peng, of the Johns Hopkins Department of Biostatistics. Together, they explore data-related news of the moment, like when an Excel error wiped out thousands of coronavirus cases from a U.K. data set, as well as more technical topics like what the future holds for R. The mix of approachability and weedsiness makes it one of the best podcasts out there.</p><p><strong>Listen</strong>: <a href="https://open.spotify.com/show/1NJ6li5ZpNVBBQfpd3D6bi">Spotify</a>, <a href="https://podcasts.apple.com/us/podcast/not-so-standard-deviations/id1040614570">Apple</a></p><h3 id="TALK-PYTHON-TO-ME"><a href="#TALK-PYTHON-TO-ME" class="headerlink" title="TALK PYTHON TO ME"></a><img src="https://builtin.com/sites/default/files/styles/ckeditor_optimize/public/inline-images/talk-python-to-me.png" alt="talk python to me">TALK PYTHON TO ME</h3><p>Podcasts aren’t great as a standalone educational tool for learning data science, but they can be a handy supplement. This weekly show dives into the foremost data science programming language and its constellation of libraries, APIs and frameworks, buttressed by interviews with people doing cool things with Python. Other notable Python-related entries include <a href="https://www.pythonpodcast.com/">The Python Podcast.<strong>init</strong> -</a> and <a href="https://realpython.com/podcasts/rpp/">The Real Python Podcast</a>.</p><p><strong>Listen</strong>: <a href="https://podcasts.apple.com/us/podcast/talk-python-to-me/id979020229">Apple</a></p><h3 id="TOWARDS-DATA-SCIENCE"><a href="#TOWARDS-DATA-SCIENCE" class="headerlink" title="TOWARDS DATA SCIENCE"></a><img src="https://builtin.com/sites/default/files/styles/ckeditor_optimize/public/inline-images/towards-data-science.jpg" alt="towards data science">TOWARDS DATA SCIENCE</h3><p>Like its affiliated Medium publication, this practitioner-focused podcast chews over concerns faced by professional data scientists, ranging from automated data cleaning to model evaluation, networking and job-seeking. Its hosts also welcome guests to explore more conceptual and high-level topics, like data privacy, AI ethics and non-technical data science skills.</p><p><strong>Listen</strong>: <a href="https://open.spotify.com/show/63diy2DtpHzQfeNVxAPZgU">Spotify</a>, <a href="https://podcasts.apple.com/us/podcast/towards-data-science/id1470952338">Apple</a></p><h3 id="WOMEN-IN-DATA-SCIENCE"><a href="#WOMEN-IN-DATA-SCIENCE" class="headerlink" title="WOMEN IN DATA SCIENCE"></a><img src="https://builtin.com/sites/default/files/styles/ckeditor_optimize/public/inline-images/women-in-data-science.png" alt="women in data science">WOMEN IN DATA SCIENCE</h3><p>When not teaching or researching engineering analytics at Stanford University, Margot Gerritsen hosts the Women in Data Science podcast. (She also co-directs the WiDS conference.) Each monthly interview tackles a pressing business or social topic with a notable guest — such as online shopping optimization with Walmart group product manager Sonu Durgia, or diversity and inclusion in AI with Timnit Gebru.</p><p><strong>Listen</strong>: <a href="https://open.spotify.com/show/0eaFZXUh8qys3c0Wr3vrA3">Spotify</a>, <a href="https://podcasts.apple.com/us/podcast/women-in-data-science/id1440076586">Apple</a></p><p><a href="https://builtin.com/jobs/data-analytics">View 2389 Jobs</a></p><p>Find out who’s hiring.</p><p>See all <strong>Data + Analytics</strong> jobs at top tech companies &amp; startups</p><p><a href="https://builtin.com/jobs/data-analytics">VIEW 2389 JOBS</a></p><h3 id="THE-DATA-EXCHANGE"><a href="#THE-DATA-EXCHANGE" class="headerlink" title="THE DATA EXCHANGE"></a><img src="https://builtin.com/sites/default/files/styles/ckeditor_optimize/public/inline-images/the-data-exchange.png" alt="the data exchange">THE DATA EXCHANGE</h3><p>Each week, Ben Lorica welcomes leading machine learning engineers and data scientists to explore the nitty-gritty of different techniques and how they can help tackle major challenges. Recent highlights include Kira Radinsky, who famously built software that predicted a once-in-a-generation cholera outbreak, and Viral Shah, co-creator of Julia. Note: Lorica formerly hosted <a href="https://www.oreilly.com/radar/topics/oreilly-data-show-podcast/">O’Reilly’s data podcast</a>, when he served as chief data scientist for the publisher. That show is no longer active, but the archive is full of great content for those who missed the original run.</p><p><strong>Listen</strong>: <a href="https://open.spotify.com/show/65oFWYoomwT8mLcdGkUGd0">Spotify</a>, <a href="https://podcasts.apple.com/us/podcast/the-data-exchange-with-ben-lorica/id1487704458">Apple</a></p><h3 id="DATA-SKEPTIC"><a href="#DATA-SKEPTIC" class="headerlink" title="DATA SKEPTIC"></a><img src="https://builtin.com/sites/default/files/styles/ckeditor_optimize/public/inline-images/data-skeptic.jpg" alt="data skeptic">DATA SKEPTIC</h3><p>When this podcast started in 2014, it alternated between two formats: mini-episodes in which host and data scientist Kyle Polich would discuss a statistics principle or modeling techniques with his partner, Linh Da Tran, a stats layperson; and deeper-dive interviews with guests whose work confront some notable data science concern of the moment. Nowadays, the latter predominates, which is just as well, as the guest booking — which sometimes revolves around a standalone miniseries theme — is consistently of high quality.</p><p><strong>Listen</strong>: <a href="https://open.spotify.com/show/1BZN7H3ikovSejhwQTzNm4">Spotify</a>, <a href="https://podcasts.apple.com/us/podcast/data-skeptic/id890348705">Apple</a></p><h3 id="THE-BANANA-DATA-PODCAST"><a href="#THE-BANANA-DATA-PODCAST" class="headerlink" title="THE BANANA DATA PODCAST"></a><img src="https://builtin.com/sites/default/files/styles/ckeditor_optimize/public/inline-images/banana-data.png" alt="banana data">THE BANANA DATA PODCAST</h3><p>Dataiku has launched some strong supplemental media as it’s climbed to become one of the best-known data science platforms out there. That includes a well-curated newsletter and this layperson-friendly podcast. Episodes are easily digestible (30 minutes or fewer) and topics have included the high costs of AI, human-in-the-loop monitoring and the eternal R vs. Python debate.</p><p><strong>Listen</strong>: <a href="https://open.spotify.com/show/3uZK2aPeVwnADRqyYR4nt0">Spotify</a>, <a href="https://podcasts.apple.com/us/podcast/the-banana-data-podcast/id1463103655">Apple</a></p><h3 id="CASUAL-INFERENCE"><a href="#CASUAL-INFERENCE" class="headerlink" title="CASUAL INFERENCE"></a><img src="https://builtin.com/sites/default/files/styles/ckeditor_optimize/public/inline-images/casual-inference.jpg" alt="casual inference">CASUAL INFERENCE</h3><p>Sponsored by the <em>American Journal of Epidemiology</em> and hosted by a biostatistician and a Boston University public-health epidemiologist, this data-centric public-health podcast — which premiered in November of last year — surely got a boost of interest amid the pandemic, bringing data science insights to its coverage while also offering other data-related counterprogramming. Don’t be intimidated by the domain specificity; non-whitecoats will find much to appreciate as they discuss topics like uncertainty communication, Bayesian statistics and machine learning fairness.</p><p><strong>Listen</strong>: <a href="https://open.spotify.com/show/1L8TqB17Peo7jNgXuPObwi">Spotify</a>, <a href="https://podcasts.apple.com/us/podcast/casual-inference/id1485892859">Apple</a></p><p>RELATED<a href="https://builtin.com/machine-learning/synthetic-data">Synthetic Data: How AI Uses Fake Data for Genuine Gains</a></p><h2 id="MACHINE-LEARNING-AND-ARTIFICIAL-INTELLIGENCE"><a href="#MACHINE-LEARNING-AND-ARTIFICIAL-INTELLIGENCE" class="headerlink" title="MACHINE LEARNING AND ARTIFICIAL INTELLIGENCE"></a>MACHINE LEARNING AND ARTIFICIAL INTELLIGENCE</h2><h3 id="GRADIENT-DISSENT"><a href="#GRADIENT-DISSENT" class="headerlink" title="GRADIENT DISSENT"></a><img src="https://builtin.com/sites/default/files/styles/ckeditor_optimize/public/inline-images/gradient-dissent.png" alt="gradient dissent">GRADIENT DISSENT</h3><p>This machine learning-focused newcomer only debuted in March, but has been going strong out of the gate. Created by ML software tool developer Weights &amp; Biases, Gradient Dissent (get it?) has so far welcomed an AI leader from NVIDIA to discuss computer vision for self-driving cars, one of the core developers behind the spaCy NLP library, and the director of applied machine learning at Facebook, among other notables.</p><p><strong>Listen</strong>: <a href="https://open.spotify.com/show/7o9r3fFig3MhTJwehXDbXm">Spotify</a>, <a href="https://podcasts.apple.com/us/podcast/gradient-dissent-a-machine-learning-podcast-by-w-b/id1504567418">Apple</a></p><h3 id="TALKING-MACHINES"><a href="#TALKING-MACHINES" class="headerlink" title="TALKING MACHINES"></a><img src="https://builtin.com/sites/default/files/styles/ckeditor_optimize/public/inline-images/talking-machines.jpg" alt="talking machines">TALKING MACHINES</h3><p>Since 2014, WBUR radio veteran Katherine Gorman and University of Cambridge machine learning professor Neil Lawrence have offered approachable yet in-depth coverage of machine learning research and issues on Talking Machines. In the most recent season, the pair started digitally inviting audiences to live-recorded episodes in order to boost interactivity and community during the pandemic. The experiment proved successful and continues today.</p><p><strong>Listen</strong>: <a href="https://open.spotify.com/show/0gKf364z7Vri0wbNXsHd2B">Spotify</a>, <a href="https://podcasts.apple.com/us/podcast/talking-machines/id955198749">Apple</a></p><h3 id="LET’S-TALK-AI"><a href="#LET’S-TALK-AI" class="headerlink" title="LET’S TALK AI"></a><img src="https://builtin.com/sites/default/files/styles/ckeditor_optimize/public/inline-images/lets-talk-ai.png" alt="lets talk ai">LET’S TALK AI</h3><p>Like the Skynet Today site that hosts it, Let’s Talk AI aims to cut through the breathless hype and fearmongering that often accompanies emergent tech coverage. It’s “where you can hear from AI researchers about what’s actually going on with AI and what’s just clickbait headlines,” as the weekly intro goes. The Stanford University-supported show does so via two recurring formats: deep-dive-yet-engaging interviews with researchers and a “Last Week in AI” digest, in which contributors unpack recent news.</p><p><strong>Listen</strong>: <a href="https://open.spotify.com/show/17HiNdxcoKJLLNibIAyUch">Spotify</a>, <a href="https://podcasts.apple.com/us/podcast/lets-talk-ai/id1502782720">Apple</a></p><h3 id="THE-TWIMLAI-PODCAST"><a href="#THE-TWIMLAI-PODCAST" class="headerlink" title="THE TWIMLAI PODCAST"></a><img src="https://builtin.com/sites/default/files/styles/ckeditor_optimize/public/inline-images/twimlai.jpg" alt="twimlai">THE TWIMLAI PODCAST</h3><p>Host Sam Charrington and guests explore emerging machine learning research and trends, plus how ML is impacting industry. (The titular acronym stands for This Week in Machine Learning &amp; Artificial Intelligence.) Recent guests include Mike del Balso, who helped modernize feature stores at Uber, and Sasha Luccioni, who studies how GANs can model the effects of climate change. Shows are often <a href="https://twimlai.com/series/">grouped by theme</a>, which have included Black in AI and NeurIPS-related series.</p><p><strong>Listen</strong>: <a href="https://open.spotify.com/show/2sp5EL7s7EqxttxwwoJ3i7">Spotify</a>, <a href="https://podcasts.apple.com/us/podcast/twiml-ai-podcast-formerly-this-week-in-machine-learning/id1116303051">Apple</a></p><h2 id="DATA-VISUALIZATION"><a href="#DATA-VISUALIZATION" class="headerlink" title="DATA VISUALIZATION"></a>DATA VISUALIZATION</h2><h3 id="THE-POLICYVIZ-PODCAST"><a href="#THE-POLICYVIZ-PODCAST" class="headerlink" title="THE POLICYVIZ PODCAST"></a><img src="https://builtin.com/sites/default/files/styles/ckeditor_optimize/public/inline-images/policyviz.jpg" alt="policyviz">THE POLICYVIZ PODCAST</h3><p>Think an audio medium can’t do justice to data visualization? Jonathan Schwabish’s long-running podcast proves otherwise. Since 2015, the host and author of <em>Better Presentations</em> has interviewed some of the most notable thought leaders in data viz — including Andy Kirk, Alberto Cairo, John Burn-Murdoch, Christine Zhang and many others — and the conversations always engage and edify.</p><p><strong>Listen</strong>: <a href="https://open.spotify.com/show/3KWkTCoMWYf3KWqISoZqFg">Spotify</a>, <a href="https://podcasts.apple.com/us/podcast/the-policyviz-podcast/id982966091">Apple</a></p><h3 id="DATA-STORIES"><a href="#DATA-STORIES" class="headerlink" title="DATA STORIES"></a><img src="https://builtin.com/sites/default/files/styles/ckeditor_optimize/public/inline-images/data-stories.png" alt="data stories">DATA STORIES</h3><p>Co-hosts Enrico Bertini, an information visualization professor at New York University, and Moritz Stefaner, an independent data viz consultant, have put together a who’s-who roster of guests since launching Data Stories in 2012. Early guests include Jeffrey Heer, Giorgia Lupi, Jer Thorp and Tamara Munzer. Among the recent standout visitors are animation expert Barbara Tversky and Flourish CEO Duncan Clark.</p><p><strong>Listen</strong>: <a href="https://open.spotify.com/show/0aIvhK1ANin1kSOKRhWG1M">Spotify</a>, <a href="https://podcasts.apple.com/us/podcast/data-stories/id502854960">Apple</a></p><p>RELATED<a href="https://builtin.com/operations/best-operations-podcasts">17 Podcasts for Operations Pros</a></p><p><a href="https://builtin.com/#linkedin">LinkedIn</a><a href="https://builtin.com/#hacker_news">Hacker News</a><a href="https://builtin.com/#reddit">Reddit</a><a href="https://builtin.com/#twitter">Twitter</a><a href="https://builtin.com/#facebook">Facebook</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> blog </tag>
            
            <tag> Data Science </tag>
            
            <tag> Machine Learning </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Top 20 Data Science Blogs And Websites For Data Scientists</title>
      <link href="2021/02/07/top-20-data-science-blogs-and-websites-for-data-scientists/"/>
      <url>2021/02/07/top-20-data-science-blogs-and-websites-for-data-scientists/</url>
      
        <content type="html"><![CDATA[<h1 id="Top-20-Data-Science-Blogs-And-Websites-For-Data-Scientists"><a href="#Top-20-Data-Science-Blogs-And-Websites-For-Data-Scientists" class="headerlink" title="Top 20 Data Science Blogs And Websites For Data Scientists"></a><a href="https://www.exastax.com/big-data/top-20-data-science-blogs-websites/">Top 20 Data Science Blogs And Websites For Data Scientists</a></h1><p><a href="https://www.exastax.com/big-data/top-20-data-science-blogs-websites/"><img src="https://miro.medium.com/max/60/0*AV7o53oKnwtuI3EY.png?q=20" alt="Image for post"><img src="https://miro.medium.com/max/1676/0*AV7o53oKnwtuI3EY.png" alt="Image for post"></a></p><p>The field of Data Science is constantly growing, enabling businesses to become more data-driven with better insights and knowledge. Whether you’re a professional working in the field of data science or a student, take a look at these <strong><em>Top 20 Data Science Blogs\</em></strong> that are frequently updated and with the highest number of followers. Never miss any developments in Data Science.</p><h1 id="1-Data-Science-Reddit"><a href="#1-Data-Science-Reddit" class="headerlink" title="1- Data Science | Reddit"></a>1- Data Science | Reddit</h1><p><img src="https://miro.medium.com/max/60/0*2Q5heVhpWm_qGDyR.png?q=20" alt="Image for post"></p><p><img src="https://miro.medium.com/max/643/0*2Q5heVhpWm_qGDyR.png" alt="Image for post"></p><p><strong>About Blog-</strong> An American social news aggregation, web content rating, and <em>discussion website.</em> Reddit’s registered community members can submit content such as text posts or direct links.</p><p><strong>Frequency —</strong> About 84 posts per week</p><p>Facebook Fans: <strong>1,108,745</strong></p><p>Twitter Followers: <strong>511K</strong></p><p><a href="https://www.reddit.com/r/datascience/">Follow</a></p><h1 id="2-Data-Science-Google-News"><a href="#2-Data-Science-Google-News" class="headerlink" title="2- Data Science | Google News"></a>2- Data Science | Google News</h1><p><img src="https://miro.medium.com/max/60/0*S3IelBcBTZPMyrOw.png?q=20" alt="Image for post"></p><p><img src="https://miro.medium.com/max/488/0*S3IelBcBTZPMyrOw.png" alt="Image for post"></p><p><strong>About blog</strong> — Comprehensive up-to-date news coverage, aggregated from sources all over the world by <em>Google News</em>.</p><p><strong>Frequency —</strong> About 21 posts per week</p><p>Facebook Fans : <strong>n/a</strong></p><p>Twitter Followers: <strong>214K</strong></p><p><a href="https://news.google.com/news/search/section/q/data science/data science?ned=us&amp;hl=en">Follow</a></p><h1 id="3-Data-Science-Central"><a href="#3-Data-Science-Central" class="headerlink" title="3- Data Science Central"></a>3- Data Science Central</h1><p><img src="https://miro.medium.com/max/60/0*uXlnb8mA9pddpCoz.jpg?q=20" alt="Image for post"></p><p><img src="https://miro.medium.com/max/391/0*uXlnb8mA9pddpCoz.jpg" alt="Image for post"></p><p><strong>About blog —</strong> The industry’s online resource for <em>big data practitioners</em>. From Analytics to Data Integration to Visualization, Data Science Central provides a community experience.</p><p><strong>Frequency —</strong> About 24 posts per week</p><p>Facebook Fans : <strong>1,013</strong></p><p>Twitter Followers: <strong>100K</strong></p><p><a href="http://www.datasciencecentral.com/">Follow</a></p><h1 id="4-KDnuggets-Data-Science-Business-Analytics-Big-Data-amp-Data-Mining"><a href="#4-KDnuggets-Data-Science-Business-Analytics-Big-Data-amp-Data-Mining" class="headerlink" title="4- KDnuggets| Data Science, Business Analytics, Big Data &amp; Data Mining"></a>4- KDnuggets| Data Science, Business Analytics, Big Data &amp; Data Mining</h1><p><img src="https://miro.medium.com/max/60/0*Qd71YIoJfn68cWyO.png?q=20" alt="Image for post"></p><p><img src="https://miro.medium.com/max/326/0*Qd71YIoJfn68cWyO.png" alt="Image for post"></p><p><strong>About blog —</strong> Here are some of the most interesting and regularly-updated blogs on <em>Analytics, Big Data, Data Science, Data Mining, and Machine Learning</em>, in alphabetical order.</p><p><strong>Frequency —</strong> About 34 posts per week</p><p>Facebook Fans : <strong>21,860</strong></p><p>Twitter Followers: <strong>96K</strong></p><p><a href="http://www.kdnuggets.com/websites/blogs.html">Follow</a></p><h1 id="5-Kaggle-Data-Science-News-—-No-Free-Hunch"><a href="#5-Kaggle-Data-Science-News-—-No-Free-Hunch" class="headerlink" title="5- Kaggle | Data Science News — No Free Hunch"></a>5- Kaggle | Data Science News — No Free Hunch</h1><p><img src="https://miro.medium.com/max/60/0*OQrtj3UnNfHUBydD.png?q=20" alt="Image for post"></p><p><img src="https://miro.medium.com/max/1676/0*OQrtj3UnNfHUBydD.png" alt="Image for post"></p><p><strong>About blog —</strong> A platform for predictive modelling and analytics competitions in which companies and researchers post data and statisticians and data miners compete to produce the best models for <em>predicting and describing the data</em>.</p><p><strong>Frequency —</strong> About 1 post per month</p><p>Facebook Fans : <strong>35,137</strong></p><p>Twitter Followers: <strong>89,1K</strong></p><p><a href="http://blog.kaggle.com/">Follow</a></p><h1 id="6-Revolution-Analytics"><a href="#6-Revolution-Analytics" class="headerlink" title="6- Revolution Analytics"></a>6- Revolution Analytics</h1><p><img src="https://miro.medium.com/max/60/0*EI5nQcF5Y-vZss0t.png?q=20" alt="Image for post"></p><p><img src="https://miro.medium.com/max/651/0*EI5nQcF5Y-vZss0t.png" alt="Image for post"></p><p><strong>About blog —</strong> A blog dedicated to news and information of interest to <em>members of the R community.</em> This blog is updated every US workday, with contributions from various authors.</p><p><strong>Frequency —</strong> About 6 posts per week</p><p>Facebook Fans : <strong>n/a</strong></p><p>Twitter Followers: <strong>25,9K</strong></p><p><a href="http://blog.revolutionanalytics.com/">Follow</a></p><h1 id="7-Data-Science-for-Social-Good"><a href="#7-Data-Science-for-Social-Good" class="headerlink" title="7- Data Science for Social Good"></a>7- Data Science for Social Good</h1><p><img src="https://miro.medium.com/max/60/0*vPcYc-CGyfZ5M9qC.png?q=20" alt="Image for post"></p><p><img src="https://miro.medium.com/max/332/0*vPcYc-CGyfZ5M9qC.png" alt="Image for post"></p><p><strong>About blog —</strong> They’re training data scientists to tackle problems that really matter. Train aspiring data scientists to work on <em>data mining, machine learning, big data</em>.</p><p><strong>Frequency —</strong> About 1 post per month</p><p>Facebook Fans : <strong>n/a</strong></p><p>Twitter Followers: <strong>20,5K</strong></p><p><a href="https://dssg.uchicago.edu/blog/">Follow</a></p><h1 id="8-Data-Camp"><a href="#8-Data-Camp" class="headerlink" title="8- Data Camp"></a>8- Data Camp</h1><p><img src="https://miro.medium.com/max/60/0*gcCMO4LzVeyI4i2S.png?q=20" alt="Image for post"></p><p><img src="https://miro.medium.com/max/547/0*gcCMO4LzVeyI4i2S.png" alt="Image for post"></p><p><strong>About blog —</strong> Learn how to become a Data Scientist from the comfort of your browser with <em>DataCamp’s</em> data science<em>blog.</em></p><p><strong>Frequency —</strong> About 7 post per month</p><p>Facebook Fans : <strong>340,109</strong></p><p>Twitter Followers: <strong>16,2K</strong></p><p><a href="https://www.datacamp.com/community/blog">Follow</a></p><h1 id="9-Becoming-a-Data-Scientist"><a href="#9-Becoming-a-Data-Scientist" class="headerlink" title="9- Becoming a Data Scientist"></a>9- Becoming a Data Scientist</h1><p><img src="https://miro.medium.com/max/60/0*C5rofcO186TqMqZG.jpeg?q=20" alt="Image for post"></p><p><img src="https://miro.medium.com/max/651/0*C5rofcO186TqMqZG.jpeg" alt="Image for post"></p><p><strong>About blog —</strong> Documenting a path from “SQL Data Analyst pursuing an Engineering Master’s Degree” to “<em>Data Scientist</em>“</p><p><strong>Frequency</strong> -About 2 posts per month</p><p>Facebook Fans : <strong>n/a</strong></p><p>Twitter Followers: <strong>20,6K</strong></p><p><a href="https://www.becomingadatascientist.com/">Follow</a></p><h1 id="11-Codementor-Data-Science-Tutorials"><a href="#11-Codementor-Data-Science-Tutorials" class="headerlink" title="11- Codementor | Data Science Tutorials"></a>11- Codementor | Data Science Tutorials</h1><p><img src="https://miro.medium.com/max/60/0*IVoY9WIN1MkRju7l.png?q=20" alt="Image for post"></p><p><img src="https://miro.medium.com/max/589/0*IVoY9WIN1MkRju7l.png" alt="Image for post"></p><p><strong>About blog —</strong> Learn about the latest trends in Data Science. Read tutorials, posts, and insights from <em>top Data Science experts and developers</em>.</p><p><strong>Frequency</strong> -About 1 post per month</p><p>Facebook Fans : <strong>12,587</strong></p><p>Twitter Followers: <strong>22,1K</strong></p><p><a href="https://www.codementor.io/community/topic/data-science">Follow</a></p><h1 id="12-DATAVERSITY-»-Data-Science-News-Articles-amp-Education"><a href="#12-DATAVERSITY-»-Data-Science-News-Articles-amp-Education" class="headerlink" title="12- DATAVERSITY » Data Science News, Articles, &amp; Education"></a>12- DATAVERSITY » Data Science News, Articles, &amp; Education</h1><p><img src="https://miro.medium.com/max/60/0*vw0DBet395oTKfVE.png?q=20" alt="Image for post"></p><p><img src="https://miro.medium.com/max/732/0*vw0DBet395oTKfVE.png" alt="Image for post"></p><p><strong>About blog —</strong> Learn the latest business intelligence <em>news</em> and get a thorough business intelligence <em>education.</em></p><p><strong>Frequency</strong> -About 1 post per week</p><p>Facebook Fans : <strong>6,312</strong></p><p>Twitter Followers: <strong>17,4K</strong></p><p><a href="http://www.dataversity.net/category/blogs/">Follow</a></p><h1 id="13-Datascience-Berkeley-Online-Learning-Blog"><a href="#13-Datascience-Berkeley-Online-Learning-Blog" class="headerlink" title="13- Datascience@Berkeley | Online Learning Blog"></a>13- Datascience@Berkeley | Online Learning Blog</h1><p><img src="https://miro.medium.com/max/60/0*ZxTwMfR6FZhadB3G.png?q=20" alt="Image for post"></p><p><img src="https://miro.medium.com/max/488/0*ZxTwMfR6FZhadB3G.png" alt="Image for post"></p><p><strong>About blog —</strong> The UC Berkeley School of Information (I School) offers a <em>professional Master of Information and Data Science</em> (MIDS) delivered online.</p><p><strong>Frequency</strong> — About 1 post per month</p><p>Facebook Fans : <strong>14,804</strong></p><p>Twitter Followers: <strong>10,2K</strong></p><p><a href="https://datascience.berkeley.edu/blog/">Follow</a></p><h1 id="14-Data-Plus-Science"><a href="#14-Data-Plus-Science" class="headerlink" title="14- Data Plus Science"></a>14- Data Plus Science</h1><p><img src="https://miro.medium.com/max/60/0*zNgmJQlO_1y-L0q0.jpg?q=20" alt="Image for post"></p><p><img src="https://miro.medium.com/max/386/0*zNgmJQlO_1y-L0q0.jpg" alt="Image for post"></p><p><strong>About blog —</strong> Helping people find <em>real answers in the data</em>, quickly and effectively</p><p><strong>Frequency</strong> — About 2 posts per month</p><p>Facebook Fans : <strong>2,932</strong></p><p>Twitter Followers: <strong>25,1K</strong></p><p><a href="https://www.dataplusscience.com/insights.html">Follow</a></p><h1 id="15-NYC-Data-Science-Academy-Blog"><a href="#15-NYC-Data-Science-Academy-Blog" class="headerlink" title="15- NYC Data Science Academy Blog"></a>15- NYC Data Science Academy Blog</h1><p><img src="https://miro.medium.com/max/60/0*yPDg1Qf0lF3n37bO.jpg?q=20" alt="Image for post"></p><p><img src="https://miro.medium.com/max/454/0*yPDg1Qf0lF3n37bO.jpg" alt="Image for post"></p><p><strong>About blog —</strong> A hub for in-depth <em>development tutorials and new technology announcements</em> created by their Students’, Faculties and community contributors in the NYCDSA network</p><p><strong>Frequency</strong> — About 5 posts per week</p><p>Facebook Fans : <strong>2,136</strong></p><p>Twitter Followers: <strong>17,1K</strong></p><p><a href="https://blog.nycdatascience.com/">Follow</a></p><h1 id="16-Data-Science-101"><a href="#16-Data-Science-101" class="headerlink" title="16- Data Science 101"></a>16- Data Science 101</h1><p><img src="https://miro.medium.com/max/60/0*QK3UtfWXQwCad3yw.png?q=20" alt="Image for post"></p><p><img src="https://miro.medium.com/max/706/0*QK3UtfWXQwCad3yw.png" alt="Image for post"></p><p><strong>About blog —</strong> A blog all about <em>becoming a data scientist</em>.</p><p><strong>Frequency</strong> — About 5 posts per week</p><p>Facebook Fans : <strong>15,925</strong></p><p>Twitter Followers: <strong>2,365</strong></p><p><a href="http://101.datascience.community/">Follow</a></p><h1 id="17-Data-Science-Dojo"><a href="#17-Data-Science-Dojo" class="headerlink" title="17- Data Science Dojo"></a>17- Data Science Dojo</h1><p><img src="https://miro.medium.com/max/60/0*a1eqI6UGCE-9T26I.png?q=20" alt="Image for post"></p><p><img src="https://miro.medium.com/max/366/0*a1eqI6UGCE-9T26I.png" alt="Image for post"></p><p><strong>About blog —</strong> A paradigm shift in data science learning. They offer short-duration, in-person, hands-on training that will get you started with <em>practical data science</em> in just one week.</p><p><strong>Frequency</strong> — About 1 post per month</p><p>Facebook Fans : <strong>12,009</strong></p><p>Twitter Followers: <strong>4,664</strong></p><p><a href="https://datasciencedojo.com/blog/">Follow</a></p><h1 id="18-Yhat-The-Yhat-Pronounced-Y-hat-Blog"><a href="#18-Yhat-The-Yhat-Pronounced-Y-hat-Blog" class="headerlink" title="18- Yhat: The Yhat (Pronounced Y-hat) Blog"></a>18- Yhat: The Yhat (Pronounced Y-hat) Blog</h1><p><img src="https://miro.medium.com/max/60/0*P8-uUNRKoCgOauz6.png?q=20" alt="Image for post"></p><p><img src="https://miro.medium.com/max/1139/0*P8-uUNRKoCgOauz6.png" alt="Image for post"></p><p><strong>About blog —</strong> Insightful thoughts and amusing tidbits about <em>predictive analytics, machine learning and engineering</em>. Go ahead, binge read.</p><p><strong>Frequency</strong> — About 3 posts per month</p><p>Facebook Fans : <strong>1,162</strong></p><p>Twitter Followers: <strong>10,8K</strong></p><p><a href="http://blog.yhat.com/">Follow</a></p><h1 id="19-DataRobot-Machine-Learning-Software"><a href="#19-DataRobot-Machine-Learning-Software" class="headerlink" title="19- DataRobot | Machine Learning Software"></a>19- DataRobot | Machine Learning Software</h1><p><img src="https://miro.medium.com/max/60/0*e8gMTlkYNW1bL1hH.png?q=20" alt="Image for post"></p><p><img src="https://miro.medium.com/max/662/0*e8gMTlkYNW1bL1hH.png" alt="Image for post"></p><p><strong>About blog —</strong> DataRobot offers a machine learning automation platform for anyone to build and deploy <em>accurate predictive models</em>fast.</p><p><strong>Frequency</strong> — About 3 posts per month</p><p>Facebook Fans : <strong>2,312</strong></p><p>Twitter Followers: <strong>8,784</strong></p><p><a href="https://www.datarobot.com/blog/">Follow</a></p><h1 id="20-Domino-Data-Science-Blog"><a href="#20-Domino-Data-Science-Blog" class="headerlink" title="20- Domino Data Science Blog"></a>20- Domino Data Science Blog</h1><p><img src="https://miro.medium.com/max/60/0*uDBlcAqFuyk3u4U0.jpg?q=20" alt="Image for post"></p><p><img src="https://miro.medium.com/max/586/0*uDBlcAqFuyk3u4U0.jpg" alt="Image for post"></p><p><strong>About blog —</strong> The <em>Domino Data Science Blog</em> features news and in-depth articles on data science best practices, trends, and tools.</p><p><strong>Frequency</strong> — About 1 post per week</p><p>Facebook Fans : <strong>538</strong></p><p>Twitter Followers: <strong>7,383</strong></p><p><a href="https://blog.dominodatalab.com/">Follow</a></p><p><em>This post was originally posted at</em> <a href="http://www.exastax.com/blog"><em>www.exastax.com/blog</em></a></p>]]></content>
      
      
      
        <tags>
            
            <tag> blog </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Feature Scaling can help the gradient descent more quickly</title>
      <link href="2021/02/05/feature-scaling-can-help-the-gradient-descent-more-quickly/"/>
      <url>2021/02/05/feature-scaling-can-help-the-gradient-descent-more-quickly/</url>
      
        <content type="html"><![CDATA[<h1 id="Feature-Scaling-for-Machine-Learning-Understanding-the-Difference-Between-Normalization-vs-Standardization"><a href="#Feature-Scaling-for-Machine-Learning-Understanding-the-Difference-Between-Normalization-vs-Standardization" class="headerlink" title="Feature Scaling for Machine Learning: Understanding the Difference Between Normalization vs. Standardization"></a><a href="https://www.analyticsvidhya.com/blog/2020/04/feature-scaling-machine-learning-normalization-standardization/">Feature Scaling for Machine Learning: Understanding the Difference Between Normalization vs. Standardization</a></h1><h2 id="Introduction-to-Feature-Scaling"><a href="#Introduction-to-Feature-Scaling" class="headerlink" title="Introduction to Feature Scaling"></a>Introduction to Feature Scaling</h2><p>I was recently working with a dataset that had multiple features spanning varying degrees of magnitude, range, and units. This is a significant obstacle as a few machine learning algorithms are highly sensitive to these features.</p><p>I’m sure most of you must have faced this issue in your projects or your learning journey. For example, one feature is entirely in kilograms while the other is in grams, another one is liters, and so on. How can we use these features when they vary so vastly in terms of what they’re presenting?</p><blockquote><p>This is where I turned to the concept of feature scaling. It’s a crucial part of the data preprocessing stage but I’ve seen a lot of beginners overlook it (to the detriment of their machine learning model).</p></blockquote><p><a href="https://cdn.analyticsvidhya.com/wp-content/uploads/2020/04/Feature-image-Normalization-vs.-Standardization.png"><img src="https://cdn.analyticsvidhya.com/wp-content/uploads/2020/04/Feature-image-Normalization-vs.-Standardization.png" alt="feature_scaling"></a></p><p>Here’s the curious thing about feature scaling – it improves (significantly) the performance of some machine learning algorithms and does not work at all for others. What could be the reason behind this quirk?</p><p>Also, what’s the difference between normalization and standardization? These are two of the most commonly used feature scaling techniques in machine learning but a level of ambiguity exists in their understanding. When should you use which technique?</p><p>I will answer these questions and more in this article on feature scaling. We will also implement feature scaling in Python to give you a practice understanding of how it works for different machine learning algorithms.</p><p><em>Note: I assume that you are familiar with Python and core machine learning algorithms. If you’re new to this, I recommend going through the below courses:</em></p><ul><li><em><a href="https://courses.analyticsvidhya.com/courses/introduction-to-data-science?utm_source=blog&amp;utm_medium=feature-scaling-machine-learning-normalization-standardization">Python for Data Science</a></em></li><li><a href="https://courses.analyticsvidhya.com/collections?category=free"><em>All free Machine Learning Courses by Analytics Vidhya</em></a></li><li><em><a href="https://courses.analyticsvidhya.com/courses/applied-machine-learning-beginner-to-professional?utm_source=blog&amp;utm_medium=feature-scaling-machine-learning-normalization-standardization">Applied Machine Learning</a></em></li></ul><h2 id="Table-of-Contents"><a href="#Table-of-Contents" class="headerlink" title="Table of Contents"></a>Table of Contents</h2><ol><li>Why Should we Use Feature Scaling?</li><li>What is Normalization?</li><li>What is Standardization?</li><li>The Big Question – Normalize or Standardize?</li><li>Implementing Feature Scaling in Python<ul><li>Normalization using Sklearn</li><li>Standardization using Sklearn</li></ul></li><li>Applying Feature Scaling to Machine Learning Algorithms<ul><li>K-Nearest Neighbours (KNN)</li><li>Support Vector Regressor</li><li>Decision Tree</li></ul></li></ol><h2 id="Why-Should-we-Use-Feature-Scaling"><a href="#Why-Should-we-Use-Feature-Scaling" class="headerlink" title="Why Should we Use Feature Scaling?"></a>Why Should we Use Feature Scaling?</h2><p>The first question we need to address – why do we need to scale the variables in our dataset? Some machine learning algorithms are sensitive to feature scaling while others are virtually invariant to it. Let me explain that in more detail.</p><h3 id="Gradient-Descent-Based-Algorithms"><a href="#Gradient-Descent-Based-Algorithms" class="headerlink" title="Gradient Descent Based Algorithms"></a>Gradient Descent Based Algorithms</h3><p><strong>Machine learning algorithms like <a href="https://www.analyticsvidhya.com/blog/2017/05/neural-network-from-scratch-in-python-and-r/?utm_source=blog&amp;utm_medium=feature-scaling-machine-learning-normalization-standardization">linear regression</a>, <a href="https://www.analyticsvidhya.com/blog/2017/05/neural-network-from-scratch-in-python-and-r/?utm_source=blog&amp;utm_medium=feature-scaling-machine-learning-normalization-standardization">logistic regression</a>, <a href="https://www.analyticsvidhya.com/blog/2017/05/neural-network-from-scratch-in-python-and-r/?utm_source=blog&amp;utm_medium=feature-scaling-machine-learning-normalization-standardization">neural network</a>, etc. that use gradient descent as an optimization technique require data to be scaled.</strong> Take a look at the formula for gradient descent below:</p><p><a href="https://cdn.analyticsvidhya.com/wp-content/uploads/2020/03/gradient-descent.png"><img src="https://cdn.analyticsvidhya.com/wp-content/uploads/2020/03/gradient-descent.png" alt="Gradient descent formula"></a></p><p>The presence of feature value X in the formula will affect the step size of the gradient descent. The difference in ranges of features will cause different step sizes for each feature. To ensure that the gradient descent moves smoothly towards the minima and that the steps for gradient descent are updated at the same rate for all the features, we scale the data before feeding it to the model.</p><blockquote><p>Having features on a similar scale can help the gradient descent converge more quickly towards the minima.</p></blockquote><h3 id="Distance-Based-Algorithms"><a href="#Distance-Based-Algorithms" class="headerlink" title="Distance-Based Algorithms"></a>Distance-Based Algorithms</h3><p>Distance algorithms like <a href="https://www.analyticsvidhya.com/blog/2018/03/introduction-k-neighbours-algorithm-clustering/?utm_source=blog&amp;utm_medium=feature-scaling-machine-learning-normalization-standardization">KNN</a>, <a href="https://www.analyticsvidhya.com/blog/2019/08/comprehensive-guide-k-means-clustering/?utm_source=blog&amp;utm_medium=feature-scaling-machine-learning-normalization-standardization">K-means</a>, and <a href="https://www.analyticsvidhya.com/blog/2017/09/understaing-support-vector-machine-example-code/?utm_source=blog&amp;utm_medium=feature-scaling-machine-learning-normalization-standardization">SVM</a> are most affected by the range of features. This is because behind the scenes <strong>they are using distances between data points to determine their similarity.</strong></p><p>For example, let’s say we have data containing high school CGPA scores of students (ranging from 0 to 5) and their future incomes (in thousands Rupees):</p><p><a href="https://cdn.analyticsvidhya.com/wp-content/uploads/2020/03/knn_ex.png"><img src="https://cdn.analyticsvidhya.com/wp-content/uploads/2020/03/knn_ex.png" alt="Feature scaling: Unscaled Knn example"></a></p><p>Since both the features have different scales, there is a chance that higher weightage is given to features with higher magnitude. This will impact the performance of the machine learning algorithm and obviously, we do not want our algorithm to be biassed towards one feature.</p><blockquote><p>Therefore, we scale our data before employing a distance based algorithm so that all the features contribute equally to the result.</p></blockquote><p><a href="https://cdn.analyticsvidhya.com/wp-content/uploads/2020/03/knn_ex_scaled.png"><img src="https://cdn.analyticsvidhya.com/wp-content/uploads/2020/03/knn_ex_scaled.png" alt="Feature scaling: Scaled Knn example"></a></p><p>The effect of scaling is conspicuous when we compare the Euclidean distance between data points for students A and B, and between B and C, before and after scaling as shown below:</p><ul><li>Distance AB before scaling =&gt;<img src="https://cdn.analyticsvidhya.com/wp-content/uploads/2020/03/eq1.gif" alt="Euclidean distance"></li><li>Distance BC before scaling =&gt;<img src="https://cdn.analyticsvidhya.com/wp-content/uploads/2020/03/eq2.gif" alt="Euclidean distance"></li><li>Distance AB after scaling =&gt;<img src="https://cdn.analyticsvidhya.com/wp-content/uploads/2020/03/eq3.gif" alt="Euclidean distance"></li><li>Distance BC after scaling =&gt;<img src="https://cdn.analyticsvidhya.com/wp-content/uploads/2020/03/eq4.gif" alt="Euclidean distance"></li></ul><p>Scaling has brought both the features into the picture and the distances are now more comparable than they were before we applied scaling.</p><h3 id="Tree-Based-Algorithms"><a href="#Tree-Based-Algorithms" class="headerlink" title="Tree-Based Algorithms"></a>Tree-Based Algorithms</h3><p><a href="https://www.analyticsvidhya.com/blog/2016/04/tree-based-algorithms-complete-tutorial-scratch-in-python/?utm_source=blog&amp;utm_medium=feature-scaling-machine-learning-normalization-standardization">Tree-based algorithms</a>, on the other hand, are fairly insensitive to the scale of the features. Think about it, a decision tree is only splitting a node based on a single feature. The decision tree splits a node on a feature that increases the homogeneity of the node. This split on a feature is not influenced by other features.</p><p>So, there is virtually no effect of the remaining features on the split. This is what makes them invariant to the scale of the features!</p><h2 id="What-is-Normalization"><a href="#What-is-Normalization" class="headerlink" title="What is Normalization?"></a>What is Normalization?</h2><p><strong>Normalization is a scaling technique in which values are shifted and rescaled so that they end up ranging between 0 and 1. It is also known as Min-Max scaling.</strong></p><p>Here’s the formula for normalization:</p><p><a href="https://cdn.analyticsvidhya.com/wp-content/uploads/2020/03/Norm_eq.gif"><img src="https://cdn.analyticsvidhya.com/wp-content/uploads/2020/03/Norm_eq.gif" alt="Normalization equation"></a></p><p>Here, Xmax and Xmin are the maximum and the minimum values of the feature respectively.</p><ul><li>When the value of X is the minimum value in the column, the numerator will be 0, and hence X’ is 0</li><li>On the other hand, when the value of X is the maximum value in the column, the numerator is equal to the denominator and thus the value of X’ is 1</li><li>If the value of X is between the minimum and the maximum value, then the value of X’ is between 0 and 1</li></ul><h2 id="What-is-Standardization"><a href="#What-is-Standardization" class="headerlink" title="What is Standardization?"></a>What is Standardization?</h2><p><strong>Standardization is another scaling technique where the values are centered around the mean with a unit standard deviation. This means that the mean of the attribute becomes zero and the resultant distribution has a unit standard deviation.</strong></p><p>Here’s the formula for standardization:</p><p><a href="https://cdn.analyticsvidhya.com/wp-content/uploads/2020/03/Stand_eq.gif"><img src="https://cdn.analyticsvidhya.com/wp-content/uploads/2020/03/Stand_eq.gif" alt="Standardization equation"></a></p><p><img src="https://cdn.analyticsvidhya.com/wp-content/uploads/2020/03/mu.gif" alt="Feature scaling: Mu"> is the mean of the feature values and <img src="https://cdn.analyticsvidhya.com/wp-content/uploads/2020/03/sigma.gif" alt="Feature scaling: Sigma"> is the standard deviation of the feature values. Note that in this case, the values are not restricted to a particular range.</p><p>Now, the big question in your mind must be when should we use normalization and when should we use standardization? Let’s find out!</p><h2 id="The-Big-Question-–-Normalize-or-Standardize"><a href="#The-Big-Question-–-Normalize-or-Standardize" class="headerlink" title="The Big Question – Normalize or Standardize?"></a>The Big Question – Normalize or Standardize?</h2><p>Normalization vs. standardization is an eternal question among machine learning newcomers. Let me elaborate on the answer in this section.</p><ul><li>Normalization is good to use when you know that the distribution of your data does not follow a Gaussian distribution. This can be useful in algorithms that do not assume any distribution of the data like K-Nearest Neighbors and Neural Networks.</li><li>Standardization, on the other hand, can be helpful in cases where the data follows a Gaussian distribution. However, this does not have to be necessarily true. Also, unlike normalization, standardization does not have a bounding range. So, even if you have outliers in your data, they will not be affected by standardization.</li></ul><p>However, at the end of the day, the choice of using normalization or standardization will depend on your problem and the machine learning algorithm you are using. There is no hard and fast rule to tell you when to normalize or standardize your data. <strong>You can always start by fitting your model to raw, normalized and standardized data and compare the performance for best results.</strong></p><p><em>It is a good practice to fit the scaler on the training data and then use it to transform the testing data. This would avoid any data leakage during the model testing process. Also, the scaling of target values is generally not required.</em></p><h2 id="Implementing-Feature-Scaling-in-Python"><a href="#Implementing-Feature-Scaling-in-Python" class="headerlink" title="Implementing Feature Scaling in Python"></a><strong>Implementing Feature Scaling in Python</strong></h2><p>Now comes the fun part – putting what we have learned into practice. I will be applying feature scaling to a few machine learning algorithms on the <a href="https://datahack.analyticsvidhya.com/contest/practice-problem-big-mart-sales-iii/?utm_source=blog&amp;utm_medium=feature-scaling-machine-learning-normalization-standardization">Big Mart dataset</a> I’ve taken the <a href="https://datahack.analyticsvidhya.com/contest/all/?utm_source=blog&amp;utm_medium=feature-scaling-machine-learning-normalization-standardization">DataHack</a> platform.</p><p>I will skip the preprocessing steps since they are out of the scope of this tutorial. But you can find them neatly explained in this <a href="https://www.analyticsvidhya.com/blog/2016/02/bigmart-sales-solution-top-20/?utm_source=blog&amp;utm_medium=feature-scaling-machine-learning-normalization-standardization">article</a>. Those steps will enable you to reach the top 20 percentile on the hackathon leaderboard so that’s worth checking out!</p><p>So, let’s first split our data into training and testing sets:</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># spliting training and testing data</span><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>model_selection <span class="token keyword">import</span> train_test_splitX <span class="token operator">=</span> dfy <span class="token operator">=</span> targetX_train<span class="token punctuation">,</span> X_test<span class="token punctuation">,</span> y_train<span class="token punctuation">,</span> y_test <span class="token operator">=</span> train_test_split<span class="token punctuation">(</span>X<span class="token punctuation">,</span>y<span class="token punctuation">,</span>test_size<span class="token operator">=</span><span class="token number">0.2</span><span class="token punctuation">,</span>random_state<span class="token operator">=</span><span class="token number">27</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>Before moving to the feature scaling part, let’s glance at the details about our data using the <strong>pd.describe()</strong> method:</p><p><a href="https://cdn.analyticsvidhya.com/wp-content/uploads/2020/03/NormVsStand_1.png"><img src="https://cdn.analyticsvidhya.com/wp-content/uploads/2020/03/NormVsStand_1.png" alt="Feature scaling: Original data"></a></p><p>We can see that there is a huge difference in the range of values present in our numerical features: <strong>Item_Visibility</strong>, <strong>Item_Weight, Item_MRP,</strong> and <strong>Outlet_Establishment_Year</strong>. Let’s try and fix that using feature scaling!</p><p><em>Note: You will notice negative values in the Item_Visibility feature because I have taken log-transformation to deal with the skewness in the feature.</em></p><h3 id="Normalization-using-sklearn"><a href="#Normalization-using-sklearn" class="headerlink" title="Normalization using sklearn"></a>Normalization using sklearn</h3><p>To normalize your data, you need to import the <em>MinMaxScalar</em> from the <a href="https://courses.analyticsvidhya.com/courses/get-started-with-scikit-learn-sklearn?utm_source=blog&amp;utm_medium=feature-scaling-machine-learning-normalization-standardization">sklearn</a> library and apply it to our dataset. So, let’s do that!</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># data normalization with sklearn</span><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>preprocessing <span class="token keyword">import</span> MinMaxScaler<span class="token comment"># fit scaler on training data</span>norm <span class="token operator">=</span> MinMaxScaler<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X_train<span class="token punctuation">)</span><span class="token comment"># transform training data</span>X_train_norm <span class="token operator">=</span> norm<span class="token punctuation">.</span>transform<span class="token punctuation">(</span>X_train<span class="token punctuation">)</span><span class="token comment"># transform testing dataabs</span>X_test_norm <span class="token operator">=</span> norm<span class="token punctuation">.</span>transform<span class="token punctuation">(</span>X_test<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>Let’s see how normalization has affected our dataset:</p><p><a href="https://cdn.analyticsvidhya.com/wp-content/uploads/2020/03/NormVsStand_2.png"><img src="https://cdn.analyticsvidhya.com/wp-content/uploads/2020/03/NormVsStand_2.png" alt="Feature scaling: Normalized data"></a></p><p>All the features now have a minimum value of 0 and a maximum value of 1. Perfect!</p><p>Try out the above code in the live coding window below!!</p><p><a href="https://id.analyticsvidhya.com/auth/login/?next=https://www.analyticsvidhya.com/blog/2020/04/feature-scaling-machine-learning-normalization-standardization/?&amp;utm_source=coding-window-blog&amp;source=coding-window-blog"><img src="https://s3-ap-south-1.amazonaws.com/av-blog-media/wp-content/uploads/2019/08/coding-window-noshow.jpg" alt="img"></a></p><p>Next, let’s try to standardize our data.</p><h3 id="Standardization-using-sklearn"><a href="#Standardization-using-sklearn" class="headerlink" title="Standardization using sklearn"></a>Standardization using sklearn</h3><p>To standardize your data, you need to import the <em>StandardScalar</em> from the sklearn library and apply it to our dataset. Here’s how you can do it:</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># data standardization with  sklearn</span><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>preprocessing <span class="token keyword">import</span> StandardScaler<span class="token comment"># copy of datasets</span>X_train_stand <span class="token operator">=</span> X_train<span class="token punctuation">.</span>copy<span class="token punctuation">(</span><span class="token punctuation">)</span>X_test_stand <span class="token operator">=</span> X_test<span class="token punctuation">.</span>copy<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment"># numerical features</span>num_cols <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'Item_Weight'</span><span class="token punctuation">,</span><span class="token string">'Item_Visibility'</span><span class="token punctuation">,</span><span class="token string">'Item_MRP'</span><span class="token punctuation">,</span><span class="token string">'Outlet_Establishment_Year'</span><span class="token punctuation">]</span><span class="token comment"># apply standardization on numerical features</span><span class="token keyword">for</span> i <span class="token keyword">in</span> num_cols<span class="token punctuation">:</span>        <span class="token comment"># fit on training data column</span>    scale <span class="token operator">=</span> StandardScaler<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>fit<span class="token punctuation">(</span>X_train_stand<span class="token punctuation">[</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>        <span class="token comment"># transform the training data column</span>    X_train_stand<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> scale<span class="token punctuation">.</span>transform<span class="token punctuation">(</span>X_train_stand<span class="token punctuation">[</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>        <span class="token comment"># transform the testing data column</span>    X_test_stand<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> scale<span class="token punctuation">.</span>transform<span class="token punctuation">(</span>X_test_stand<span class="token punctuation">[</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>You would have noticed that I only applied standardization to my numerical columns and not the other <a href="https://www.analyticsvidhya.com/blog/2020/03/one-hot-encoding-vs-label-encoding-using-scikit-learn/?utm_source=blog&amp;utm_medium=feature-scaling-machine-learning-normalization-standardization">One-Hot Encoded</a> features. Standardizing the One-Hot encoded features would mean assigning a distribution to categorical features. You don’t want to do that!</p><p>But why did I not do the same while normalizing the data? Because One-Hot encoded features are already in the range between 0 to 1. So, normalization would not affect their value.</p><p>Right, let’s have a look at how standardization has transformed our data:</p><p><a href="https://cdn.analyticsvidhya.com/wp-content/uploads/2020/03/NormVsStand_3.png"><img src="https://cdn.analyticsvidhya.com/wp-content/uploads/2020/03/NormVsStand_3.png" alt="Feature scaling: Standardized data"></a></p><p>The numerical features are now centered on the mean with a unit standard deviation. Awesome!</p><h3 id="Comparing-unscaled-normalized-and-standardized-data"><a href="#Comparing-unscaled-normalized-and-standardized-data" class="headerlink" title="Comparing unscaled, normalized and standardized data"></a>Comparing unscaled, normalized and standardized data</h3><p>It is always great to visualize your data to understand the distribution present. We can see the comparison between our unscaled and scaled data using boxplots.</p><p><em>You can learn more about data visualization</em> <a href="https://www.analyticsvidhya.com/blog/tag/data-visualization/?utm_source=blog&amp;utm_medium=feature-scaling-machine-learning-normalization-standardization">here</a><em>.</em></p><p><a href="https://cdn.analyticsvidhya.com/wp-content/uploads/2020/03/NormVsStand_box_plots-1.png"><img src="https://cdn.analyticsvidhya.com/wp-content/uploads/2020/03/NormVsStand_box_plots-1.png" alt="Feature scaling: Normalization vs Standardization"></a></p><p>You can notice how scaling the features brings everything into perspective. The features are now more comparable and will have a similar effect on the learning models.</p><h2 id="Applying-Scaling-to-Machine-Learning-Algorithms"><a href="#Applying-Scaling-to-Machine-Learning-Algorithms" class="headerlink" title="Applying Scaling to Machine Learning Algorithms"></a>Applying Scaling to Machine Learning Algorithms</h2><p>It’s now time to train some machine learning algorithms on our data to compare the effects of different scaling techniques on the performance of the algorithm. I want to see the effect of scaling on three algorithms in particular: K-Nearest Neighbours, Support Vector Regressor, and Decision Tree.</p><p><strong>K-Nearest Neighbours</strong></p><p>Like we saw before, KNN is a distance-based algorithm that is affected by the range of features. Let’s see how it performs on our data, before and after scaling:</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># training a KNN model</span><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>neighbors <span class="token keyword">import</span> KNeighborsRegressor<span class="token comment"># measuring RMSE score</span><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>metrics <span class="token keyword">import</span> mean_squared_error<span class="token comment"># knn </span>knn <span class="token operator">=</span> KNeighborsRegressor<span class="token punctuation">(</span>n_neighbors<span class="token operator">=</span><span class="token number">7</span><span class="token punctuation">)</span>rmse <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token comment"># raw, normalized and standardized training and testing data</span>trainX <span class="token operator">=</span> <span class="token punctuation">[</span>X_train<span class="token punctuation">,</span> X_train_norm<span class="token punctuation">,</span> X_train_stand<span class="token punctuation">]</span>testX <span class="token operator">=</span> <span class="token punctuation">[</span>X_test<span class="token punctuation">,</span> X_test_norm<span class="token punctuation">,</span> X_test_stand<span class="token punctuation">]</span><span class="token comment"># model fitting and measuring RMSE</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>trainX<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token comment"># fit</span>    knn<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>trainX<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span>y_train<span class="token punctuation">)</span>    <span class="token comment"># predict</span>    pred <span class="token operator">=</span> knn<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>testX<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token comment"># RMSE</span>    rmse<span class="token punctuation">.</span>append<span class="token punctuation">(</span>np<span class="token punctuation">.</span>sqrt<span class="token punctuation">(</span>mean_squared_error<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span>pred<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># visualizing the result</span>df_knn <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'RMSE'</span><span class="token punctuation">:</span>rmse<span class="token punctuation">}</span><span class="token punctuation">,</span>index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'Original'</span><span class="token punctuation">,</span><span class="token string">'Normalized'</span><span class="token punctuation">,</span><span class="token string">'Standardized'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>df_knn<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><a href="https://cdn.analyticsvidhya.com/wp-content/uploads/2020/03/NormVsStand_knn.png"><img src="https://cdn.analyticsvidhya.com/wp-content/uploads/2020/03/NormVsStand_knn.png" alt="Feature scaling: K-Nearest Neighbors"></a></p><p>You can see that scaling the features has brought down the RMSE score of our KNN model. Specifically, the normalized data performs a tad bit better than the standardized data.</p><p><em>Note: I am measuring the RMSE here because this competition evaluates the RMSE.</em></p><p><strong>Support Vector Regressor**</strong><br>**</p><p><a href="https://www.analyticsvidhya.com/blog/2020/03/support-vector-regression-tutorial-for-machine-learning/?utm_source=blog&amp;utm_medium=feature-scaling-machine-learning-normalization-standardization">SVR</a> is another distance-based algorithm. So let’s check out whether it works better with normalization or standardization:</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># training an SVR model</span><span class="token keyword">from</span>  sklearn<span class="token punctuation">.</span>svm <span class="token keyword">import</span> SVR<span class="token comment"># measuring RMSE score</span><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>metrics <span class="token keyword">import</span> mean_squared_error<span class="token comment"># SVR</span>svr <span class="token operator">=</span> SVR<span class="token punctuation">(</span>kernel<span class="token operator">=</span><span class="token string">'rbf'</span><span class="token punctuation">,</span>C<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">)</span>rmse <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token comment"># raw, normalized and standardized training and testing data</span>trainX <span class="token operator">=</span> <span class="token punctuation">[</span>X_train<span class="token punctuation">,</span> X_train_norm<span class="token punctuation">,</span> X_train_stand<span class="token punctuation">]</span>testX <span class="token operator">=</span> <span class="token punctuation">[</span>X_test<span class="token punctuation">,</span> X_test_norm<span class="token punctuation">,</span> X_test_stand<span class="token punctuation">]</span><span class="token comment"># model fitting and measuring RMSE</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>trainX<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token comment"># fit</span>    svr<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>trainX<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span>y_train<span class="token punctuation">)</span>    <span class="token comment"># predict</span>    pred <span class="token operator">=</span> svr<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>testX<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token comment"># RMSE</span>    rmse<span class="token punctuation">.</span>append<span class="token punctuation">(</span>np<span class="token punctuation">.</span>sqrt<span class="token punctuation">(</span>mean_squared_error<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span>pred<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># visualizing the result    </span>df_svr <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'RMSE'</span><span class="token punctuation">:</span>rmse<span class="token punctuation">}</span><span class="token punctuation">,</span>index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'Original'</span><span class="token punctuation">,</span><span class="token string">'Normalized'</span><span class="token punctuation">,</span><span class="token string">'Standardized'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>df_svr<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><a href="https://cdn.analyticsvidhya.com/wp-content/uploads/2020/03/NormVsStand_svr.png"><img src="https://cdn.analyticsvidhya.com/wp-content/uploads/2020/03/NormVsStand_svr.png" alt="Feature scaling: Support Vector Regressor"></a></p><p>We can see that scaling the features does bring down the RMSE score. And the standardized data has performed better than the normalized data. Why do you think that’s the case?</p><p>The <a href="https://scikit-learn.org/stable/modules/preprocessing.html#standardization-or-mean-removal-and-variance-scaling">sklearn documentation</a> states that SVM, with RBF kernel, assumes that all the features are centered around zero and variance is of the same order. This is because a feature with a variance greater than that of others prevents the estimator from learning from all the features. Great!</p><p><strong>Decision Tree</strong></p><p>We already know that a Decision tree is invariant to feature scaling. But I wanted to show a practical example of how it performs on the data:</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># training a Decision Tree model</span><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>tree <span class="token keyword">import</span> DecisionTreeRegressor<span class="token comment"># measuring RMSE score</span><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>metrics <span class="token keyword">import</span> mean_squared_error<span class="token comment"># Decision tree</span>dt <span class="token operator">=</span> DecisionTreeRegressor<span class="token punctuation">(</span>max_depth<span class="token operator">=</span><span class="token number">10</span><span class="token punctuation">,</span>random_state<span class="token operator">=</span><span class="token number">27</span><span class="token punctuation">)</span>rmse <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token comment"># raw, normalized and standardized training and testing data</span>trainX <span class="token operator">=</span> <span class="token punctuation">[</span>X_train<span class="token punctuation">,</span>X_train_norm<span class="token punctuation">,</span>X_train_stand<span class="token punctuation">]</span>testX <span class="token operator">=</span> <span class="token punctuation">[</span>X_test<span class="token punctuation">,</span>X_test_norm<span class="token punctuation">,</span>X_test_stand<span class="token punctuation">]</span><span class="token comment"># model fitting and measuring RMSE</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>trainX<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token comment"># fit</span>    dt<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>trainX<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span>y_train<span class="token punctuation">)</span>    <span class="token comment"># predict</span>    pred <span class="token operator">=</span> dt<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>testX<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token comment"># RMSE</span>    rmse<span class="token punctuation">.</span>append<span class="token punctuation">(</span>np<span class="token punctuation">.</span>sqrt<span class="token punctuation">(</span>mean_squared_error<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span>pred<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># visualizing the result    </span>df_dt <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'RMSE'</span><span class="token punctuation">:</span>rmse<span class="token punctuation">}</span><span class="token punctuation">,</span>index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'Original'</span><span class="token punctuation">,</span><span class="token string">'Normalized'</span><span class="token punctuation">,</span><span class="token string">'Standardized'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>df_dt<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><a href="https://cdn.analyticsvidhya.com/wp-content/uploads/2020/03/NormVsStand_dt.png"><img src="https://cdn.analyticsvidhya.com/wp-content/uploads/2020/03/NormVsStand_dt.png" alt="Feature scaling: Decision Tree"></a></p><p>You can see that the RMSE score has not moved an inch on scaling the features. So rest assured when you are using tree-based algorithms on your data!</p><h2 id="End-Notes"><a href="#End-Notes" class="headerlink" title="End Notes"></a>End Notes</h2><p>This tutorial covered the relevance of using feature scaling on your data and how normalization and standardization have varying effects on the working of machine learning algorithms</p><p>Keep in mind that there is no correct answer to when to use normalization over standardization and vice-versa. It all depends on your data and the algorithm you are using.</p><p>As a next step, I encourage you to try out feature scaling with other algorithms and figure out what works best – normalization or standardization? I recommend you use the <a href="https://datahack.analyticsvidhya.com/contest/practice-problem-big-mart-sales-iii/?utm_source=blog&amp;utm_medium=feature-scaling-machine-learning-normalization-standardization">BigMart Sales data</a> for that purpose to maintain the continuity with this article. And don’t forget to share your insights in the comments section below!</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Windows 下查看 BIOS 是否启用虚拟化</title>
      <link href="2021/02/05/windows-xia-cha-kan-bios-shi-fou-qi-yong-xu-ni-hua/"/>
      <url>2021/02/05/windows-xia-cha-kan-bios-shi-fou-qi-yong-xu-ni-hua/</url>
      
        <content type="html"><![CDATA[<h3 id="如何判断BIOS设置是否开启CPU虚拟化功能"><a href="#如何判断BIOS设置是否开启CPU虚拟化功能" class="headerlink" title="如何判断BIOS设置是否开启CPU虚拟化功能?"></a><a href="https://blog.csdn.net/cnds123/article/details/107285546">如何判断BIOS设置是否开启CPU虚拟化功能?</a></h3><p>右击任务栏空白处，单击快捷菜单中“任务管理器“，找到“性能”选项卡，看“虚拟化：已启用” 还是 “虚拟化：已禁用”。参见下图：</p><p><img src="https://img-blog.csdnimg.cn/20200711152623126.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2NuZHMxMjM=,size_16,color_FFFFFF,t_70" alt="img"></p><p><strong>若看到“虚拟化：已启用”，说明开启CPU虚拟化功能。</strong></p><p>若看到“虚拟化：已禁用”，说明未开启CPU虚拟化功能，需要进入BIOS设置， 以联想的笔记本为例，进入BIOS按键是F2，进入后按左右键选择configuration，找到 Intel Virtual Technology（Intel虚拟化技术），确认为enable。</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Tutorial on reading large datasets</title>
      <link href="2021/02/03/tutorial-on-reading-large-datasets/"/>
      <url>2021/02/03/tutorial-on-reading-large-datasets/</url>
      
        <content type="html"><![CDATA[<h2 id="Large-datasets"><a href="#Large-datasets" class="headerlink" title="Large datasets"></a><a href="https://www.kaggle.com/rohanrao/tutorial-on-reading-large-datasets">Large datasets</a></h2><blockquote><p>As a Data Scientist or Kaggler, we crave for more data</p></blockquote><p>How many times have you complained about not having good enough data for working on a particular problem? Plenty I’m sure.<br>How many times have you complained about having too much data to work with? Maybe not many but it’s still a better problem to have.</p><p>The most common resolution in the scenario of having too much data is using a part/sample of it that fits in the RAM available. But that leads to wastage of the unused data and sometimes loss of information. Many times there are ways to overcome this challenge without the need of subsampling. A single solution might not cater to all requirements and so different solutions can work in different scenarios.</p><p>This notebook aims to describe and summarize some of these techniques. The <a href="https://www.kaggle.com/c/riiid-test-answer-prediction">Riiid! Answer Correctness Prediction</a> dataset is quite a nice sample to experiment on since the plain vanilla <strong><em>pd.read_csv\</em></strong> will result in an out-of-memory error on Kaggle Notebooks. It has over 100 million rows and 10 columns.</p><p>Different packages have their own way of reading data. The methods explored in the notebook (Default <strong><em>pandas\</em></strong> and rest alphabetically):</p><ul><li><a href="https://www.kaggle.com/rohanrao/tutorial-on-reading-large-datasets#Method:-Pandas">Pandas</a></li><li><a href="https://www.kaggle.com/rohanrao/tutorial-on-reading-large-datasets#Method:-Dask">Dask</a></li><li><a href="https://www.kaggle.com/rohanrao/tutorial-on-reading-large-datasets#Method:-Datatable">Datatable</a></li><li><a href="https://www.kaggle.com/rohanrao/tutorial-on-reading-large-datasets#Method:-Rapids">Rapids</a></li></ul><p>Apart from methods of reading data from the raw csv files, it is also common to convert the dataset into another format which uses lesser disk space, is smaller in size and/or can be read faster for subsequent reads. The file types explored in the notebook (Default <strong><em>csv\</em></strong> and rest alphabetically):</p><ul><li><a href="https://www.kaggle.com/rohanrao/tutorial-on-reading-large-datasets#Format:-csv">csv</a></li><li><a href="https://www.kaggle.com/rohanrao/tutorial-on-reading-large-datasets#Format:-feather">feather</a></li><li><a href="https://www.kaggle.com/rohanrao/tutorial-on-reading-large-datasets#Format:-hdf5">hdf5</a></li><li><a href="https://www.kaggle.com/rohanrao/tutorial-on-reading-large-datasets#Format:-jay">jay</a></li><li><a href="https://www.kaggle.com/rohanrao/tutorial-on-reading-large-datasets#Format:-parquet">parquet</a></li><li><a href="https://www.kaggle.com/rohanrao/tutorial-on-reading-large-datasets#Format:-pickle">pickle</a></li></ul><p>Note that just reading data is not the end of the story. The final decision of which method to use should also consider the downstream tasks and processes of the data that will be required to run. But that is outside the scope of this notebook.</p><p>You will also find that for different datasets or different environments, there will be different methods that work best. So there is no clear winner as such.</p><p>Feel free to share other approaches that can be added to this list.</p><h2 id="Methods"><a href="#Methods" class="headerlink" title="Methods"></a>Methods</h2><p>Before exploring various methods let’s once confirm that reading the dataset using the default pandas setting fails.</p><p>In [1]:</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd<span class="token keyword">import</span> dask<span class="token punctuation">.</span>dataframe <span class="token keyword">as</span> dd<span class="token comment"># confirming the default pandas doesn't work (running the below code should result in a memory error)</span><span class="token comment"># data = pd.read_csv("../input/riiid-test-answer-prediction/train.csv")</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="Method-Pandas"><a href="#Method-Pandas" class="headerlink" title="Method: Pandas"></a>Method: Pandas</h2><p><img src="data:image/png;base64,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PQoheS4ICAKCgCAgCCwABMShLwAhCYmCgCAgCAgCgkAUAuLQoxCS54KAICAICAKCwAJAQBz6AhCSkCgICAKCgCAgCEQhIA49CiF5LggIAoKAICAILAAExKEvACEJiYKAICAICAKCQBQC4tCjEJLngoAgIAgIAoLAAkBAHPoCEJKQKAgIAoKAICAIRCEgDj0KIXkuCAgCgoAgIAgsAATk5SxNhaSrxr3Jk+/njtPoqSpjMohba5qd3BQEBAFBQBAQBPqMgDj0BoB9VcTrP9OLtErCpVfTfEl3+6ARr5bUGlCaarZ9XHkqCAgCgoAgIAj0BwFx6FO48r3cBXTHs+icmzGjKytx3YOb7Xvomu//VkXfFA+BR986lZ18EQQEAUFAEBAE5hEBcehTYOd9fr1PFYrLvXPOTJpaRmtj701FafLFKF+jN+/7xk+ahNlVFwVtAQmCgCAgCAgCgsD8ICAOfTbOZlvxss2zb8sdQUAQEAQEAUFg30VAHHpT2eQSSm2Jnj6flXYlh+1lYdwsXOSGICAICAKCQL8REIfeFGFxyk1hkZuCgCAgCAgC+ywC7Rd8zTPZMuk8z4BLcYKAICAICAL7DQJ97qFbF80/MXx1EAUr0fYbdIURQUAQEAQEAUFgnhDop0PHhi5MQxu77SvGfLRGbOzpNr5nN4LNEwBSjCAgCAgCgoAgsD8g0E+H7lkHrRQWmMXw58qE8XCV81n2h8olPAgCgoAgIAjMHwJxPG1X1Ayl1z5eeYk16HNX0E2PUY42GGtPoBVQXjy5+KbN6qIiCmY6GYLvSgKSSBAQBAQBQUAQmDsCMRx4ZCG9yCOyEIkgCAgCgoAgIAjsDwj00WmOJA9XKplUAx31sDdZVK8t49JRuv1BGMKDICAICAKCgCAgCAgCgoAgIAgIAoKAICAICAKCgCAgCAgCgoAgIAgIAoKAICAICAKCgCAgCAgCgoAgIAgIAoKAICAICAKCgCAgCAgCgoAgIAgIAoKAICAICAKCgCAgCAgCgoAgIAgIAoKAICAICAKCgCAgCAgCgoAgIAgIAoKAICAICAKCgCAgCAgCgoAgIAgIAoKAICAICAKCgCAgCAgCgoAgIAgIAoKAICAICAKCgCAgCAgCgoAgIAgIAoKAICAICAKCgCAgCAgCgoAgIAgIAoKAICAICAKCgCAgCAgCgoAgIAgIAoKAICAICAKCgCAgCAgCgoAgIAgIAoKAICAICAKCgCAgCAgCgoAgIAgIAoKAICAICAKCgCAgCAgCgoAgIAgIAoKAICAICAKCgCAgCAgCgoAgIAgIAoKAICAICAKCgCAgCAgCgoAgIAgIAoKAICAICAKCgCAgCAgCgoAgIAgIAoKAICAICAKCgCAgCAgCgoAgIAgIAoKAICAICAKCgCAgCAgCgoAgIAgIAoKAICAICAKCgCAgCAgCgoAgIAgIAoKAICAICAKCgCCwQBD4/1QDfwCPfzglAAAAAElFTkSuQmCC" alt="pandas.png"></p><p><a href="https://pandas.pydata.org/">Pandas</a> is probably the most popular method of reading datasets and is also the default on Kaggle. It has a lot of options, flexibility and functions for reading and processing data.</p><p>One of the challenges with using pandas for reading large datasets is it’s conservative nature while infering data types of the columns of a dataset often resulting in unnecessary large memory usage for the pandas dataframe. You can pre-define optimal data types of the columns (based on prior knowledge or sample inspection) and provide it explicitly while reading the dataset.</p><p>This is the method used in the <a href="https://www.kaggle.com/sohier/competition-api-detailed-introduction">official starter notebook of the RiiiD competition</a> as well.</p><p>Documentation: <a href="https://pandas.pydata.org/docs/">https://pandas.pydata.org/docs/</a></p><p>In [2]:</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token operator">%</span><span class="token operator">%</span>timedtypes <span class="token operator">=</span> <span class="token punctuation">{</span>    <span class="token string">"row_id"</span><span class="token punctuation">:</span> <span class="token string">"int64"</span><span class="token punctuation">,</span>    <span class="token string">"timestamp"</span><span class="token punctuation">:</span> <span class="token string">"int64"</span><span class="token punctuation">,</span>    <span class="token string">"user_id"</span><span class="token punctuation">:</span> <span class="token string">"int32"</span><span class="token punctuation">,</span>    <span class="token string">"content_id"</span><span class="token punctuation">:</span> <span class="token string">"int16"</span><span class="token punctuation">,</span>    <span class="token string">"content_type_id"</span><span class="token punctuation">:</span> <span class="token string">"boolean"</span><span class="token punctuation">,</span>    <span class="token string">"task_container_id"</span><span class="token punctuation">:</span> <span class="token string">"int16"</span><span class="token punctuation">,</span>    <span class="token string">"user_answer"</span><span class="token punctuation">:</span> <span class="token string">"int8"</span><span class="token punctuation">,</span>    <span class="token string">"answered_correctly"</span><span class="token punctuation">:</span> <span class="token string">"int8"</span><span class="token punctuation">,</span>    <span class="token string">"prior_question_elapsed_time"</span><span class="token punctuation">:</span> <span class="token string">"float32"</span><span class="token punctuation">,</span>     <span class="token string">"prior_question_had_explanation"</span><span class="token punctuation">:</span> <span class="token string">"boolean"</span><span class="token punctuation">}</span>data <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">"../input/riiid-test-answer-prediction/train.csv"</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span>dtypes<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Train size:"</span><span class="token punctuation">,</span> data<span class="token punctuation">.</span>shape<span class="token punctuation">)</span>Train size<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token number">101230332</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span>CPU times<span class="token punctuation">:</span> user 8min 22s<span class="token punctuation">,</span> sys<span class="token punctuation">:</span> <span class="token number">11.6</span> s<span class="token punctuation">,</span> total<span class="token punctuation">:</span> 8min 34sWall time<span class="token punctuation">:</span> 9min 25s<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>In [3]:</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">data<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>Out[3]:</p><div class="table-container"><table><thead><tr><th style="text-align:left"></th><th style="text-align:left">row_id</th><th style="text-align:left">timestamp</th><th style="text-align:left">user_id</th><th style="text-align:left">content_id</th><th style="text-align:left">content_type_id</th><th style="text-align:left">task_container_id</th><th style="text-align:left">user_answer</th><th style="text-align:left">answered_correctly</th><th style="text-align:left">prior_question_elapsed_time</th><th style="text-align:left">prior_question_had_explanation</th></tr></thead><tbody><tr><td style="text-align:left">0</td><td style="text-align:left">0</td><td style="text-align:left">0</td><td style="text-align:left">115</td><td style="text-align:left">5692</td><td style="text-align:left">False</td><td style="text-align:left">1</td><td style="text-align:left">3</td><td style="text-align:left">1</td><td style="text-align:left">NaN</td><td style="text-align:left"><na></na></td></tr><tr><td style="text-align:left">1</td><td style="text-align:left">1</td><td style="text-align:left">56943</td><td style="text-align:left">115</td><td style="text-align:left">5716</td><td style="text-align:left">False</td><td style="text-align:left">2</td><td style="text-align:left">2</td><td style="text-align:left">1</td><td style="text-align:left">37000.0</td><td style="text-align:left">False</td></tr><tr><td style="text-align:left">2</td><td style="text-align:left">2</td><td style="text-align:left">118363</td><td style="text-align:left">115</td><td style="text-align:left">128</td><td style="text-align:left">False</td><td style="text-align:left">0</td><td style="text-align:left">0</td><td style="text-align:left">1</td><td style="text-align:left">55000.0</td><td style="text-align:left">False</td></tr><tr><td style="text-align:left">3</td><td style="text-align:left">3</td><td style="text-align:left">131167</td><td style="text-align:left">115</td><td style="text-align:left">7860</td><td style="text-align:left">False</td><td style="text-align:left">3</td><td style="text-align:left">0</td><td style="text-align:left">1</td><td style="text-align:left">19000.0</td><td style="text-align:left">False</td></tr><tr><td style="text-align:left">4</td><td style="text-align:left">4</td><td style="text-align:left">137965</td><td style="text-align:left">115</td><td style="text-align:left">7922</td><td style="text-align:left">False</td><td style="text-align:left">4</td><td style="text-align:left">1</td><td style="text-align:left">1</td><td style="text-align:left">11000.0</td><td style="text-align:left">False</td></tr></tbody></table></div><h2 id="Method-Dask"><a href="#Method-Dask" class="headerlink" title="Method: Dask"></a>Method: Dask</h2><p><img src="data:image/png;base64,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" alt="dask.png"></p><p><a href="https://dask.org/">Dask</a> provides a framework to scale pandas workflows natively using a parallel processing architecture. For those of you who have used <a href="https://spark.apache.org/">Spark</a>, you will find an uncanny similarity between the two.</p><p>Documentation: <a href="https://docs.dask.org/en/latest/">https://docs.dask.org/en/latest/</a></p><p>In [4]:</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token operator">%</span><span class="token operator">%</span>timedtypes <span class="token operator">=</span> <span class="token punctuation">{</span>    <span class="token string">"row_id"</span><span class="token punctuation">:</span> <span class="token string">"int64"</span><span class="token punctuation">,</span>    <span class="token string">"timestamp"</span><span class="token punctuation">:</span> <span class="token string">"int64"</span><span class="token punctuation">,</span>    <span class="token string">"user_id"</span><span class="token punctuation">:</span> <span class="token string">"int32"</span><span class="token punctuation">,</span>    <span class="token string">"content_id"</span><span class="token punctuation">:</span> <span class="token string">"int16"</span><span class="token punctuation">,</span>    <span class="token string">"content_type_id"</span><span class="token punctuation">:</span> <span class="token string">"boolean"</span><span class="token punctuation">,</span>    <span class="token string">"task_container_id"</span><span class="token punctuation">:</span> <span class="token string">"int16"</span><span class="token punctuation">,</span>    <span class="token string">"user_answer"</span><span class="token punctuation">:</span> <span class="token string">"int8"</span><span class="token punctuation">,</span>    <span class="token string">"answered_correctly"</span><span class="token punctuation">:</span> <span class="token string">"int8"</span><span class="token punctuation">,</span>    <span class="token string">"prior_question_elapsed_time"</span><span class="token punctuation">:</span> <span class="token string">"float32"</span><span class="token punctuation">,</span>     <span class="token string">"prior_question_had_explanation"</span><span class="token punctuation">:</span> <span class="token string">"boolean"</span><span class="token punctuation">}</span>data <span class="token operator">=</span> dd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">"../input/riiid-test-answer-prediction/train.csv"</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span>dtypes<span class="token punctuation">)</span><span class="token punctuation">.</span>compute<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Train size:"</span><span class="token punctuation">,</span> data<span class="token punctuation">.</span>shape<span class="token punctuation">)</span>Train size<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token number">101230332</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span>CPU times<span class="token punctuation">:</span> user 9min 35s<span class="token punctuation">,</span> sys<span class="token punctuation">:</span> <span class="token number">22.7</span> s<span class="token punctuation">,</span> total<span class="token punctuation">:</span> 9min 58sWall time<span class="token punctuation">:</span> 7min 43s<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>In [5]:</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">data<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>Out[5]:</p><div class="table-container"><table><thead><tr><th style="text-align:left"></th><th style="text-align:left">row_id</th><th style="text-align:left">timestamp</th><th style="text-align:left">user_id</th><th style="text-align:left">content_id</th><th style="text-align:left">content_type_id</th><th style="text-align:left">task_container_id</th><th style="text-align:left">user_answer</th><th style="text-align:left">answered_correctly</th><th style="text-align:left">prior_question_elapsed_time</th><th style="text-align:left">prior_question_had_explanation</th></tr></thead><tbody><tr><td style="text-align:left">0</td><td style="text-align:left">0</td><td style="text-align:left">0</td><td style="text-align:left">115</td><td style="text-align:left">5692</td><td style="text-align:left">False</td><td style="text-align:left">1</td><td style="text-align:left">3</td><td style="text-align:left">1</td><td style="text-align:left">NaN</td><td style="text-align:left"><na></na></td></tr><tr><td style="text-align:left">1</td><td style="text-align:left">1</td><td style="text-align:left">56943</td><td style="text-align:left">115</td><td style="text-align:left">5716</td><td style="text-align:left">False</td><td style="text-align:left">2</td><td style="text-align:left">2</td><td style="text-align:left">1</td><td style="text-align:left">37000.0</td><td style="text-align:left">False</td></tr><tr><td style="text-align:left">2</td><td style="text-align:left">2</td><td style="text-align:left">118363</td><td style="text-align:left">115</td><td style="text-align:left">128</td><td style="text-align:left">False</td><td style="text-align:left">0</td><td style="text-align:left">0</td><td style="text-align:left">1</td><td style="text-align:left">55000.0</td><td style="text-align:left">False</td></tr><tr><td style="text-align:left">3</td><td style="text-align:left">3</td><td style="text-align:left">131167</td><td style="text-align:left">115</td><td style="text-align:left">7860</td><td style="text-align:left">False</td><td style="text-align:left">3</td><td style="text-align:left">0</td><td style="text-align:left">1</td><td style="text-align:left">19000.0</td><td style="text-align:left">False</td></tr><tr><td style="text-align:left">4</td><td style="text-align:left">4</td><td style="text-align:left">137965</td><td style="text-align:left">115</td><td style="text-align:left">7922</td><td style="text-align:left">False</td><td style="text-align:left">4</td><td style="text-align:left">1</td><td style="text-align:left">1</td><td style="text-align:left">11000.0</td><td style="text-align:left">False</td></tr></tbody></table></div><h2 id="Method-Datatable"><a href="#Method-Datatable" class="headerlink" title="Method: Datatable"></a>Method: Datatable</h2><p><img src="data:image/png;base64,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" alt="py_datatable_logo.png"></p><p><a href="https://github.com/h2oai/datatable">Datatable</a> (heavily inspired by R’s data.table) can read large datasets fairly quickly and is often faster than pandas. It is specifically meant for data processing of tabular datasets with emphasis on speed and support for large sized data.</p><p>Documentation: <a href="https://datatable.readthedocs.io/en/latest/index.html">https://datatable.readthedocs.io/en/latest/index.html</a></p><p>In [1]:</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># datatable installation with internet</span><span class="token comment"># !pip install datatable==0.11.0 &gt; /dev/null</span><span class="token comment"># datatable installation without internet</span>!pip install <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">/</span><span class="token builtin">input</span><span class="token operator">/</span>python<span class="token operator">-</span>datatable<span class="token operator">/</span>datatable<span class="token operator">-</span><span class="token number">0.11</span><span class="token number">.1</span><span class="token operator">-</span>cp37<span class="token operator">-</span>cp37m<span class="token operator">-</span>manylinux2010_x86_64<span class="token punctuation">.</span>whl <span class="token operator">&gt;</span> <span class="token operator">/</span>dev<span class="token operator">/</span>null<span class="token keyword">import</span> datatable <span class="token keyword">as</span> dtWARNING<span class="token punctuation">:</span> You are using pip version <span class="token number">20.2</span><span class="token number">.3</span><span class="token punctuation">;</span> however<span class="token punctuation">,</span> version <span class="token number">20.3</span><span class="token number">.1</span> <span class="token keyword">is</span> available<span class="token punctuation">.</span>You should consider upgrading via the <span class="token string">'/opt/conda/bin/python3.7 -m pip install --upgrade pip'</span> command<span class="token punctuation">.</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>In [7]:</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token operator">%</span><span class="token operator">%</span>timedata <span class="token operator">=</span> dt<span class="token punctuation">.</span>fread<span class="token punctuation">(</span><span class="token string">"../input/riiid-test-answer-prediction/train.csv"</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Train size:"</span><span class="token punctuation">,</span> data<span class="token punctuation">.</span>shape<span class="token punctuation">)</span>Train size<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token number">101230332</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span>CPU times<span class="token punctuation">:</span> user <span class="token number">41.4</span> s<span class="token punctuation">,</span> sys<span class="token punctuation">:</span> <span class="token number">14.3</span> s<span class="token punctuation">,</span> total<span class="token punctuation">:</span> <span class="token number">55.7</span> sWall time<span class="token punctuation">:</span> 1min 14s<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>In [8]:</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">data<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>Out[8]:</p><div class="table-container"><table><thead><tr><th style="text-align:left"></th><th style="text-align:left">row_id</th><th style="text-align:left">timestamp</th><th style="text-align:left">user_id</th><th style="text-align:left">content_id</th><th style="text-align:left">content_type_id</th><th style="text-align:left">task_container_id</th><th style="text-align:left">user_answer</th><th style="text-align:left">answered_correctly</th><th style="text-align:left">prior_question_elapsed_time</th><th>prior_question_had_explanation</th></tr></thead><tbody><tr><td style="text-align:left"></td><td style="text-align:left">▪▪▪▪</td><td style="text-align:left">▪▪▪▪▪▪▪▪</td><td style="text-align:left">▪▪▪▪</td><td style="text-align:left">▪▪▪▪</td><td style="text-align:left">▪</td><td style="text-align:left">▪▪▪▪</td><td style="text-align:left">▪▪▪▪</td><td style="text-align:left">▪▪▪▪</td><td style="text-align:left">▪▪▪▪▪▪▪▪</td><td>▪</td></tr><tr><td style="text-align:left">0</td><td style="text-align:left">0</td><td style="text-align:left">0</td><td style="text-align:left">115</td><td style="text-align:left">5692</td><td style="text-align:left">0</td><td style="text-align:left">1</td><td style="text-align:left">3</td><td style="text-align:left">1</td><td style="text-align:left">NA</td><td>NA</td></tr><tr><td style="text-align:left">1</td><td style="text-align:left">1</td><td style="text-align:left">56943</td><td style="text-align:left">115</td><td style="text-align:left">5716</td><td style="text-align:left">0</td><td style="text-align:left">2</td><td style="text-align:left">2</td><td style="text-align:left">1</td><td style="text-align:left">37000</td><td>0</td></tr><tr><td style="text-align:left">2</td><td style="text-align:left">2</td><td style="text-align:left">118363</td><td style="text-align:left">115</td><td style="text-align:left">128</td><td style="text-align:left">0</td><td style="text-align:left">0</td><td style="text-align:left">0</td><td style="text-align:left">1</td><td style="text-align:left">55000</td><td>0</td></tr><tr><td style="text-align:left">3</td><td style="text-align:left">3</td><td style="text-align:left">131167</td><td style="text-align:left">115</td><td style="text-align:left">7860</td><td style="text-align:left">0</td><td style="text-align:left">3</td><td style="text-align:left">0</td><td style="text-align:left">1</td><td style="text-align:left">19000</td><td>0</td></tr><tr><td style="text-align:left">4</td><td style="text-align:left">4</td><td style="text-align:left">137965</td><td style="text-align:left">115</td><td style="text-align:left">7922</td><td style="text-align:left">0</td><td style="text-align:left">4</td><td style="text-align:left">1</td><td style="text-align:left">1</td><td style="text-align:left">11000</td><td>0</td></tr><tr><td style="text-align:left">5</td><td style="text-align:left">5</td><td style="text-align:left">157063</td><td style="text-align:left">115</td><td style="text-align:left">156</td><td style="text-align:left">0</td><td style="text-align:left">5</td><td style="text-align:left">2</td><td style="text-align:left">1</td><td style="text-align:left">5000</td><td>0</td></tr><tr><td style="text-align:left">6</td><td style="text-align:left">6</td><td style="text-align:left">176092</td><td style="text-align:left">115</td><td style="text-align:left">51</td><td style="text-align:left">0</td><td style="text-align:left">6</td><td style="text-align:left">0</td><td style="text-align:left">1</td><td style="text-align:left">17000</td><td>0</td></tr><tr><td style="text-align:left">7</td><td style="text-align:left">7</td><td style="text-align:left">194190</td><td style="text-align:left">115</td><td style="text-align:left">50</td><td style="text-align:left">0</td><td style="text-align:left">7</td><td style="text-align:left">3</td><td style="text-align:left">1</td><td style="text-align:left">17000</td><td>0</td></tr><tr><td style="text-align:left">8</td><td style="text-align:left">8</td><td style="text-align:left">212463</td><td style="text-align:left">115</td><td style="text-align:left">7896</td><td style="text-align:left">0</td><td style="text-align:left">8</td><td style="text-align:left">2</td><td style="text-align:left">1</td><td style="text-align:left">16000</td><td>0</td></tr><tr><td style="text-align:left">9</td><td style="text-align:left">9</td><td style="text-align:left">230983</td><td style="text-align:left">115</td><td style="text-align:left">7863</td><td style="text-align:left">0</td><td style="text-align:left">9</td><td style="text-align:left">0</td><td style="text-align:left">1</td><td style="text-align:left">16000</td><td>0</td></tr></tbody></table></div><p>10 rows × 10 columns</p><h2 id="Method-Rapids"><a href="#Method-Rapids" class="headerlink" title="Method: Rapids"></a>Method: Rapids</h2><p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfQAAAD6CAYAAABXq7VOAAAAAXNSR0IArs4c6QAAAIRlWElmTU0AKgAAAAgABQESAAMAAAABAAEAAAEaAAUAAAABAAAASgEbAAUAAAABAAAAUgEoAAMAAAABAAIAAIdpAAQAAAABAAAAWgAAAAAAAABIAAAAAQAAAEgAAAABAAOgAQADAAAAAQABAACgAgAEAAAAAQAAAfSgAwAEAAAAAQAAAPoAAAAA8DjORwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAVlpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IlhNUCBDb3JlIDUuNC4wIj4KICAgPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4KICAgICAgPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIKICAgICAgICAgICAgeG1sbnM6dGlmZj0iaHR0cDovL25zLmFkb2JlLmNvbS90aWZmLzEuMC8iPgogICAgICAgICA8dGlmZjpPcmllbnRhdGlvbj4xPC90aWZmOk9yaWVudGF0aW9uPgogICAgICA8L3JkZjpEZXNjcmlwdGlvbj4KICAgPC9yZGY6UkRGPgo8L3g6eG1wbWV0YT4KTMInWQAAQABJREFUeAHtvQe4JUd55l9z8517J0ijMBqNpBlJoziKIAmJIJBAEkEkY0yyWWOcvdhesI1tWJu1H2eC12vv3waz68UmGOu/YJBJAhElEQSKCKE0yhqNwuSZG2d/b1XXmb7nntDn3BO6z/nquX3OPd0Vvnqr+nvr+6q6etk73IEDzoIhYAgYAkVEYBlCo8GkxCbXOrd8pXNz084Njjk3cZhzw3z7i0Wsm8lsCDSIwFCD8S26IWAIGAL5QQAmn0ea5WucG5/g/1nnxg7h92rnBtBuB3TRgiHQJwgYofdJQ1s1DYGeQwDrfB5CH4HIl6+AwIch9UOdG+W3iHx+zrllsuAtGAJ9goARep80tFXTEOgpBCBqTRYOUqlJSHwcq3xsFb8h9UjkRuY91eJWmQwIGKFnAMmiGAKGQI4QGAgWuObNVx7n3Or1zJWPB/kimedIWhPFEOgYAkboHYPaCjIEDIElIyDLXO50MlqzybnDIfNlaLFI5GaVLxlhy6DACBihF7jxTHRDoN8QkJtd0+KHn+LcYccEt3sk837DwuprCJQjYIRejoj9NgQMgfwgIPaGxOVeVxgexcW+0blDjg5kLmvdrPKAjX0aAkbo1gcMAUMgnwgkZC73+iCaajmL3yZY/LbiSE5wzcg8n81mUnUPASP07mFvJRsChkAlBETkhLjllVavT/Bc+dAIq9l53nyQb3OzB4zs0xBII2CEnkbD/jcEDIHuIpC2ylnNvvwISHwSkTDTRyB2PWNuZN7dJrLS84uAEXp+28YkMwT6B4Eyq3yUjWImscaHscbnZvjmt3Z/Mzd7/3QJq2njCBihN46ZpTAEDIFWIlBulR+OVQ6BL8NCn4XMh9iPXeSu4Fe5J+QfztinIWAIRASM0CMS9m0IGAKdRaCCVT7BwrcRVrJrS1fty6792CcgeH2bq72zzWOlFQ8BI/TitZlJbAgUH4Eyq3wc0tZ+7LLK5/QoWvKcmn9jmgje9mUvfptbDdqOgBF62yG2AgwBQ2ABApB5XME+yoI3b5XjVp+HyD1xa2tXvTUNN7uuG5kvQM9+GAJVETBCrwqNXTAEDIGWIhCtcqzvQf4vWeW8YWUOC1xBFrrIfJj3mtsiuICJfRoCWREwQs+KlMUzBAyBphEQUcsClyddVrc2iRnBKteJkgUuyx1iH8TFPqFFcPot97sGAhYMAUOgLgJG6HUhsgiGgCHQNAIJGWtefID/tcBNK9gHsco9wUPonrAVT+QN8SuOdoYrEX3ThVtCQ6C/EDBC76/2ttoaAh1DIG2Vj7AhTJwrlwBysYvIS9Y3xC5rfIJtXYc1n26L4DrWTlZQ7yBghN47bWk1MQTygUDaKkcib5UzJ77IKo/SEn+e5821resY1ru52SMw9m0INIaAEXpjeFlsQ8AQqIHAAqt8OWQOSfu5ctIsssqVD2SuRXAjEHlcBFcje7tkCBgCNRAwQq8Bjl0yBAyBjAgk7nM/V06S5clz5X4uHFd6xR3eROa41gfY3lXEL/e75tVLbviMRVs0Q8AQCAgYoVtPMAQMgSUhIKtcbvI55sFHxiHzw1jJrhXshIpWuS5A3n7JO9+TvIBlcDiQu5G5wLFgCDSHgBF6c7hZKkPAEICMRcB+ZzfQ0K5u45orR6uI4Cta5SnUtLXr5NqwCE7xPcmnrtu/hoAh0BgCRuiN4WWxDQFDAATSVrlWpYvMR7HOFTw5813N2lbauWnIn2fRx3gmPcb3ie3DEDAEmkbACL1p6CyhIdCHCCzRKveL5ljRPqLNZfQ61D6E0KpsCLQLASP0diFr+RoCPYaAt8phYLnY9Z7yCea+NWcOx5es7GpWuYeCiP4NakqLRR/z6zGYrDqGQNcQMELvGvRWsCFQHAS8Za15bsJyVqQvXxWeK9c8uV51WpPIlcizvv6BzLUTnBbBJfmFs/ZpCBgCS0XACH2pCFp6Q6CHEYhWtKzyIUh4kp3c9Fy5CDy+Ma0umYOP+HyORXDaCU7pjcx7uNNY1bqGgBF616C3gg2BfCMQrXLNc2sB24SscjSGiDySeZYaKJ+5KRbAaRGcdoJThhYMAUOg5QgYobccUsvQECg4AjKnCbLKReCyyrWCPW2Vhxj1P/2ggEVww9oJ7pAFnvf6iS2GIWAINISAEXpDcFlkQ6C3EVhglUPAE6xEb8Yq9ygxMNBLVgZw1WsnuAFtQGPWeW93IKtdVxEwQu8q/Fa4IZATBGSVc3irHOKdPKp5q9zXSPmJvDm0CG6Ile02b+6RsQ9DoG0IGKG3DVrL2BAoBgIlqxzyHWOefJK57qat8qTK4vM5XO1+ERzueiPzYvQFk7LYCBihF7v9THpDoHkEUlb5AP+vwCof4w1pzcyVp4UoLYLDZe8XwaUv2v+GgCHQNgSM0NsGrWVsCOQYgcQlrmfIx9h/XXPcQ2iDRlewl9ewtAhOO8FpERzl2Lx5OUr22xBoDwJG6O3B1XI1BPKLACQrImeq3K2UVT7RIuJVvjxrPoBW8YvgNECwzWPy2w9Msp5DwAi955rUKmQIVEEgZZWPYkFPsv2qNotZqlXuS0vy1iI4vQt9aNTIvEor2GlDoG0IGKG3DVrL2BDIEQIQrohbvLuCV5aOQ+itdofPswhuOfu7jzIPb5Z5jtreROkbBIzQ+6apraJ9iUDKKh/Btb5C1nOrrPIE0LgIbpRn1vU+dMYNFgwBQ6ALCBihdwF0K9IQ6AgCaauc3d7G2a2t1VZ5XAQ3xGChtAhO8+YaSFgwBAyBjiJghN5RuK0wQ6BzCGjh2wju70ms8uFkTrulK84hbS2CW4YW0SK40hvUjMw718hWkiGQQsAIPQWG/WsIFB6BxCpXPSaZz16OC9xb5a1ebS7Slm+dYzmL64btDWqC3IIh0FUEjNC7Cr8Vbgi0FgFZ5SLXFbjY22KVp8SVdT6OZa7H3mwRXAoY+9cQ6BICRuhdAt6KNQRaiYCMZQXtm67XnMoq14tR9N3yoLxZ0T6C9T9OWd5Q56MtZbVceMvQEOhdBIzQe7dtrWZ9goAIdQirXC72kcT1PY+LvS0EC5kfwDIfYn92LYIbGGzjwKFP2s+qaQi0CgEj9FYhafkYAh1GIFrlmsP2VnmKXNtG5rL6KWe5torlDWpt8wJ0GEsrzhDoBQSM0HuhFa0O/YOAXOgwubfKWbnurfLkbWZtJdekXBWsefORpMy2DBz6pzWtpoZASxEwQm8pnJaZIdAmBCKRJ2a5SHWCjVzSLu+2kivlahHcGK9W9W9Q06p5ySK5LBgChkAuEDBCz0UzmBCGQA0EIpkTZRA3t6xyv72qSLZdC9/S4lC+XwTHxjTLGUQo+G1kjcwDGPZpCOQEASP0nDSEiWEILEIgEnm0yrGOZZUPctdq0Zss5LZa5RIIGbQIbhD3/nLKT3sEFslrJwwBQ6CrCBihdxV+K9wQqIJAQubibS0+0+NoY+z6pjAXrfJ2W8gic5XFe1a18M4WwQX87dMQyCsCRuh5bRmTqz8RSEg6btE6zqNhExxDiVXeMVd3MqDwi+Agc+/ijwOJ/mwZq7UhkHsEjNBz30QmYN8gkJCot8p5I9oEc+XlVnnbXewRbM3PaxEcLv4xvUFNQlkwBAyBXCNghJ7r5jHh+gKBSlY5RKrXnGquvGNWeQQbeTRvPhzfoMZ5bSnbscFElMO+DQFDoCEEjNAbgssiGwKtRUAkKcKOVvly5srHIVKFOFfeUSKVPLjWB+Qh4NG4Abn6zdUeGsQ+DYGcI2CEnvMGMvF6FIHEKpflqzCORa6tVIe7ZZVLCJG5RhZ8+0VwrGw3MhcwFgyBYiBghF6MdjIpewgBrRoXcXqrnDtQVrneWCZLvCtWecRWgwuEGtciOOQxMo/A2LchUAwEjNCL0U4mZS8gIKucwz9Dzr9acKbnyoe1J7oInqOj7vUyTDVvPsLb0/wb1DTasGAIGAKFQsAIvVDNZcIWFYGSVY4VrEfQSlY51npXrXIByiDDbx7Dc+4TbB6jcYctgitqTzO5+xkBI/R+bn2re/sRgB1ldfvV6pQ2hgXsnyvHKvdu924vOBOZSwY0wQSudlsE1/4uYSUYAu1CwAi9Xchavn2PQLTK57DKB/XKUZ4r1wp2nffz0yDUTRe7b6BkUZ7IfNgWwfV9nzUAio2AEXqx28+kzykCnrSZhxZfyirXS000V67feVpsJut8jMfTRicTS13+dguGgCFQSASM0AvZbCZ0bhFICHEOMh/UHuja7Q2rXC81kYu945vEVANKrnZtHqM3qDHg8I+rVYtr5w0BQ6AQCBihF6KZTMgiILDAKme7VP9ceZlV3nUXu4BM5s31BjVtHhPn+HMhWxEa2mQ0BHKKgBF6ThvGxCoQArLKOWSVD/A9eWROrfIIKXJq8KE3uPlXsXZ7YV6Uy74NAUNgSQgYoS8JPkvc7wiUrHImx0dxX+uxL82VK8S58rxZvnKvTzDoGB47KGOQ2D4NAUOgyAgYoRe59Uz27iGAJS6i9lY5UnirnIVlA1i+mifX6re8Ebm8CPMzrLTHzT7G4EPEnjsZu9eiVrIhUHgEjNAL34RWgU4jIKtcZKjH0bQ6XPPQ0Sr3ZC6BIM9cBeTxO8FpERwr7m0RXK5ax4QxBFqCgBF6S2C0TPoCAUix3CofT1vleQVBZM4AZICpAD1vrjp4QufbgiFgCPQOAkbovdOWVpM2IpC2yke0RSrEOMIqcYWSVR5+5u9TUwCESR6hs0VwAQv7NAR6EQEj9F5sVatTSxEQmWuuXAatSHEct3VprrylJbUhM1njzJtPrA2L4GSZ27x5G3C2LA2BHCBghJ6DRjAR8omAt8qxbkXmI+OQIo95FcYqF6SQuV8Ex8r7Me0ERz0sGAKGQO8iYITeu21rNVsCAiLz+JpTEflyNoopjFWuessy105wELk2uMn9tMAS2sqSGgKGQEDACN16giGQRkB+dYKscr2sRI+jFcoql/Aic+QfGEb+uAgumUfXZQuGgCHQmwgYofdmu1qtmkBggVUOEWqP80JZ5bHOIm+OCS2Cg9TN1R6BsW9DoLcRMELv7fa12mVBIGWVD/Fo1wpZ5eyiplA4VzV10by5doLTvL+ReWhH+zQE+gEBI/R+aGWrY1UEolUuo3Y5G8RMyCrXm9EK6KJWXeamWQDHnHncCa5qxe2CIWAI9BwCRug916RWocwIYM1qrnyIu2CSx7pGZdGSuIhkHle0D/OqVi2Cs2AIGAL9h4ARev+1udVYCGjhGOw9zjaokzzWVVSr3DempgwYmCzjbtaGN4Wc9/cVsQ9DwBBYCgI46SwYAv2HgN/+lGqL1OWqViikZe4FR3YIXZveDGkRXAGnC3wD2IchYAgsCQEj9CXBZ4mLioB/rAvLdv8O5/buCrUo4g5qklmL4JZr0xtNGRiZF7VLmtyGwJIRMEJfMoSWQZERkLd671bnZqaw1PWjQMEvgoPMS4vgjMwL1HomqiHQegSM0FuPqeVYFAQgQM034612u5/kW/PQBSH1aJkP86IYvwiuIHIXpWuYnIZAEREwQi9iq5nMLUNArvdB7oLpPc7tS1zvLcu8XRlB3n7wERfB8ZidX57frvIsX0PAECgEAkbohWgmE7KdCGjeWTfC3sch9iK43uVaZyCiPea1EY7Nm7ezd1jehkBxEDBCL05bmaTtQgCC9BvMkP+eJ3Luepd1zrz5OI+njeJuNzJvV6ewfA2B4iFghF68NjOJ24BAyfW+N7+udz/oYCe4UZ6dH+ftbzLULRgChoAhEBEwQo9I2HffIxBd73ty6HqPi+CGtAiOjXD84j1j9L7vswaAIZBGwAg9jYb9398IJK53gbAbUs/Nqve4CI7Fb9oJbjBPe83b6vr+vmes9rlCwAg9V81hwnQbAb/hDIQ5s59Fcju7LQ3lizBliSeL4IZ5C1xu5s0lF/It0yp7C51BQJhnOTojjZWSMwRsL/ecNUhexEl09UJxIrksPJurXxXlblDCA3Oseqeue7eF16jqVaotIdGoiLPKk+A9z7z5ONu6jmgRHLI1XEfl046ggQ+ejEFeCDOoOX3k9AOQVpSlSnYytAujpdYh4oDp5bco1rdkjUfMP8bjW4NSDQD9dzyf1/pF+e27JQgYobcExjZnoptRNyatNbiOe1mtppu2XTdpUt4BVlNLSR/AUj2AxSpSa1eR1GbJYdkkEPEoV90gLOWbAsM5COkAC+F8xaLy008qqvrK9b56fdiAZkmkTl4DEPKy0VAun/UDMszPQuYQ5iQL4aTQvZLO2giU6QcADAJ8f4klZk0f45d9S445+sMgW80e+ULndtzJQsJ7kPMEzkcsy9I09BP5BpL30TeUrpnIwkj3kgZK+ua3D0vEKMmlua9EBt3n/l5HFt+O3Isa3JXuS+7PtLzLeIQxHgPx/6Sfqx+pjj50s26JCPbVHgSWvaM1tkd7pLNcuUMBQTc4N6YIax/kyqPSbSNWFScdoG+NG+RNHdK8Le8Jlxzz7H0+z65qEslbCnyXlIr+71JYBuFp8LEHQol6q54oqt/ECj6o8AHqVcI6SeiJCyWveetJXkm6FEJfxktTZh9i73g2r8mqT4WxZFyJ9estYClwNU61QMYqx3EMMHBYJssZYhyAeP15MvRkIOWukFWQEDt8kodIYx5C3/dV5678Lv+T39UX4kE4lxX468FfG/TUkjOdX/n/iUzTD4S+5juggGhVoEMLC00TaHC1jEGWBg/+0Hn1BdpcxFkaBDWDUzPyqp6UpbYTfvP78IBwr82xNfGBRzknOY+kTemLg/R3LzP1UL8U4c+zOdLcdo6n+P8R4qsfHE0fwrszpAEh7ebbX/2oU3WiKAudQ0D6wkKeEUiU2TJu4r3c3CuPcu64ZyOwbkhZFC28MQ+gmGdQxtNPM2hAgezjkME1w7PZyzikZ+AGN7wJxYBCn3uQb4kg5S1ZOh1UdwRYBuFJkaHP3OHItvpsTie4VRNJg5Env+nc09QR3nMDDFg0WPGDlCStFLt3vVP3YSo+ikKtl2/F8rjLZu/jCpgd/VOBZKWAs7Tdcggn8xvUkFeW8yxAqB1nIIIprOd5vpch++AJkO5avqmw2npeI0OFRvsQ5QwiF1m4ebDa9CznLv2ic1++jKwgkREIZE6N0Wi+koUwDRlNnklfo69nxSmkrP+penuM6Nizu0PfntlCPZK+PHAMbb0OzLnfBqhLtIh9zk3Wp65USX/zXgnK0P02fQupIN6xi5xbc6Fzh5zo3Kr1zq0A2/FJ+iKH1lPEQbUWcM5Qp/3gvpd+vPMx57YzKHr6x87tupl7g/YRuY9yfwwxiFXbaz8Df+/WFdAiFAUBI/Q8txQ3twhk5GRuzDudO/mNzr3qd5074liUkW7GFisYEdgc+c5wTHHD70KxbOfYChk9crtzD33GuSdQtnN3oVjAbflJKAU8BrMoDy+KPhLl1BFYKUuW+Txkjrjusvc599zXoPDE0LWwkYxc34Piu/ajzn3j96kLylCk7i31CsLvpo7DKPuG3psu+VC6MyjV4Y3OXf63tOEF4AWpZGk7xVkUL5F9gYjJOd9+5K2+MY11txdc1IZPo9ifoM2elmL/Qqj7KEQxvAbsGAA0rNiRS8QI37lZ0iuc8SJk/RKkfjnXnglxYEk2SuqymkXmG17v3HPeSh4MGtT/PQax3vpWQIZSX9P/9QLplDT28Tnkn0Z2ebx2Y9GKAJ/e4txTd4LZTeD0bdr6cGQ4HQJkwNgUTvVkSuQZQAuLzKdpq6nrud/Pcm79rzl3DAOldac6d+g6+id9s9GgwdAu6rbtfucevtW5B7/BIPZTkD5AjNNGQ5NJGynjLBg2KoDF7zgCRugdh7yBArnx/FwYmhPucc/9WaxzFEzHwokHS5qC8La93bn7UAy3fdm5O/7OuccgqkOIMsqAYwZF6JUvSjmzz/tg9s39hxKSW3knxHX+bzLYeRu/VX7GIDf6q38DJbfFuR98EOv+CAhKQKeD2gAPhEhyD+WsgAQzB3kukHGKtJuwzM96YeaULY84Tfs9BVk+zMBsyzede/T/oti/BVFAxENgKKu+IWuNejH+c0OjQVSR5WbV74uQur7PT0gdKziz+104/8i5c38SL8ta0nU4aOpABPjE/eB0GwQITk9+DNJncORxigRI3VsRNLjQOgTdN7u/ApbHOnfSnzLoA7/1p4UBTbocWeFKkyVo4Kl7YSWDEh0nQOC7rnTuXvrhHZ9hkP63lE0Z4yemBiu6d9SQFgqLwFBhJe8TwWWBzqCIGcD73cFU7UzWuZTOEm5OKRmRkawjKQdZS+s3heOCK5y7603OXf9J577zfhQeZL4aS2J2C8oB5edJFeug3WEQpb//4WApXvDqUO5+iGsEkvHylwsQMUm+ZSmrXue/xrlbIPSpu8jrSOqwdWFCKVHvekfZa6X5aKKEF8aq8AuC0pylwvLDwnep7SQDIfkKP5LP2GyVri2IWOkHiWN6XY7tJ7nXorx1bL4UUn+lc7ej2B/4c+p0DnWCTGaxVhshdQ9jQjAiw0G0ifJ21wRSX3YBeTNImtvNOQ1u6gRZlEOnIAsDDAVhpcFUq8OivkFFVI4s5VXIq+OE8xgovgycXufcj67GQ/XXyEYfHz8pqU9yfzQrm/pUHEjtvZapmF9nIPMG545/BnKIWAmRwNWGvh0FODJmCuoHlKE8FJTnCvrgWZczuKRdfshA7pZ/pI7/zvTGS2g7rs/p3lX+6Q7kU9tHURDI2j2KUp/ekxMlp8U7usfmEpLUnGongxTgHIpBCkIKX+Rw+oVYE+c6dyaK4TNYxo/egYWLslu2jbhP8y2llMjbNlnBYYrMN6B4N5wWShGZR4WYtdzjN+PefAEW2bXMV65CbAhdCrRcsemUXO+ypHwZ9RQf1yNBaipDIc6H+/zDqbZ/qv3UdvqWPJp/PfnZYHY23paLnLvxvXgfbkSxQ2IzeCGizJkEEygEkbnc2JHUD2Cpf+UyLjyL/nI41zKQujDxc/vIqiCSaUiWkKypT2ETCdSXTX1k2ap/n3g+pH6pc9//Wwjw05zH0hX5NbuGxZM5bTD9JMd1EDnEqkGltvNVUF9RvX0f47upAJbCU28SVPD3MO2jc8sxEp75CueOPdO5GxhA3POHrCOhrbS2Qu0UF1D6hPZRKASa7S6FqmShheUGjMQSScAraBRQp4JXDChXkZEfyaMYZD0NQ57nv9i5X/k8iu9nggt+YA1xDkFkkblIvU1BK/7nHkEO8j/9pVgfhwaF3IhFF+OuWefcqS+DzMhL874VFRp4K76s+j0asGSpVypSJCa1XaeD2k/kILKVp0HWtMhXlvAzXu7cS/4n87SX4JK9hjaNbdegkKqX8p9PBnGaU78EUp++IcwND9JedRdOJtiU+nmDMiwluseI9lUddEQCVH00f30uJH4lhH7sO5j+wrMhV3m2TrBQKu+FEJk/QV96wLmLr+Z4SyBztYnKG+Q+a3RQurCUxb/8Paz2px+oHNXviI3Ovfh3IPf/zXoL2kprKeKCyWbqtrhUO9NpBOjCFgyBxhCQwhO5SzHIa3DUCc797Psxxn4NUr8bpXAkimOEPKXcU6TWWCm1Y2sB2zTlryDaaReFuJ5MGihPJCuCVjiVPJSXXPhy5VfiXVlWIsR9ELpc+5F4fAb1PiplWC9NO64jv1zLasOo2DVf+5I/wcPyWjwQ34bUGRzJUm607UQSIoxyUtdCL1mjIouKwFapZwNNWSWH5k8vIkDa/kj6+Uve7dwpf5aQugYpDbSr+o9/OmAng8ebIPIPOXc27m4FDZDVJq0m8pD7wk+Vo6D210r5577ZuYs+yUAVUtfUiB6b8wNyH8s+ioSAEXqRWqsRWVE0Uqwi3Hjod7VDcfw1lI4Uc5bgFZBIEWUkC/kNf8gc3Rude/xHKIpNDem6LMUtiCOFI3f7CW/Fajo5XGpGGUbS2HCqcxveAFmTld+cQ1nGiyH70qdOy/UuzKrFKUWO/1TJK14u/5byr9ZWtc4rXSPtJ0JSfocezSr8P8D1ehaDlYcYsDFg8qReLliN37GK5aSuR9qmroPUn4IsZNlm7F8Zo/n6qs5Zjqxlp6vpCZDKiQDlFr/sN5iy+GM8Grjf9QiYJ79Y+XTC9P/Ip8fg1D57v4ZV/EG8WpeHCHKxa4BcL6h+aqvSvcr/mibwh84jn66rjHohDliURkEu//P/D0+1fBZZGKg0NFgNWdhnDhAwQs9BI7RFBBSMFKtc5PHQ72qH4vhr9AjdzHEQUE8BKu4QI35P6rjbX/NfsfRQcttvZ+70pKBksyyIagSDZQwe9KicFP4ZKEWttJZiii70RvJSvaUQ5VY97bKQp1yhera9Yt2lmMFI+OhxJ6rflhDnUKu1V7Xz0bUflXs94RRfh0hgzTG4yf8I8v1OSCUCajZIPpGLgtzvInXNF0/Tbn5KI1xqy2etNlGfWUCAGchPQqYJUP3t0l/HYv8FyPke7i8IMItFq0fT9jA9teF3IfRXhap7yzwDzhFL4Vq6V/lffdEfOs99qOtqT8VXPesFpYl5n4+HZtO7uXevat5LU688u95eBGh6C72IgBT0FPPBjRyzMnmTEAcB2jikrmJAg3piJO56SPzFHw6W7qzcrMzJ1p07jYVm/NYiQYwat+YoLKXzMiaqFg3Zo0I7hcVPjBXcfjL36wCUpgI7CFu53vezgEwbeXhCFFO0MMhq07PkM1mP/WFQIxEi+Ui5a+BRz2JX/Bg2nosb+O95JvvfGSixeCoLUcW05d/lpK45dc0960mIVgzyYr0kf/pQm6V/l/+/gABFfrRn7APldSj/LQIUpmOQ+KXv5CrtL4xqPi5J3xCZTzGYGQXfcyBOLSwVmdezzNXXfH8TUVMv9YsdjzO1dQ9PKNzGY2g38ijp99kj4g4et3uA+25XkFjY+4FnYoGX1yP927cT5WhNzEVvoW5nI+s22kpTCpy3UBwE6J4WegkBKSfdyHu4sa/6c0gBhTM0Ul+pC4MRLOsJGO3QtWFe/JhNuBg5pyAlJtKuFkRqUjay6s65hJXTr+OxqI9jxZyGcng6KKOKFm+1DKudJ/8D1Eljj2eifI48LkSUUqoW0oq/UpyYdv2JrGjGnfqdD4ADOHqeq0HUuu43nEEGKfpYTqUyspxTeilthTu/yfPCV+M5ODwb2SidHoMax9Owah1ekg1gs/GgXOm8fQFlH3FQonzOfAmrus+i7+CB8AQssBO5ypLV/Sls5S0QPrLU7/4q5EO/GAPrGtDWzVcRJOsuBo13XU/+9AvJWKsNJIv6sB5VXM5AU9NEkxy6XxRE6sIhtkE4u/hTeYhktajsgr907uu4qw/B4q76hICwI408H6f8BVNEZ4Q8Y7mLSwhnVIbkUZA3aMsPwO4m9hP4Eff3A5T3BDLvII7qhXdsjHZfuYlHE8n/uHN4FO4UzoO76hX7eMht8adEVFC/Off3nPsag47Df5K221sfD5/QPnKBAM1toacQSLSkdnv71p8ymqdymrZEN9QNSqp46hSrOU56KwtmfhoF/7ygCOuRulzvGlBIUT7jJ3gkCsU9/RBpyUy7ubUiaDGcFBk6zJ1xacixlqWTJrL0/2lZoiUjUth8CYORDyD3g1gsIlMslYohIV89zrcbUll1ZMVYjZ1UAySa9SkU9s3vZXCVWLSpSyUiVFSdLw/igMkX8ijeFVjbrwjPntciulL6pBDNp5/yy85975dQ6ij2KSzqmhZoKYPK//jBDjiJnIZl9UHwXp5qFaiczYKzsS1F6J+/MvRxZUcxNYOw0WOHoyfST0+mfpvxKjF4OY5DVrdCmkjDmQqfSTudcRn9/JVghBx+k5hyixhMtchs9mnqvsG5jRcGco2DnAo5+1NpGWSFf/uDWOV4TlQ/zdsPkdcAA7gh2kqdQF4PbfH69FVY7Jy6hXJOfjP34avD43dxoM+lisEP6JI22nQR6bm39tEHR7kHZo3UK2KWx5NDeRTKZFo6AiKpo5+P5fBjLO+juOelaBIlVDF3lIKCFKVerrEfrfDtD0FuHK//J+de9KZA6jUVA/nrkSiVfSIWwlFYC0/ehQy44bXXurd8knJCaU18UsYMydZdTBkoYYValo7KfPKREE+Pp6UVZTi78HPTuRDgM9gVDyUqt2jNQF28630ncWUdo2i9lUeZSw2j5HUYg4SVl5DnFLkJN+Ub8avyv+qn+NOP4iF5h3P3f5pFXAxQ5EqvV/fYP4TZxvN57pri5qYpVloilsu/jQZPvvQJTzzk14rHGSPEsjxX0r/G6GsiJT16VTVQB8ni8XmS3dI+zI5wYPVD+sW6N0B+b3T+2XxPbsSrZanrmvIao53O/jk20rmSwRfkOQNxK306CL/pLQySL8ZrckL6SpX/yZc/3xx33cCA5eWkZ2C58sVh0CBWl5tf7ekZXmCsIv7RHGeGa1MPce8yIHsUr8Blf0hfOoaoxK91r8QytUvf8QzIv/8r9GkGdG43BzhbyD8CRuj5b6PmJOTunILI9nPMP85NDtFmCdIN2n98fAPK7QgWyKAQ/vebcUGvZn4NxaLgFXTUqOFU6TMqjMNRLhtQco+8j0vE9dGlMZYQ9Gas+adQbuSxGYVTeva8grJJy/iDa9BHWN8veD0JESR9LYojYpB4hyH3KSjmR26kLIjav6FKBVYLJFLd9jwW5iA1J+oVra9wKlGDddfASC9X0e5tsr4kc7WgonTZFwmZyJoeO5Y2PBG5bnLuPyCqn/oCdeNcLVKPJKXvQ9ezRgGM99xLXvyvF5mUE1U1eaqel4Aiuxp1qZq21gXax8/1k6+fz/ZAVE6gug3Rj4ZXUp+NIc4MGD/4V5D7h+gj/xqmBtJYVM6J9MmF4xn8aIMW7WGgRwJ9+6cSqe3mIdjVDDri1sHKv1rwnjDy2QmJX8dgbJbvNUxhabCgQ8EnT+XhIU1wVTuNrqPdIPFHP8xuvPx+9fv5jQeiUt8POZJnkp/uhXWnhwGddjpcincm5m3fnUFAt5eFHkVAloHuUe137r/50E1b61BEvUltZgsreCHzVeeihMjjc7+DpftwGOHXWkDkrRvi6/nWdafwD2FOxMjvpYZluJ9nsUzwYLoznhdyk9VRKUSlqoVl3/s4btEvoVRnQ93jtXQ6YaI1AAqbLw5leGvr0HCu1qfSavGgXO8+8LtlpKU7lEO4Vjvi9bjQTKTm3yTG4GfybNqSOdcb/ikRrd4dn5CCVv0fDklN/YDiBXhyPuTSmU/BmCWov6pNPalTd31XPWhjWegi3xnmozRg0p4Jq16Dl+UM575wGTunfTeUqnatWe9EQG0VuwFLdu/XyYvBwoLBF3hrMC34Vh7NYIKyFNSW1YIvl4sP3MKU2dUMpl8UiFxvfot9wLe1yk8OpSld47TaX4fm9jVQueNroTT1ccnn8RJmqUNCxntb28QuPzFg5PeU6EL7B4ntsxEEanSrRrKxuLlGIN6M+s5yEM0rB76nt0Do9JKtkMIdiaLzSoRrlYInNxSqgtx80l8zuH+XQRBLCigsKUYZy8e/kTnPZLAQt7ZclLcUHeHR+1iI9TmU4//C6uZ/BUFQKUQl67eCfQVkpkgVrP9FaclQxU3tQqlzyEuhMhIRfPSopBelbdOJqNy1sG3yZayGxtLTW7cUKg1owpWDnyKeQ46DFDgVcTl4tT3/lbdL+e+qpUag43fViFxQnOTw9eL/A3Sq6ccZxB2JV+Nc3sD3rtTgrFZeqWvHYaVr8CgLPd3B1O4aXKjIMbwCCgsIP5wqfepaXMC2Aw/NPKQsC9nn0YC29nUjL5H6BHW65yuhCLVrmvxjP4nfsWxNH2mO3r+LoIFySxWxf7qCgDVVV2AvQKGM3BXk4h48Nij2h34YzvlH1JLr4czCz6iw9DYzEbr4Pe5HvzBm9l/a6lUrejEw3FkQVHz23CuusmxEWNH1fyeDEA0CMMTc3VibCn6VcgW20OBAFr+s080vDXWewyuxTC6KDEFKew9KeIYCPamnyoiYZMimpVE8PtRpjnZ89M6QdU1ZVIkkTLIgSsHHT50PZ1v/6Qc9YFZTvtYXSwPzR0cVqU+ejCfqiwctWs/EqXasVvzhGxkQ0EfnGAUucFELN9LrK/bJNOEvyi9VlremFUGJmw3kp3e7b/sGC92ol7xU3nuh+7fs0HkFxbn3ewxQb8bTtprfGtkuRQafq310AgGNJy0YApURSJSRf4UrMWQxyAoZwfVdUykluY2gJEXoXh/EoWOSZxIl+xdWivSNDP3TnlU7mQhBxezEBX7zp0IaWZq3X+PceZdjsZCJiFvEviCQSMpMilfbyX6ZixpA+LlHLO96wVtjlL37CcpcS2zykX7W4cmqXgZtui48ZDluZ3Dig8DJENTOvrnAqtLAKUMWDUXx7TZ8MElHMQMjTVFpPn3FBRD6VUzrXBba/qBE1f/Teo7VVzKguw8ShEDLSVB9INNABcA9Dnyr3+n5dU+0viGql1/1igomraa8vvV7WOrUaRxZq92/stC1tfFjX6P851CPaeKK+FW+hdwjYISe+ybqroDSBwq6n6dQdrPc4FL0WZSTHmMTZ/o8lqIQ1Espl6lSd947WCm8IeQZ3YOcPhgoLJLPQ3ehmCH0ozaT9jb+/yBu919mN6xziFNFnpjnMSc5d8IvOnfr32N5idUVP4JxsLSF/6lszkzh5twLVpNrGIQwQJD4YxrZdCtIrsPAIBmUVKt7uXhqP43DlkQo5ZnW+C255IXRY24KGlz558vDz/Z/qnwGrHqe+4mPYqm/OzzLnYXM9ETEavrMdkaBIxeCGZ1V9fHknAwcNRhWUP+sdv8oTXykbS35DTO1pMGBFvHNgo08CXX7oS8l9UH765G6Ob4f+MskPf+X8qFM/z9yalpLHqnRM0kTXe66bqEQCOh+tWAI1EVA9//gKDd7opyyKDlZwUq31CDrYn4vBxmdjYWtIGVfiZi0OM0TA+b8j26AWImrF2KMnYGC5v+7cCUqyAqvtKBO571CxVLUXtuSfw6LW++lzxqk//bivp1GqYuc0Iv+8bas6XMTrwuKXPsM3PhJcKexReZqi06GSMB0H7dtS6rkah05Oa+B4KpjsPBp99I9ouTUwz/2x797toV6+Vyr5cfF6JrXBjSn/AKDhK+RB0QeX5qTZQ2ELyP1IaLWzm8T9OnlL+LQ9xXJEf9/IddfzPHcEFdpstznqWLs3y4jYITe5QbIdfEoHel0KRDpn+W46vS+cYUsul5vMpNO8J2shgLzGdb5UD5rsRr0nLhCJTIPV8LnU4/hbv8Qj/vwU5t6qAIi1tv+HQWJ0lWoZiWFq2Fb2UOlpDnRyP7jfkBBGrne5d7U5hwaaHQt0FgHdtJ2AkAhoywiU0X1Ho+MaXz+TX7IEzCCdXz7bzj3pb+mbH5rQLSI1Nssiy+XOjy1JVWRDB1+Ai+IBp3RQ+RTI6t+6wmNnQ8c3Jq1Vt9T/Lja/Dn/Ca/U3/DCo6sYJN5LXzoCYmdwqTj+vlSBWfBQH8DL5R+BpEPr/0VHcl4eAb8YLkOdfR3tIzcI0C0sGALVEZB1PIerTx1FW13KapL+WKC0ypJHPbAfFyN646DbVvGyKJ90fomLUd7KM9/M/CYEKcs6usbTUaUko3Vz/x1Y47fjBj0LQr4LUn80bGl752dxO94ZUiluJcWqvCXm4euZS//ZUAdtN+uoeyNBC/e8NdVonRspJENctccBXBWrjwqRK9W5UjZa3FciqA7VQXgtx1K8/b/w/PQHKJ9BxSJSjx2sktAtOCcZhiDn3Qz8fPtlzHMU0q4UhPfQiQwkb2MnN/qhQr028H0QOTS99YJfdu5V38QDwID28X9lYPApMmCgM4KMw3g0/GCTuHX7mnDLil3WeKqMhdwgYISem6bImSAJqQ1gXc7gKsRb5044O8goi6mqhYzyimS/fWtYEIfu8fuvN6Mj5L6ch0z5cme9IJRfTclGJTmDq/u2a8NAQtME4qI5/O3aaEMu+B9dH6w+1aFSXjofn0k/89KQj980ZEUov+an8qRArXjWKn8tMJrGUteOct0IHhPKHsSyW7spkaCWLAIrCXvBzIcqA5/kamu/ICb1n4nL2MHtHZD6+0NbLSD1lIytLTzp13gG1O/1DoJF3oHyAlNYau8FH9Lycf2A5sAZTO39CnuxQ+oKfuCZjhdOL/j0VjhxRO4nP9u5n/w75175LXZI/G/0qXuYEvgk5P65MOgZYqCrxXj+9bQqMwvBLyjNfvQCAkbovdCK9eoQlU78Lo9f4bzcjloZPQwRoNfcWb+NUjk3JIxWcHk2+i0Cide33hdc7kMbUTrKpNEguThk5W98Jc+enxoyiPmXZxer8fjDzt30J1jYRNCcZgxzu3m2mh+3fohFT4/Es5W/YxknYBWte35ipVeOuuCs6i/yWUHhfjACjoxH6lpkCzJp0Q/vOsbCmwKPdW9mMeGJIeMsgwsR2faHaEsloU4Ne1ZCUY1/0oh+YRYpRep30O++8N4wwCqRuuI0nnPmFCJD7Uo4yyJCeQiyBr/GpEJk72WA7PVK3nu+GF4oI7LWjnD1gh90JpXVNrMnXeTcS36X7Ziv5fsapqDeTb7cIE9dxX36/9PWtJmfb6ejyzWvVfIKfuDaTtBCMfbZZQRQPRZ6FoF4A6OgfIi/yyscz2MJ6HnvARTHkCaf+X33jTyT/TznXvGbXOO3FL0Ua7XgHwdDWe16iu00v+ez8EplljK8VR/LqpZB+vwwP0awbPbyBqjXoKDk/kcJLnrcjGheCSfD03tuYncszul1qNrtLpYr1/vq03nG9nbeXMVx5LHUlTqJhH2cVNk6r3lMbXl7JmVf/VUs/B3EgyAPyP9fJWhQsWJdwCjKJE6YYn6yqSC84tFgBlLoerHG9M3OPfvfQh2jTPWy2s/gZ9uteBpOpHjJHkdL9RK24nokdfqZSP3OdyIDffjyt9Mv6Q/1+uCSRVB/oO/N4umptHCyWv6aYokhDZfIe568ll/IBk0fZJBCnc6nT0W3uq7XCmlS1/9Kdyh9TMfpL+Be+0UGqFvo8/Tph78dnqPfdw/xyHT0HA7iabc/zZnPIUfYGILvtJD8tFB8BGqo5uJXrq9rwM06uCoQ6uD6RCnXAgQlJtfg7EOQIMS1k2+NA17y+85d+TaI8IhAcLXIPJ29Hhm7/xMoZE5q/rbZoLe0KY/TLwo5VNNB4jxd0/ugb7k6TBH4VbpKpgscspS0j7d+3n4tK+YvRtnx25McSrI8iOgVtM3sNXxrMDEki6cSoSt/4q/EtTpCHA0G/Na7Koygt7I1EqTkJVJp29VElpp5kEbpPIFQ111fIzaekZczqFl7IvUkj5rkkbq+/TFI4sNg/xJkp/3KBzw15WjFRXDzljoaahIC/PHvhXa64h20AeQUST22USuKTOfhvSvcD+obWYPfJY7IXqak3WNavTRGT1uMPpNV/H9Oe5zEa1TPDH1KHpN6+Jau00bqCvG32nPlYeE4nrxnfip4AJ7i/n30Dgiett/GYE7vNx85jkWapyIHg3YtfPPPykvAMlmjzPZdPAS4XSz0IgJSRDtv4OamcqPc2FICtYLuaXWGSYh7/QuYp3teILINp3ESpaH8ZBnUCt46VyYUduvXcNny77pNDBIgd68z6gmRzlzEBDHuwao4+z+jADeGi9EVno6q8iJRPbqF1e3/C3f7MVim9yflSil7AcJ6APSfu/UvsZZ+DqV68sFr/LcgxLIU54Q3QSr/DEYQpc8rXRfyFpnrKYBxlKUfICzIKUlTfq7Gbz3vv4frIw+RN0DWJS7qqJXsc48TX+nW0oZYtBcg92HHhYIiCVQrVlVKYHIPYtWj890qvDVTWzlfp+2r5bmk8wjjSZ2yJy9nkeO7ArZX/Fbw1ihv3+6qcAuDH/hQpnZ9q4t7qlxPzPqd7hvJdcmpFeajRzFg/iGbFv0Bg+W/Cm9f8yvaqWvsw6ksF/+rePFsLKd0IuCi19/qOPEC7r3Xcx++M+wSeN91zOFfhV64FW8TlrvWlAhfeQ8OZhozt+8iIiD1a6GHEIhKYRLr/HfuCQqwniKP1debwrSH8xgmcXyJhK55BYdCqhekmESC9+H6++7v4HpWAhENX16GqIDqZaTrUlzjkAkkde7LQoKq7nbyjXW8E4sEB4Nbtx5CvJ7zklsKP4kzswW5sGR+/D3mM28KhC6ZPQmX1VFpvSU4wqDi5Sy0g9CXw7KaX/Wr3slWcgofbSwyCaGXCCClZBUtU0il0Rz88b+AhQwBZJnHlazDtNvEGh7VOz68unYNCruZsOsJ3MIfoz7gJOu8q8pe+NKvBI1I/e7/youC+H0F/UsrwP3rXal3JRJtpu4+jfoKeMqqLrVnhszUj/irnoZKaHHlcqzkPXc495lf5bXEf8bakLND5vH+yYx3qr8sqH/qvLwZesuejjNeCLn/Ip4zBmt3Xo31/jfc5xu5509HZuoaX/6SoaoWJacIGKHntGGaFSsSm8j5KBT7UoIncpRDzLNWXiI+lakV5tf+E4/XEHk9imL69iQ9SrKhgGbU60OPQFmfdG5IWW8xl7Z6/f6/JM+ei9UV0uVK0ek3BE+23jV//hX8z+DH15Vzi4LSEE7F2iGad50PSWsrcE3ppMhXHhnqWZUA0nKE1Is+0zhvRvluviSUsShilRN+8FJ2LbZh2elFP9Px7vwGbtpPg/1rGVDRkF2xztMSCmdIXGGS9rr7PZA6bfjyP2DwuZJ+ci+WLy7sloakzAzNVio23X5VSZl8NUgaO5F7Y5tz//5injP/AO9if8VBr4N/LJN4VfMolZj6R/GrhNgnJZ/eda5j86UQOgPGWz4Fnu9mcPQMMFwXBhwNlVulTDvdHQSiaupO6VZqWxHQjdzokSbABQqqhqSyLOLc+tdx6X0dV+JalMPsw0miRrSikqB4BrB2d/PvOe8K84NSclUJK+nFD/4Yy/Ja3I1noSx/lOjDdNnKgzynH8RiQand9hG2goUMFJR3VHzhTPjUC1t0/ohjmcf/7WT6XHlqKJzkrddiqv6y8quGGgq3UhphLyKVXFmPmE9sc/3O1IYpjLaCxw1aM3EZRIl3pBLmsZyOfgs/kTrHCiz1e/8oPKf+1ANYmBdyehfXGsS4nvy+PVPY1Ivv20mR6qVBTrnftfObtli9/nXO/euvQqzfISn10wBRdUm3Y72ya133fSnBJuap/nrsZudexv316lu4Z87HFf8ZysbT5Nu8Xh1qFWjXuoaAuo6FHkUg3siNfDeqFL01AfEofPcLzn3iTcFCFhnNbedkM0pWygSFI348+0V8KFRRMFJQChpU3P71kGaQuXevjCv1bs7NYRmNbUCBke7Ob/NBHsIo5sWZg4HzylvhHKxDHBF+tbAeDZJ8kwwMSnvbN1NXZdziENs7U7bUXfVWGi2G/PKf8nsc+FHsuZtbVVvQAOpboxDQfQwe7/sWhH4s57F6q/WRTDhUiOSJrYE2VZ/z3TFLGuJo1bkfoLyUaaLbcMHjBfq332I66Do8I9Qn3Y6RiJdaxwV5qgMTtMXsa/ASXPDPDKI/i1zIphcy1RyghqT2mTMEKqm8nIlo4uQSATSXJ/OkB13/7859CMKbRNiRDRDfgygkXfMarrEa6NG5/Vj3x1/qnF+UR3KfV4VspKAUtNXrje/EkuZ/uep9qFR2ck4WHQaSu+mjzCtC8LVCLPvEs5nGOJ26oYg1vzp+CPOhK4qr+DxJUHHVT4+pfeHPmCr5EG2Igp9hMNZ1V3t5o9B2esmINuqZwZq99H24qrFut3+CAYgas5UBsvMekgbyXDAgrNT3yvNK+q631lfjeXgZ+F/r3Gef7dzH34Kn5OMs3LwXzqevlYg4SVMi+PI8G/gd+7UGrFozc9EbeTTwq/QFBknx2Xkj9QYAzUHURB3nQBIToTgISFmhWOQa1FvFrnqvc//AHOBK5jNHjkHZbknIILEAGq3Y4GHBen7mTwfr17vbE0WWzktKLRL6fVg493FxJVaOL1/xJWd5UBrOzeCeP2Qzu8Z9I8NWsNRTMmjnt3PeGp4cGOH/Fci5QImXl5XX32AQsRN+2x917tMMhh74G/B7NYT5FBjhIclVQGY9wjeDbLO3OPfCL7OpyrOQFde1J7thpK3U3s1UAkyEzyAkF/tXlmzUR9TlG0nj81V5kKq8DCNHslbjSqZ2GNBezwr1T5yG1f6bzn37X1mh/sNwvymNr7M6cgyqezziuYzffs+F5F499WIW6v0Hlvo1JKbfy1JvGa4Z5bFozSOQt9u2+ZpYysUI6AYnJF+1vd9p5RCSLfqMJKCM/PaqjOQ//fawavaoU7EkIAZvmeMS9fOdi3LIdkLPx44RdfNzQvyqoqlikoX4N38+LHTzbkwli5UOWSz6lIU9NBEUsFz1p0MOfp960lVSyJG4z3wBc7fktoLBiywcPfZTG9hFRXf2RMQhDSL/66esrzuvc+5rvxuIcsWL+H6Sa60kx1bUVm0SyXwLZP459th/fpIx1waOpS4QYqs8Cmp/P5ctQqeNswY9uujhTmOdNbHiqVz6kyxyPbO+8uX8po2euJ4FbH/rL3uyX3shT3HIW3QSax2OYvqBuBX7oITJKIsG59Hjdurz2L7gX3h/Ohb7Ya8JfSJrPqqGhe4hYITePezbX3JyM2e8p2vKI8Ui5SZX3I1fcu4/3sVua98PK7/XYelOYyF7/SEFiHJtNgxgoexiYHDGL6C0NoZcqirVpGLbHsJ1/oHwTO8shDSA+9Ir96hgU8L4JHz4XbPwLlCcu5m6XPozuOuPqa7//EIl4h57CjvH/RS7ceHmHTiZE4kMqSJa969nh4PZxZ81iyy/WP6b7NSGj+ChuPFjLMT6YwYnL2T64HgU93aqkzcyR15Z5tO06xzt/EIsVRGO3MSyLP2gaj+RKtTzIHKN/ydi1VqMek9WpHPWIFHBDwj9zRB+N/xJXTSg0FbFqtcI80hjeMB0g2mh4t3/nX3uH2NRHacOfRNPkzyHA4I/kjbUJjMlLBJMSgNxLtUKntQTXM+8Ao/XW8Kuc5PnJX1D97aFXCMwlGvpTLiOIpDlxtduWE9CuN+FzC+4jOdpb2IBD2QuxbpMSgzibypI+ZBeu9vt3urcM1/Jb/KMVkN5nmlZ77iBbWaJcDqKf889B/VZeZry31N3MAeOlfNDyO3uHySETpnpvGMaKWmRyDBlnPUTbAULoY+OcE5konq3IyQKOWZd9jOezvQtq28nc8+P/Air/PMMxv6Cumxg2uFVEMcePCsc3s3errpkknJxJLl8NWc+R5940cfZzve5oR0WeFFaTTQAHQm96mBysahuFk9RDIJxKe3l80ky8IPP6ZCz8JiAYCe5DyXjbvr7Tf/M4IzLK7Dcj2aB3caLIPjTGGxrtEooYZVBqFhf7amw+bWsq/gwZZ1PHq3GOIhmny1GgG5hoZcQiGSkVbK3X4fy46b3N2OVm9lb3iiO01AC2lQmWuLlmCiPuLHLxT/JStyvOveDj6A4zoUMHk9iL4UMlBaTY3pLWNh20jNCniVllBRR/qU5/Jv/DTm4MAhpwbeZFamK1Ar1w/m+7YtsYHMplhBu+IghpxeGRMFuugCsuKLFTJkLW5hT3V9aeKejXv19RknbSm4NOnRMM9DYBzbaJOap+5177GaO/2DAczt13ISy14CJeN4qp21LfaSuZB2KQF28Zb6N+mCdX/bR8MYx1U2yZsKlSVGVv7YrHppEhgY0pAhdTdHykPQ75est9z36hwM59frU0WTwq5fJ3PNeHt18FyR8tnPHv4n7+nJI/lSi4s3wfVXpUvnxa0EQrnEQfTSDgkNJv28LfeZo+iMeA99PFqSwH3lCoIHumiexTZZqCHhC5ubdy03/P14U3pS2nMiVDGfd17q/0fnunZDzpec1lawAAC1hSURBVCgAzQPq3q8U5JITaYj4n//zWAWk0QKqwTVB6ZYURqXEtc4lggzBytvuQ44/Ym7wiFBWNcUdz2t17hv+CkXzfgpQZRoNlB0HNfFZ+uheL8/K15+Thx/Ltpq/zYK6v8DCP530KcusPE1Dv5FfVVDd7v2ec9/8YxTpuqBEpcjrBcXRy1hmdtAuj+I5uZXfyo9j9HjyOok5UZS71ijMQfa+LNo0dwHBPJkzUJynLpf9C5sLYX2mybzqoGuJlVG+ugHmuSlGV/NvPQ3pQQyFal2JDwK8UlDceqFa2nQ6xUniaXc3bVGrMDAMkT8vfIvc9frZWzlOpR9d+J8gZ0g5Ja5PU/EjkVPu+7XPwaPzbvo5/cfvI10xgZ3MCwL1umte5DQ5GkRAI/INlzKvdi+jeJFjJULgxtWc6bEo/y+/HQv1hbhg1x60xMuL9KN38tH89CnnOXfJ77JA7E+dO+F8BhBYUZ5ksyit8oz57RXNGGTE/+dgFfjgTyb/V/iS8tWLUNaeUOFik6fqEYVwVP1PvwJlCaELv5YRekpmLfR78nMo0megoLlLpbirDpik3MHCW64McOSWHWYgMAou3sLkmuZ35VHQXLRvJ9IknJAqNR//6pWf049RJQYnl3/E+dXs8g5pQBX7WDtlF47aq0Db6DZikcorVjUIb/qKl79qJOrMCMzfq1krqHyTuH5Ax0BNQeS+iukUNfKd7+IJhk/ykqWPBld8tMB9xAofMT95rw6lD5VUR1aZKuRppzqDgBF6Z3DufCko8f0PQrT3QXp8S1FUCvEe3c7Fb1zFdpq/elBBVIqvgYIUgoj0ua937nsQ+q7vYP1thIwpKyrcSmmrnkPWwUOR9Q4s3wsZiJwWYkbFUi2drouAZbktOZBXiTBqZBYV/EZcmoeeAfGg+AcmSAAmrQzCefwYSBlillx+6kT1pRC+KgZvXRJBHgfJo2ftZ6NcJBJeUf6KGeTgpAZLen/7Mtr0in8Kg0W174K2EQACok1BMuh2WX1sqoBawCfRdtMXSBrwj0mVTgMRDRIg22r7pfuBJHEGVxBXg8Qq92vMttp3bF+Ru59OAatDXhP0wNU/z3vUPx0WztUkdeGbBM2lI9bBqbt4wb5ziYDaykKPIuBf30ndlkE4ukd1s3ulzo+0cl/GTbuc61//Nd7KdG9QntqbvWpIlOnxm1l1/DekIaJ/f3rVBDUuIIuyG8IzgPfenfdWBgfI68kppViq5aB6yC265ANNrLzqBcURYeqZ9FN/DkUJ+Wi7zFYH1V+PAGrf7zksa/+t/2scssC1SE+LqLyVh1C+zZN2b7WMLc8PbDUdoLnryz8cyHyBZd7yAhdnqC6g9pViXHNs6nq1vpGc16BjJ31B/Thi71MrI9pymmuzEL4sZz/4U6dPHRqwHKD99t9MPAZiGlQsddDiyR359Oz+KHJN/Rg3/JfJV0FlZwijDDB8FfDweJkypLEo3UPALPTuYd+5kuPNi6JaEOJ55tv1pq6dfH/t48697ve4iVEo3mqooMh0LS6Qu+BlrHhn/vqJ72Gxno7SuD2QSCMWq4qQS3iU7zOeu0DCXP4QbJL51Oc7d50kTJR2VdNZcRoMyt8fyT9+sMH/+tmrQYSxHy/NZfTBE5jS8W+6E7F1sNLa0leW7cpLwhvKsmI9zUBrB4Q5vJH7hgFVbC/JPvM4z4xfyeOOrwyLMONagEiqsT+prAdvYTHrByH13QwOWPCmAU6WgWZNOemfGugNHMF9eneIWev+Ftzx3tfb2vxvBizhn+Q7ZGOfOUPACD1nDdINcTQHPMBIfBxCv+H3eRzt5c5txPqehWT1BrVKIT6fu3YDVvqfsFPc63DtoZk0fyuFlil4TUEZx6EM7+JxsJ9F8W0MKZesxDIJ0FykWPf1JzMn+RMoyatQ1Cw20ysoWxXkEpWi7ySZtUr2pvORZUw/XLsp5FAixaYzbCAhfVH9dmQNaxf+lXcI/C1eGDxXPqQZt0qWu5+mD1/DPXRBIGFF070whftKL2G5UH37pCqJU6f1KtVxiPxbP4fX6VzyQEN79zvyNR0kvwadeN30+GK9kK6u+qEPKj/+n5yyr/whoGa2YAj41cTDuJEZyLtr/08ARGTu52Mr4CN3XnTLn3Mpe2pDbI/9EIV4WkJEGXuWlMcg5e7g+zzy8ApMJ+sF4siK0OGZr+z/eE7fMV78jufK45R+1ytbyh/lNsw6gs2anyT+AG7iViq8WSwixlm5n/OuB1XD18FW27kqdHJQp8GY5q9nKVtd9/TLvQjhIwOZPvEA984T5EGfKLncyWgea3/0SKaRyFtBddN9U+mI9T7tEp6kUL/6EvnRr3x+GWQIJVT4VFrdB/TZMQYLCroXauKblDeNp0A8rqkCrwuWIocv2T7aiYD6rgVDAL8gNzg3raaDv/+XzLXdEECRa71akNtOI/hVhzn3/F8KsabuRwmhwDLd/CgVv6L54YXPnlcrL573xBx/8E02/tCp+H/6W+fTQdcUyuOUfvOPyqgZEsWmx6nwSgavRAvvJhWvgYJ/MQf51hOnpqxFukhF1a8UMtc5RozfIXnlT8VJDvXR2E+HVof+v+0zzj3rY6knJ7LkSZYP/QBPk7JO3y/kPwCBTm2lLSF2BW0vXG29h1aVyx2vx0JPe6U3qIPrfSX5yrLOKIsvKPlQ/TT49vcZ7vZjsPoVVE7VkCpn79P0QSJKN7RywFq1bLuwJARaqIKWJIclzgEC89uwOiFj3cBf/TDfuCBlpVe7+TXCj8S3+SLnnv1feDsUCkCPTPlQazSvtETSnOOTlHvee8Ijc0pX03Igka534qilQKOMek/6Juq9h8VMfrV7Shl6DJr8UP4Ycn5zGK+U+W2hMgLLsIr94j8NBDg0F+9/o90WfOs8rKt58gHIcwji1MYsIqv997Jnw6fwNL2fvviqUI7v2xlw3wNZb7mawfALuGewwFWmgtpNFvb0FjxQzKM3Ek6/hDl3ZHnqi+SJq2aYqYBIqn4QQt5xYBK//UCX86XryK46qq47PguZ/2f66gVBCi3CqxZiF9Zg8ukHKZeIqpPPt1oiO58LBGwOPRfNkBMhdCdzcP+72z7IlpKvRcG9EEJHSUSrqVzSQZSkrHi9IOK5b2DXtvexHeUPyON4jP57UQTSBlFDlCfmt5SxXMtZnz2XdpFr8p7bgpKpkGVTpyTiIEprWVLXY09Ficr0rhGk4KToNr/UuVuo9wow0KNJrVoNTNZuirmIEfId0dqEGjjWELOwl9R1MgUI2ZM4CTyZVkso/Dj06Ng860W0w+HsfaTh9MpXOHf+H7IXw5X0A/IT1nHQVk2GGOdB+uL2L7Ao9NX0+acPyqC578EJBgtbeC3qj7G6L+Y3Gjemq5Sv7jPdT9ow6XlvJS9+3/w2+uIh3FPncX41qZBNfa9E3Pz2lVD/FQak0W/Vc/99DApvZf7+Z9mw6bfJh/tNA/Rq97OXSfkRNFDZeiNu+g2UJQ+BgLKQawSM0HPdPB0WTkoAJTeyHiXwEFb6P6CEGNHLBehXHFfpLfE+P+lclNBf8ga232KzGkgonq9YC5SGHvER+W96his9e141UVRaZHbPLc697VnsHsb/mvNvNihLkSb6zb/oAiPIu8/Rye7tKOljT+cfhVTZ4UTymVRw41ko8+NQ5syh+kWByrAFwWfPxz4U6wAKXUpeyrge0bSg6FxkUQ12CRevCY+dd4E9h/CC52oGxdE89/BpDMCeiVfop8ObyzbSBw87NiT1A1h1jDpB7aD9AW79N+6RM/mfkemCttGAj7IG1vG2tOvZrwHLX6/clcwi9mrBD5LJdwzr/pJfYjpqEwPGf8GT9c+hr2rgOXQK+TJY0I56sROrfD26OLeFgwGLwuTzeRrj78Ial1VHhLJrkbkGG/H64/exc+NHGOy8LOQXPQ8+Y/vIJQI1ulUu5TWh2omAtCThACwJH7sff5LtXV/v3HNQRLWCFMAsCmiI3nTRK9nj/b/jqoMQD0HpTP0IpSblmNa0/JZ1MXwUc4+P8czxL4dBQ60yogKXJv/+53AfEnkNg439yl8uhUZDkqG3lki76tBA6qPHMd/5ebZ1/eZBQi+VXVaGV95cXMFI4DSsqBveTp3PBwuI3SvZsviN/lS5wlZTHyL1ScjAY6kLBQzeoqwGZoP1icSplegv+r8QJFa1Z/Qa2Mhylat5BBIcXx1Wsavt/OtHSa6+IBkjodUSKZL+Pd9jF7a/pt25R+K++Ol0smxHT4aMuZfufS1PclyRyJmOVOF/Eb4fRFMvpdlwDuX8DC/X4b56+sdYzw/gqaKfzTEA94/JjYEBdRrhxlh+Ef15IwOBU3gKg0HpUQwIhE1dy5xoqr9w0nsEfnwtvzmnAZAWx3nLv4Ksdio/CBih56ct8iEJN/4cimJ4A4ptC5vNMLo/4zkoiMMTBVOlx8hqUFh3Igvk/ti5f3kzI3usBVkRBxJrIcTgEy1BMZ6oZGDE956Xrlf4Jypw/6a396CsKGf6IfKRIsfiaShIS0kAghYxrYAURoaCwpPL9JBjeRb4H3nU6DWBrEPMyp8xK815XqcoKEOvBStHb/ist5iQbQpCH2aU5TfdaTiX7ieIBOhXS0MWLQmAr/3Gz3vl0nJTG8rSFpE3Qub7IbnrPhAI1M+dJ32qJA2/RejaKGdqJdNYkPrxzwxWeq1HQmN6kbr3yHBv6c1pZ7yI1fcvCK5wvZRIU0/aPz4S9TADW00TyaO2fFX4P+ZVy8MW4/jBbXIfP3g7W8a+E3xfArnv4nZJzse49p1PBOgyFgyBFAJoN+klPW4ziXK47xrnvvM5rCCsg5J1WK64iK9r0Uo/D4vi+y/jlaSfhXixEBZsNiMlRxkjWA1PozTOfvPBZ889EVbIO33+zu8yr0d5J67Gar07yJqSvqF/NQ6YOARZkEc7sPHl5lHSYyfgIr0Wiwj5Tn8eZSQyx0FFupB47missPUvp07/QX6nkg/5tSRIKMoXvvueCm53/zihzhckiEwk8x4GSzvvY8xzWIIp1uCSQtJX1J8aCsRXGk9gCba1XODpvCN56tx1H2HR2icgWwYUeiFORdIj/zlId/ws5tE/jMfrQga8bw14ZCFZDTAkp+LKu6DHOuW215ElKJ3kylK/6J3Q3PkN/x9p1nFgnWunObPOs6Dd/Tg0tQVDoAwBlJAIfehoRvlc+ub7mEt7MCgUkXa1MITy0YIevSnt+b+MEiCiyLz0GJsS6iRBi3sowj3zNfzP3HDNkKTRC0u+gwLFoHZzkIMPybXkV6YvKSdxiZ4NniAzKbwD5OMVsvKjjugxd/vniVejvrEwKVw9cnTG65gnJf7gSvLTaKEVAXm8GxRFLmKQ613lRRxbUUQ784iWqF7les0HcD1/hT5F/1CduhXUziJKkZy+46CsnjyeVImvcNPVLFb7FSzYl9NdqJvvO+HSok8tjlO3Wn4xc+G/zZz7NSGKylee9YLk84TMtwYUSqND/8vz4Q/9X3ZN/cTXMYOWj3VTv73+I7j2/4FBw0WQOfeZkXm9FsrP9QxNnR9hTZIOIYAikAKa28pNjavvoZu5yT8TypaC8IRSSRQlEtkQzn4+K4ZReOJdvXjFB/U2FJCezdWLY8jaaSFdKSh9jfDwPSjRjzFgOANFw/9eESfl1Ui24JIUr19FzEhlkvlTWT1SiL5o1ZvzM9uwupDrh3/KLnAPheRZlP5JzwqL6vwLOBLFXyq8QTlL6eI/wo2Bj1a9T+1J5I3XcvodyXw/LtsvvhePzX8Dn42JsNSnXqjTHUrJ1TaNHKWEGf/R4EOE50mVNLd8kS2S8UBNXEbfYZBVL/g+Rzw9Qja0iZcg/Qbu7G+FVMpTOMX7plZeqmMciHiipo95q50+rPPl17L02QV1o49+66PU723cY69ALnkdsjZCLcHtWscQoCtYMAQqIMCNrEd7tAMaxqe77u3sM31nuMGl3KoFr6C4roVGF/8MVgkR99yBVbYhWGXitRH+3/YYc59/wMI2FsYpVB0khMv+85ZrUaz8JwWpfBoNSufnckk4uTZ4BlTuAqWleuMuH16N3MS7Cxd/DNVkjOn9M+m/zsp90mj3uwULATMoxmp18kmTi6qDXlUrEojlRvm68l1F6EpkvvpKZNZAxzdifWmrZF0/YYtiRItXmKtfa776BjxE116OB+f5gUD1DoIs3hLlMUuH0ktS5P655i0MTj8fBPV7PSSDhnCm/Z/qy/4+pnOpbtqL/qv/yHsZuGc1b66Fdr5uyG2hOAhYc+W9raTVEjKIhCJFXlWZp+Iuya1Jucpqdgvkt5F5a5TZ9Z8KYPk5XBRQtSCrQeHUC1j1/sdhW1dPnFi/CtrYA/3hzsbCiXWrWh8lIGiv7G+T1+H8P/NQkqwRjU9lhIeSTKBUR1GqFfFRBEhHblQ85+5WFLgWPynUk1FkdQaWm6Lr+eM0ccWyauWRvhbjCx9fTTUG/2gOVYp2H3j4/qDz3QwVyi8n87veg8cDXPxjVbUIMMmr1M87XC+VG0lc39HilRgPMyj93J8xsH0dfHwJ7ctIVVMgIuqswZM63orRo8kbr9W1L3buK/+T+2PrwbJi+aX2z5p5xnga0Mb93EXk6nNb76Vuf87TKT/PvY5MCn6RH9ebGjn7HOyjGwioySzkGQFIQo+RSdfpBlQoWWc6KW2ffOvmlDtZrlnvghtX7CUE8tOcmrLHW+iueyfPs17h3AlnMaJnBK/H1GLZvpSUHFPILNK86FWs7v17lNb9KItjiE6cnViweqvaMaf4VMFSCP8uzI9zUrIaQNx7Kwv0HnPueFzh+79PNCnSGoOKmF3pm3LnyWs5inQcr4NgK2FXihT+ETHPYQVPXky5V/F62Hc7p2fNo2dCdVB6vnyIeal9jjuDbUNPxi3+YCB1kZiCf6yKbz0OJNmVR3lQXaXItaZA7acomn/Vs8a+DP3mulaKy/WuVc1aBxCvlefX8d8IHMl8H8T1pffi4XhPIHOt9o7vdK8ml+qvndxUdwXfl9tROfIsz1bt4TFPyvblI/PWe3h86xu4yD+Cx4bvFRCe2iW9I5ziZg2R1EcYmQ5eylz8rzBYuIFH097IfgzPom9qFJmEdH/zfUbnVXjWoHqmjljH+Ejlrid4PPPruNg/zNqPq6kbgy71NyPzrADnL15CEfkTzCQKCBxAcQ+dCIlhke3jfwURXLUQlaHmWff9ILn/G7AiFuSLMpAS0G5aE5uYT77Luc//D+fegqJOK54FaZIfo4Phn8PWQYwQnBbVaX5a5ATXu0NOwgKGXBXiQCX8qvypub1VXJrbnlxHtqxBynAOIhzBataqdtXJz5tXU46cF3FqMAO3ups+Gwg9i5za13457fUUCnLo7FBnybkX5alQdwFgiObdu/BJeDnHvuRk6kuWulzver2l8pTi7kpIyhWUGqxIlopkngxkasmogdTs3QxW5OIg1OrnIUbrP6dwHe1g4PgYcjx4I2T7JTwu1zI4ZUC36hX0G9rCD0yavacQOZL6IAMybdry9DXhhUh3/gZrSi5nUEi/Wb128X2hPpt5sSUNorcClgYCCVRK/wT34n3U7e7Ps/L+Q+B8OmSuulF3XzexQrf6U+ubtK9yVNNZyCsC3JDewpvlBkfGr3PzrTkSC3ADio9zUqILRuy6CTmp51O//E8oRn6Oo3gOyL+9xDCHkjsEsroFGT6BdXHZW1Bwa8hUQnhBUgUkcizj+3rIcOs1wcLXynntSy3Su+cfIUqskpOeQTrieUIqy0c//cr2L1Du35NuI/W+l+J0QWVkCFJoUoTyJqxAbg145Nb0eVRLT95+cdxWyjwHt/u7eL5+M5vHPCcQlrckU2klShT99m+wkhsyH4MA5iCmZRDu2Bh7fX8MlybpT72I87OcR66YRln56vChQcPWLWBzFSSifCUvZBitKv7zkb0XgfN6ecaKI/zZjn94mZNSZxh9DEPmWgBXssxfiqic94sEqW/doHZi4HjjJxgU/XzifeBczbaqm+nBCF5e8pPlL7ez7qEp5NUz3bJWdzzMQOye8Djlnq8Rh2sjZwTSVS767UO64ZJTjX759mNkq++JZ5L3HgYPf83q8r/jKY7X0t8u5KDsw4+jfPqtnqLwU1lZcCwTRk8YbKcvP34v+d+Cx+lbeMk+TX7kq4V9GmTHuqlfZr23yoqxnzlAYNk7uje2z0H1iyPCACS4G6Wz6ihu8hcEReBH62nlgsaS5aZ3i2+9HjKnenJh+rd8LKWq3OTe1cuo4gBKbRcKcTWZH/Fy8h8m47Rm10+U5qCU+5MokM8iE+f0Egx5GxR1EEWyfxvKm//X/SS/ITylKQ9S5HsfxVL6MoqHi971PFUeq8Zv0kfyXbkegtC8J+WkIauRGiYiLrLJ/T6DQjz81ZDsGlJUkFWVlKty6z8jJ3GGIFn/XngKUxtoa1LNqR/xJuoLdmq7NFEJF/0WDk9/Byv3Nso6ld+Qji+vgtCKr13ktCZAm4l0xEpHUN/miLX7C869lH6m1f0KIo4vvS9xs4vMkT0zmYcsfGeZfgCvzplhisZ7UuK1JX4LY+EumdRWs3tpFwZEalt5obQIVGHoZPor95lWpavDaq7cr4dQR25D8PcW94v69+xuBhn0lbkHkeF42hZrfdUm7rfjGLjRztotUP1Y+/tro6G4XkV109oKLW7TgF5ekl2PQ9zcP9up2847Ofc98n2KdCeRnvzUD7VKX+k8kbehbpZlZxEwQu8s3o2XJkWuu5XvZYcGN6s4rYJ+93krKoN+twIFoZtU8+8tCcoLstEjZ7I696As6skhGSc5hhIy93Ik+WhzkSkGKOifWD1/Of2huhDdz99rL/N5lK8nQV2oFxLcFHXiSI6VlJMlXTpf8vBz2IwmpAj3PxJkTUcp/38MOYcgA4+7hFeZ5KOFgLOk34+XolZQdKLWJXOfh+qYDC5WHk25JGy4jj6jBj4Q0BM6Ze/5PBsOfZXNdy4OZP7Fv8KN+0cQULNkHsWgA0/dR9XAy4NRaQAV42b5Fk4CVu2gm4NBqNpDI0o9xTEgYoTcRKhan6C4Ijl5F3xQ+nYHycchufz7ABgMaWGmXiAz9wCXuNl03w3SztriVXsd+L3cNSpWUtJKXlnacwyctU/D/EM+S7eM+EPrObjntFhT95AGNb5+6qMWegYBI/QiNKVuOik1vgePSZRRLSXHDTvHyHzRlqtLrasUW6J0pFi8iV1LDuQVCc9D3AtCUh/tRLUMZeqV7YIIqR9SPpCpCNVbEbXKSyWT8tYiOO3Z7XfV4rcGJH5AkI5X73/VGatOSt/vGU+eVYPKkMUjS0/EkY7L/z4PLP5qFrePL2xQ5nLXV43HpRi8cib+MIpaewa0PVCPSOjbIfTX3soOeSc791mI/C6O1S+j2hBLw5Z5WnBw1Pu72x3UtH4ARL9Q3/Aer3T/UoROh9hn6Af+Va+RsGljT8IQux9siJA1ok7J6+ND+mofPzCI/yd9UYNT7/FRGd2oW6ex7MPyjNAL1uhZ7sUscZqutteCKIYkg+TnAv0Qy4/fFcuKCStePHiylEfG+D6lBhIoOs07aorCz5vzu2EyPyhGqHCsdPp8+f+SU0eloPRZ8lBaEXvGoHp51zuErsWKbbXSkV+EoQGHFoid/25cug+yPuBtkPmLERicl0Tmsc5ZcYrxW/Fdrd1akXczeaQxEMGrT+g79rFK8ioNh+8DDEQ1UFnQ5yqlaUY2S5NLBIzQc9ksdYTSTZm+2cuj17teHr/Z3/XKqXdd5daLU+96uezElzITia9aj+WKlVJ3EVx5HgX9rXrL9a7FaW0ldfDx0y9yW0Ma2llP7lxZiC0h84Li3xGxa9335QLo3rHQVwg0YAf0FS75rmy9m7re9VbVrl459a5Ljnpx6l1P1yUhc53STnB6TWa/kLkfGGGN6VE2eSfaHTQXLfetFpd5MtdvXO22uKrNyIuksx5tFsWyzx8CRuj5axOTqBkEpOQS8l/OKnq9ZtSvkNb5fgjU3a+mxxWuR8eWNL2QBa8Ea78jHhj7udl+wToLPhbHEOgCAkboXQDdimwPAjJMR5lDntCq+vK5w/YUma9cIVmt0t6nx+y0KroDBOsXkoncO1BWvsA2aQyB/CFghJ6/NjGJGkVAFiKkovlyPacrIvNzyP1IMkmd93TI9d5oU1l8Q8AQaB8CRujtw9Zy7gQCCXlrm0s9tqWd1vrK1V6OMQMbzW9r0xRt9NIJK71cBPttCBgC3UHACL07uFuprUBA1qjcvQTtljbCs8t9swguVLvyJ5hox8D9PLuvV34aqVeGyc4aAr2GgBF6r7VoP9UH4tJU+fgaDnb86mvLvLzdzfVejoj9NgR6HgEj9J5v4t6toF8EB5FPst1qu5+7LhyK0fXOY2V6S589Tla4FjSBDYGGETBCbxgyS9B1BDRvjhB6vabeoFZaBNd1wXImQHS9s/2uXthhrvectY+JYwi0GAEj9BYDatm1GQGRuaxPitHbpwYhdXO118dc72MXThYMAUOgdxEwQu/dtu3Nmsk0J2gR3Khe/8jWo2Z5BkyqfWrVu95Dv5c3vZnrvRpKdt4QKD4CRujFb8O+qoFfBMdrZJfzrmr/bvNk8VdfgdBoZeXRgNSnIHS9L1ukbmsOGgXR4hsC+UfACD3/bWQSJgjIOB/hNaaTEHp0uxs4DSDA4GePXO/swW6WegO4WVRDoCAIGKEXpKH6WkzNmwOA3qC2ks1jbBFcc71BuOltaN71bp6N5kC0VIZAjhEwQs9x45hoCQLJvPmKdbYIbql9wrveeYxtao+53peKpaU3BPKGgBF63lrE5FmEgObNJ7HMx2wR3CJsmjqBda7XrM5F13syYGoqL0tkCBgCuUHACD03TWGCLEJALmJOjrNxzHLeomaPpy1CqKkTJdc7z6d7z7u535vC0RIZAnlDwAg9by1i8gQEIBktfBvBKl+RLIIzaFqHgFzv07y8xVzvrcPUcjIEuo2AEXq3W8DKX4xAQuYD9E69Qc0es1oMUUvOgPNeXuAyN8OCQ7C2R9lagqplYgh0DQEj9K5BbwVXRSC1CG5oxFztVXFa4oW0611Z6bcFQ8AQKC4CRujFbbvelBxS0bz5BJb5KM+c205w7W1m73rfxatWd5snpL1IW+6GQPsRMEJvP8ZWQlYEROZY52OrIXQWwR2A2c1qzAreEuKB+z5c77M8o26u9yXgaEkNgS4jYITe5Qaw4hMEIBXN4Q6PMm/O+81tPrdzPcO73plH38eqd8122CCqc9hbSYZAKxEwQm8lmpZXcwgkZC4iWXlUYiU2l5OlahIB73rH7b4f97stQmwSREtmCHQZASP0LjdA3xcPiXuzkC/tBKd3nPvnzfsemA4DoHYg7MdK9653HmszL0nAxD4NgaIgYIRelJbqVTkhEr8I7gjmzlkEJxIxl28XGlu4ow3mcb3vles9rl+QD96CIWAIFAIBI/RCNFNvCukJBOIYWxV2gjOLsPvtLNf7jFzvcdV790UyCQwBQyAjAkboGYGyaK1FIJJ5XARnVnlr8W06t7TrfSq84c4GWk2jaQkNgY4iYITeUbitMI+A3Oxy6fJjxVojjVz1CrnesdLLXe9G6rlqJRPGEKiIgBF6RVjsZNsQSCxATc2uOJrH1NgJzsiibWg3l3FC6t71nqx6by4jS2UIGAKdRMAIvZNoW1l+wZs2j5k4/OAiOIMlhwho4MWxfztz6vvNi5LDFjKRDIFFCBihL4LETrQLAbly57QIjl3gJlgIJyvdQk4RSKz0eXaP2wep+y140RbmTclpe5lYhgAIGKFbN+gIAloENzfHc+a42CcPw/iTBWiM3hHsmy5EpD6UrHqX6502U7NZMAQMgXwiYISez3bpLanoZVoEp86mRXCDtmlJcdpXDM4RXe/yspiVXpzmM0n7CwEj9P5q787XVoSApSdjfJKd4EbYq90IofPN0HSJstKTVe/mem8aRUtoCHQEASP0jsDcv4XITesXweFmH58wMi9kT4DUB8pd7xqoWTAEDIFcIWCEnqvm6C1h4iK40RXsBMciOAsFRkAEzuFd7/v4F81hnpYCt6eJ3pMIGKH3ZLN2v1J+JzgtguNlK1oEZ+/Z7n6bLEmClOt9b7Lq3dp0SYhaYkOg5QgYobccUstQllx6JziRullzPdAvylzvqpFt2dsD7WpV6BkEjNB7pinzVRF0v5tgRfvIGGTOCncLPYIAgzV5X/Sa1Wk2nDHXe4+0q1WjJxAwQu+JZsxPJbyrHTZfvoaDuXNZ5mad56d9liyJrHStep9lwxlIXd/mel8yqpaBIdASBIzQWwKjZRIREHlr/dQ0G5FMJRac3LJG6hGh4n+rLQeYRol7vatG5novfrtaDYqPgBF68dswXzUQoUPgc2wZuuNB5/buCL/NNZuvZmqFNNpFzlzvrUDS8jAEWoOAEXprcLRc0ggkVros9V1bndv5RJhHN9dsGqSC/y8rXa53nmSQ633OXO8Fb1ATvxcQMELvhVbMax1gdHUwKfztDzs3OxNIIK/imlyNIaDFjmnXOxxvrvfGILTYhkBLETBCbymcltkCBKThCQMQ+yzz6dvvZ159L0rfel0Apkc+tYucXO8zyYYzPVItq4YhUDgETLUWrskKKLBc8JC6toDd8ZBze9iYxC+i4lzC+QWslInsEVDb4no/kHK9+7a1hrUOYgh0HAEj9I5D3qcFSvFTdR27H4fYObzLVicsFBqBkut9D5b6zmSQZu1a6DY14YuJgBF6Mdut0FLLBb+f1e/bsdY1r24u+EI3Z0l4zaeb670Eh/1jCHQcASP0jkNuBcrP7ufVp5x7egskgGXn3bQGTXERkAdGVjnfe58Kq96tTYvbnCZ5MREwQi9muxVf6kgA1GQnK+B3M6+uYCQQcCjiZ9xwZpaFj/LA0MQWDAFDoIMIGKF3EGwrqgyBROOLxPdsC/Pqeq7ZSL0MpwL9jPPpfsMZrXq3ufQCtZ6JWnQEjNCL3oK9ID/ELhf8FAuqnmZ3uRl2mTMiKHDDisQ59j1prvcCt6KJXkAEjNAL2Gg9KXJC6nMsktPz6javXuBWVlvybPosFvo+rXpPPDEFrpGJbggUAgEj9EI0U58IieKPlvmOR5hXZ7MShXgu/LLPIiDgXe8jeF1ow2lzvRehyUzGHkDACL0HGrGnqpBYc3LB72EP+B2P4ba1efXiNjHtuNdc78VtP5O8UAgYoRequfpIWIh9kN45tRsX/ANYeTziZpZ6wdqfNpTrfY6226dV78lgrWC1MHENgcIgYIRemKbqP0HlthWp601eIvV9kLsndaw+C8VAwFa9F6OdTMreQMAIvTfasWdrIUIQiYvDdz7K61jZtCSe69lK92DFtN/7XqZQNDgzT0sPNrBVKRcIGKHnohlMiJoIyFULo2teXfOxmlefNWKoCVmuLsr1DqHP8TjiXjYQMs97rlrHhOkhBIzQe6gxe7oqYgEOueCn2SrWz6vzSlaz9orR6n76hL3epyD0KdvqtxiNZlIWDgEj9MI1WX8L7ImBXqsd5bazCc3eXQEPI/b89wuNyWSp7zPXe/4byyQsJAJG6IVstv4WWqQ+QM/VvPou3O+aV59P5tr7G5mc1x5G11z6PJsH7eX5dBG8BUPAEGgdAkborcPScuogAiL1OK++D0LfwYI5/ypWsbyCsUXAIWeffjAm1zuPsemRRHt1bs4ayMQpNAJG6IVuvj4XXqTN4efVecOX5tWn4q5k9Gx77jmf/cO/lY3n07Xqfdb27c9nI5lUhUTACL2QzWZCpxEozatjte94iB3m2D9cRC+3vJF6Gqkc/Y8n5QDrIPTudGujHLWLiVJoBIzQC918JnxEID2vvnsr8+paeAVhaBGWhRwiwIBrGVb6NIsa95vrPYcNZCIVEQEj9CK2mslcEYEF8+o8HqV59RltGZv0crMEK8LWvZPyokDqes2qud671wxWcu8gYITeO21pNRECkISC5tVnmE/fwaNt8VWs5oIP2OTqM7reIXUbcOWqZUyYAiJghF7ARjOR6yAAqafn1Xc+zKtYtUOZLEJ6vBFHHfw6eZk28a533O77cb/Lm2Lt08kGsLJ6CQEj9F5qTavLAgTS8+p7trEXPIf2Ei/NqyfW/IJE9qPzCGigFV3vTJFo0BU9LZ0Xxko0BIqLgBF6cdvOJM+AQHpefT/PPu94hIVY2jJWPV/uXiP1DCh2IErSFnui653fFgwBQ6AxBIzQG8PLYhcRgYS0/bw6FqDm1ffJvQtpmAs+Jw1KG2kXuRn2ed/HY4fmes9Ju5gYhULACL1QzWXCNo0AhBHn1WWV72IF/G5tP6ptZCESs9SbRrZ1CWkX73rn2fQZvCg22GodtJZTfyBghN4f7Wy1TBBYMK/Os+o7Hg9bxg5C6hZygIBc7RC7XpOrQZa9dCcHbWIiFAYBI/TCNJUJ2ioE0vPqU7jetbuc3zI2uRvMWm8V0k3kIxJncDXLI4d7WfNgrvcmMLQkfYuAEXrfNn2fVxziUBjAIpzj7V+aV9+ruVubVw/AdPMzIfX9TIloLwGbEulmY1jZRULACL1IrWWythYBkTqHn6vl3916FSuuXr2K1UiktVA3lRtts0evxmULX3O9N4WgJeozBIzQ+6zBrbqLEZALXoSh6Vu9LGQHxK6tSG1efTFWnTwjd/scFvo+c713EnYrq8AIGKEXuPFM9BYiIGtd7naOaR6d2s68+n5eyeo3OeGSzau3EOsGshKp72eXv2lzvTeAmkXtVwSM0Pu15a3eixGILnhIfZ4d5XZC6rtlHYrouVOM1BdD1vYzYB9XvZdc72onC4aAIbAIASP0RZDYib5HAMIQiYs39vAqVm0Za/Pq3esV3vXOc+l7sdT9qvfuiWIlGwK5RsAIPdfNY8J1DYGE1GUg7oNItvOClzivbpZ651tFRD6Ft2RK0yC2EVDnG8BKLAQCRuiFaCYTsisIyESXu52vWSzE7Q9A7syvlxbL6bqFziCQuN73adU70yHeUjf8O4O9lVIYBIzQC9NUJmhXEEhIQy54ud39q1h5Plq/xfRmrXeuVRa43oW/BUPAEFiAgBH6AjjshyFQBQGIXSQuHtGrWHcwtx63kTVSr4JZO06jsabYAGgKT4m53tsBsOVZZASM0IvceiZ7ZxGI1jqlilS2s7vcDM+rG7F0rhlkpTs8JXK9a4c/e/qgc9hbSflHwAg9/21kEuYQAVnqWiS3/X6ek94dSD2HYvaeSPKUsChujtfgasMZBT/9Ef61T0OgrxEwQu/r5rfKLwUBkbqM9p2P8Lw6FqMPnDQXfIJFu74EPJorut5tgVy7gLZ8i4aAEXrRWszkzRUC4hYde/QqVubVtfmJuYHb3ESy0qW55HpngaK53tuMt2VfGASM0AvTVCZonhHQjaRXserRthncwZpXt9BGBNKud/YJUDDXe8DBPvsXASP0/m17q3mLEfCvYuUZaf+8OvPqRjAtBrg8u+h6ZyCldQzmei8HyH73GwL/D68dLsCqonUGAAAAAElFTkSuQmCC" alt="rapids.png"></p><p><a href="https://rapids.ai/">Rapids</a> is a great option to scale data processing on GPUs. With a lot of machine learning modelling moving to GPUs, Rapids enables to build end-to-end data science solutions on one or more GPUs.</p><p>Documentation: <a href="https://docs.rapids.ai/">https://docs.rapids.ai/</a></p><p>In [1]:</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># rapids installation (make sure to turn on GPU)</span><span class="token keyword">import</span> sys!cp <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">/</span><span class="token builtin">input</span><span class="token operator">/</span>rapids<span class="token operator">/</span>rapids<span class="token punctuation">.</span><span class="token number">0.16</span><span class="token number">.0</span> <span class="token operator">/</span>opt<span class="token operator">/</span>conda<span class="token operator">/</span>envs<span class="token operator">/</span>rapids<span class="token punctuation">.</span>tar<span class="token punctuation">.</span>gz!cd <span class="token operator">/</span>opt<span class="token operator">/</span>conda<span class="token operator">/</span>envs<span class="token operator">/</span> <span class="token operator">&amp;</span><span class="token operator">&amp;</span> tar <span class="token operator">-</span>xzvf rapids<span class="token punctuation">.</span>tar<span class="token punctuation">.</span>gz <span class="token operator">&gt;</span> <span class="token operator">/</span>dev<span class="token operator">/</span>nullsys<span class="token punctuation">.</span>path <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"/opt/conda/envs/rapids/lib/python3.7/site-packages"</span><span class="token punctuation">]</span> <span class="token operator">+</span> sys<span class="token punctuation">.</span>pathsys<span class="token punctuation">.</span>path <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"/opt/conda/envs/rapids/lib/python3.7"</span><span class="token punctuation">]</span> <span class="token operator">+</span> sys<span class="token punctuation">.</span>pathsys<span class="token punctuation">.</span>path <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"/opt/conda/envs/rapids/lib"</span><span class="token punctuation">]</span> <span class="token operator">+</span> sys<span class="token punctuation">.</span>path<span class="token keyword">import</span> cudf<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>In [2]:</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token operator">%</span><span class="token operator">%</span>timedata <span class="token operator">=</span> cudf<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">"../input/riiid-test-answer-prediction/train.csv"</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Train size:"</span><span class="token punctuation">,</span> data<span class="token punctuation">.</span>shape<span class="token punctuation">)</span>Train size<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token number">101230332</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span>CPU times<span class="token punctuation">:</span> user <span class="token number">3.56</span> s<span class="token punctuation">,</span> sys<span class="token punctuation">:</span> <span class="token number">3.28</span> s<span class="token punctuation">,</span> total<span class="token punctuation">:</span> <span class="token number">6.85</span> sWall time<span class="token punctuation">:</span> 1min 4s<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>In [3]:</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">data<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>Out[3]:</p><div class="table-container"><table><thead><tr><th style="text-align:left"></th><th style="text-align:left">row_id</th><th style="text-align:left">timestamp</th><th style="text-align:left">user_id</th><th style="text-align:left">content_id</th><th style="text-align:left">content_type_id</th><th style="text-align:left">task_container_id</th><th style="text-align:left">user_answer</th><th style="text-align:left">answered_correctly</th><th style="text-align:left">prior_question_elapsed_time</th><th style="text-align:left">prior_question_had_explanation</th></tr></thead><tbody><tr><td style="text-align:left">0</td><td style="text-align:left">0</td><td style="text-align:left">0</td><td style="text-align:left">115</td><td style="text-align:left">5692</td><td style="text-align:left">0</td><td style="text-align:left">1</td><td style="text-align:left">3</td><td style="text-align:left">1</td><td style="text-align:left"><na></na></td><td style="text-align:left"><na></na></td></tr><tr><td style="text-align:left">1</td><td style="text-align:left">1</td><td style="text-align:left">56943</td><td style="text-align:left">115</td><td style="text-align:left">5716</td><td style="text-align:left">0</td><td style="text-align:left">2</td><td style="text-align:left">2</td><td style="text-align:left">1</td><td style="text-align:left">37000.0</td><td style="text-align:left">False</td></tr><tr><td style="text-align:left">2</td><td style="text-align:left">2</td><td style="text-align:left">118363</td><td style="text-align:left">115</td><td style="text-align:left">128</td><td style="text-align:left">0</td><td style="text-align:left">0</td><td style="text-align:left">0</td><td style="text-align:left">1</td><td style="text-align:left">55000.0</td><td style="text-align:left">False</td></tr><tr><td style="text-align:left">3</td><td style="text-align:left">3</td><td style="text-align:left">131167</td><td style="text-align:left">115</td><td style="text-align:left">7860</td><td style="text-align:left">0</td><td style="text-align:left">3</td><td style="text-align:left">0</td><td style="text-align:left">1</td><td style="text-align:left">19000.0</td><td style="text-align:left">False</td></tr><tr><td style="text-align:left">4</td><td style="text-align:left">4</td><td style="text-align:left">137965</td><td style="text-align:left">115</td><td style="text-align:left">7922</td><td style="text-align:left">0</td><td style="text-align:left">4</td><td style="text-align:left">1</td><td style="text-align:left">1</td><td style="text-align:left">11000.0</td><td style="text-align:left">False</td></tr></tbody></table></div><h2 id="File-Formats"><a href="#File-Formats" class="headerlink" title="File Formats"></a>File Formats</h2><p>It is common to convert a dataset into a format which is easier or faster to read or smaller in size to store. There are various formats in which datasets can be stored though not all will be readable across different packages. Let’s look at how these datasets can be converted into different formats.</p><p>Most of them are available in pandas: <a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/io.html">https://pandas.pydata.org/pandas-docs/stable/user_guide/io.html</a></p><p>In [ ]:</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># reading data from csv using datatable and converting to pandas</span><span class="token comment"># data = dt.fread("../input/riiid-test-answer-prediction/train.csv").to_pandas()</span><span class="token comment"># writing dataset as csv</span><span class="token comment"># data.to_csv("riiid_train.csv", index=False)</span><span class="token comment"># writing dataset as hdf5</span><span class="token comment"># data.to_hdf("riiid_train.h5", "riiid_train")</span><span class="token comment"># writing dataset as feather</span><span class="token comment"># data.to_feather("riiid_train.feather")</span><span class="token comment"># writing dataset as parquet</span><span class="token comment"># data.to_parquet("riiid_train.parquet")</span><span class="token comment"># writing dataset as pickle</span><span class="token comment"># data.to_pickle("riiid_train.pkl.gzip")</span><span class="token comment"># writing dataset as jay</span><span class="token comment"># dt.Frame(data).to_jay("riiid_train.jay")</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>All the formats of the dataset (except csv since it’s already provided in the competition) are available in this dataset: <a href="https://www.kaggle.com/rohanrao/riiid-train-data-multiple-formats">https://www.kaggle.com/rohanrao/riiid-train-data-multiple-formats</a></p><h2 id="Format-csv"><a href="#Format-csv" class="headerlink" title="Format: csv"></a>Format: csv</h2><p>Most Kaggle datasets are available in csv format and is pretty much the standard format in which datasets are shared. Almost all methods can be used to read data from csv.</p><p>Read more: <a href="https://en.wikipedia.org/wiki/Comma-separated_values">https://en.wikipedia.org/wiki/Comma-separated_values</a></p><p>In [2]:</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token operator">%</span><span class="token operator">%</span>timedtypes <span class="token operator">=</span> <span class="token punctuation">{</span>    <span class="token string">"row_id"</span><span class="token punctuation">:</span> <span class="token string">"int64"</span><span class="token punctuation">,</span>    <span class="token string">"timestamp"</span><span class="token punctuation">:</span> <span class="token string">"int64"</span><span class="token punctuation">,</span>    <span class="token string">"user_id"</span><span class="token punctuation">:</span> <span class="token string">"int32"</span><span class="token punctuation">,</span>    <span class="token string">"content_id"</span><span class="token punctuation">:</span> <span class="token string">"int16"</span><span class="token punctuation">,</span>    <span class="token string">"content_type_id"</span><span class="token punctuation">:</span> <span class="token string">"boolean"</span><span class="token punctuation">,</span>    <span class="token string">"task_container_id"</span><span class="token punctuation">:</span> <span class="token string">"int16"</span><span class="token punctuation">,</span>    <span class="token string">"user_answer"</span><span class="token punctuation">:</span> <span class="token string">"int8"</span><span class="token punctuation">,</span>    <span class="token string">"answered_correctly"</span><span class="token punctuation">:</span> <span class="token string">"int8"</span><span class="token punctuation">,</span>    <span class="token string">"prior_question_elapsed_time"</span><span class="token punctuation">:</span> <span class="token string">"float32"</span><span class="token punctuation">,</span>     <span class="token string">"prior_question_had_explanation"</span><span class="token punctuation">:</span> <span class="token string">"boolean"</span><span class="token punctuation">}</span>data <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">"../input/riiid-test-answer-prediction/train.csv"</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span>dtypes<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Train size:"</span><span class="token punctuation">,</span> data<span class="token punctuation">.</span>shape<span class="token punctuation">)</span>Train size<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token number">101230332</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span>CPU times<span class="token punctuation">:</span> user 8min 15s<span class="token punctuation">,</span> sys<span class="token punctuation">:</span> <span class="token number">11.7</span> s<span class="token punctuation">,</span> total<span class="token punctuation">:</span> 8min 27sWall time<span class="token punctuation">:</span> 9min 24s<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="Format-feather"><a href="#Format-feather" class="headerlink" title="Format: feather"></a>Format: feather</h2><p>It is common to store data in feather (binary) format specifically for pandas. It significantly improves reading speed of datasets.</p><p>Read more: <a href="https://arrow.apache.org/docs/python/feather.html">https://arrow.apache.org/docs/python/feather.html</a></p><p>In [2]:</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token operator">%</span><span class="token operator">%</span>timedata <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_feather<span class="token punctuation">(</span><span class="token string">"../input/riiid-train-data-multiple-formats/riiid_train.feather"</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Train size:"</span><span class="token punctuation">,</span> data<span class="token punctuation">.</span>shape<span class="token punctuation">)</span>Train size<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token number">101230332</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span>CPU times<span class="token punctuation">:</span> user <span class="token number">3</span> s<span class="token punctuation">,</span> sys<span class="token punctuation">:</span> <span class="token number">17.5</span> s<span class="token punctuation">,</span> total<span class="token punctuation">:</span> <span class="token number">20.5</span> sWall time<span class="token punctuation">:</span> <span class="token number">19.6</span> s<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="Format-hdf5"><a href="#Format-hdf5" class="headerlink" title="Format: hdf5"></a>Format: hdf5</h2><p>HDF5 is a high-performance data management suite to store, manage and process large and complex data.</p><p>Read more: <a href="https://www.hdfgroup.org/solutions/hdf5">https://www.hdfgroup.org/solutions/hdf5</a></p><p>In [2]:</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token operator">%</span><span class="token operator">%</span>timedata <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_hdf<span class="token punctuation">(</span><span class="token string">"../input/riiid-train-data-multiple-formats/riiid_train.h5"</span><span class="token punctuation">,</span> <span class="token string">"riiid_train"</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Train size:"</span><span class="token punctuation">,</span> data<span class="token punctuation">.</span>shape<span class="token punctuation">)</span>Train size<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token number">101230332</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span>CPU times<span class="token punctuation">:</span> user <span class="token number">10.5</span> s<span class="token punctuation">,</span> sys<span class="token punctuation">:</span> <span class="token number">10.5</span> s<span class="token punctuation">,</span> total<span class="token punctuation">:</span> <span class="token number">20.9</span> sWall time<span class="token punctuation">:</span> <span class="token number">53.8</span> s<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="Format-jay"><a href="#Format-jay" class="headerlink" title="Format: jay"></a>Format: jay</h2><p>Datatable uses .jay (binary) format which makes reading datasets blazing fast. An example notebook is shared <a href="https://www.kaggle.com/rohanrao/riiid-with-blazing-fast-rid">here</a> and also shown below which reads the entire dataset in less than a second!</p><p>Read more: <a href="https://datatable.readthedocs.io/en/latest/api/frame/to_jay.html">https://datatable.readthedocs.io/en/latest/api/frame/to_jay.html</a></p><p>In [2]:</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token operator">%</span><span class="token operator">%</span>timedata <span class="token operator">=</span> dt<span class="token punctuation">.</span>fread<span class="token punctuation">(</span><span class="token string">"../input/riiid-train-data-multiple-formats/riiid_train.jay"</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Train size:"</span><span class="token punctuation">,</span> data<span class="token punctuation">.</span>shape<span class="token punctuation">)</span>Train size<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token number">101230332</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span>CPU times<span class="token punctuation">:</span> user <span class="token number">4.66</span> ms<span class="token punctuation">,</span> sys<span class="token punctuation">:</span> <span class="token number">2.77</span> ms<span class="token punctuation">,</span> total<span class="token punctuation">:</span> <span class="token number">7.43</span> msWall time<span class="token punctuation">:</span> <span class="token number">24.5</span> ms<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="Format-parquet"><a href="#Format-parquet" class="headerlink" title="Format: parquet"></a>Format: parquet</h2><p>In the Hadoop ecosystem, parquet was popularly used as the primary file format for tabular datasets and is now extensively used with Spark. It has become more available and efficient over the years and is also supported by pandas.</p><p>Read more: <a href="https://parquet.apache.org/documentation/latest/">https://parquet.apache.org/documentation/latest/</a></p><p>In [2]:</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token operator">%</span><span class="token operator">%</span>timedata <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_parquet<span class="token punctuation">(</span><span class="token string">"../input/riiid-train-data-multiple-formats/riiid_train.parquet"</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Train size:"</span><span class="token punctuation">,</span> data<span class="token punctuation">.</span>shape<span class="token punctuation">)</span>Train size<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token number">101230332</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span>CPU times<span class="token punctuation">:</span> user <span class="token number">43.4</span> s<span class="token punctuation">,</span> sys<span class="token punctuation">:</span> <span class="token number">17.7</span> s<span class="token punctuation">,</span> total<span class="token punctuation">:</span> 1min 1sWall time<span class="token punctuation">:</span> <span class="token number">47.2</span> s<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="Format-pickle"><a href="#Format-pickle" class="headerlink" title="Format: pickle"></a>Format: pickle</h2><p>Python objects can be stored in the form of pickle files and pandas has inbuilt functions to read and write dataframes as pickle objects.</p><p>Read more: <a href="https://docs.python.org/3/library/pickle.html">https://docs.python.org/3/library/pickle.html</a></p><p>In [2]:</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token operator">%</span><span class="token operator">%</span>timedata <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_pickle<span class="token punctuation">(</span><span class="token string">"../input/riiid-train-data-multiple-formats/riiid_train.pkl.gzip"</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Train size:"</span><span class="token punctuation">,</span> data<span class="token punctuation">.</span>shape<span class="token punctuation">)</span>Train size<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token number">101230332</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span>CPU times<span class="token punctuation">:</span> user <span class="token number">5.75</span> s<span class="token punctuation">,</span> sys<span class="token punctuation">:</span> <span class="token number">8.7</span> s<span class="token punctuation">,</span> total<span class="token punctuation">:</span> <span class="token number">14.5</span> sWall time<span class="token punctuation">:</span> <span class="token number">42.3</span> s<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="There-is-no-winner-or-loser"><a href="#There-is-no-winner-or-loser" class="headerlink" title="There is no winner or loser"></a>There is no winner or loser</h2><p><img src="data:image/png;base64,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" alt="choice.png"></p><p>Each method has it’s own set of pros and cons. Some examples are:</p><ul><li><strong>Pandas</strong> requires a lot more RAM to handle large datasets.</li><li><strong>Dask</strong> can be slow at times especially with transformations that cannot be parallelized.</li><li><strong>Datatable</strong> doesn’t have a very exhaustive set of data processing functions.</li><li><strong>Rapids</strong> is not useful if you don’t have a GPU.</li></ul><p>So it’s a good idea to explore various options and finally choose whichever appropriately fits the requirements. I strongly believe in not marrying a technology and continuously adapting to newer ideas, better approaches and ultimately the best possible solutions for building data science pipelines.</p><p>Even in my personal experience I’ve found different approaches working well on different datasets. So don’t shy away from experimentation.</p><blockquote><p>Data Science is blooming under the blessings of open source packages and communities</p></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> kaggle </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Kaggle Jane Street</title>
      <link href="2021/02/03/kaggle-jane-street/"/>
      <url>2021/02/03/kaggle-jane-street/</url>
      
        <content type="html"><![CDATA[<h2 id="相关资料汇总"><a href="#相关资料汇总" class="headerlink" title="相关资料汇总"></a>相关资料汇总</h2><h3 id="背景知识"><a href="#背景知识" class="headerlink" title="背景知识"></a>背景知识</h3><h4 id="1-交易日"><a href="#1-交易日" class="headerlink" title="1.交易日"></a>1.交易日</h4><p>每年交易日并不是 365 或者 366，而是 253 左右。</p><p>在<a href="https://en.wikipedia.org/wiki/Business">业务中</a>，<strong>交易日</strong>或<strong>常规交易时间（RTH）</strong> 是特定<a href="https://en.wikipedia.org/wiki/Stock_exchange">证券交易所</a>开放的时间跨度，而不是<a href="https://en.wikipedia.org/wiki/Electronic_trading_hours">电子或延长交易时间</a>（ETH）。例如，<a href="https://en.wikipedia.org/wiki/New_York_Stock_Exchange">纽约证券交易所</a>是，截至2020年，从上午9点开<a href="https://en.wikipedia.org/wiki/Eastern_Time_Zone">美国东部时间</a>到下午4:00<a href="https://en.wikipedia.org/wiki/Eastern_Time_Zone">东部时间</a>。交易日通常是星期一至星期五。交易日结束时，所有股票交易结束，并冻结时间，直到下一个交易日开始。还有其他几种特殊情况会导致交易日缩短，或者根本没有交易日，例如节假日或<a href="https://en.wikipedia.org/wiki/State_funeral">国葬日。</a>一的<a href="https://en.wikipedia.org/wiki/Head_of_state">国家元首</a>是如期举行。</p><p>纽约证券交易所和纳斯达克平均每年约253个交易日。这是从365.25（平均每年的天数）<em> 5/7（每周的比例工作日）-6（工作日假日）-3 </em> 5/7（固定日期假日）= 252.75≈253。股票交易所的假日<a href="https://en.wikipedia.org/wiki/New_Year's_Day">元旦</a>，小<a href="https://en.wikipedia.org/wiki/Martin_Luther_King_Jr._Day">马丁·路德·金纪念日</a>，<a href="https://en.wikipedia.org/wiki/Washington's_Birthday">华盛顿诞辰</a>，<a href="https://en.wikipedia.org/wiki/Good_Friday">耶稣受难日</a>，<a href="https://en.wikipedia.org/wiki/Memorial_Day">阵亡将士纪念日</a>，<a href="https://en.wikipedia.org/wiki/Independence_Day_(United_States">独立日</a>)，<a href="https://en.wikipedia.org/wiki/Labor_Day">劳动节</a>，<a href="https://en.wikipedia.org/wiki/Thanksgiving_Day">感恩节</a>和<a href="https://en.wikipedia.org/wiki/Christmas_Day">圣诞节</a>关闭；还有一些允许交易的假期，包括<a href="https://en.wikipedia.org/wiki/Columbus_Day">哥伦布日</a>，<a href="https://en.wikipedia.org/wiki/Veterans_Day">退伍军人节</a>和<a href="https://en.wikipedia.org/wiki/New_Year's_Eve">除夕</a>。<a href="https://en.wikipedia.org/wiki/Trading_day#cite_note-1">[1]</a>最多可以缩短三个交易日（独立日之前<a href="https://en.wikipedia.org/wiki/Black_Friday_(shopping">的一天，感恩节之后的一天</a>)以及<a href="https://en.wikipedia.org/wiki/Christmas_Eve">圣诞节前夕</a>），<em>即</em>交易所的开放时间为上午9:30 –下午1:00，具体取决于日历年的交易地点。</p><p><strong>数据大概 500 天，也就是两年的数据信息</strong></p><h4 id="2-Investment-Time-Horizon"><a href="#2-Investment-Time-Horizon" class="headerlink" title="2.Investment Time Horizon"></a>2.<a href="https://www.investopedia.com/terms/t/timehorizon.asp">Investment Time Horizon</a></h4><p><strong>长线投资和短线投资的区别和特点</strong></p><h3 id="数学支撑"><a href="#数学支撑" class="headerlink" title="数学支撑"></a>数学支撑</h3><h4 id="1-峰度（Kurtosis）与偏态（Skewness）"><a href="#1-峰度（Kurtosis）与偏态（Skewness）" class="headerlink" title="1.峰度（Kurtosis）与偏态（Skewness）"></a>1.峰度（Kurtosis）与偏态（Skewness）</h4><p><a href="http://blog.sciencenet.cn/blog-1148346-786610.html">峰度（Kurtosis）与偏态（Skewness）</a></p><p><a href="https://zhuanlan.zhihu.com/p/53184516">偏度与峰度的正态性分布判断</a></p><p>（1）偏度（Skewness）<br>偏度衡量随机变量概率分布的不对称性，是相对于平均值不对称程度的度量，通过对偏度系数的测量，我们能够判定数据分布的不对称程度以及方向。<br>具体来说，对于随机变量X，我们定义偏度为其的三阶标准<a href="https://link.zhihu.com/?target=https%3A//baike.baidu.com/item/%E4%B8%AD%E5%BF%83%E7%9F%A9">中心距</a>:</p><p><img src="https://www.zhihu.com/equation?tex=%5Cgamma_%7B1%7D+%3D+E%5B%28%5Cfrac%7BX-%5Cmu%7D%7B%5Cdelta%7D%29%5E3%5D+%3D+%5Cfrac%7BE%5B%28X-%5Cmu%29%5E3%5D%7D%7B%5Cdelta%5E3%7D+%3D+%5Cfrac%7BE%5B%28X-%5Cmu%29%5E3%5D%7D%7B%28E%5B%28X-%5Cmu%29%5E2%5D%29%5E%5Cfrac%7B3%7D%7B2%7D%7D+%3D+%5Cfrac%7BK_%7B3%7D%7D%7BK_%7B2%7D%5E%5Cfrac%7B3%7D%7B2%7D%7D" alt="[公式]"><br>对于样本的偏度，我们一般记为SK，我们可以基于矩估计，得到有:</p><p><img src="https://www.zhihu.com/equation?tex=SK_%7B1%7D+%3D+%5Cfrac%7Bm_%7B3%7D%7D%7Bm_2%5E%5Cfrac%7B3%7D%7B2%7D%7D+%3D+%5Cfrac%7B%5Cfrac%7B1%7D%7Bn%7D+%5Csum_%7Bi%3D1%7D%5E%7Bn%7D+%28x_%7Bi%7D+-+%5Coverline%7Bx%7D%29%5E3+%7D+%7B%5B%5Cfrac%7B1%7D%7Bn%7D+%5Csum_%7Bi%3D1%7D%5E%7Bn%7D+%28x_%7Bi%7D+-+%5Coverline%7Bx%7D%29%5E2%5D%5E%5Cfrac%7B3%7D%7B2%7D%7D" alt="[公式]"></p><p>其中, <img src="https://www.zhihu.com/equation?tex=%5Coverline%7Bx%7D" alt="[公式]"> 为样本均值， <img src="https://www.zhihu.com/equation?tex=m_%7B3%7D" alt="[公式]"> 为样本三阶中心矩， <img src="https://www.zhihu.com/equation?tex=m_%7B2%7D" alt="[公式]"> 为样本二阶中心矩</p><p>偏度的衡量是相对于正态分布来说，正态分布的偏度为0，即若数据分布是对称的，偏度为0。若偏度大于0，则分布右偏，即分布有一条长尾在右；若偏度小于0，则分布为左偏，即分布有一条长尾在左（如下图）；同时偏度的绝对值越大，说明分布的偏移程度越严重。</p><p><img src="https://pic2.zhimg.com/80/v2-e702671ffdfb6997dd6e23de014e12f5_1440w.jpg" alt="img"></p><p>【注意】数据分布的左偏或右偏，指的是数值拖尾的方向，而不是峰的位置。</p><p>（2）峰度（Kurtosis）<br>峰度，是研究数据分布陡峭或者平滑的统计量，通过对峰度系数的测量，我们能够判定数据相对于正态分布而言是更陡峭还是更平缓。比如正态分布的峰度为0，均匀分布的峰度为-1.2（平缓），指数分布的峰度6（陡峭）。<br>峰度，定义为四阶中心距 <img src="https://www.zhihu.com/equation?tex=m_%7B4%7D" alt="[公式]"> 除以方差 <img src="https://www.zhihu.com/equation?tex=%5Cdelta" alt="[公式]"> 的平方减3。<br><img src="https://www.zhihu.com/equation?tex=%5Cgamma_%7B2%7D+%3D+%5Cfrac%7BK_%7B4%7D%7D%7BK_%7B2%7D%5E%7B2%7D%7D+-+3+%3D+%5Cfrac%7B%5Cmu_%7B4%7D%7D%7B%5Cdelta%5E4%7D+-+3+%3D+%5Cfrac%7B%5Cfrac%7B1%7D%7Bn%7D%5Csum_%7Bi%3D1%7D%5E%7Bn%7D%28x_%7Bi%7D-%5Coverline%7Bx%7D%29%5E4%7D%7B%28%5Cfrac%7B1%7D%7Bn%7D%5Csum_%7Bi%3D1%7D%5E%7Bn%7D%28x_%7Bi%7D-%5Coverline%7Bx%7D%29%5E2%29%5E2%7D+-3" alt="[公式]"></p><p>若峰度 <img src="https://www.zhihu.com/equation?tex=%5Capprox" alt="[公式]"> 0 , 分布的峰态服从正态分布；<br>若峰度&gt;0,分布的峰态陡峭（高尖）；<br>若峰度&lt;0,分布的峰态平缓（矮胖）；</p><p><img src="https://pic2.zhimg.com/80/v2-67887d745da1b7dce1468bfccb451d99_1440w.jpg" alt="img"></p><h4 id="2-核密度估计（kernel-density-estimation）"><a href="#2-核密度估计（kernel-density-estimation）" class="headerlink" title="2.核密度估计（kernel density estimation）"></a>2.核密度估计（kernel density estimation）</h4><h5 id="pandas-DataFrame-plot-kde"><a href="#pandas-DataFrame-plot-kde" class="headerlink" title="pandas.DataFrame.plot.kde"></a>pandas.DataFrame.plot.kde</h5><pre class="line-numbers language-python" data-language="python"><code class="language-python">DataFrame<span class="token punctuation">.</span>plot<span class="token punctuation">.</span>kde<span class="token punctuation">(</span>bw_method<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> ind<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token operator">**</span>kwargs<span class="token punctuation">)</span><span class="token punctuation">[</span>source<span class="token punctuation">]</span>Generate Kernel Density Estimate plot using Gaussian kernels<span class="token punctuation">.</span>In statistics<span class="token punctuation">,</span> kernel density estimation <span class="token punctuation">(</span>KDE<span class="token punctuation">)</span> <span class="token keyword">is</span> a non<span class="token operator">-</span>parametric way to estimate the probability density function <span class="token punctuation">(</span>PDF<span class="token punctuation">)</span> of a random variable<span class="token punctuation">.</span> This function uses Gaussian kernels <span class="token keyword">and</span> includes automatic bandwidth determination<span class="token punctuation">.</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><h5 id="核密度估计（kernel-density-estimation）"><a href="#核密度估计（kernel-density-estimation）" class="headerlink" title="核密度估计（kernel density estimation）"></a><a href="https://lotabout.me/2018/kernel-density-estimation/">核密度估计（kernel density estimation）</a></h5><p>Table of Contents</p><p>有一些数据，想“看看”它长什么样，我们一般会画直方图（Histogram）。现在你也可以用核密度估计。</p><h6 id="什么是“核”"><a href="#什么是“核”" class="headerlink" title="什么是“核”"></a>什么是“核”</h6><p>如果不了解背景，看到“核密度估计”这个概念基本上就是一脸懵逼。我们先说说这个核 (<a href="https://en.wikipedia.org/wiki/Kernel_(statistics">kernel</a>)) 是什么。</p><p>首先，“核”在不同的语境下的含义是不同的，例如在模式识别里，它的含义就和这里不同。在“非参数估计”的语境下，“核”是一个函数，用来提供权重。例如高斯函数 (Gaussian) 就是一个常用的核函数。</p><p>让我们举个例子，假设我们现在想买房，钱不够要找亲戚朋友借，我们用一个数组来表示 5 个亲戚的财产状况： <code>[8, 2, 5, 6, 4]</code>。我们是中间这个数 <code>5</code>。“核”可以类比 成朋友圈，但不同的亲戚朋友亲疏有别，在借钱的时候，关系好的朋友出力多，关系不好的朋友出力少，于是我们可以用权重来表示。总共能借到的钱是： <code>8*0.1 + 2*0.4 + 5 + 6*0.3 + 4*0.2 = 9.2</code>。</p><p>那么“核”的作用就是用来决定权重，例如高斯函数（即正态分布）：</p><p><img src="https://upload.wikimedia.org/wikipedia/commons/0/0f/Kernel_exponential.svg" alt="Kernel Exponential"></p><p>如果还套用上面的例子的话，可以认为在 3 代血亲之外的亲戚就基本不会借钱给你了。</p><h3 id="博客"><a href="#博客" class="headerlink" title="博客"></a>博客</h3><h4 id="Kaggle-Jane-Street-市场预测数据竞赛1月回顾"><a href="#Kaggle-Jane-Street-市场预测数据竞赛1月回顾" class="headerlink" title="Kaggle Jane Street 市场预测数据竞赛1月回顾"></a><a href="https://zhuanlan.zhihu.com/p/348593422">Kaggle Jane Street 市场预测数据竞赛1月回顾</a></h4><p>特征（feature）和标签（tag）的含义：<br>由于我们得到的数据都是经过处理的而不是原始数据，这让特征之间的关系模糊甚至消失。以下内容大部分是相对可靠的，而含有（*）的相关内容，是相对不确定，仅供参考。</p><ul><li><ul><li>feature 0: 卖/买<br>二元取值，1和-1（而不是1和0）各佔大约一半。</li><li>tag 22: 交易日时间（可能经过处理）<br>feature_64只有一个tag，就是tag_22.</li></ul></li><li><p>tag 14: 特定股票数据（沽空成本，股息率，隐含波动率？）<br>tag 14的特征（feature 41-43)都是成组出现的。（下图date 12的数据）</p></li></ul><p>可能有用的trick</p><ul><li>去除前85天的数据</li><li>去除weight为0的数据</li><li>用所有resp来训练模型</li><li>给训练集设置权重</li></ul><h4 id="量化投资学习笔记93——Kaggle量化交易竞赛Jane-Street-笔记2"><a href="#量化投资学习笔记93——Kaggle量化交易竞赛Jane-Street-笔记2" class="headerlink" title="量化投资学习笔记93——Kaggle量化交易竞赛Jane Street 笔记2"></a><a href="https://zhuanlan.zhihu.com/p/338059311">量化投资学习笔记93——Kaggle量化交易竞赛Jane Street 笔记2</a></h4><h3 id="Kaggle-Notebook"><a href="#Kaggle-Notebook" class="headerlink" title="Kaggle Notebook"></a>Kaggle Notebook</h3><h4 id="Blending-tensorflow-and-pytorch🔥🔥🔥"><a href="#Blending-tensorflow-and-pytorch🔥🔥🔥" class="headerlink" title="Blending tensorflow and pytorch🔥🔥🔥"></a><a href="https://www.kaggle.com/a763337092/blending-tensorflow-and-pytorch">Blending tensorflow and pytorch🔥🔥🔥</a></h4><p>目前开源最高分数，使用的 tensorflow 和 pytorch</p><p>训练 link <a href="https://www.kaggle.com/a763337092/pytorch-resnet-starter-training">Pytorch Resnet Starter[Training]</a></p><h4 id="Jane-Street-Neural-Network-Starter"><a href="#Jane-Street-Neural-Network-Starter" class="headerlink" title="Jane Street: Neural Network Starter"></a><a href="https://www.kaggle.com/gogo827jz/jane-street-neural-network-starter?scriptVersionId=48765235&amp;select=submission.csv">Jane Street: Neural Network Starter</a></h4><h2 id="Idea"><a href="#Idea" class="headerlink" title="Idea"></a>Idea</h2><p>数据划分 </p><ul><li>5个resp (resp,resp_1,resp_2,resp_3,resp_4)</li></ul><p>这四个 resp (resp_1,resp_2,resp_3,resp_4)，推测是由一些特征组合算出来的，应当利用 feature 和 tag，将特征划分成4或5份。其中5份并不是很推荐，因为我偏向于resp 是基于resp_1~resp_2组合加权得到的。</p><ul><li>feature_{0…129}</li></ul><p>可以做的分析，一定要做特征提取</p><ol><li>PCA 降维</li><li>去除或者不去相关性很高的 feature</li></ol><ul><li>tag_{0_28}</li></ul><ol><li>辅助 feature 进行特征提取，核心分块 分4或5</li></ol>]]></content>
      
      
      
        <tags>
            
            <tag> kaggle </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2021.02.02 Links</title>
      <link href="2021/02/02/2021-02-02-links/"/>
      <url>2021/02/02/2021-02-02-links/</url>
      
        <content type="html"><![CDATA[<h2 id="Need-to-read-next-day"><a href="#Need-to-read-next-day" class="headerlink" title="Need to read next day"></a>Need to read next day</h2><p><a href="https://github.com/academic/awesome-datascience">https://github.com/academic/awesome-datascience</a></p><p>Ensemble Learning</p><p><a href="https://i.am.ai/roadmap/">AI Expert Roadmap</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> link </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Deep Learning 面试题</title>
      <link href="2021/01/31/deep-learning-mian-shi-ti/"/>
      <url>2021/01/31/deep-learning-mian-shi-ti/</url>
      
        <content type="html"><![CDATA[<h2 id="1-梯度下降算法的一般步骤"><a href="#1-梯度下降算法的一般步骤" class="headerlink" title="1.梯度下降算法的一般步骤"></a>1.梯度下降算法的一般步骤</h2><p>答：用随机值初始化权重和偏差—-&gt;&gt;将输入传入网络，得到输出—-&gt;&gt;计算预测值与真实值之间的误差—-&gt;&gt;对每一个产生误差的神经元，调整相应的(权重)值以减小误差—-&gt;&gt;重复迭代，直至得到网络权重的最佳值</p><h2 id="2-CNN卷积核是单层的还是多层的？"><a href="#2-CNN卷积核是单层的还是多层的？" class="headerlink" title="2.CNN卷积核是单层的还是多层的？"></a>2.CNN卷积核是单层的还是多层的？</h2><p><strong>答：</strong>一般而言，深度卷积网络是一层又一层的。层的本质是特征图, 存贮输入数据或其中间表示值。一组卷积核则是联系前后两层的网络参数表达体,</p><p>训练的目标就是每个卷积核的权重参数组。</p><p>  描述网络模型中某层的厚度，通常用名词通道channel数或者特征图feature map数。不过人们更习惯把作为数据输入的前层的厚度称之为通道数</p><p>(比如RGB三色图层称为输入通道数为3），把作为卷积输出的后层的厚度称之为特征图数。</p><p>  卷积核(filter)一般是3D多层的，除了面积参数, 比如3x3之外, 还有厚度参数H（2D的视为厚度1). 还有一个属性是卷积核的个数N。</p><p>  卷积核的厚度H, 一般等于前层厚度M(输入通道数或featuremap数). 特殊情况M &gt; H。</p><p>  卷积核的个数N, 一般等于后层厚度(后层featuremaps数，因为相等所以也用N表示)。</p><p>  卷积核通常从属于后层，为后层提供了各种查看前层特征的视角，这个视角是自动形成的。</p><p>  卷积核厚度等于1时为2D卷积，对应平面点相乘然后把结果加起来，相当于点积运算；</p><p>  卷积核厚度大于1时为3D卷积，每片分别平面点求卷积，然后把每片结果加起来，作为3D卷积结果；1x1卷积属于3D卷积的一个特例，有厚度无面积</p><p>直接把每片单个点乘以权重再相加。</p><p>  归纳之，卷积的意思就是把一个区域，不管是一维线段，二维方阵，还是三维长方块，全部按照卷积核的维度形状，对应逐点相乘再求和，浓缩成一</p><p>个标量值也就是降到零维度，作为下一层的一个feature map的一个点的值</p><p>  2D卷积表示渔夫的网就是带一圈浮标的渔网，只打上面一层水体的鱼；</p><p>  3D卷积表示渔夫的网是多层嵌套的渔网，上中下层水体的鱼儿都跑不掉；</p><p>  1x1卷积可以视为每次移位stride，甩钩钓鱼代替了撒网；</p><p>  <strong>下面解释一下特殊情况的 M&gt; H：</strong></p><p>​    实际上，除了输入数据的通道数比较少之外，中间层的feature map数很多，这样中间层算卷积会累死计算机(鱼塘太深，每层鱼都打，需要的鱼网太重).所以很多深度卷积网络把全部通道/特征图划分一下，每个卷积核只看其中一部分(渔夫A的渔网只打捞深水段，渔夫B的渔网只打捞浅水段)。</p><p>  这样整个深度网络架构是横向开始分道扬镳了，到最后才又融合。这样看来，很多网络模型的架构不完全是突发奇想，而是是被参数计算量逼得。特</p><p>  别是现在需要在移动设备上进行AI应用计算(也叫推断), 模型参数规模必须更小, 所以出现很多减少握手规模的卷积形式, 现在主流网络架构大都如此</p><h2 id="3-全连接层的作用："><a href="#3-全连接层的作用：" class="headerlink" title="3.全连接层的作用："></a>3.全连接层的作用：</h2><p><strong>答</strong>：在CNN结构中，经多个卷积层和池化层后，连接着1个或1个以上的全连接层．与MLP类似，全连接层中的每个神经元与其前一层的所有神经元进行中全连接.全连接层可以整合卷积层或者池化层中具有类别区分性的局部信息．为了提升 CNN网络性能，全连接层每个神经元的激励函数一般采用ReLU函数。最后一层全连接层的输出值被传递给一个输出，可以采用softmax逻辑回归（softmax regression）进行 分 类，该层也可 称为 softmax层（softmax layer）．</p><p>对于一个具体的分类任务，选择一个合适的损失函数是十分重要的，CNN几种常用的损失函数并分析了它们各自的特点．通 常，CNN的全连接层与MLP 结构一样，CNN的训练算法也多采用BP算法。</p><h2 id="4-卷积神经网络的卷积是什么意思？"><a href="#4-卷积神经网络的卷积是什么意思？" class="headerlink" title="4.卷积神经网络的卷积是什么意思？"></a>4.卷积神经网络的卷积是什么意思？</h2><p><strong>答：</strong>对图像（不同的数据窗口数据）和滤波矩阵（一组固定的权重：因为每个神经元的多个权重固定，所以又可以看做一个恒定的滤波器filter）做内积（逐个元素相乘再求和）的操作就是所谓的『卷积』操作，也是卷积神经网络的名字来源</p><h2 id="5-简单介绍一下tensorflow的计算流图"><a href="#5-简单介绍一下tensorflow的计算流图" class="headerlink" title="5.简单介绍一下tensorflow的计算流图?"></a>5.简单介绍一下tensorflow的计算流图?</h2><p><strong>答：</strong>Tensorflow是一个通过计算图的形式来表述计算的编程系统，计算图也叫数据流图，可以把计算图看做是一种有向图，Tensorflow中的每一个节点都是计算图上的一个Tensor, 也就是张量，而节点之间的边描述了计算之间的依赖关系(定义时)和数学操作(运算时)</p><h2 id="6-你有哪些deep-learning（rnn、cnn）调参的经验"><a href="#6-你有哪些deep-learning（rnn、cnn）调参的经验" class="headerlink" title="6.你有哪些deep learning（rnn、cnn）调参的经验?"></a>6.你有哪些deep learning（rnn、cnn）调参的经验?</h2><p><strong>答：</strong>1.参数初始化； 2.参数预处理方式； 3.训练技巧； 4.尽量对数据进行shuffle; 5.Ensemble</p><h2 id="7-CNN最成功的应用是在CV，那为什么NLP和Speech的很多问题也可以用CNN解出来？为什么AlphaGo里也用了CNN？这几个不相关的问题的相似性在哪里？CNN通过什么手段抓住了这个共性"><a href="#7-CNN最成功的应用是在CV，那为什么NLP和Speech的很多问题也可以用CNN解出来？为什么AlphaGo里也用了CNN？这几个不相关的问题的相似性在哪里？CNN通过什么手段抓住了这个共性" class="headerlink" title="7.CNN最成功的应用是在CV，那为什么NLP和Speech的很多问题也可以用CNN解出来？为什么AlphaGo里也用了CNN？这几个不相关的问题的相似性在哪里？CNN通过什么手段抓住了这个共性?"></a>7.CNN最成功的应用是在CV，那为什么NLP和Speech的很多问题也可以用CNN解出来？为什么AlphaGo里也用了CNN？这几个不相关的问题的相似性在哪里？CNN通过什么手段抓住了这个共性?</h2><p><strong>答：</strong>以上几个不相关的问题的相关性在于，都是存在局部与整体的关系，由低层次的特征经过组合，组成高层次的特征，并且得到不同特征之间的空间相关性</p><p>CNN抓住共性的手段有四个：局部连接、权值共享、池化操作、多层次结构</p><p>局部连接：使网络可以提取数据的局部特征；</p><p>权值共享：大大降低了网络的训练难度，一个filter只提取一个特征，在整个图片(或者语音、文本)中进行卷积；</p><p>池化操作：与多层次结构一起，实现了数据的降维，将低层次的局部特征组合为较高层次的特征，从而对整个图片进行表示</p><h2 id="8-LSTM结果推导，为什么比RNN好"><a href="#8-LSTM结果推导，为什么比RNN好" class="headerlink" title="8.LSTM结果推导，为什么比RNN好?"></a>8.LSTM结果推导，为什么比RNN好?</h2><p><strong>答：</strong>推导forget gate, input gate, cell state, hidden information等的变化；因为LSTM有进有出且当前的cellinformation是通过input gate控制之后叠加的，RNN是叠乘，因此LSTM可以防止梯度消失或者梯度爆炸</p><h2 id="9-sigmoid、Tanh、-Relu这三个激活函数有什么缺点或者不足，有没改进的激活函数？"><a href="#9-sigmoid、Tanh、-Relu这三个激活函数有什么缺点或者不足，有没改进的激活函数？" class="headerlink" title="9.sigmoid、Tanh、 Relu这三个激活函数有什么缺点或者不足，有没改进的激活函数？"></a>9.sigmoid、Tanh、 Relu这三个激活函数有什么缺点或者不足，有没改进的激活函数？</h2><p>答：relu函数：梯度弥散没有完全解决，神经元死亡问题</p><p>解决方案：LeakyRelu 解决了神经死亡问题</p><p>Maxout:参数较多，本质上是在输出结果上又增加了一层 克服了relu的缺点，比较提倡使用</p><h2 id="10-为什么要引入非线性激励函数？"><a href="#10-为什么要引入非线性激励函数？" class="headerlink" title="10.为什么要引入非线性激励函数？"></a>10.为什么要引入非线性激励函数？</h2><p> 答：1.对于神经网络来说，网络的每一层相当于f(wx+b)=f(w’x),对于线性函数，其实相当于f(x)=x,那么在线性激活函数下，每一层相当于用一个矩阵</p><p>去乘以x,那么多层就是反复的用矩阵去乘以输入。根据举证的乘法法则，多个矩阵相乘得到一个大的矩阵。所以线性激励函数下，多层网络与一层网络相当。</p><p>比如：两层的网络f(w1*f(w2x)) = W1W2x = Wx</p><p>2.非线性变换是深度学习有效的原因之一。原因在于非线性相当于对空间进行变换，变换完成之后相当于对问题空间进行简化，原来线性不可解的问题现</p><p>在变得可以解了</p><p>3.如果不用激励函数(其实相当于激励函数是f(x)=x),在这种情况下，你的每一层输出都是上层输入的线性函数，很容易验证，无论你神经网络多少层，</p><p>输出都是输入的线性组合，与没有隐藏层效果相当，这种情况就是最原始的感知机了</p><p>正因为上面的原因，我们决定引入非线性函数作为激励函数，这样深层神经网络就有意义了(不再是输入的线性组合，可以逼近任意函数)。最早的想法是</p><p>sigmoid函数或者tanh函数，输出有界，很容易充当下一层输入</p><h2 id="11-神经网路中使用relu函数要好过tanh和sigmoid函数？"><a href="#11-神经网路中使用relu函数要好过tanh和sigmoid函数？" class="headerlink" title="11.神经网路中使用relu函数要好过tanh和sigmoid函数？"></a><strong>11.神经网路中使用relu函数要好过tanh和sigmoid函数？</strong></h2><p>答：1.使用sigmoid函数，算激活函数时(指数运算)，计算量大，反向传播误差梯度时，求导涉及除法和指数运算，计算量相对较大，而采用relu激活函数，整个过程的计算量节省很多</p><p>​    2.对于深层网络，sigmoid函数反向传播时，很容易就会出现梯度消失的情况，这种现象称为饱和，从而无法完成深层网络的训练。而relu函数就不会出现饱和倾向，不会有特别小的梯度出现</p><p>   3.relu函数会使一部分神经元的输出为0，这样就造成了网络的稀疏性，并且减少了参数的相互依存关系，缓解了过拟合问题的发生。当然现在也有一些对relu函数的改进，比如prelu, random relu等，在不同的数据集上会有一些训练速度上或者准确率上的改进多加一句，现在主流的做法，会多做一步batch normalization,尽可能保证每一层网络的输入具有相同的分布。</p><h2 id="12-深度学习中的Batch-Normalization"><a href="#12-深度学习中的Batch-Normalization" class="headerlink" title="12.深度学习中的Batch Normalization?"></a><strong>12.深度学习中的Batch Normalization?</strong></h2><p>答：BN就是在神经网络的训练过程中对每层的输入数据加一个标准化处理</p><p> 传统的神经网络，只是在将样本x输入输入层之前对x进行标准化处理（减均值，除标准差），以降低样本间的差异性。BN是在此基础上，不仅仅只对输入层的输入数据x进行标准化，还对每个隐藏层的输入进行标准化</p><h2 id="13-为什么在LSTM模型中既存在sigmoid函数又存在tanh两种激活函数，二不是选择区中单独的一组-这样做的目的是什么"><a href="#13-为什么在LSTM模型中既存在sigmoid函数又存在tanh两种激活函数，二不是选择区中单独的一组-这样做的目的是什么" class="headerlink" title="13.为什么在LSTM模型中既存在sigmoid函数又存在tanh两种激活函数，二不是选择区中单独的一组?这样做的目的是什么?"></a><strong>13.为什么在LSTM模型中既存在sigmoid函数又存在tanh两种激活函数，二不是选择区中单独的一组?这样做的目的是什么?</strong></h2><p>答：sigmoid函数用在了各种gate上，产生0~1之间的值，这个一般只有sigmoid最直接了；</p><p>   tanh用在了状态和输出上，是对数据的处理，这个用其他激活函数或许也可以；</p><p> 两者的目的不同</p><h2 id="14-如何解决RNN梯度爆炸和弥散的问题"><a href="#14-如何解决RNN梯度爆炸和弥散的问题" class="headerlink" title="14.如何解决RNN梯度爆炸和弥散的问题?"></a><strong>14.如何解决RNN梯度爆炸和弥散的问题?</strong></h2><p>答：梯度爆炸：为解决梯度爆炸问题，Thomas Mikolov首先提出了一个简单的启发性的解决方案，就是当梯度大于一定阀值的时候，将它截断为一个较为小的数。</p><p>解决梯度弥散问题的两种方法：</p><p> 第一种：将随机初始化W改为一个有关联的矩阵初始化。</p><p> 第二种：使用ReLU代替sigmid函数。ReLU导数不是0就是1，因此，神经元的梯度将始终为1，而不会当梯度传播了一定时间之后变小</p><h2 id="15-什么样的资料不适合深度学习"><a href="#15-什么样的资料不适合深度学习" class="headerlink" title="15.什么样的资料不适合深度学习?"></a><strong>15.什么样的资料不适合深度学习?</strong></h2><p>答：(1) 数据集太小，数据样本不足时，深度学习相对于其他机器学习算法，没有明显优势；</p><p>   (2) 数据集没有局部相关性，目前深度学习表现较好的领域是图像识、语音、自然语言处理等领域，这些领域的一个共性是局部相关性。图像中像素组成物体，语音信号中音位组合成单词，文本数据中单词组合成句子，这些特征元素的组合一旦被打乱，表示的含义同时也被改变。对于没有这样的局部相关性的数据集，不合适使用深度学习算法进行处理。举个例子：预测一个人的健康状况，相关的参数会有年龄，职业，收入，家庭状况等各种因素，将这些元素打乱，并不会影响相关的结果</p><h2 id="16-如何解决梯度消失和梯度膨胀"><a href="#16-如何解决梯度消失和梯度膨胀" class="headerlink" title="16.如何解决梯度消失和梯度膨胀?"></a><strong>16.如何解决梯度消失和梯度膨胀?</strong></h2><p>答：(1) 梯度消失：根据链式法则，如果每一层神经元对上一层的输出的偏导乘上权重解雇小于1的话，那么即使这个结果是0.99，经过足够多层传播之后，误差对输入层的偏导会趋于0；</p><p>   (2) 梯度膨胀：根据链式法则，如果每一层神经元对上一层的输出的偏导乘上权重结果都大于1的话，在经过足够多层传播之后，误差对输入层的偏导会趋于无穷大</p><p> 解决方案：可以通过激活函数来解决或者用Bath Normalization解决这个问题</p><h2 id="17-广义线性模型是怎么被应用在深度学习中"><a href="#17-广义线性模型是怎么被应用在深度学习中" class="headerlink" title="17.广义线性模型是怎么被应用在深度学习中?"></a><strong>17.广义线性模型是怎么被应用在深度学习中?</strong></h2><p>答：深度学习从统计学角度，可以看做递归的广义线性模型</p><p> 广义线性模型相对于经典的线性模型(y=wx+b),核心在于引入了连接函数g(.),形式变为：y=g-1(wx+b)</p><p> 深度学习时递归的广义线性模型，神经元的激活函数，既为广义线性模型的连接函数。逻辑回归(广义线性模型的一种)的Logistic函数即为神经元激活函数中的sigmoid函数，很多类似的方法在统计学和神经网络中的名称不一样，容易引起初学者的困惑</p><h2 id="18-简述神经网络的发展史"><a href="#18-简述神经网络的发展史" class="headerlink" title="18.简述神经网络的发展史?"></a><strong>18.简述神经网络的发展史?</strong></h2><p>答：sigmoid会饱和，造成梯度消失，于是有了ReLU</p><p>​    ReLU负半轴是死区,会造成梯度变为0,于是有了LeakyReLU、PReLU</p><p> 强调梯度和权值分布的稳定性，由此有了ELU，以及较新的SELU</p><p> 太深了，梯度传递不下去，于是有了highway</p><p> 干脆连highway的参数都不要，直接变残差，于是有了ResNet</p><p> 强行稳定参数的均值和方差，于是有了BatchNorm</p><p> 在梯度流中增加噪声，于是有了Dropout</p><p>   RNN梯度不稳定，于是加几个通路和门控，于是有了LSTM</p><p>   LSTM简化一下，有了GRU</p><p>   GAN的JS散度有问题，会导致梯度消失或者无效，于是有了WGAN</p><p>   WGAN对梯度的clip有问题，于是有了WGAN-GP</p><h2 id="19-深度学习常用方法"><a href="#19-深度学习常用方法" class="headerlink" title="19.深度学习常用方法:"></a><strong>19.深度学习常用方法:</strong></h2><p>答：全连接DNN(相邻层互相连接，层内无连接)</p><p>   AutoEncoder(尽可能还原输入)、Sparse Coding(在AE上加入L1规范)、RBM(解决概率问题)——&gt;&gt;特征检测——&gt;&gt;栈式叠加贪心训练</p><p>   RBM——&gt;DBM</p><p> 解决全连接DNN的全连接问题——&gt;CNN</p><p> 解决全连接DNN的无法对时间序列上变化进行建模的问题——&gt;RNN——解决时间轴上的梯度消失问题——&gt;&gt;LSTM</p><p>   DNN是传统的全连接网络，可以用于广告点击预估，推荐等。其使用embedding的方式将很多离散的特征编码到神经网络中，可以很大的提升结果</p><p>   CNN主要用于计算机视觉(Computer Vision)领域，CNN的出现主要解决了DNN在图像领域中参数过多的问题。同时，CNN特有的卷积，池化、batch normalization、Inception、ResNet、DeepNet等一系列的发展使得在分类、物体检测、<a href="https://cloud.tencent.com/product/facerecognition?from=10680">人脸识别</a>、图像分割等众多领域有了长足的进步。同时，CNN不仅在图像上应用很多，在自然语言处理上也颇有进展，现在已经有基于CNN的语言模型可以比LSTM更好的效果。在最新的AlphaZero中，CNN中的ResNet也是两种基本算法之一</p><p>   GAN是一种应用在生成模型的训练方法现在有很多在CV方面的应用，例如图像翻译，图像超清化，图像修复等等</p><p>   RNN主要应用于NLP领域，用于处理序列到序列的问题。普通RNN会遇到梯度爆炸和梯度消失的问题。所以现在在NLP领域，一般会使用LSTM模型。在最近的机器翻译领域，Attention作为一种新的手段，也被引入进来</p><p> 除了DNN、RNN和CNN外，自动编码器(AutoEncoder)、稀疏编码(SparseCoding)、深度信念网络(DBM)、限制玻尔兹曼(RBM)也都有相应的研究</p><h2 id="20-简单说说CNN常用的几个模型："><a href="#20-简单说说CNN常用的几个模型：" class="headerlink" title="20.简单说说CNN常用的几个模型："></a><strong>20.简单说说CNN常用的几个模型：</strong></h2><div class="table-container"><table><thead><tr><th style="text-align:left">名称</th><th style="text-align:left">特点</th></tr></thead><tbody><tr><td style="text-align:left">LeNet5</td><td style="text-align:left">没啥特点，不过是第一个CNN应该知道</td></tr><tr><td style="text-align:left">AlexNet</td><td style="text-align:left">引入了ReLU和dropout,引入数据增强，池化相互之间有覆盖，三个卷积一个最大池化+三个全连接</td></tr><tr><td style="text-align:left">VGGNet</td><td style="text-align:left">采用1<em>1和3</em>3的卷积核以及2*2的最大池化使得层数变得更深，常用VGGNet-16和VGGNet-19</td></tr><tr><td style="text-align:left">Google Inception Net</td><td style="text-align:left">这个在控制参数的同时，获得了比较好的分类性能，和上面相比有几个大的改进 1.去除最后的全连接层，而是用一个全局的平均池化层来取代它              2.引入Inception Module,这是一个4个分支结合的结构，所有的分支都用到了1<em>1的卷积，这是因为1×1性价比很高，可以用很少的参数达到非线性和特征变换 3.Inception V2第二版将所有的5</em>5变成2个3*3，而且提出来著名的Batch Normalization4.Inception V3第三版就更变态了，把较大的二维卷积拆成了两个较小的一维卷积，加速运算，减少过拟合，同时还更改了Inception Module的结构</td></tr><tr><td style="text-align:left">微软ResNet残差神经网络(Residual Neural Network)</td><td style="text-align:left">1.引入高速公路结构，可以让神经网络 变得非常深  2.ResNet第二个版本将ReLU激活函数 变成y=x的线性函数</td></tr></tbody></table></div><h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><p><a href="https://cloud.tencent.com/developer/article/1420568">面试宝典之深度学习面试题</a></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>AAAI 2020</title>
      <link href="2021/01/31/aaai-2020/"/>
      <url>2021/01/31/aaai-2020/</url>
      
        <content type="html"><![CDATA[<h1 id="Hinton-向-AAAI-提交论文竟收到最差评价！深度学习三教父再押宝，AI-或突破常识瓶颈"><a href="#Hinton-向-AAAI-提交论文竟收到最差评价！深度学习三教父再押宝，AI-或突破常识瓶颈" class="headerlink" title="Hinton 向 AAAI 提交论文竟收到最差评价！深度学习三教父再押宝，AI 或突破常识瓶颈"></a><a href="https://bbs.cvmart.net/topics/1474">Hinton 向 AAAI 提交论文竟收到最差评价！深度学习三教父再押宝，AI 或突破常识瓶颈</a></h1><blockquote><p><strong>【导读】</strong>日前，图灵奖获得者、深度学习三巨头Geoffrey Hinton、Yann LeCun、Yoshua Bengio在AAAI聚首，分享各自最新研究成果。三位一致表示深度学习可以克服诸如对抗性示例之类的障碍，甚至可能获得常识。</p></blockquote><p>作为2020年人工智能学界的第一个顶会，AAAI 2020正在美国纽约举行，最佳论文等各大奖项已经揭晓。</p><p>AAAI 2020的一大亮点是主办方特邀图灵奖获得者、深度学习三巨头Geoffrey Hinton、Yann LeCun、Yoshua Bengio同台，分享各自最新研究成果。三位一致表示深度学习可以克服诸如对抗性示例之类的障碍，甚至可能获得常识。</p><h2 id="Geoffrey-Hinton：堆栈式胶囊自编码器"><a href="#Geoffrey-Hinton：堆栈式胶囊自编码器" class="headerlink" title="Geoffrey Hinton：堆栈式胶囊自编码器"></a>Geoffrey Hinton：堆栈式胶囊自编码器</h2><p><img src="https://bbs.cvmart.net/uploads/images/202002/12/3/C6BELdoxzR.gif?imageView2/2/w/1240/h/0" alt="file"></p><p>首先，Geoffrey Hinton登台，做了题为“Stacked Capsule Autoencoders”的演讲，这也是他去年一篇论文的题目。</p><p><img src="https://bbs.cvmart.net/uploads/images/202002/12/3/begmKJ1gOD.gif?imageView2/2/w/1240/h/0" alt="file"></p><p>论文地址：<a href="https://arxiv.org/abs/1906.06818">https://arxiv.org/abs/1906.06818</a></p><p><img src="https://bbs.cvmart.net/uploads/images/202002/12/3/MTDT3Su5wm.gif?imageView2/2/w/1240/h/0" alt="file"></p><p>Hinton首先介绍了识别物体的两种方法的优劣势：</p><ul><li>传统模型使用模块化表示形式（例如计算机图形学中使用的表示形式），但是它们通常涉及很多手动操作，这让深层次结构很难实现。</li><li>卷积神经网络使用端到端学习，通过在所有图像位置使用相同的知识，它们获得了巨大的胜利。但是它们在很多方面与人类的感知不同。</li></ul><p><img src="https://bbs.cvmart.net/uploads/images/202002/12/3/hSQvQlqd4X.gif?imageView2/2/w/1240/h/0" alt="file"></p><p>用Hinton的话讲，CNN就是”<strong>rubbish</strong>“，问题很多，比如处理视角的变化、解析图像、对抗性例子等等。</p><p><img src="https://bbs.cvmart.net/uploads/images/202002/12/3/nZD964NkcK.gif?imageView2/2/w/1240/h/0" alt="file"></p><p><img src="https://bbs.cvmart.net/uploads/images/202002/12/3/MPVNFZCLfi.gif?imageView2/2/w/1240/h/0" alt="file"></p><p>吐槽完CNN，Hinton开始介绍重头戏：Capsules 2019: Stacked Capsule Auto-Encoders。</p><p><img src="https://bbs.cvmart.net/uploads/images/202002/12/3/Kc9sKkXM0i.gif?imageView2/2/w/1240/h/0" alt="file"></p><p>在这项研究中，Hinton等人提出一个无监督版本的胶囊网络，通过可查看所有部件的神经编码器，进而推断物体胶囊的位置与姿势。</p><p><img src="https://bbs.cvmart.net/uploads/images/202002/12/3/6QTjMpLBF9.gif?imageView2/2/w/1240/h/0" alt="file"></p><p>该编码器通过解码器进行反向传播训练，通过混合式姿势预测方案来预测已发现部件的姿势。同样是使用神经编码器，通过推断部件及其仿射变换，可以直接从图像中发现具体的部件。</p><p><img src="https://bbs.cvmart.net/uploads/images/202002/12/3/NmxF3OlIRZ.gif?imageView2/2/w/1240/h/0" alt="file"></p><p>换句话说，每个相应的解码器图像像素建模，都是仿射变换部分做出的混合预测结果。他们通过未标记的数据习得物体及其部分胶囊，然后再对物体胶囊的存在向量进行聚类。</p><p><img src="https://bbs.cvmart.net/uploads/images/202002/12/3/M1TRFeavyV.gif?imageView2/2/w/1240/h/0" alt="file"></p><p>最后，该成果在 SVHN 上获得了最先进的无监督分类结果 (55%)，同时在 MNIST 上获得了接近最先进的分类结果。</p><p><img src="https://bbs.cvmart.net/uploads/images/202002/12/3/hRZbtYItSF.gif?imageView2/2/w/1240/h/0" alt="file"></p><h2 id="Yann-LeCun：自监督学习赋予机器-“常识”-，实现“真正的”人工智能"><a href="#Yann-LeCun：自监督学习赋予机器-“常识”-，实现“真正的”人工智能" class="headerlink" title="Yann LeCun：自监督学习赋予机器 “常识” ，实现“真正的”人工智能"></a>Yann LeCun：自监督学习赋予机器 “常识” ，实现“真正的”人工智能</h2><p>接着，Facebook人工智能总监、图灵奖得主Yann LeCun上台，继续推广他的自监督学习概念。</p><p><img src="https://bbs.cvmart.net/uploads/images/202002/12/3/cnex4pugwa.gif?imageView2/2/w/1240/h/0" alt="file"></p><p>这位被誉为卷积神经之父的图灵奖得主，对自监督学习给予了深厚的希望以及非常坚实的肯定。</p><p>他认为<strong>自监督学习因为更接近人类的学习程序，能够突破现有深度学习的局限。</strong></p><p>目前被广泛使用的监督学习，对人工标记的依赖性交大，不仅耗时耗力，且无法完全保证人工标记过程中准确性的问题。另外，机器只能根据已标记的特征学习。</p><p><img src="https://bbs.cvmart.net/uploads/images/202002/12/3/qlBGABmKoR.gif?imageView2/2/w/1240/h/0" alt="file"></p><p>强化学习是透过奖罚机制，让机器在虚拟情境中不断试错（trial and error），累积经验来学习。强化学习已经被证明在竞技游戏中体现出强大的能力，甚至远超人类，但性价比太低。</p><p><img src="https://bbs.cvmart.net/uploads/images/202002/12/3/OSQyDvw2jc.gif?imageView2/2/w/1240/h/0" alt="file"></p><p>Yann LeCun认为自监督学习是克服上述问题的有效解决方案。自监督学习通过构建一个庞大的神经网络，透过预测来认识世界。这一点就非常类似于我们人类的学习过程，不断透过已知部分预测未知。</p><p><img src="https://bbs.cvmart.net/uploads/images/202002/12/3/ugE35FCIi7.gif?imageView2/2/w/1240/h/0" alt="file"></p><p><img src="https://bbs.cvmart.net/uploads/images/202002/12/3/bNZ6w8EXp1.gif?imageView2/2/w/1240/h/0" alt="file"></p><p>预测是自监督学习的强力武器，例如预测到车子可能会撞到前方路障，就提前进行规避动作，而不需要人工标注这是路障需要避开，更不需要试错去积累经验。</p><p><img src="https://bbs.cvmart.net/uploads/images/202002/12/3/033HXtH5sp.gif?imageView2/2/w/1240/h/0" alt="file"><br><img src="https://bbs.cvmart.net/uploads/images/202002/12/3/xLyNqEWcQ7.gif?imageView2/2/w/1240/h/0" alt="file"></p><p>Yann LeCun认为现今的深度学习方法，虽然在自动驾驶、语言翻译、聊天机器人等方面取得进展，却无法创造出“真正的”人工智能。 </p><p>他所谓的“真正的”人工智能，是具备常识、聪明、敏捷且灵活的机器人。他认为更接近人类学习行为的自监督学习方法，将会是实现这个宏远的第一步。</p><h2 id="Yoshua-Bengio：从“系统1”向“系统2”进发"><a href="#Yoshua-Bengio：从“系统1”向“系统2”进发" class="headerlink" title="Yoshua Bengio：从“系统1”向“系统2”进发"></a>Yoshua Bengio：从“系统1”向“系统2”进发</h2><p>最后，深度学习三巨头之一、图灵奖得主Yoshua Bengio在会上做了题为“深度学习在系统2处理中的应用”（Deep Mind in System 2 Processing）的演讲。<strong>Bengio认为，深度学习的瓶颈已经出现，并指明了突破方向</strong>。</p><p><img src="https://bbs.cvmart.net/uploads/images/202002/12/3/5UuvjPiEpV.gif?imageView2/2/w/1240/h/0" alt="file"></p><p>Bengio首先介绍了深度学习的发展困境。他引用了Daniel Kahneman的认知系统理论。</p><p>Kahneman认为，人的认知系统主要分为“系统1”和“系统2”两个部分。“系统1”所主导的思维是直觉性的、下意识的和非语言的，它使得人类能在熟悉的情况下做出不假思索的快速反应；而“系统2”则是有意识的思维，注重逻辑、规划、推理和因果关系，它使得人类能在全新的情况下做出判断和决策。</p><p><img src="https://bbs.cvmart.net/uploads/images/202002/12/3/LMwwed8hvA.gif?imageView2/2/w/1240/h/0" alt="file"></p><p>Bengio说，目前的深度学习类似于“系统1”的思维模式，想要提升至人类水平的智能，则需要开发出类似“系统2”的认知系统，他认为这必将是未来的发展方向，也是目前深度学习发展所遇到的瓶颈。</p><p>Bengio指出，<strong>为突破该瓶颈，或许可以向自然智能身上获取灵感，模拟人类婴儿的学习模式。</strong></p><p><img src="https://bbs.cvmart.net/uploads/images/202002/12/3/NqLPzcCHQN.gif?imageView2/2/w/1240/h/0" alt="file"></p><p>目前深度学习都是基于独立同分布的假设，但实际现状是，我们感兴趣的往往是出现次数非常少的数据。因此，Bengio认为，分布外泛化（out-of-distribution generalization）是目前深度学习所欠缺的，而且是向“系统2”推进的关键。</p><p><img src="https://bbs.cvmart.net/uploads/images/202002/12/3/niej8Mat0T.gif?imageView2/2/w/1240/h/0" alt="file"></p><p>同时，他还提出，<strong>提升深度学习需要从“个体”（agent）的角度考虑</strong>。个体之间的互动也将影响深度学习的发展，因此需要采取包括建设更好的模型等措施。</p><p><img src="https://bbs.cvmart.net/uploads/images/202002/12/3/cO3cIAmOBh.gif?imageView2/2/w/1240/h/0" alt="file"></p><p>Bengio还提到，“系统2”的两大关键是注意力和意识。注意力是近年深度学习发展的一个重要技术，目前已有大量的实现和探讨。而人类意识往往是先验的。他提出，这可以通过稀疏因子图（sparse factor graph）实现。稀疏因子图可用于学习变量间的因果关系，从而构造变量间的因果关系。</p><h2 id="三巨头笑谈多年研究无人问津"><a href="#三巨头笑谈多年研究无人问津" class="headerlink" title="三巨头笑谈多年研究无人问津"></a>三巨头笑谈多年研究无人问津</h2><p>演讲结束后，Hinton、LeCun、Bengio“三巨头”进行了对话讨论。</p><p>深度学习三巨头的再次聚首是深度学习的一次胜利的转折，该学科曾经被抛弃，甚至也被AAAI淘汰。这也有点自相矛盾，因为这三场演讲似乎都借用了通常被认为属于AI的对立面（即“符号性” AI理论家）的术语，他们是几年前抛弃了Bengio，Hinton和LeCun的人。 </p><p>“然而，你们中的一些人对符号性的人工智能世界有点轻蔑，”主持人、麻省理工学院教授Leslie Kaebling注意到了术语的借用。 “我们能成为朋友吗？还是不能？”她问道，引得观众哄堂大笑。 </p><p>Hinton站在会议桌旁，没有坐下，干脆地打趣道：“好吧，我们有着悠久的历史，比如，”引起了更多的笑声。 </p><p>“<strong>上一次我向AAAI提交论文时，得到了我有史以来最差的评价，而且很刻薄！</strong>” Hinton说。</p><p>“上面说，Hinton已经研究这个想法7年了，没人感兴趣，是时候继续前进了，”Hinton回忆说，LeCun和Bengio笑了，他们也默默无闻地工作了几十年，直到2012年的深度学习取得突破。“忘记这个需要一段时间，”Hinton说，虽然也许忘记过去并继续前进会更好，他也承认。 </p><p><img src="https://bbs.cvmart.net/uploads/images/202002/12/3/30ymeVEKAi.gif?imageView2/2/w/1240/h/0" alt="file"></p><p>Kaebling的问题击中了要害。三位科学家的演讲都暗示了他们的成果曾受到怀疑论者的攻击。</p><p>LeCun表示，他在“社交媒体上还算活跃，并注意到很多人对于深度学习是什么并不清楚”。LeCun影射的正是之前与他在推特上来回争论的深度学习评论家Gary Marcus等人，他们的争论有时甚至有些剑拔弩张。LeCun在演讲的最开始用一张幻灯片定义了深度学习，回应的正是12月Marcus和Bengio之间的一场争论。</p><p>但当晚的大多数情况下，三人之间还是显现出惺惺相惜之意。当有听众提问，对于彼此的观点有什么无法认同的地方时，Bengio打趣道：“这招Leslie已经在我们身上使过了，没有用。”Hinton则表示：“我可以告诉你有啥我不认同他们的。Bengio的邮件地址以‘魁北克’结尾。而我认为，在‘魁北克’之后还应该加上国家代码，但他没加。”</p><p>他们还趁机损了对方几句。Hinton在他演讲的一开始就说明，他就是针对LeCun的。LeCun在30年前实现了卷积神经网路，并使其成为实用技术。<strong>Hinton表示，他要证明为何卷积神经网络完全是“垃圾”，应该以自己的胶囊网络代替。</strong>Hinton还自嘲称，过去三年中，他每年都会推出一个新版本的胶囊网络。他笑着说道：“忘记你们所熟悉的老版本胶囊网络吧，它们都是错的，这个版本才是对的。”</p><p>作为一门学科，其中的有些困难将越来越难以解决。当Kebling问及，是否有人对于大公司使用AI的目的和打算表示担忧时。Hinton笑着指指LeCun，LeCun也笑着回指了Hinton。LeCun主管Facebook的AI研究部门，而Hinton则是谷歌AI团队成员。Hinton说：“呃，我觉得他们应该管管假新闻的事，但……”他说着，声音小了下去。与此同时，LeCun回应道：“实际上，我们正在处理这事。”这次交锋引发了现场最大的掌声和笑声。</p><p>对于该领域的整体架构和如何改进，三位科学家提出了一些想法。Bengio指出，<strong>如今年轻学者们发表论文的压力比他读博士学位时大多了</strong>。他认为必须从结构上做出改变，让学者们能够更加关注长期的问题。LeCun同时也是纽约大学的教授。他表示作为一名教授，“我都不会录取我这样的学生。”</p><p>Hinton多年来默默无闻地努力。他用慢吞吞温柔的英国腔，设法以轻松的方式阐释了这种短视的研究所带来的问题。</p><p>他说：“对于这个过程我提出这样一个模型。人们就某个想法研究了很短的时间，取得了一点点进展就发表了论文。“</p><p>“这就好比有人拿了一本很难的数独书，浏览了一遍，将每个数独题里简单的几个空填了。这给别人带来了大麻烦。”</p><p>参考链接：</p><p><a href="https://www.zdnet.com/article/deep-learning-godfathers-bengio-hinton-and-lecun-say-the-field-can-fix-its-flaws/">https://www.zdnet.com/article/deep-learning-godfathers-bengio-hinton-and-lecun-say-the-field-can-fix-its-flaws/</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> Geoffrey Hinton </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Geoffrey Hinton</title>
      <link href="2021/01/31/geoffrey-hinton/"/>
      <url>2021/01/31/geoffrey-hinton/</url>
      
        <content type="html"><![CDATA[<p><a href="http://www.cs.toronto.edu/~hinton/bio.html">Geoffrey E. Hinton’s Biographical Sketch</a></p><p><a href="https://zhuanlan.zhihu.com/p/62645723">【AI大咖】认真认识一代AI教父Hinton</a></p><p><a href="https://zhuanlan.zhihu.com/p/29435406">浅析 Hinton 最近提出的 Capsule 计划</a></p><p><a href="https://www.zhihu.com/question/65430434/answer/231173731">如何看待Geoffrey Hinton的言论，深度学习要另起炉灶，彻底抛弃反向传播？</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> Geoffrey Hinton </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>YOLO 专栏</title>
      <link href="2021/01/30/yolo-zhuan-lan/"/>
      <url>2021/01/30/yolo-zhuan-lan/</url>
      
        <content type="html"><![CDATA[<h1 id="实时目标检测方法-YOLO-—-从-V1-到-V4"><a href="#实时目标检测方法-YOLO-—-从-V1-到-V4" class="headerlink" title="实时目标检测方法 YOLO — 从 V1 到 V4"></a>实时目标检测方法 YOLO — 从 V1 到 V4</h1><p>Apr 25, 2020 in <a href="https://tangh.github.io/categories/Computer-Science/">Computer Science</a>, <a href="https://tangh.github.io/categories/Computer-Science/Deep-Learning/">Deep Learning</a></p><p>目前真正能实时（30fps 以上）的目标检测算法效果最好的可能就是 YOLO 了，本文注重它从五年前最初版本到前两天公布的 v4 版本的进化过程，会涉及到很多其它关联算法，希望能说清楚算法流程。此文不会对各种 ablation experiment 有分析，这种实验结果类的应当去看原文，只会提及 mAP 等关键数据；对于 related work 中 YOLO 没有使用的，也不会提到，这也应该去看原文。</p><p><strong>论文地址：</strong></p><ol><li>V1，CVPR2016：<a href="https://arxiv.org/abs/1506.02640">https://arxiv.org/abs/1506.02640</a></li><li>V2，CVPR2017：<a href="https://arxiv.org/abs/1612.08242">https://arxiv.org/abs/1612.08242</a></li><li>V3：<a href="https://arxiv.org/abs/1804.02767">https://arxiv.org/abs/1804.02767</a></li><li>V4：<a href="https://arxiv.org/abs/2004.10934">https://arxiv.org/abs/2004.10934</a></li><li>作者网站：<a href="https://pjreddie.com/，上面有一些">https://pjreddie.com/，上面有一些</a> slides、oral 视频、审稿 review</li><li>代码：<a href="https://github.com/AlexeyAB/darknet，官方代码是">https://github.com/AlexeyAB/darknet，官方代码是</a> C/CUDA 写的，除了 OpenCV 不依赖任何第三方库，包括现代的 tensor 库比如 TensorFlow、PyTorch 这些，它本身就是一个框架</li></ol><p>下个月应该会把一个两年前做的 R-CNN 系列的 slides 放上来（已更新至 <a href="https://docs.google.com/presentation/d/1N2H12L0XVV-s0FuxcyHAcG0CFNujHxuWneObr8o7CAE/edit?usp=sharing">Google Presentation</a>），这样双极网络和单级网络的代表算法系列就齐活了。当然去年以来有一些很重要的 Anchor Free 的算法，虽然也可以划分为双极和单级，但其实挺大区别的，大致它们都是关键点检测的思想用了进来。</p><p>下面的图来自 YOLOv4 的论文，检测的各个步骤和相应研究，我觉得分地挺好的。</p><p><a href="https://d2y8c08sxwbp8v.cloudfront.net/2020-detection/yolo-detection-steps.png"><img src="https://d2y8c08sxwbp8v.cloudfront.net/2020-detection/yolo-detection-steps.png" alt="object detection steps"></a><em>object detection steps</em></p><p>通常而言，单级网络去除了 Proposals 的生成过程，直接由预设好的 Anchors 加上回归值（SSD），或者网络直接预测框的中心和宽高（YOLO），来给出图像内 BBox 的位置。且单级网络没有特征重采样的过程，始终是一个密集预测，这使得一些平衡正负样本或其它作用的采样方式无法使用。</p><p>此外，在两级网络中，对于一个位置上的一组 Anchors 或者一组 Proposals 的 类别 和 回归值，通常是由两个并行的全连接层分支给出的；而单级网络中，类别 和 Anchor 的回归值（或 BBox 的宽高）一般直接由一个预测卷积层给出，类别和回归值按照一定次序排列在输出特征的特定通道中。且通常一个点上只有一个位置预测，而不像两级网络一样，一个点上多个类别有对应的多个位置预测。</p><h1 id="Table-of-Contents"><a href="#Table-of-Contents" class="headerlink" title="Table of Contents"></a>Table of Contents</h1><ol><li><a href="https://tangh.github.io/articles/yolo-from-v1-to-v4/#Overview">Overview</a></li><li>You Only Look Once: Unified, Real-Time Object Detection<ol><li><a href="https://tangh.github.io/articles/yolo-from-v1-to-v4/#Architecture">Architecture</a></li><li><a href="https://tangh.github.io/articles/yolo-from-v1-to-v4/#Training-and-Inference">Training and Inference</a></li><li><a href="https://tangh.github.io/articles/yolo-from-v1-to-v4/#Summary-and-Results">Summary and Results</a></li></ol></li><li>YOLO9000: Better, Faster, Stronger<ol><li><a href="https://tangh.github.io/articles/yolo-from-v1-to-v4/#Architecture-1">Architecture</a></li><li><a href="https://tangh.github.io/articles/yolo-from-v1-to-v4/#Train-YOLOv2">Train YOLOv2</a></li><li><a href="https://tangh.github.io/articles/yolo-from-v1-to-v4/#Summary">Summary</a></li><li><a href="https://tangh.github.io/articles/yolo-from-v1-to-v4/#Joint-train-on-object-detection-and-classification-YOLO9000">Joint train on object detection and classification (YOLO9000)</a></li></ol></li><li>YOLOv3: An Incremental Improvement<ol><li><a href="https://tangh.github.io/articles/yolo-from-v1-to-v4/#Network">Network</a></li><li><a href="https://tangh.github.io/articles/yolo-from-v1-to-v4/#Other-Improvements">Other Improvements</a></li><li><a href="https://tangh.github.io/articles/yolo-from-v1-to-v4/#Results">Results</a></li></ol></li><li>YOLOv4: Optimal Speed and Accuracy of Object Detection<ol><li><a href="https://tangh.github.io/articles/yolo-from-v1-to-v4/#Bag-of-freebies">Bag of freebies</a></li><li><a href="https://tangh.github.io/articles/yolo-from-v1-to-v4/#Bag-of-specials">Bag of specials</a></li></ol></li></ol><h1 id="Overview"><a href="#Overview" class="headerlink" title="Overview"></a>Overview</h1><p>以下速度数据均在 Titan X (Maxwell) 上测试，Tesla M40 基本是相同的 GPU。新一代构架的是 Titan X (Pascal)、Titan Xp、GTX 1080 Ti、Tesla P100 这些。Titan Volta (Titan V)、Tesla V100 是更加新一代。再就到目前的 Turing，Titan RTX 这些。</p><p>在 Pascal VOC 07 test 上，使用 07+12 训练</p><div class="table-container"><table><thead><tr><th>名称</th><th>速度（fps）</th><th>精度（mAP）</th><th>输入尺寸</th><th>网络结构</th></tr></thead><tbody><tr><td>YOLOv1</td><td>45</td><td>63.4%</td><td>448 × 448</td><td>Darknet-24</td></tr><tr><td>Fast YOLOv1</td><td>155</td><td>52.7%</td><td>448 × 448</td><td>Darknet-9</td></tr><tr><td>YOLOv2</td><td>40</td><td>78.6%</td><td>544 × 544</td><td>Darknet-19</td></tr><tr><td>YOLOv2</td><td>59</td><td>77.8%</td><td>480 × 480</td><td>Darknet-19</td></tr><tr><td>YOLOv2</td><td>67</td><td>76.8%</td><td>416 × 416</td><td>Darknet-19</td></tr><tr><td>YOLOv2</td><td>81</td><td>73.7%</td><td>352 × 352</td><td>Darknet-19</td></tr><tr><td>YOLOv2</td><td>91</td><td>69.0%</td><td>288 × 288</td><td>Darknet-19</td></tr></tbody></table></div><p>在 Pascal VOC 12 test 上，使用 07++12（即含 07 test）训练</p><div class="table-container"><table><thead><tr><th>名称</th><th>速度（fps）</th><th>精度（mAP）</th><th>输入尺寸</th><th>网络结构</th></tr></thead><tbody><tr><td>YOLOv1</td><td>45</td><td>57.9%</td><td>448 × 448</td><td>Darknet-24</td></tr><tr><td>YOLOv2</td><td>–</td><td>73.4%</td><td>–</td><td>Darknet-19</td></tr></tbody></table></div><p>在 MS COCO test-dev 上，使用 2017 split (trainval35k) 训练</p><div class="table-container"><table><thead><tr><th>名称</th><th>速度（fps）</th><th>精度（mAP）</th><th>精度（mAP 50）</th><th>输入尺寸</th><th>网络结构</th></tr></thead><tbody><tr><td>YOLOv2</td><td>–</td><td>21.6%</td><td>44.0%</td><td>–</td><td>Darknet-19</td></tr><tr><td>YOLOv3</td><td>19.6</td><td>33.0%</td><td>57.9%</td><td>608 × 608</td><td>Darknet-53</td></tr><tr><td>YOLOv3</td><td>34.5</td><td>31.0%</td><td>55.3%</td><td>416 × 416</td><td>Darknet-53</td></tr><tr><td>YOLOv3</td><td>45.5</td><td>28.2%</td><td>51.5%</td><td>320 × 320</td><td>Darknet-53</td></tr><tr><td>YOLOv4</td><td>23</td><td>43.5%</td><td>65.7%</td><td>608 × 608</td><td>CSPDarknet-53</td></tr><tr><td>YOLOv4</td><td>31</td><td>43.5%</td><td>64.9%</td><td>512 × 512</td><td>CSPDarknet-53</td></tr><tr><td>YOLOv4</td><td>38</td><td>43.5%</td><td>62.8%</td><td>416 × 416</td><td>CSPDarknet-53</td></tr></tbody></table></div><h1 id="You-Only-Look-Once-Unified-Real-Time-Object-Detection"><a href="#You-Only-Look-Once-Unified-Real-Time-Object-Detection" class="headerlink" title="You Only Look Once: Unified, Real-Time Object Detection"></a>You Only Look Once: Unified, Real-Time Object Detection</h1><p>思想：缩放图片一次通过卷积神经网络同时得出位置和类别，这样速度快、中间步骤简单、基于一整张图所有信息而不是每个 Proposal 中部分信息进行检测。</p><h2 id="Architecture"><a href="#Architecture" class="headerlink" title="Architecture"></a>Architecture</h2><p><a href="https://d2y8c08sxwbp8v.cloudfront.net/2020-detection/yolo-prediction-model.png"><img src="https://d2y8c08sxwbp8v.cloudfront.net/2020-detection/yolo-prediction-model.png" alt="YOLO prediction model"></a><em>YOLO prediction model</em></p><p>YOLO 的检测方法是将输入图划分成 S×S 个格子（Grid），每一个格子预测出 B 个框。如果一个物体的中心落在某一个格子内部，那么这个格子负责预测这个物体。一个格子首先要预测它负责预测的物体的类别概率，这是一个长度为 Class (C) 的数组。此外，对于一个格子内的每个框，都还要预测另外的 5 个值 <code>x, y, w, h, Pr*IoU</code>，前两个值 <code>x, y ∈ [0, 1]</code> 表示框的中心点相对于这个格子的偏移，<code>w, h</code> 表示这个框在原图尺寸上的宽长（相对值，归一化到 <code>[0, 1]</code>）。这样得到预测值之后，先应用偏移 <code>x, y</code> 找到框的中心点，再通过 <code>w, h</code> 即可作出一个框。最后一个值 <code>confidence = Pr(Object)*IoU</code> 表示框内有物体的概率乘以这个框和 GT 之间的 IoU，也就是说，如果这个框对应的是背景，那么这个值应该是 <code>0</code>，如果这个框对应的是前景，那么这个值应该是与对应前景 GT 的 IoU。</p><p>从上面我们可以看出：</p><ul><li>YOLO 所需要的整个输出为一个 <code>S × S × (B*5 + C)</code> 的 tensor，且这里 C 是前景的类别数，无需加上背景一类（例如对于 Pascal VOC，C=20）。它无需两级检测网络的两个全连接分开输出类别和位置，也无需 Proposals 生成、特征重采样等过程。实验中，S=7，B=2。</li><li>每个格子预测的长度为 Class 的概率是一个条件概率，是在有物体下的概率，即 <code>Pr(Class_i|Object)</code>，所以在预测的时候，把这个和每个框内预测的概率相乘 <code>Pr(Class_i|Object) * Pr(Object) * IoU = Pr(Class_i) * IoU</code> 就得到对每个框的逐类别概率。这里与 R-CNN 等两级网络不同之处在于，两级网络中一般使用 C+1 类判断前背景，而 YOLO 使用框内一个额外概率值判断前背景。</li><li>得到的条件概率的意思是，以上图 class probability map 为例，每个格子取输出 tensor 对应的向量中的 class 分数的最大值对应的类别，就可以得到此图。最下方的红色是 C=20 类中的一个类别，假设代表「飞机」。但是它并不表示这个格子就是「飞机」，而是，如果这个格子内有物体，那么这个格子内的物体的类别是「飞机」。而有没有物体，需要看上方图的 confidence，经提醒，这个图内的 98 个框（位置和大小反映 <code>x, y, w, h</code>）的粗细可能就代表这个 confidence 分数，只有 confidence 大的框，才认为里面有物体。</li></ul><p>下面看得到这个输出 tensor 的网络结构，YOLO 系列用了一个自创的网络结构，叫做 darknet，灵感源于 <a href="https://arxiv.org/abs/1409.4842">GoogLeNet (Inception V1)</a>。在 YOLOv1 中，它有 24 层卷积层（加上 4 个池化层和 2 个全连接层），结构图如下。</p><p><a href="https://d2y8c08sxwbp8v.cloudfront.net/2020-detection/yolo-darknet-24.png"><img src="https://d2y8c08sxwbp8v.cloudfront.net/2020-detection/yolo-darknet-24.png" alt="Darknet-24 (Unofficial name) Architecture"></a><em>Darknet-24 (Unofficial name) Architecture</em></p><p>这里没有使用 Inception Module，但是使用了同样的减少计算量的方法，即先用 1 × 1 reduction layer，再使用 3 × 3 convolutional layer。可以简单计算一下，在 1024 × 14 × 14 层，如果直接使用 1024 × 1024 × 3 × 3 卷积，计算量为 <code>(1024 × 14 × 14) × (1024 × 3 × 3) = 1849.7M</code>。而如果像图上结构一样先降维（可以理解为非线性映射到低维空间，可能联想到 PCA 虽然它是线性的）再卷积，计算量为 <code>(512 × 14 × 14) × (1024 × 1 × 1) + (1024 × 14 × 14) × (512 × 3 × 3) = 102.7M + 924.8M = 1027.5M</code>，接近于小到一半。这种 bottleneck 结构在现代 backbone 上很常见。</p><p>对于激活层，最后一层使用的是线性激活函数，其它层使用的是 leaky ReLU，<code>f(x) = 0.1x when x&lt;0</code>。</p><h2 id="Training-and-Inference"><a href="#Training-and-Inference" class="headerlink" title="Training and Inference"></a>Training and Inference</h2><p>首先在 ImageNet 上预训练前 20 层卷积，把后面替换为一个平均池化层和一个全连接层，输入尺寸为 224 × 224。训练好后改为 4 个卷积层和 2 个全连接层，输入尺寸改为 448 × 448。</p><p>Loss 函数选择为 sum-squared error，SSE=∑i(xi−x^)2。这有几个不平衡的问题：</p><ol><li>位置预测和类别预测是相等权重的；</li><li>对于不含任何物体的格子，即负样本总是多于正样本的，所以 confidence 分数（每个 BBox 的第五个预测参数）会趋向于 <code>0</code>；</li><li>大物体和小物体位置预测错误的权重是相等的，对于大物体，相同数量的位置偏移在 Loss 上的反映应当小于小物体的，因为对于 IoU 的影响会更小。</li></ol><p>对于前两个问题，通过增加权重 λcoord=5, λnoobj=.5 来解决。第三个问题，通过预测 BBox 宽高的平方根来解决。</p><p>还有一个关于 GT 的问题是，一个格子负责预测中心点落在其内的物体，但一个格子预测了 B 个 BBox，我们只希望一个 BBox Predictor 负责一个物体。所以在训练时，只有预测出的框的与 GT 的 IoU 最大的那个 BBox 认为是有物体的（正样本）。所以这里与 R-CNN 系列两级网络不同，在那里一个 GT 是可以匹配到多个预测框的。作者这么设计意图是让每个 Predictor 专门化，专注于一种尺寸、长宽比或类别的物体。</p><p>整个损失函数如下：</p><p>λcoord∑i=0S2∑j=0BIijobj⋅([(xi−x^i)2+(yi−y^i)2]+[(wi−w^i)2+(hi−h^i)2])+∑i=0S2∑j=0BIijobj⋅(Ci−C^i)2+λnoobj∑i=0S2∑j=0BIijnoobj⋅(Ci−C^i)2+∑i=0S2Iiobj∑c∈classes(pi(c)−p^i(c))2</p><p>公式中第一行是 BBox 的位置和大小；第二行是 BBox 内的 <code>Pr*IoU</code>；第三行是每个格子内的类别概率，可以看到只有格子内有物体时才有这项 loss，这与之前的条件概率是对应的。Icondition 表示如果 <code>condition</code>，那么这个值为 <code>1</code>，否则为 <code>0</code>。</p><p><strong>训练细节：</strong></p><ol><li>epochs = 135，batch size = 64，momentum = 0.9，weight decay = 0.0005。</li><li>lr：第一个 epoch 从 10e-3 增加到 10e-2，继续保持 75 个 epochs，然后 10e-3 训练 30 个 epochs，最终 10e-4 训练 30 个 epochs。</li><li>第一个全连接层后加了一个 <code>.5</code> 的 Dropout 层防止过拟合。数据增强：20% 尺度的随机 translation 和 scaling，在 HSV 空间中 1.5x 的曝光和饱和度调整。</li></ol><p>对于测试，YOLO 设计为预测 98 个框，使用每个框内的第五个预测值决定是否留下这个框，类别使用格子预测的类别。对于一些大的物体，可能在多个格子内都给出接近的框，使用 NMS 可以增加 2% ～ 3% mAP。而对于 R-CNN 等基于区域分类的算法，NMS 是必不可少的。</p><h2 id="Summary-and-Results"><a href="#Summary-and-Results" class="headerlink" title="Summary and Results"></a>Summary and Results</h2><p>YOLO 的几个问题：</p><ol><li>对小物体效果不好；</li><li>YOLO 通过下采样后数据得出 BBox 的位置偏移和宽高，所以精度不高，同时对于一些罕见的长宽比或者尺寸的物体的效果不好；</li><li>loss 只是近似反映检测效果的好坏，比如对于不同大小的物体，<code>x, y, w, h</code> 的误差仍不能准确反映 IoU 的误差。YOLO 对于位置的预测较差，是降低 mAP 的主要原因。</li></ol><p>数据集使用 Pascal VOC 07+12。如果在 12 测试，那么 07 的 test 也被用于训练。在 07 的测试结果为 <code>63.4%</code> mAP，在 12 的测试结果为 <code>57.9%</code> mAP。</p><h1 id="YOLO9000-Better-Faster-Stronger"><a href="#YOLO9000-Better-Faster-Stronger" class="headerlink" title="YOLO9000: Better, Faster, Stronger"></a>YOLO9000: Better, Faster, Stronger</h1><p>改进：除了一些提高精度的，YOLOv2 还引入了 multi-scale training，所以它可在不同输入尺寸上工作，提供速度精度的 tradeoff。此外，提出了一种联合训练，可以同时在 COCO 和 ImageNet 上训练，网络可以学习检测那些没有在检测数据集中标注的类别。</p><h2 id="Architecture-1"><a href="#Architecture-1" class="headerlink" title="Architecture"></a>Architecture</h2><p>首先看网络，作者将网络减少了几层，提高了速度，同时加入了 <a href="https://arxiv.org/abs/1502.03167">BN</a> 层，提高了精度。</p><p><a href="https://d2y8c08sxwbp8v.cloudfront.net/2020-detection/yolo-darknet-19-classification.png"><img src="https://d2y8c08sxwbp8v.cloudfront.net/2020-detection/yolo-darknet-19-classification.png" alt="Darknet-19 for classification"></a><em>Darknet-19 for classification</em></p><p><a href="https://d2y8c08sxwbp8v.cloudfront.net/2020-detection/yolo-darknet-19-detection.png"><img src="https://d2y8c08sxwbp8v.cloudfront.net/2020-detection/yolo-darknet-19-detection.png" alt="Darknet-19 for detection"></a><em>Darknet-19 for detection</em></p><p>整个网络（左图）含有 19 个卷积层和 5 个最大值池化层，不再有全连接层，网络的 output stride 减小了一倍变为 32。倒数第二层是 Global Average Pooling，出自 <a href="https://arxiv.org/abs/1312.4400">Network in Network</a>，<a href="https://arxiv.org/abs/1409.4842">GoogLeNet</a> 中也使用了，方法是在每个特征图通道上进行平均池化。在每个卷积层之后都加了 BN 层，网络不再需要 Dropout 层。</p><p>对于检测（右图），网络输入尺寸也进行了改动，希望最终输出一个奇数尺寸，这样就会有一个中心点。所以 v2 中默认输入尺寸是 416 × 416，增减输入尺寸是以 64 为单位进行。一般一个大物体的中心会落在图像中心，所以这样可以用一个格子去预测它而不是四个格子。</p><p>左图这个网络是用于 ImageNet Classification 的，在预训练完后需要改成检测网络。方法是去掉最后 Convolutional、AvgPool、Softmax 三层，然后加上三层 1024 × 3 × 3 卷积，最后用一个 1 × 1 卷积进行预测，得到所需 <code>A × (5 + C) = 125</code> 通道（这里通道数与 YOLOv1 不同，见下文）。此外，这里还加入一个 passthrough layer，使得网络对于小物体的检测效果更好。注意这里论文里说的和实际上<a href="https://github.com/pjreddie/darknet/blob/master/cfg/yolov2.cfg#L211-L217">代码</a>里做的有些不同：论文中是把最后一个 512 × 3 × 3 卷积的结果，尺寸为 26 × 26 × 512 feature map 转化为 13 × 13 × 2048，然后 concat（通道上的连接）到倒数第二个卷积（也就是最后一个 3 × 3 卷积）的结果上；实际代码中对尺寸为 26 × 26 × 512 feature map 后面加了一个 64 × 1 × 1 的卷积，降低了通道数，然后再 <a href="https://github.com/pjreddie/darknet/blob/8215a8864d4ad07e058acafd75b2c6ff6600b9e8/src/blas.c#L9-L30">reorg</a> 转化为 13 × 13 × 256，并 concat 到 13 × 13 × 1024 的特征图上，输出一个 13 × 13 × 1280 的特征图。</p><p>再看其它的改进：</p><p><strong>Anchor Box</strong></p><p>YOLO 在 BBox 位置预测上表现并不好，一方面是因为它直接给出宽高。相比 R-CNN 中有预设的 Anchors，网络只需要预测一个 offset，这相对容易。作者在 v2 中引入了 Anchors。</p><p>第二个改动是，之前每个格子只预测一次类别，这实际上是对 BBox 的一种限制，现在需要 decouple。所以对每个 Anchor 都预测一组类别，它们的意义没变。同时，每个格子上的 BBox/Anchor 数量不再是 2。</p><p><a href="https://d2y8c08sxwbp8v.cloudfront.net/2020-detection/yolo-output-tensor.png"><img src="https://d2y8c08sxwbp8v.cloudfront.net/2020-detection/yolo-output-tensor.png" alt="output tensor of YOLOv1 against YOLOv2"></a><em>output tensor of YOLOv1 against YOLOv2</em></p><p>此外，R-CNN 系列的 Anchors 是人工指定的，而这里的 Anchors 是通过 k-means 算法得到的，距离指标为 <code>d(box, centroid) = 1 − IoU(box, centroid)</code>，即以 IoU 来判断。下图是在 COCO 和 VOC 上聚类出的 Anchor 形状，以及使用不同距离指标或人工指定得到的平均 IoU。</p><p><a href="https://d2y8c08sxwbp8v.cloudfront.net/2020-detection/yolo-anchor-clusters.png"><img src="https://d2y8c08sxwbp8v.cloudfront.net/2020-detection/yolo-anchor-clusters.png" alt="k-means result"></a><em>k-means result</em></p><p><strong>Direct location prediction</strong></p><p>这里先回顾一下 R-CNN 系列中的 regressor 是怎么工作的（注意在 YOLO 的论文中符号错了）：</p><p>x=(tx∗wa)+xa , y=(ty∗ha)+yaw=wa⋅etw , h=ha⋅eth</p><p>其中带下标 <code>a</code> 的是 Anchor，<code>t</code> 表示网络预测的值。</p><p>对于位置这样引入了尺度不变性，比如 <code>tx = 1</code> 框的中心点就向右移动一个框宽度的距离。但是这对于框的位置没有限定，对于随机化的初始值，框可能出现在图中的任何位置，导致难以训练。所以位置还是沿用 v1 中的相对于格子的预测方式，宽高则采用相同的指数形式。</p><p>bx=σ(tx)+cx , by=σ(ty)+cybw=pwetw , bh=pheth</p><p><a href="https://d2y8c08sxwbp8v.cloudfront.net/2020-detection/yolo-v2-anchor-regression.png"><img src="https://d2y8c08sxwbp8v.cloudfront.net/2020-detection/yolo-v2-anchor-regression.png" alt="YOLOv2 anchor regression"></a><em>YOLOv2 anchor regression</em></p><p>公式里 <code>sigma(·)</code> 是一个 logistic activation (sigmoid) 用于将值限定在 <code>[0, 1]</code>，即把中心点的变动限制在当前格子里。<code>cx, cy</code> 是所在格点左上角到图像左上角的距离，例如上图中是 <code>(1, 1)</code>（网格大小归一化了）。这里可以看出，这个位置是直接预测出的，它不依赖于设定的 Anchors。</p><h2 id="Train-YOLOv2"><a href="#Train-YOLOv2" class="headerlink" title="Train YOLOv2"></a>Train YOLOv2</h2><div class="table-container"><table><thead><tr><th>网络</th><th>top-5</th><th>top-1</th><th>输入尺寸</th><th>floating point operations</th></tr></thead><tbody><tr><td>VGG-16</td><td>90.0%</td><td>-</td><td>224 × 224</td><td>30.69 billion</td></tr><tr><td>Darknet-24</td><td>88.0%</td><td>-</td><td>224 × 224</td><td>8.52 billion</td></tr><tr><td>Darknet-19</td><td>91.2%</td><td>72.9%</td><td>224 × 224</td><td>5.58 billion</td></tr></tbody></table></div><ol><li>在 ImageNet 上训练 160 个 epochs。lr = 0.1，polynomial rate decay with a power of 4，weight decay = 0.0005，momentum = 0.9。随机裁剪、旋转、颜色和曝光调整。</li><li>High Resolution Classifier：ImageNet 训练是使用 224 × 224，这样在进行检测训练时，网络不仅要学习更大的 448 × 448 输入，还要同时学习检测任务。所以在 v2 中，会在 ImageNet 上使用 448 × 448 fine tune 10 个 epochs 再进行检测训练，lr = 10e-3。准确率达到 76.5%/93.3%。</li><li>Multi-Scale Training：接下来进行检测训练。训练中每过 10 个 epochs，会在 <code>{320, 352, ..., 608}</code> 中随机选择一个输入尺寸继续训练。共 160 个 epochs，lr = 10e-3，在 10、60、90 epoch 时减半。weight decay、momentum 与上面相同。</li></ol><h2 id="Summary"><a href="#Summary" class="headerlink" title="Summary"></a>Summary</h2><p><a href="https://d2y8c08sxwbp8v.cloudfront.net/2020-detection/yolo-v2-improvement-path.png"><img src="https://d2y8c08sxwbp8v.cloudfront.net/2020-detection/yolo-v2-improvement-path.png" alt="The path from YOLO to YOLOv2"></a><em>The path from YOLO to YOLOv2</em></p><p>上表总结了从 v1 到 v2 的各项改进，说明一下：表中的 anchor boxes 指的是人工指定的，固定尺寸和长宽比的 anchors，使用这种框，mAP 69.5 -&gt; 69.2，recall 81% -&gt; 88%，精度小幅下降召回明显提高，说明网络有较大提升空间，所以作者采取了下面的 k-means 聚类找出最佳初始尺寸的方法。对于这种聚类得到的框，作者叫它 dimension priors，可能应该翻译成「先验框」。但是我觉得它本质和 anchors 没什么差别，且对于网络的修改也沿用了，其实在 v3 中作者也管它叫 anchors 了，所以在上文没有区分。</p><h2 id="Joint-train-on-object-detection-and-classification-YOLO9000"><a href="#Joint-train-on-object-detection-and-classification-YOLO9000" class="headerlink" title="Joint train on object detection and classification (YOLO9000)"></a>Joint train on object detection and classification (YOLO9000)</h2><p>基本思路是对于检测的数据传入，BP 整个网络，对于分类的数据传入，只 BP 有关分类的网络部分。一个问题是检测数据集如 COCO 提供的是一个很泛的类别，比如「狗」，共 80 类；而分类数据集如 ImageNet 提供的类别是很具体的，如「哈士奇」，共 21841 类。而 Softmax 意味着各类别之间是相互排斥的，而我们希望只在每个数据集内类别相互排斥，而数据集之间不是。</p><p>下面仍然先要在分类上预训练，然后再训练检测。</p><p><strong>Classification</strong></p><p>ImageNet 的标签来自于 WordNet，一个语言数据集，它有详细的层级，比如 canine -&gt; dog -&gt; hunting dog -&gt; terrier -&gt; Norfolk terrier，但是它是一个 Graph 而不是 Tree，比如 dog 可以属于 canine 也可以属于 domestic animal，即有多个父节点。好在大多数类别通向 root 只有一条路径，对于有多条路径的，选择最短的路径，舍弃其它的，这样就可以构造一个 Word Tree。</p><p>对于 ImageNet-1000，构建完整个图之后有 1369 个节点，增加了额外的 369 个节点。每一个节点预测一个条件概率，最终的概率需要将它们相乘，例如 <code>Pr(Norfolk terrier) = Pr(Norfolk terrier|terrier) * Pr(terrier|hunting dog) ∗ ... ∗ Pr(mammal|animal) * Pr(animal|physical object) * Pr(physical object)</code>。对于分类，每张图都有物体，所以这里最后一项 <code>Pr(physical object) = 1</code>。</p><p><a href="https://d2y8c08sxwbp8v.cloudfront.net/2020-detection/yolo-prediction-on-wordtree1k.png"><img src="https://d2y8c08sxwbp8v.cloudfront.net/2020-detection/yolo-prediction-on-wordtree1k.png" alt="Prediction on ImageNet vs WordTree"></a><em>Prediction on ImageNet vs WordTree</em></p><p>在 ImageNet 上使用这个图训练网络，预测的形式如上图右侧，在每层级下分别 Softmax。一张图片会顺着这个 tree（可参考下面的图）走到 root，获得路径上的所有标签，即一张图现在有多个标注。这样训练的结果为 71.9%/90.4%。新增节点后准确率下降不多，同时如果网络见到了一个没训练过的狗的品种，那么预测中「狗」的概率会很大，同时所有具体类别的概率又很小。</p><p><strong>Detection</strong></p><p>对于框的分类结果，检测中每个格子内不一定有物体， <code>Pr(physical object)</code> 根据 confidence/objectness 分数（BBox 的第五个预测值）确定。判断一个框的类别时，从 WordTree 根节点开始向下遍历，对每一个节点，在它的所有子节点中，选择概率最大的那个（一个节点下面的所有子节点是互斥的），一直向下遍历直到某个节点的子节点概率低于设定的阈值（意味着很难确定它的下一层对象到底是哪个），或达到叶子节点，那么该节点就是对应的对象。</p><p><a href="https://d2y8c08sxwbp8v.cloudfront.net/2020-detection/yolo-combine-coco-and-imagenet.png"><img src="https://d2y8c08sxwbp8v.cloudfront.net/2020-detection/yolo-combine-coco-and-imagenet.png" alt="Combining datasets using WordTree hierarchy"></a><em>Combining datasets using WordTree hierarchy</em></p><p>训练总共选取了 9000 类，含有 COCO、ImageNet 分类和检测数据集。为了构造 Tree 产生的父节点，构造的方法与之前相同，加起来共 9418 类。Oversampling COCO 使得数据量之比为 4:1。</p><p>网络结构和 v2 相同，先验框的尺寸改为 3 种。标注和反向传播与之前类似，（1）对于检测数据集图像，loss 与之前相同，只是这里对于 class，只反向传播标注的那个节点及其父节点上的 loss，不 BP 其子节点上的；（2）对于分类数据集图像，首先找到 GT 所属类别的预测值最高的那个框，只反向传播这个框上的 class 和 objectness 部分，四个坐标不反向传播。对于 class，与检测的相同，只看其和其父节点的，对于 objectness，原文是「We also assume that the predicted box overlaps what would be the ground truth label by at least .3 IOU and we backpropagate objectness loss based on this assumption.」，我觉得意思是说如果预测的 <code>objectness = Pr(object) * IoU</code> 小于 <code>1 * 0.3</code> 的话就有一个损失在上面，具体损失形式需要以后看一下代码了更新。</p><p><strong>Results</strong></p><p>作者在 ImageNet Detection 上测试，其中 44 类是与 COCO 相同的，156 类是 COCO 中没有只出现在 ImageNet Classification 的。结果是 19.7 mAP，在不重合的 156 类上有 16.0 mAP。具体来看不重合的类别部分，对于各种动物，COCO 中有一些动物的标注，对于新动物的类别的表现不错：<code>red panda = 50.7, fox = 52.1, koala bear = 54.3, tiger = 61.0, armadillo = 61.7</code>；对于一些 COCO 中完全没有相关（类似）的类别的，表现很差：<code>diaper = 0.0, horizontal bar = 0.0, rubber eraser = 0.0, sunglasses = 0.0, swimming trunks = 0.0</code>。</p><h1 id="YOLOv3-An-Incremental-Improvement"><a href="#YOLOv3-An-Incremental-Improvement" class="headerlink" title="YOLOv3: An Incremental Improvement"></a>YOLOv3: An Incremental Improvement</h1><p>YOLOv3 和 v4 都是 tech report，更多是把别人的工作在保证速度前提下整合进 YOLO 以提高精度。</p><p>每一代 YOLO 都对网络或是说 backbone 进行了改进，YOLOv3 更是主要集中在这个网络上。</p><h2 id="Network"><a href="#Network" class="headerlink" title="Network"></a>Network</h2><p>YOLOv3 同样是先有一个检测网络，在 ImageNet 上预训练，然后改为检测网络训练。下图（右侧是左侧红线部分）是 DarkNet-53，含有 52 个卷积和 1 个全连接。可以看到，与 DarkNet-19 相比，层数多了不少，主要的改变在于：</p><ol><li>去掉了池化层，全部由一个步长为 2 的卷积层完成下采样。</li><li>最后的全连接层又回来了。</li><li>内部出现了类似于 ResNet 的残差连接。</li></ol><p><a href="https://d2y8c08sxwbp8v.cloudfront.net/2020-detection/yolo-darknet-53-classification.png"><img src="https://d2y8c08sxwbp8v.cloudfront.net/2020-detection/yolo-darknet-53-classification.png" alt="Darknet-53 for classification"></a><em>Darknet-53 for classification</em></p><div class="table-container"><table><thead><tr><th>backbone</th><th>top-1</th><th>top-5</th><th>测试尺寸</th><th>Ops</th><th>FPS</th><th>BFLOP/s</th></tr></thead><tbody><tr><td>Darknet-19</td><td>74.1%</td><td>91.8%</td><td>256 × 256</td><td>7.29 B</td><td>171</td><td>1246</td></tr><tr><td>Darknet-53</td><td>77.2%</td><td>93.8%</td><td>256 × 256</td><td>18.7 B</td><td>78</td><td>1457</td></tr><tr><td>ResNet-101</td><td>77.1%</td><td>93.7%</td><td>256 × 256</td><td>19.7 B</td><td>53</td><td>1039</td></tr><tr><td>ResNet-152</td><td>77.6%</td><td>93.8%</td><td>256 × 256</td><td>29.4 B</td><td>37</td><td>1090</td></tr></tbody></table></div><p>上述数据统一在 TitanX 下测试，最后一项 BFLOP/s 意味着 Darknet 对 GPU 的利用更好。</p><p>再看检测网络，在这里作者引入了类似于 FPN 的多级预测结构。这个在论文里讲得有点零散混乱且没有结构图，我根据<a href="https://github.com/pjreddie/darknet/blob/master/cfg/yolov3.cfg">代码</a>做了一个下面的网络结构图。</p><p><a href="https://d2y8c08sxwbp8v.cloudfront.net/2020-detection/yolo-darknet-53-detection.png"><img src="https://d2y8c08sxwbp8v.cloudfront.net/2020-detection/yolo-darknet-53-detection.png" alt="Darknet-53 for detection"></a><em>Darknet-53 for detection</em></p><p>解释几点：</p><ol><li>每一个 Conv 都跟着一个 BN 和 leaky ReLU 激活层，最后每个 Prediction 是通过一个无 BN、linear 激活的 1 × 1 卷积层得到的，就是一般的预测层，在图中没有画出（也可认为绿色的 Prediction 就是这个卷积）。</li><li>每一个 Add 之后有一个 linear activation。</li><li>这里每个 Residual Unit 里面只有两层，与 ResNet 的不一样。上方蓝色的 <code>N×</code> 表示括号内的模块重复 N 次。</li><li>Conv 上方的尺寸是指经过这一层后的尺寸，以输入 <code>416 × 416</code> 为例。都是 CHW 的格式。</li><li>黄色的层是改为检测网络之后新加入的，白色的是原有的 Darknet-53 Backbone，共 52 层（去掉了最后的全连接）。</li></ol><p>再看最后输出的 255 个通道是怎么回事，<code>255 = 3 × (80 + 5)</code>，首先这里是以 COCO 为基准了，不再使用 VOC 的，所以是 80；5 就是从 v1 一直延续来的；3 指的是三个 Anchors，在 v2 里是五个，而 v3 实际用了 9 个，平均分在三级预测上。在 COCO 上尺寸分别是 <code>(10×13),(16×30),(33×23),(30×61),(62×45),(59× 119), (116 × 90), (156 × 198), (373 × 326)</code>。</p><h2 id="Other-Improvements"><a href="#Other-Improvements" class="headerlink" title="Other Improvements"></a>Other Improvements</h2><p><strong>Bounding Box Prediction (objectness)</strong></p><p>对于 objectness 分数，YOLOv3 采用了 logistic regression，所以如果一个 BBox 与 GT 的交叠大于任何其它的 BBox，那么它的 objectness 分数应该为 <code>1</code>。训练使用 binary cross-entropy loss，不再是 SSE loss。</p><p>同时引入了类似 RPN 的匹配机制：如果一个框与 GT 的交叠大于一个阈值 <code>0.5</code> 但它又不是交叠最大的框，那么这个将作为非正非负的样本，在训练时被忽略。</p><p>同样，一个 GT 只会与一个 Anchor/BBox 匹配上，对于没有匹配上的负样本，loss 中将没有 coordinate 和 class predictions 部分，只有 objectness loss。</p><p><strong>Class Prediction (classes)</strong></p><p>作者去掉了之前使用的 Softmax 进行类别分类，因为发现对准确率没有帮助，且一个大型数据集如 Open Images 上面有一些交叠的类别，比如 Woman - Person。使用 independent logistic classifiers 预测，并设定一个阈值，高于这个阈值的类别将被赋给对应的框。训练使用 binary cross-entropy loss，不再是 SSE loss。</p><h2 id="Results"><a href="#Results" class="headerlink" title="Results"></a>Results</h2><p><a href="https://d2y8c08sxwbp8v.cloudfront.net/2020-detection/yolo-v3-results-on-coco-test-dev.png"><img src="https://d2y8c08sxwbp8v.cloudfront.net/2020-detection/yolo-v3-results-on-coco-test-dev.png" alt="YOLO v3 results on COCO test-dev"></a><em>YOLO v3 results on COCO test-dev</em></p><p>从上表可以看出，YOLOv3-608 在 COCO 上的结果以及到了和 ResNet-FasterRCNN 接近的水平，但是时间仅需 51ms，是后者的三倍多。同时，在 AP50 指标上 YOLO 表现得很好，说明很大一部分的问题来自于框的位置的不准确。</p><p><a href="https://d2y8c08sxwbp8v.cloudfront.net/2020-detection/yolo-v3-precision-speed-compare.png"><img src="https://d2y8c08sxwbp8v.cloudfront.net/2020-detection/yolo-v3-precision-speed-compare.png" alt="precision-speed compare on COCO test-dev"></a><em>precision-speed compare on COCO test-dev</em></p><h1 id="YOLOv4-Optimal-Speed-and-Accuracy-of-Object-Detection"><a href="#YOLOv4-Optimal-Speed-and-Accuracy-of-Object-Detection" class="headerlink" title="YOLOv4: Optimal Speed and Accuracy of Object Detection"></a>YOLOv4: Optimal Speed and Accuracy of Object Detection</h1><p>YOLOv4 是一篇将其它人提出许多的方法整合进 YOLO 的文章，但有一个前提就是保证速度，所以有些方法做了一些改动。同时基于这个原则，作者希望能使用较亲民的设备进行训练和预测，所以所有涉及多 GPU 的方法比如 SyncBN 均不予考虑。相应的测试也选用单个 RTX 2080Ti/RTX 2070/GTX 1080Ti 这类游戏显卡（但是 2080Ti 这好像不是所有打游戏的都买得起的？）。不过这篇文章还挺好的，对检测的研究也进行了一个相应的划分总结，还是挺全面的像综述一样，值得看看原文，本文里只有 YOLOv4 用到了的方法的分析。</p><p>其实我感觉很难写，因为涉及太多其它的文章，不知道简单几句能不能给一篇文章讲清楚。此外有些还是今年的，很新，我也没看过。。。</p><p>总的来说，作者将其它人的工作划分为 Bag of freebies (BoF) 和 Bag of specials (BoS)。前者指在训练时候的一些方法，不影响预测时间和模型复杂度；而后者指的是整个构架的改动，对预测（时间）会有影响。我花了点时间给整理了一下，下面两个表是用到的所有方法和对应论文，没有对应论文的就是作者在 YOLOv4 中应用的一些简单 BoF，可以看到，这篇文章各种 tricks 真的巨多，我相信给其它算法这么一顿军训效果也能好不少的。不过别人已经测试好了，直接能用，也很实用对吧。</p><div class="table-container"><table><thead><tr><th>Backbone BoF</th><th>arXiv</th><th>Detector BoF</th><th>arXiv</th></tr></thead><tbody><tr><td>CutMix</td><td>ICCV 2019 <a href="https://arxiv.org/abs/1905.04899">1905.04899</a></td><td>CIoU-loss</td><td>AAAI 2020 <a href="https://arxiv.org/abs/1911.08287">1911.08287</a></td></tr><tr><td>DropBlock regularization</td><td>NIPS 2018 <a href="https://arxiv.org/abs/1810.12890">1810.12890</a></td><td>DropBlock regularization</td><td><a href="https://arxiv.org/abs/1810.12890">1810.12890</a></td></tr><tr><td>Class label smoothing</td><td>CVPR 2016 <a href="https://arxiv.org/abs/1512.00567">1512.00567</a></td><td>Cross mini-Batch Normalization (CmBN)</td><td><a href="https://arxiv.org/abs/2002.05712">2002.05712</a></td></tr><tr><td></td><td></td><td>Cosine annealing scheduler</td><td><a href="https://arxiv.org/abs/1608.03983">1608.03983</a></td></tr></tbody></table></div><p>Others:</p><ul><li>BoF: Mosaic data augmentation.</li><li>Detector BoF: Eliminate grid sensitivity, Optimal hyper-parameters, Random training shapes, Self-Adversarial Training, Multiple anchors for a single ground truth.</li></ul><div class="table-container"><table><thead><tr><th>Backbone BoS</th><th>arXiv</th><th>Detector BoS</th><th>arXiv</th></tr></thead><tbody><tr><td>Mish activation</td><td><a href="https://arxiv.org/abs/1908.08681">1908.08681</a></td><td>Mish activation</td><td><a href="https://arxiv.org/abs/1908.08681">1908.08681</a></td></tr><tr><td>Cross-stage partial connections (CSP)</td><td><a href="https://arxiv.org/abs/1911.11929">1911.11929</a></td><td>SPP-block</td><td>TPAMI 2015 <a href="https://arxiv.org/abs/1406.4729">1406.4729</a></td></tr><tr><td>Multi-input weighted residual connections (MiWRC)</td><td>CVPR 2020 <a href="https://arxiv.org/abs/1911.09070">1911.09070</a></td><td>Path-aggregation block (PAN)</td><td>CVPR 2018 <a href="https://arxiv.org/abs/1803.01534">1803.01534</a></td></tr><tr><td></td><td></td><td>SAM-block</td><td>ECCV 2018 <a href="https://arxiv.org/abs/1807.06521">1807.06521</a></td></tr><tr><td></td><td></td><td>DIoU-NMS</td><td>AAAI 2020 <a href="https://arxiv.org/abs/1911.08287">1911.08287</a></td></tr></tbody></table></div><p><del>仍需要一点时间施工，不过我猜要拖到五月底了。</del><br>已经到五月底了，然而事情很多，考虑到眼下两个月之内应该不会有机会看论文，所以我愉快地宣布下面的内容鸽子了 🐦。</p><h2 id="Bag-of-freebies"><a href="#Bag-of-freebies" class="headerlink" title="Bag of freebies"></a>Bag of freebies</h2><p>最常用的 bag of freebies 就是数据增强（data augmentation）了，YOLOv4 用了下面这些。</p><p><strong>CutMix</strong></p><p>CutMix 是一种 regional dropout strategy，这类方法通过去除一些 informative pixels 来使得网络学习图像中 less discriminative 部分的信息。</p><p>关于训练时的标签和损失函数，YOLOv4 中使用了下面这些。</p><p><strong>Class label smoothing</strong></p><p>使得 class 标签不绝对，提升分类器效果。</p><p><strong>CIoU Loss</strong></p><p>直接以 IoU 作为 regression 的损失函数，提高了回归精度。从 IoU -&gt; GIoU -&gt; DIoU -&gt; CIoU 的变化过程，见 <a href="https://tangh.github.io/articles/improvements-of-regressor-in-detector/#Generalized-Intersection-over-Union-A-Metric-and-A-Loss-for-Bounding-Box-Regression-CVPR-2019">另一篇关于 regressor 的文中 IoU Loss 的部分</a>。</p><h2 id="Bag-of-specials"><a href="#Bag-of-specials" class="headerlink" title="Bag of specials"></a>Bag of specials</h2><p><strong>Multi-input weighted residual connections (MiWRC)、Path-aggregation block (PAN)</strong></p><p>前者为带权重的特征融合方式，后者为 neck 上的新的特征融合路径。见 <a href="https://tangh.github.io/articles/efficientnet-and-efficientdet/#Neck-BiFPN">另一篇关于 EfficientDet 文中 BiFPN 的部分</a>。</p><p><strong>DIoU-NMS</strong></p><p>在 NMS 时考虑两个 box 中心点之间的距离以稍微降低其 IoU 值的方法，见 <a href="https://tangh.github.io/articles/improvements-of-regressor-in-detector/#Distance-IoU-and-Complete-IoU">另一篇关于 regressor 的文中 DIoU 的部分</a>。</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>deep learning 吴恩达笔记(1)</title>
      <link href="2021/01/30/deep-learning-wu-en-da-bi-ji-1/"/>
      <url>2021/01/30/deep-learning-wu-en-da-bi-ji-1/</url>
      
        <content type="html"><![CDATA[<h1 id="局部最优的问题-The-problem-of-local-optima"><a href="#局部最优的问题-The-problem-of-local-optima" class="headerlink" title="局部最优的问题(The problem of local optima)"></a><a href="https://www.cnblogs.com/xiaojianliu/articles/9661503.html">局部最优的问题(The problem of local optima)</a></h1><p>人们总是担心优化算法会困在极差的局部最优， 不过随着深度学习理论不断发展，我们对局部最优的理解也发生了改变。</p><p><a href="https://img2018.cnblogs.com/blog/1150378/201809/1150378-20180917125539907-1508355070.jpg"><img src="https://img2018.cnblogs.com/blog/1150378/201809/1150378-20180917125539907-1508355070.jpg" alt="img"></a></p><p>这是曾经人们在想到局部最优时脑海里会出现的图，也许你想优化一些参数，我们把它们称之为W1W1和W2W2，平面的高度就是损失函数。在图中似乎各处都分布着局部最优。梯度下降法或者某个算法可能困在一个局部最优中，而不会抵达全局最优。如果你要作图计算一个数字，比如说这两个维度，就容易出现有多个不同局部最优的图，而这些低维的图曾经影响了我们的理解，但是这些理解并不正确。事实上，如果你要创建一个神经网络，通常梯度为零的点并不是这个图中的局部最优点，实际上成本函数的零梯度点，通常是鞍点。</p><p><a href="https://img2018.cnblogs.com/blog/1150378/201809/1150378-20180917125603916-1151714447.jpg"><img src="https://img2018.cnblogs.com/blog/1150378/201809/1150378-20180917125603916-1151714447.jpg" alt="img"></a></p><p>但是一个具有高维度空间的函数，如果梯度为 0，那么在每个方向，它可能是凸函数，也可能是凹函数。如果你在 2 万维空间中，那么想要得到局部最优，所有的 2 万个方向都需要是这样，但发生的机率也许很小，也许是2−200002−20000，你更有可能遇到有些方向的曲线会这样向上弯曲，另一些方向曲线向下弯，而不是所有的都向上弯曲，因此在高维度空间，你更可能碰到鞍点，而不会碰到局部最优。</p><p><a href="https://img2018.cnblogs.com/blog/1150378/201809/1150378-20180917125625393-299506684.jpg"><img src="https://img2018.cnblogs.com/blog/1150378/201809/1150378-20180917125625393-299506684.jpg" alt="img"></a></p><p>由上图我们可以分析是平稳段会减缓学习，平稳段是一块区域，其中导数长时间接近于 0，如果你在此处，梯度会从曲面从从上向下下降，因为梯度等于或接近 0，曲面很平坦，你得花上很长时间慢慢抵达平稳段的这个点。</p><p><a href="https://img2018.cnblogs.com/blog/1150378/201809/1150378-20180917125657081-613195483.jpg"><img src="https://img2018.cnblogs.com/blog/1150378/201809/1150378-20180917125657081-613195483.jpg" alt="img"></a></p><p>总结：</p><p>你不太可能困在极差的局部最优中，条件是你在训练较大的神经网络，存在大量参数， 并且成本函数J被定义在较高的维度空间。</p><p>平稳段是一个问题，这样使得学习十分缓慢，这也是像 Momentum 或是RMSprop， Adam 这样的算法，能够加速学习算法的地方。在这些情况下，更成熟的优化算法，如 Adam 算法，能够加快速度，让你尽早往下走出平稳段。</p><h1 id="你的模型真的陷入局部最优点了吗"><a href="#你的模型真的陷入局部最优点了吗" class="headerlink" title="你的模型真的陷入局部最优点了吗?"></a><a href="https://www.jiqizhixin.com/articles/2018-07-29-6">你的模型真的陷入局部最优点了吗?</a></h1><p><img src="https://image.jiqizhixin.com/uploads/editor/99580556-4bf1-47fc-87b7-05e798d48812/1532842884131.png" alt="img"></p><p>小夕曾经收到过一个提问：“小夕，我的模型总是在前几次迭代后很快收敛了，陷入到了一个局部最优点，怎么也跳不出来，怎么办？”</p><p><strong>本文不是单纯对这个问题的回答，不是罗列工程tricks，而是希望从理论层面上对产生类似疑问的人有所启发。</strong></p><p><img src="https://image.jiqizhixin.com/uploads/editor/eb993f95-7a0c-4835-b25e-3ce8ed42a641/1532842884171.png" alt="img"></p><p><strong>真的结束于最优点吗？</strong></p><p>我们知道，在局部最优点附近，各个维度的导数都接近0，而我们训练模型最常用的梯度下降法又是基于导数与步长的乘积去更新模型参数的，因此一旦陷入了局部最优点，就像掉进了一口井，你是无法直着跳出去的，你只有连续不间断的依托四周的井壁努力向上爬才有可能爬出去。更何况梯度下降法的每一步对梯度正确的估计都在试图让你坠入井底，因此势必要对梯度“估计错很多次”才可能侥幸逃出去。那么从数学上看，什么才是局部最优点呢？</p><p>这个问题看似很白痴，很多人会说“局部最优点不就是在loss曲面上某个一阶导数为0的点嘛”。这就不准确啦，比如下面这个马鞍形状的中间的那个点：</p><p><img src="https://image.jiqizhixin.com/uploads/editor/8f60e74c-a671-415b-a58c-b17bfef217e2/1532842884855.png" alt="img"></p><p>（图片来自《deep learning》）</p><p>显然这个点也是（一阶）导数为0，但是肯定不是最优点。事实上，这个点就是我们常说的<strong>鞍点</strong>。</p><p>显然，只用一阶导数是难以区分最优点和鞍点的。</p><p>我们想一下，最优点和鞍点的区别不就在于其在各个维度是否都是最低点嘛～只要某个一阶导数为0的点在某个维度上是最高点而不是最低点，那它就是鞍点。而区分最高点和最低点当然就是用二阶导数（斜率从负变正的过程当然就是“下凸”，即斜率的导数大于0，即二阶导数大于0。反之则为“上凹”，二阶导数小于0）。也就是说，<strong>若某个一阶导数为0的点在至少一个方向上的二阶导数小于0，那它就是鞍点啦</strong>。</p><p>那么二阶导数大于0和小于0的概率各是多少呢？由于我们并没有先验知识，因此按照最大熵原理，我们认为二阶导数大于和小于0的概率均为0.5！</p><p>那么对于一个有n个参数的机器学习/深度学习模型，“loss曲面”即位于n+1维空间（loss值为纵轴，n个参数为n个横轴）。在这个空间里，如果我们通过梯度下降法一路下滑终于滑到了一个各方向导数均为0的点，那么它为局部最优点的概率即<img src="https://image.jiqizhixin.com/uploads/editor/cec6cf06-ebc1-4b57-a7c6-4579aea38244/1532842884276.png" alt="0.5^n">，为鞍点的概率为<img src="https://image.jiqizhixin.com/uploads/editor/5efc102a-849b-40be-98c5-33ef18fc9af3/1532842884389.png" alt="1-0.5^n">，显然，<strong>当模型参数稍微一多，即n稍微一大，就会发现这个点为鞍点的概率会远大于局部最优点！</strong></p><p>好吧我再啰嗦的举个栗子，已经反应过来的同学可以跳过这个栗子：</p><p>假设我们的模型有100个参数（实际深度学习模型中一般会远大于100），那么某一阶导数为0的点为局部最优点的概率为约为<img src="https://image.jiqizhixin.com/uploads/editor/19b182e1-6b88-412f-a65f-ae824a0d077e/1532842884316.png" alt="0.5^{100}\approx10^{-31}">，而为鞍点的概率则为<img src="https://image.jiqizhixin.com/uploads/editor/1df55829-de66-40fb-b0d9-f62821a8c7e5/1532842884427.png" alt="1.0-10^{-31}\approx 1.0">。就算我们的模型在训练时使用了特别厉害的“超级梯度下降法”，它可以每走一步都恰好踩在一个一阶导数为0的点上，那么从数学期望上来看，我们需要走<img src="https://image.jiqizhixin.com/uploads/editor/385683fd-69a5-4b7b-9765-ed00a88987e3/1532842884947.png" alt="10^{31}">步才行。而实际的projects中，哪怕数据集规模为千万级，我们分了100万个batches，然后要迭代100次，那也仅仅是走了<img src="https://image.jiqizhixin.com/uploads/editor/ccbe52f5-4915-4771-8c40-5b98c2ce0e47/1532842885029.png" alt="10^6*10^2=10^8">步，你真的觉得运气可以辣么好的走到局部最优点上去吗？所以实际中，当我们的深度学习模型收敛时，几乎没有必要认为它收敛到了一个局部最优点，这完全等同于杞人忧天。</p><p><strong>也就是说，如果最后模型确实在梯度下降法的指引下收敛到了一个导数为0的点，那这个点几乎可以肯定就是一个鞍点。</strong></p><p><img src="https://image.jiqizhixin.com/uploads/editor/2c6708b4-cd9a-474f-8251-a77a95b94548/1532842884087.png" alt="img"></p><p><strong>如果我们的模型真的收敛到鞍点上了，会很可怕吗？</strong></p><p>这就又回到了文章开头的那副马鞍状的图。</p><p>显然，站在马鞍中央的时候，虽然很难翻过两边的山坡，<strong>但是往前或者往后随便走一步就能摔下马鞍！</strong>而在文章<a href="http://mp.weixin.qq.com/s?__biz=MzIwNzc2NTk0NQ==&amp;mid=2247484570&amp;idx=1&amp;sn=4c0b6b76a7f2518d77818535b677e087&amp;chksm=970c2c4ca07ba55ad5cfe6b46f72dbef85a159574fb60b9932404e45747c95eed8c6c0f66d62&amp;scene=21#wechat_redirect">《batch size》</a>中小夕讲过，我们默认使用的mini-batch梯度下降法本身就是有噪声的梯度估计，哪怕我们位于梯度为0的点，也经常在某个mini-batch下的估计把它估计偏了，导致往前或者往后挪了一步摔下马鞍，<strong>也就是mini-batch的梯度下降法使得模型很容易逃离特征空间中的鞍点。</strong></p><p><img src="https://image.jiqizhixin.com/uploads/editor/4f5b1a12-0217-4257-9061-7502f7c0c830/1532842884214.png" alt="img"></p><p>那么问题来了，既然局部最优点很难踩到，鞍点也很容易逃离出去，<strong>那么为什么我们的模型看起来是收敛了呢？</strong></p><p>初学者可能会说 “诶诶，会不会是学习率太大了，导致在“鞍点”附近震荡？” 首先，鞍点不像最优点那样容易震荡，而且哪怕你不断的减小学习率继续让模型收敛，你这时计算output层或者后几层的梯度向量的长度时会发现它依然离0很遥远！（这句话是有实验支撑的，不过那篇论文我找不到惹，也忘了名字了。热心的观众帮忙补充一下哦）</p><p>难道，踩到的鞍点太多，最后恰好收敛到一个跳不下去的鞍点身上了？</p><p>虽然高维空间中的鞍点数量远远大于最优点，但是鞍点的数量在整个空间中又是微不足道的：按前面的假设，假设在某个维度上随机一跳有10%的概率踩到导数为0的点，那么我们在101维的空间中的一步恰好踩到这个点上的概率为<img src="https://image.jiqizhixin.com/uploads/editor/635d4d60-9479-4364-b86d-6b9265478f76/1532842885065.png" alt="10^{-100}">，也就是说在101维空间里随机乱跳的时候，有<img src="https://image.jiqizhixin.com/uploads/editor/65d2f248-116e-4860-b5d1-da96e4723e86/1532842885102.png" alt="10^{-100}">的可能性踩到鞍点身上。因此，即使有难以逃离的鞍点，那么被我们正好踩到的概率也是非常小的。</p><p>所以更令人信服的是，在高维空间里（深度学习问题上）真正可怕的不是局部最优也不是鞍点问题，而是一些特殊地形。比如大面积的平坦区域：</p><p><img src="https://image.jiqizhixin.com/uploads/editor/16251ae1-203b-40cf-ac0a-9fe228970250/1532842885392.png" alt="img"></p><p>（图片来自《deep learning》）</p><p>在平坦区域，虽然导数不为0但是却不大。虽然是在不断下降但是路程却非常长。对于优化算法来说，它需要走很多很多步才有可能走过这一片平坦区域。甚至在这段地形的二阶导数过于特殊的情况下，一阶优化算法走无穷多步也走不出去（设想一下，如果终点在一米外，但是你第一次走0.5米，后续每一步都是前一步的一半长度，那么你永远也走不到面前的一米终点处）。</p><p>所以相比于栽到最优点和鞍点上，优化算法更有可能载到这种类似平坦区的地形中（如果这个平坦区又是“高原地带”，即loss值很高的地带，那么恭喜你悲剧了）。更糟糕的是，由于高维地形难以可视化，还有很多更复杂的未知地形会导致假收敛，<strong>一旦陷入到这些危险地形中，几乎是无解的。</strong></p><p><strong>所以说，在深度学习中，与其担忧模型陷入局部最优点怎么跳出来，更不如去好好考虑：</strong></p><ol><li>如何去设计一个尽量没有“平坦区”等危险地形的loss空间，即着手于loss函数的设计以及深度学习模型的设计；</li><li>尽量让模型的初始化点远离空间中的危险地带，让最优化游戏开始于简单模式，即着手于模型参数的初始化策略；</li><li>让最优化过程更智能一点，该加速冲时加速冲，该大胆跳跃时就大胆跳，该慢慢踱步时慢慢走，对危险地形有一定的判断力，如梯度截断策略；</li><li>开外挂，本来下一步要走向死亡的，结果被外挂给拽回了安全区，如batch normalization策略等。</li></ol>]]></content>
      
      
      
        <tags>
            
            <tag> 吴恩达 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Task5 作者信息关联</title>
      <link href="2021/01/25/task5-zuo-zhe-xin-xi-guan-lian/"/>
      <url>2021/01/25/task5-zuo-zhe-xin-xi-guan-lian/</url>
      
        <content type="html"><![CDATA[<h2 id="任务说明"><a href="#任务说明" class="headerlink" title="任务说明"></a>任务说明</h2><ul><li>学习主题：作者关联（数据建模任务），对论文作者关系进行建模，统计最常出现的作者关系；</li><li>学习内容：构建作者关系图，挖掘作者关系</li><li>学习成果：论文作者知识图谱、图关系挖掘</li></ul><h2 id="数据处理步骤"><a href="#数据处理步骤" class="headerlink" title="数据处理步骤"></a>数据处理步骤</h2><p>将作者列表进行处理，并完成统计。具体步骤如下：</p><ul><li>将论文第一作者与其他作者（论文非第一作者）构建图；</li><li>使用图算法统计图中作者与其他作者的联系；</li></ul><h2 id="社交网络分析"><a href="#社交网络分析" class="headerlink" title="社交网络分析"></a>社交网络分析</h2><p>图是复杂网络研究中的一个重要概念。Graph是用<strong>点</strong>和<strong>线</strong>来刻画离散事物集合中的每对事物间以某种方式相联系的数学模型。Graph在现实世界中随处可见，如交通运输图、旅游图、流程图等。利用图可以描述现实生活中的许多事物，如用点可以表示交叉口，点之间的连线表示路径，这样就可以轻而易举的描绘出一个交通运输网络。</p><h3 id="图类型"><a href="#图类型" class="headerlink" title="图类型"></a>图类型</h3><ul><li><p>无向图，忽略了两节点间边的方向。</p></li><li><p>指有向图，考虑了边的有向性。</p></li><li><p>多重无向图，即两个结点之间的边数多于一条，又允许顶点通过同一条边和自己关联。</p></li></ul><h3 id="图统计指标"><a href="#图统计指标" class="headerlink" title="图统计指标"></a>图统计指标</h3><ul><li><p>度：是指和该节点相关联的边的条数，又称关联度。对于有向图，节点的入度 是指进入该节点的边的条数；节点的出度是指从该节点出发的边的条数；</p></li><li><p>迪杰斯特拉路径：.从一个源点到其它各点的最短路径，可使用迪杰斯特拉算法来求最短路径；</p></li><li><p>连通图：在一个无向图 G 中，若从顶点i到顶点j有路径相连，则称i和j是连通的。如果 G 是有向图，那么连接i和j的路径中所有的边都必须同向。如果图中任意两点都是连通的，那么图被称作连通图。如果此图是有向图，则称为强连通图。</p></li></ul><p>对于其他图算法，可以在networkx和igraph两个库中找到。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> seaborn <span class="token keyword">as</span> sns<span class="token keyword">from</span> bs4 <span class="token keyword">import</span> BeautifulSoup<span class="token keyword">import</span> re<span class="token keyword">import</span> requests<span class="token keyword">import</span> json<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">readArxivFile</span><span class="token punctuation">(</span>path<span class="token punctuation">,</span> columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">,</span> <span class="token string">'submitter'</span><span class="token punctuation">,</span> <span class="token string">'authors'</span><span class="token punctuation">,</span> <span class="token string">'title'</span><span class="token punctuation">,</span> <span class="token string">'comments'</span><span class="token punctuation">,</span> <span class="token string">'journal-ref'</span><span class="token punctuation">,</span> <span class="token string">'doi'</span><span class="token punctuation">,</span>       <span class="token string">'report-no'</span><span class="token punctuation">,</span> <span class="token string">'categories'</span><span class="token punctuation">,</span> <span class="token string">'license'</span><span class="token punctuation">,</span> <span class="token string">'abstract'</span><span class="token punctuation">,</span> <span class="token string">'versions'</span><span class="token punctuation">,</span>       <span class="token string">'update_date'</span><span class="token punctuation">,</span> <span class="token string">'authors_parsed'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> count<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">'''    定义读取文件的函数        path: 文件路径        columns: 需要选择的列        count: 读取行数    '''</span>        data  <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>path<span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>         <span class="token keyword">for</span> idx<span class="token punctuation">,</span> line <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>f<span class="token punctuation">)</span><span class="token punctuation">:</span>             <span class="token keyword">if</span> idx <span class="token operator">==</span> count<span class="token punctuation">:</span>                <span class="token keyword">break</span>                            d <span class="token operator">=</span> json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>line<span class="token punctuation">)</span>            d <span class="token operator">=</span> <span class="token punctuation">{</span>col <span class="token punctuation">:</span> d<span class="token punctuation">[</span>col<span class="token punctuation">]</span> <span class="token keyword">for</span> col <span class="token keyword">in</span> columns<span class="token punctuation">}</span>            data<span class="token punctuation">.</span>append<span class="token punctuation">(</span>d<span class="token punctuation">)</span>    data <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>data<span class="token punctuation">)</span>    <span class="token keyword">return</span> datadata <span class="token operator">=</span> readArxivFile<span class="token punctuation">(</span><span class="token string">'../data/arxiv-metadata-oai-snapshot.json'</span><span class="token punctuation">,</span>                      <span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">,</span> <span class="token string">'authors_parsed'</span><span class="token punctuation">]</span>                    <span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">data<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }    .dataframe tbody tr th {        vertical-align: top;    }    .dataframe thead th {        text-align: right;    }</style><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>id</th>      <th>authors_parsed</th>    </tr>  </thead>  <tbody>    <tr>      <th>0</th>      <td>0704.0001</td>      <td>[[Balázs, C., ], [Berger, E. L., ], [Nadolsky,...</td>    </tr>    <tr>      <th>1</th>      <td>0704.0002</td>      <td>[[Streinu, Ileana, ], [Theran, Louis, ]]</td>    </tr>    <tr>      <th>2</th>      <td>0704.0003</td>      <td>[[Pan, Hongjun, ]]</td>    </tr>    <tr>      <th>3</th>      <td>0704.0004</td>      <td>[[Callan, David, ]]</td>    </tr>    <tr>      <th>4</th>      <td>0704.0005</td>      <td>[[Abu-Shammala, Wael, ], [Torchinsky, Alberto, ]]</td>    </tr>  </tbody></table></div><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token builtin">len</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token number">1796911</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> networkx <span class="token keyword">as</span> nxG <span class="token operator">=</span> nx<span class="token punctuation">.</span>Graph<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">for</span> row <span class="token keyword">in</span> data<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">.</span>itertuples<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token comment">#     print(row)</span>    authors <span class="token operator">=</span> row<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span>    authors <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">' '</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">for</span> x <span class="token keyword">in</span> authors<span class="token punctuation">]</span>        <span class="token keyword">for</span> author <span class="token keyword">in</span> authors<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">:</span>        G<span class="token punctuation">.</span>add_edge<span class="token punctuation">(</span>authors<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> author<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">authors<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token punctuation">[</span><span class="token string">'Ovchinnikov Sergei'</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">nx<span class="token punctuation">.</span>draw<span class="token punctuation">(</span>G<span class="token punctuation">,</span> with_labels<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/2021/01/25/task5-zuo-zhe-xin-xi-guan-lian/output_11_0.png" alt="png"></p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">try</span><span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>nx<span class="token punctuation">.</span>dijkstra_path<span class="token punctuation">(</span>G<span class="token punctuation">,</span> <span class="token string">'Balázs C.'</span><span class="token punctuation">,</span> <span class="token string">'Ziambaras Eleni'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">except</span><span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'No path'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">No path<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">degree_sequence <span class="token operator">=</span> <span class="token builtin">sorted</span><span class="token punctuation">(</span><span class="token punctuation">[</span>d <span class="token keyword">for</span> n<span class="token punctuation">,</span> d <span class="token keyword">in</span> G<span class="token punctuation">.</span>degree<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> reverse<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>dmax <span class="token operator">=</span> <span class="token builtin">max</span><span class="token punctuation">(</span>degree_sequence<span class="token punctuation">)</span>plt<span class="token punctuation">.</span>loglog<span class="token punctuation">(</span>degree_sequence<span class="token punctuation">,</span> <span class="token string">"b-"</span><span class="token punctuation">,</span> marker<span class="token operator">=</span><span class="token string">"o"</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span><span class="token string">"Degree rank plot"</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">"degree"</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">"rank"</span><span class="token punctuation">)</span><span class="token comment"># draw graph in inset</span>plt<span class="token punctuation">.</span>axes<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0.45</span><span class="token punctuation">,</span> <span class="token number">0.45</span><span class="token punctuation">,</span> <span class="token number">0.45</span><span class="token punctuation">,</span> <span class="token number">0.45</span><span class="token punctuation">]</span><span class="token punctuation">)</span>Gcc <span class="token operator">=</span> G<span class="token punctuation">.</span>subgraph<span class="token punctuation">(</span><span class="token builtin">sorted</span><span class="token punctuation">(</span>nx<span class="token punctuation">.</span>connected_components<span class="token punctuation">(</span>G<span class="token punctuation">)</span><span class="token punctuation">,</span> key<span class="token operator">=</span><span class="token builtin">len</span><span class="token punctuation">,</span> reverse<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>pos <span class="token operator">=</span> nx<span class="token punctuation">.</span>spring_layout<span class="token punctuation">(</span>Gcc<span class="token punctuation">)</span>plt<span class="token punctuation">.</span>axis<span class="token punctuation">(</span><span class="token string">"off"</span><span class="token punctuation">)</span>nx<span class="token punctuation">.</span>draw_networkx_nodes<span class="token punctuation">(</span>Gcc<span class="token punctuation">,</span> pos<span class="token punctuation">,</span> node_size<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">)</span>nx<span class="token punctuation">.</span>draw_networkx_edges<span class="token punctuation">(</span>Gcc<span class="token punctuation">,</span> pos<span class="token punctuation">,</span> alpha<span class="token operator">=</span><span class="token number">0.4</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="/2021/01/25/task5-zuo-zhe-xin-xi-guan-lian/output_13_0.png" alt="png"></p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>]]></content>
      
      
      
        <tags>
            
            <tag> DataWhale </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>How to add your Conda environment to your jupyter notebook in just 4 steps</title>
      <link href="2021/01/23/how-to-add-your-conda-environment-to-your-jupyter-notebook-in-just-4-steps/"/>
      <url>2021/01/23/how-to-add-your-conda-environment-to-your-jupyter-notebook-in-just-4-steps/</url>
      
        <content type="html"><![CDATA[<p>In this article I am going to detail the steps, to add the Conda environment to your Jupyter notebook.</p><p><strong>Step 1:</strong> Create a Conda environment.</p><pre class="line-numbers language-none"><code class="language-none">conda create --name firstEnv<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>once you have created the environment you will see,</p><p><img src="https://miro.medium.com/max/1855/1*-XO11EGam-liFNEg1-QUww.png" alt="Image for post"></p><p>output after you create your environment.</p><p><strong>Step 2:</strong> Activate the environment using the command as shown in the console. After you activate it, you can install any package you need in this environment.</p><p>For example, I am going to install Tensorflow in this environment. The command to do so,</p><pre class="line-numbers language-none"><code class="language-none">conda install -c conda-forge tensorflow<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="https://miro.medium.com/max/4665/1*4LMpbqJUfcf1Vdf6Cc6vTQ.png" alt="Image for post"></p><p><strong>Step 3:</strong> Now you have successfully installed Tensorflow. Congratulations!!</p><p>Now comes the step to set this conda environment on your jupyter notebook, to do so please install ipykernel.</p><pre class="line-numbers language-none"><code class="language-none">conda install -c anaconda ipykernel<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>After installing this,</p><p>just type,</p><pre class="line-numbers language-none"><code class="language-none">python -m ipykernel install --user --name=firstEnv<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>Using the above command, I will now have this conda environment in my Jupyter notebook.</p><p><img src="https://miro.medium.com/max/4688/1*cmfzg482hlu5U6Q34VzrjQ.png" alt="Image for post"></p><p><strong>Step 4:</strong> Just check your Jupyter Notebook, to see the shining firstEnv.</p><p><img src="https://miro.medium.com/max/60/1*QpkEdJSnvDDhIWRIxGMr5A.png?q=20" alt="Image for post"></p><p><img src="https://miro.medium.com/max/4688/1*QpkEdJSnvDDhIWRIxGMr5A.png" alt="Image for post"></p><p>Yayy!! Happy coding :)</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Task4 论文种类分类</title>
      <link href="2021/01/22/task4-lun-wen-chong-lei-fen-lei/"/>
      <url>2021/01/22/task4-lun-wen-chong-lei-fen-lei/</url>
      
        <content type="html"><![CDATA[<h2 id="任务说明"><a href="#任务说明" class="headerlink" title="任务说明"></a>任务说明</h2><ul><li>学习主题：论文分类（数据建模任务），利用已有数据建模，对新论文进行类别分类；</li><li>学习内容：使用论文标题完成类别分类；</li><li>学习成果：学会文本分类的基本方法、<code>TF-IDF</code>等；</li></ul><h2 id="数据处理步骤"><a href="#数据处理步骤" class="headerlink" title="数据处理步骤"></a>数据处理步骤</h2><p>在原始arxiv论文中论文都有对应的类别，而论文类别是作者填写的。在本次任务中我们可以借助论文的标题和摘要完成：</p><ul><li>对论文标题和摘要进行处理；</li><li>对论文类别进行处理；</li><li>构建文本分类模型；</li></ul><h2 id="文本分类思路"><a href="#文本分类思路" class="headerlink" title="文本分类思路"></a>文本分类思路</h2><ul><li>思路1：TF-IDF+机器学习分类器</li></ul><p>直接使用TF-IDF对文本提取特征，使用分类器进行分类，分类器的选择上可以使用SVM、LR、XGboost等</p><ul><li>思路2：FastText</li></ul><p>FastText是入门款的词向量，利用Facebook提供的FastText工具，可以快速构建分类器</p><ul><li>思路3：WordVec+深度学习分类器</li></ul><p>WordVec是进阶款的词向量，并通过构建深度学习分类完成分类。深度学习分类的网络结构可以选择TextCNN、TextRnn或者BiLSTM。</p><ul><li>思路4：Bert词向量</li></ul><p>Bert是高配款的词向量，具有强大的建模学习能力。</p><h2 id="具体代码实现以及讲解"><a href="#具体代码实现以及讲解" class="headerlink" title="具体代码实现以及讲解"></a>具体代码实现以及讲解</h2><p>为了方便大家入门文本分类，我们选择思路1和思路2给大家讲解。首先完成字段读取：</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 导入所需的package</span><span class="token keyword">import</span> seaborn <span class="token keyword">as</span> sns <span class="token comment">#用于画图</span><span class="token keyword">from</span> bs4 <span class="token keyword">import</span> BeautifulSoup <span class="token comment">#用于爬取arxiv的数据</span><span class="token keyword">import</span> re <span class="token comment">#用于正则表达式，匹配字符串的模式</span><span class="token keyword">import</span> requests <span class="token comment">#用于网络连接，发送网络请求，使用域名获取对应信息</span><span class="token keyword">import</span> json <span class="token comment">#读取数据，我们的数据为json格式的</span><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd <span class="token comment">#数据处理，数据分析</span><span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt <span class="token comment">#画图工具</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">readArxivFile</span><span class="token punctuation">(</span>path<span class="token punctuation">,</span> columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">,</span> <span class="token string">'submitter'</span><span class="token punctuation">,</span> <span class="token string">'authors'</span><span class="token punctuation">,</span> <span class="token string">'title'</span><span class="token punctuation">,</span> <span class="token string">'comments'</span><span class="token punctuation">,</span> <span class="token string">'journal-ref'</span><span class="token punctuation">,</span> <span class="token string">'doi'</span><span class="token punctuation">,</span>       <span class="token string">'report-no'</span><span class="token punctuation">,</span> <span class="token string">'categories'</span><span class="token punctuation">,</span> <span class="token string">'license'</span><span class="token punctuation">,</span> <span class="token string">'abstract'</span><span class="token punctuation">,</span> <span class="token string">'versions'</span><span class="token punctuation">,</span>       <span class="token string">'update_date'</span><span class="token punctuation">,</span> <span class="token string">'authors_parsed'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> count<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">'''    定义读取文件的函数        path: 文件路径        columns: 需要选择的列        count: 读取行数    '''</span>        data  <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>path<span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>         <span class="token keyword">for</span> idx<span class="token punctuation">,</span> line <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>f<span class="token punctuation">)</span><span class="token punctuation">:</span>             <span class="token keyword">if</span> idx <span class="token operator">==</span> count<span class="token punctuation">:</span>                <span class="token keyword">break</span>                            d <span class="token operator">=</span> json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>line<span class="token punctuation">)</span>            d <span class="token operator">=</span> <span class="token punctuation">{</span>col <span class="token punctuation">:</span> d<span class="token punctuation">[</span>col<span class="token punctuation">]</span> <span class="token keyword">for</span> col <span class="token keyword">in</span> columns<span class="token punctuation">}</span>            data<span class="token punctuation">.</span>append<span class="token punctuation">(</span>d<span class="token punctuation">)</span>    data <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>data<span class="token punctuation">)</span>    <span class="token keyword">return</span> datadata <span class="token operator">=</span> readArxivFile<span class="token punctuation">(</span><span class="token string">'../data/arxiv-metadata-oai-snapshot.json'</span><span class="token punctuation">,</span>                      <span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">,</span> <span class="token string">'title'</span><span class="token punctuation">,</span> <span class="token string">'categories'</span><span class="token punctuation">,</span> <span class="token string">'abstract'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>                    <span class="token number">200000</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>为了方便数据的处理，我们可以将标题和摘要拼接一起完成分类。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">data<span class="token punctuation">[</span><span class="token string">'text'</span><span class="token punctuation">]</span> <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token string">'title'</span><span class="token punctuation">]</span> <span class="token operator">+</span> data<span class="token punctuation">[</span><span class="token string">'abstract'</span><span class="token punctuation">]</span>data<span class="token punctuation">[</span><span class="token string">'text'</span><span class="token punctuation">]</span> <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token string">'text'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> x<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'\n'</span><span class="token punctuation">,</span><span class="token string">' '</span><span class="token punctuation">)</span><span class="token punctuation">)</span>data<span class="token punctuation">[</span><span class="token string">'text'</span><span class="token punctuation">]</span> <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token string">'text'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> x<span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>data <span class="token operator">=</span> data<span class="token punctuation">.</span>drop<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'abstract'</span><span class="token punctuation">,</span> <span class="token string">'title'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>由于原始论文有可能有多个类别，所以也需要处理：</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 多个类别，包含子分类</span>data<span class="token punctuation">[</span><span class="token string">'categories'</span><span class="token punctuation">]</span> <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token string">'categories'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x <span class="token punctuation">:</span> x<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">' '</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># 单个类别，不包含子分类</span>data<span class="token punctuation">[</span><span class="token string">'categories_big'</span><span class="token punctuation">]</span> <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token string">'categories'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x <span class="token punctuation">:</span> <span class="token punctuation">[</span>xx<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'.'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token keyword">for</span> xx <span class="token keyword">in</span> x<span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>然后将类别进行编码，这里类别是多个，所以需要多编码：</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>preprocessing <span class="token keyword">import</span> MultiLabelBinarizermlb <span class="token operator">=</span> MultiLabelBinarizer<span class="token punctuation">(</span><span class="token punctuation">)</span>data_label <span class="token operator">=</span> mlb<span class="token punctuation">.</span>fit_transform<span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token string">'categories_big'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h3 id="思路1"><a href="#思路1" class="headerlink" title="思路1"></a>思路1</h3><p>思路1使用TFIDF提取特征，限制最多4000个单词：</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>feature_extraction<span class="token punctuation">.</span>text <span class="token keyword">import</span> TfidfVectorizervectorizer <span class="token operator">=</span> TfidfVectorizer<span class="token punctuation">(</span>max_features<span class="token operator">=</span><span class="token number">4000</span><span class="token punctuation">)</span>data_tfidf <span class="token operator">=</span> vectorizer<span class="token punctuation">.</span>fit_transform<span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token string">'text'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>由于这里是多标签分类，可以使用sklearn的多标签分类进行封装：</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 划分训练集和验证集</span><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>model_selection <span class="token keyword">import</span> train_test_splitx_train<span class="token punctuation">,</span> x_test<span class="token punctuation">,</span> y_train<span class="token punctuation">,</span> y_test <span class="token operator">=</span> train_test_split<span class="token punctuation">(</span>data_tfidf<span class="token punctuation">,</span> data_label<span class="token punctuation">,</span>                                                 test_size <span class="token operator">=</span> <span class="token number">0.2</span><span class="token punctuation">,</span>random_state <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token comment"># 构建多标签分类模型</span><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>multioutput <span class="token keyword">import</span> MultiOutputClassifier<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>naive_bayes <span class="token keyword">import</span> MultinomialNBclf <span class="token operator">=</span> MultiOutputClassifier<span class="token punctuation">(</span>MultinomialNB<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>fit<span class="token punctuation">(</span>x_train<span class="token punctuation">,</span> y_train<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>metrics <span class="token keyword">import</span> classification_report<span class="token keyword">print</span><span class="token punctuation">(</span>classification_report<span class="token punctuation">(</span>y_test<span class="token punctuation">,</span> clf<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>x_test<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">              precision    recall  f1<span class="token operator">-</span>score   support           <span class="token number">0</span>       <span class="token number">0.95</span>      <span class="token number">0.85</span>      <span class="token number">0.89</span>      <span class="token number">7925</span>           <span class="token number">1</span>       <span class="token number">0.85</span>      <span class="token number">0.79</span>      <span class="token number">0.82</span>      <span class="token number">7339</span>           <span class="token number">2</span>       <span class="token number">0.77</span>      <span class="token number">0.72</span>      <span class="token number">0.74</span>      <span class="token number">2944</span>           <span class="token number">3</span>       <span class="token number">0.00</span>      <span class="token number">0.00</span>      <span class="token number">0.00</span>         <span class="token number">4</span>           <span class="token number">4</span>       <span class="token number">0.72</span>      <span class="token number">0.48</span>      <span class="token number">0.58</span>      <span class="token number">2123</span>           <span class="token number">5</span>       <span class="token number">0.51</span>      <span class="token number">0.66</span>      <span class="token number">0.58</span>       <span class="token number">987</span>           <span class="token number">6</span>       <span class="token number">0.86</span>      <span class="token number">0.38</span>      <span class="token number">0.52</span>       <span class="token number">544</span>           <span class="token number">7</span>       <span class="token number">0.71</span>      <span class="token number">0.69</span>      <span class="token number">0.70</span>      <span class="token number">3649</span>           <span class="token number">8</span>       <span class="token number">0.76</span>      <span class="token number">0.61</span>      <span class="token number">0.68</span>      <span class="token number">3388</span>           <span class="token number">9</span>       <span class="token number">0.85</span>      <span class="token number">0.88</span>      <span class="token number">0.87</span>     <span class="token number">10745</span>          <span class="token number">10</span>       <span class="token number">0.46</span>      <span class="token number">0.13</span>      <span class="token number">0.20</span>      <span class="token number">1757</span>          <span class="token number">11</span>       <span class="token number">0.79</span>      <span class="token number">0.04</span>      <span class="token number">0.07</span>       <span class="token number">729</span>          <span class="token number">12</span>       <span class="token number">0.45</span>      <span class="token number">0.35</span>      <span class="token number">0.39</span>       <span class="token number">507</span>          <span class="token number">13</span>       <span class="token number">0.54</span>      <span class="token number">0.36</span>      <span class="token number">0.43</span>      <span class="token number">1083</span>          <span class="token number">14</span>       <span class="token number">0.69</span>      <span class="token number">0.14</span>      <span class="token number">0.24</span>      <span class="token number">3441</span>          <span class="token number">15</span>       <span class="token number">0.84</span>      <span class="token number">0.20</span>      <span class="token number">0.33</span>       <span class="token number">655</span>          <span class="token number">16</span>       <span class="token number">0.93</span>      <span class="token number">0.16</span>      <span class="token number">0.27</span>       <span class="token number">268</span>          <span class="token number">17</span>       <span class="token number">0.87</span>      <span class="token number">0.43</span>      <span class="token number">0.58</span>      <span class="token number">2484</span>          <span class="token number">18</span>       <span class="token number">0.82</span>      <span class="token number">0.38</span>      <span class="token number">0.52</span>       <span class="token number">692</span>   micro avg       <span class="token number">0.81</span>      <span class="token number">0.65</span>      <span class="token number">0.72</span>     <span class="token number">51264</span>   macro avg       <span class="token number">0.70</span>      <span class="token number">0.43</span>      <span class="token number">0.50</span>     <span class="token number">51264</span>weighted avg       <span class="token number">0.80</span>      <span class="token number">0.65</span>      <span class="token number">0.69</span>     <span class="token number">51264</span> samples avg       <span class="token number">0.72</span>      <span class="token number">0.72</span>      <span class="token number">0.70</span>     <span class="token number">51264</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="思路2"><a href="#思路2" class="headerlink" title="思路2"></a>思路2</h3><p>思路2使用深度学习模型，单词进行词嵌入然后训练。将数据集处理进行编码，并进行截断：</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>model_selection <span class="token keyword">import</span> train_test_splitx_train<span class="token punctuation">,</span> x_test<span class="token punctuation">,</span> y_train<span class="token punctuation">,</span> y_test <span class="token operator">=</span> train_test_split<span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token string">'text'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">100000</span><span class="token punctuation">]</span><span class="token punctuation">,</span>                                                     data_label<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">100000</span><span class="token punctuation">]</span><span class="token punctuation">,</span>                                                 test_size <span class="token operator">=</span> <span class="token number">0.95</span><span class="token punctuation">,</span>random_state <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># parameter</span>max_features<span class="token operator">=</span> <span class="token number">500</span>max_len<span class="token operator">=</span> <span class="token number">150</span>embed_size<span class="token operator">=</span><span class="token number">100</span>batch_size <span class="token operator">=</span> <span class="token number">128</span>epochs <span class="token operator">=</span> <span class="token number">5</span><span class="token keyword">from</span> keras<span class="token punctuation">.</span>preprocessing<span class="token punctuation">.</span>text <span class="token keyword">import</span> Tokenizer<span class="token keyword">from</span> keras<span class="token punctuation">.</span>preprocessing <span class="token keyword">import</span> sequencetokens <span class="token operator">=</span> Tokenizer<span class="token punctuation">(</span>num_words <span class="token operator">=</span> max_features<span class="token punctuation">)</span>tokens<span class="token punctuation">.</span>fit_on_texts<span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token string">'text'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">100000</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>y_train <span class="token operator">=</span> data_label<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">100000</span><span class="token punctuation">]</span>x_sub_train <span class="token operator">=</span> tokens<span class="token punctuation">.</span>texts_to_sequences<span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token string">'text'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">100000</span><span class="token punctuation">]</span><span class="token punctuation">)</span>x_sub_train <span class="token operator">=</span> sequence<span class="token punctuation">.</span>pad_sequences<span class="token punctuation">(</span>x_sub_train<span class="token punctuation">,</span> maxlen<span class="token operator">=</span>max_len<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>定义模型并完成训练：</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># LSTM model</span><span class="token comment"># Keras Layers:</span><span class="token keyword">from</span> keras<span class="token punctuation">.</span>layers <span class="token keyword">import</span> Dense<span class="token punctuation">,</span>Input<span class="token punctuation">,</span>LSTM<span class="token punctuation">,</span>Bidirectional<span class="token punctuation">,</span>Activation<span class="token punctuation">,</span>Conv1D<span class="token punctuation">,</span>GRU<span class="token keyword">from</span> keras<span class="token punctuation">.</span>layers <span class="token keyword">import</span> Dropout<span class="token punctuation">,</span>Embedding<span class="token punctuation">,</span>GlobalMaxPooling1D<span class="token punctuation">,</span> MaxPooling1D<span class="token punctuation">,</span> Add<span class="token punctuation">,</span> Flatten<span class="token keyword">from</span> keras<span class="token punctuation">.</span>layers <span class="token keyword">import</span> GlobalAveragePooling1D<span class="token punctuation">,</span> GlobalMaxPooling1D<span class="token punctuation">,</span> concatenate<span class="token punctuation">,</span> SpatialDropout1D<span class="token comment"># Keras Callback Functions:</span><span class="token keyword">from</span> keras<span class="token punctuation">.</span>callbacks <span class="token keyword">import</span> Callback<span class="token keyword">from</span> keras<span class="token punctuation">.</span>callbacks <span class="token keyword">import</span> EarlyStopping<span class="token punctuation">,</span>ModelCheckpoint<span class="token keyword">from</span> keras <span class="token keyword">import</span> initializers<span class="token punctuation">,</span> regularizers<span class="token punctuation">,</span> constraints<span class="token punctuation">,</span> optimizers<span class="token punctuation">,</span> layers<span class="token punctuation">,</span> callbacks<span class="token keyword">from</span> keras<span class="token punctuation">.</span>models <span class="token keyword">import</span> Model<span class="token keyword">from</span> keras<span class="token punctuation">.</span>optimizers <span class="token keyword">import</span> Adamsequence_input <span class="token operator">=</span> Input<span class="token punctuation">(</span>shape<span class="token operator">=</span><span class="token punctuation">(</span>max_len<span class="token punctuation">,</span> <span class="token punctuation">)</span><span class="token punctuation">)</span>x <span class="token operator">=</span> Embedding<span class="token punctuation">(</span>max_features<span class="token punctuation">,</span> embed_size<span class="token punctuation">,</span> trainable<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">(</span>sequence_input<span class="token punctuation">)</span>x <span class="token operator">=</span> SpatialDropout1D<span class="token punctuation">(</span><span class="token number">0.2</span><span class="token punctuation">)</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span>x <span class="token operator">=</span> Bidirectional<span class="token punctuation">(</span>GRU<span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">,</span> return_sequences<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>dropout<span class="token operator">=</span><span class="token number">0.1</span><span class="token punctuation">,</span>recurrent_dropout<span class="token operator">=</span><span class="token number">0.1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span>x <span class="token operator">=</span> Conv1D<span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">,</span> kernel_size <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">,</span> padding <span class="token operator">=</span> <span class="token string">"valid"</span><span class="token punctuation">,</span> kernel_initializer <span class="token operator">=</span> <span class="token string">"glorot_uniform"</span><span class="token punctuation">)</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span>avg_pool <span class="token operator">=</span> GlobalAveragePooling1D<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span>max_pool <span class="token operator">=</span> GlobalMaxPooling1D<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span>x <span class="token operator">=</span> concatenate<span class="token punctuation">(</span><span class="token punctuation">[</span>avg_pool<span class="token punctuation">,</span> max_pool<span class="token punctuation">]</span><span class="token punctuation">)</span> preds <span class="token operator">=</span> Dense<span class="token punctuation">(</span><span class="token number">19</span><span class="token punctuation">,</span> activation<span class="token operator">=</span><span class="token string">"sigmoid"</span><span class="token punctuation">)</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span>model <span class="token operator">=</span> Model<span class="token punctuation">(</span>sequence_input<span class="token punctuation">,</span> preds<span class="token punctuation">)</span>model<span class="token punctuation">.</span><span class="token builtin">compile</span><span class="token punctuation">(</span>loss<span class="token operator">=</span><span class="token string">'binary_crossentropy'</span><span class="token punctuation">,</span>optimizer<span class="token operator">=</span>Adam<span class="token punctuation">(</span>lr<span class="token operator">=</span><span class="token number">1e</span><span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span>metrics<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'accuracy'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>model<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>x_sub_train<span class="token punctuation">,</span> y_train<span class="token punctuation">,</span>           batch_size<span class="token operator">=</span>batch_size<span class="token punctuation">,</span>           validation_split<span class="token operator">=</span><span class="token number">0.2</span><span class="token punctuation">,</span>          epochs<span class="token operator">=</span>epochs<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">WARNING<span class="token punctuation">:</span>tensorflow<span class="token punctuation">:</span>Layer gru will <span class="token keyword">not</span> use cuDNN kernel since it doesn't meet the cuDNN kernel criteria<span class="token punctuation">.</span> It will use generic GPU kernel <span class="token keyword">as</span> fallback when running on GPUWARNING<span class="token punctuation">:</span>tensorflow<span class="token punctuation">:</span>Layer gru will <span class="token keyword">not</span> use cuDNN kernel since it doesn't meet the cuDNN kernel criteria<span class="token punctuation">.</span> It will use generic GPU kernel <span class="token keyword">as</span> fallback when running on GPUWARNING<span class="token punctuation">:</span>tensorflow<span class="token punctuation">:</span>Layer gru will <span class="token keyword">not</span> use cuDNN kernel since it doesn't meet the cuDNN kernel criteria<span class="token punctuation">.</span> It will use generic GPU kernel <span class="token keyword">as</span> fallback when running on GPUEpoch <span class="token number">1</span><span class="token operator">/</span><span class="token number">5</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">InternalError<span class="token punctuation">:</span> <span class="token number">2</span> root error<span class="token punctuation">(</span>s<span class="token punctuation">)</span> found<span class="token punctuation">.</span>  <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> Internal<span class="token punctuation">:</span>  Blas xGEMM launch failed <span class="token punctuation">:</span> a<span class="token punctuation">.</span>shape<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">128</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">]</span><span class="token punctuation">,</span> b<span class="token punctuation">.</span>shape<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token number">128</span><span class="token punctuation">]</span><span class="token punctuation">,</span> m<span class="token operator">=</span><span class="token number">128</span><span class="token punctuation">,</span> n<span class="token operator">=</span><span class="token number">128</span><span class="token punctuation">,</span> k<span class="token operator">=</span><span class="token number">100</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token punctuation">{</span><span class="token punctuation">{</span>node model<span class="token operator">/</span>bidirectional<span class="token operator">/</span>forward_gru<span class="token operator">/</span><span class="token keyword">while</span><span class="token operator">/</span>body<span class="token operator">/</span>_1<span class="token operator">/</span>model<span class="token operator">/</span>bidirectional<span class="token operator">/</span>forward_gru<span class="token operator">/</span><span class="token keyword">while</span><span class="token operator">/</span>gru_cell_1<span class="token operator">/</span>MatMul_2<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token punctuation">[</span><span class="token punctuation">[</span>gradient_tape<span class="token operator">/</span>model<span class="token operator">/</span>embedding<span class="token operator">/</span>embedding_lookup<span class="token operator">/</span>Reshape<span class="token operator">/</span>_28<span class="token punctuation">]</span><span class="token punctuation">]</span>  <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> Internal<span class="token punctuation">:</span>  Blas xGEMM launch failed <span class="token punctuation">:</span> a<span class="token punctuation">.</span>shape<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">128</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">]</span><span class="token punctuation">,</span> b<span class="token punctuation">.</span>shape<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token number">128</span><span class="token punctuation">]</span><span class="token punctuation">,</span> m<span class="token operator">=</span><span class="token number">128</span><span class="token punctuation">,</span> n<span class="token operator">=</span><span class="token number">128</span><span class="token punctuation">,</span> k<span class="token operator">=</span><span class="token number">100</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token punctuation">{</span><span class="token punctuation">{</span>node model<span class="token operator">/</span>bidirectional<span class="token operator">/</span>forward_gru<span class="token operator">/</span><span class="token keyword">while</span><span class="token operator">/</span>body<span class="token operator">/</span>_1<span class="token operator">/</span>model<span class="token operator">/</span>bidirectional<span class="token operator">/</span>forward_gru<span class="token operator">/</span><span class="token keyword">while</span><span class="token operator">/</span>gru_cell_1<span class="token operator">/</span>MatMul_2<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token number">0</span> successful operations<span class="token punctuation">.</span><span class="token number">0</span> derived errors ignored<span class="token punctuation">.</span> <span class="token punctuation">[</span>Op<span class="token punctuation">:</span>__inference_train_function_5452<span class="token punctuation">]</span>Function call stack<span class="token punctuation">:</span>train_function <span class="token operator">-</span><span class="token operator">&gt;</span> train_function<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>DataLoader 中 num_work 运作</title>
      <link href="2021/01/20/dataloader-zhong-num-work-yun-zuo/"/>
      <url>2021/01/20/dataloader-zhong-num-work-yun-zuo/</url>
      
        <content type="html"><![CDATA[<h2 id="Dataloader"><a href="#Dataloader" class="headerlink" title="Dataloader"></a>Dataloader</h2><p><a href="https://blog.csdn.net/daixiangzi/category_9137687.html">关于pytorch中，dataloader中的num_work运行机制的理解</a></p><p><a href="https://zhuanlan.zhihu.com/p/69250939">torch Dataloader中的num_workers</a></p><p><a href="https://www.jianshu.com/p/8ea7fba72673">[PyTorch] dataloader使用教程</a></p><p><a href="https://blog.csdn.net/songyuc/article/details/103365591">PyTorch——num_workers参数的设置</a></p><h2 id="Resnext50"><a href="#Resnext50" class="headerlink" title="Resnext50"></a>Resnext50</h2><p><a href="https://www.kaggle.com/yasufuminakama/cassava-resnext50-32x4d-starter-training">Cassava / resnext50_32x4d starter [training]</a></p><p><a href="https://www.kaggle.com/yasufuminakama/cassava-resnext50-32x4d-starter-inference">Cassava / resnext50_32x4d starter [inference]</a></p><p><a href="https://www.kaggle.com/piantic/no-tta-cassava-resnext50-32x4d-inference-lb0-903?scriptVersionId=48299703">[No TTA] Cassava Resnext50_32x4d Inference lb0.903</a></p><h2 id="Nginx"><a href="#Nginx" class="headerlink" title="Nginx"></a>Nginx</h2><p><a href="https://www.runoob.com/w3cnote/nginx-setup-intro.html">Nginx 配置详解</a></p><p><a href="https://zhuanlan.zhihu.com/p/34943332">8分钟带你深入浅出搞懂Nginx</a></p><p><a href="https://juejin.cn/post/6844904129987526663">连前端都看得懂的《Nginx 入门指南》</a></p><p><a href="https://zhuanlan.zhihu.com/p/31558973">科普帖：深度学习中GPU和显存分析</a></p><h2 id="Other"><a href="#Other" class="headerlink" title="Other"></a>Other</h2><p><a href="https://cloud.tencent.com/developer/article/1718045">小白学PyTorch | 17 TFrec文件的创建与读取</a></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>12-FACTORS</title>
      <link href="2021/01/20/12-factors/"/>
      <url>2021/01/20/12-factors/</url>
      
        <content type="html"><![CDATA[<h1 id="12-factors"><a href="#12-factors" class="headerlink" title="12-factors"></a>12-factors</h1><h2 id="I-基准代码"><a href="#I-基准代码" class="headerlink" title="I. 基准代码"></a><a href="https://12factor.net/zh_cn/codebase">I. 基准代码</a></h2><h3 id="一份基准代码，多份部署"><a href="#一份基准代码，多份部署" class="headerlink" title="一份基准代码，多份部署"></a>一份基准代码，多份部署</h3><h2 id="II-依赖"><a href="#II-依赖" class="headerlink" title="II. 依赖"></a><a href="https://12factor.net/zh_cn/dependencies">II. 依赖</a></h2><h3 id="显式声明依赖关系"><a href="#显式声明依赖关系" class="headerlink" title="显式声明依赖关系"></a>显式声明依赖关系</h3><h2 id="III-配置"><a href="#III-配置" class="headerlink" title="III. 配置"></a><a href="https://12factor.net/zh_cn/config">III. 配置</a></h2><h3 id="在环境中存储配置"><a href="#在环境中存储配置" class="headerlink" title="在环境中存储配置"></a>在环境中存储配置</h3><h2 id="IV-后端服务"><a href="#IV-后端服务" class="headerlink" title="IV. 后端服务"></a><a href="https://12factor.net/zh_cn/backing-services">IV. 后端服务</a></h2><h3 id="把后端服务当作附加资源"><a href="#把后端服务当作附加资源" class="headerlink" title="把后端服务当作附加资源"></a>把后端服务当作附加资源</h3><h2 id="V-构建，发布，运行"><a href="#V-构建，发布，运行" class="headerlink" title="V. 构建，发布，运行"></a><a href="https://12factor.net/zh_cn/build-release-run">V. 构建，发布，运行</a></h2><h3 id="严格分离构建和运行"><a href="#严格分离构建和运行" class="headerlink" title="严格分离构建和运行"></a>严格分离构建和运行</h3><h2 id="VI-进程"><a href="#VI-进程" class="headerlink" title="VI. 进程"></a><a href="https://12factor.net/zh_cn/processes">VI. 进程</a></h2><h3 id="以一个或多个无状态进程运行应用"><a href="#以一个或多个无状态进程运行应用" class="headerlink" title="以一个或多个无状态进程运行应用"></a>以一个或多个无状态进程运行应用</h3><h2 id="VII-端口绑定"><a href="#VII-端口绑定" class="headerlink" title="VII. 端口绑定"></a><a href="https://12factor.net/zh_cn/port-binding">VII. 端口绑定</a></h2><h3 id="通过端口绑定提供服务"><a href="#通过端口绑定提供服务" class="headerlink" title="通过端口绑定提供服务"></a>通过端口绑定提供服务</h3><h2 id="VIII-并发"><a href="#VIII-并发" class="headerlink" title="VIII. 并发"></a><a href="https://12factor.net/zh_cn/concurrency">VIII. 并发</a></h2><h3 id="通过进程模型进行扩展"><a href="#通过进程模型进行扩展" class="headerlink" title="通过进程模型进行扩展"></a>通过进程模型进行扩展</h3><h2 id="IX-易处理"><a href="#IX-易处理" class="headerlink" title="IX. 易处理"></a><a href="https://12factor.net/zh_cn/disposability">IX. 易处理</a></h2><h3 id="快速启动和优雅终止可最大化健壮性"><a href="#快速启动和优雅终止可最大化健壮性" class="headerlink" title="快速启动和优雅终止可最大化健壮性"></a>快速启动和优雅终止可最大化健壮性</h3><h2 id="X-开发环境与线上环境等价"><a href="#X-开发环境与线上环境等价" class="headerlink" title="X. 开发环境与线上环境等价"></a><a href="https://12factor.net/zh_cn/dev-prod-parity">X. 开发环境与线上环境等价</a></h2><h3 id="尽可能的保持开发，预发布，线上环境相同"><a href="#尽可能的保持开发，预发布，线上环境相同" class="headerlink" title="尽可能的保持开发，预发布，线上环境相同"></a>尽可能的保持开发，预发布，线上环境相同</h3><h2 id="XI-日志"><a href="#XI-日志" class="headerlink" title="XI. 日志"></a><a href="https://12factor.net/zh_cn/logs">XI. 日志</a></h2><h3 id="把日志当作事件流"><a href="#把日志当作事件流" class="headerlink" title="把日志当作事件流"></a>把日志当作事件流</h3><h2 id="XII-管理进程"><a href="#XII-管理进程" class="headerlink" title="XII. 管理进程"></a><a href="https://12factor.net/zh_cn/admin-processes">XII. 管理进程</a></h2><h3 id="后台管理任务当作一次性进程运行"><a href="#后台管理任务当作一次性进程运行" class="headerlink" title="后台管理任务当作一次性进程运行"></a>后台管理任务当作一次性进程运行</h3>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>WSL2 使用</title>
      <link href="2021/01/18/wsl2-shi-yong/"/>
      <url>2021/01/18/wsl2-shi-yong/</url>
      
        <content type="html"><![CDATA[<h1 id="WSL2-使用"><a href="#WSL2-使用" class="headerlink" title="WSL2 使用"></a>WSL2 使用</h1><h2 id="一、安装"><a href="#一、安装" class="headerlink" title="一、安装"></a>一、安装</h2><p>wsl2 安装还是很简单的，根据官网步骤来就好。<a href="https://docs.microsoft.com/en-us/windows/wsl/install-win10">Windows Subsystem for Linux Installation Guide for Windows 10</a>，如果对官网安装不熟悉的的地方。我推荐看这个 UP 主，讲得很清楚：<a href="https://www.bilibili.com/video/BV1aA411s7PJ">Window10开发环境搭建(1) | 详细演示WSL2的安装</a>，这里我也是跟着他的视频进行的开发环境的搭建学到不少，这里给下他视频的目录：</p><ul><li><a href="https://www.bilibili.com/video/BV1aA411s7PJ">详细演示WSL2的安装</a></li><li><a href="https://www.bilibili.com/video/BV1Zz4y167Vo">Terminal和VS Code</a></li><li><a href="https://www.bilibili.com/video/BV1nt4y1k7Fy">在WSL2里安装Docker</a></li><li><p><a href="https://www.bilibili.com/video/BV1sv41147FS/">给WSL配置漂亮且强大的 zsh</a></p></li><li><p><a href="https://www.bilibili.com/video/BV1Lv411t7ov">WSL+VS Code 搭建Python开发环境</a></p></li></ul><p>安装后输入 <code>lsb_release -a</code>查看系统版本</p><p><img src="/2021/01/18/wsl2-shi-yong/QQ图片20210118212318.png" alt=""></p><h2 id="二、修改镜像"><a href="#二、修改镜像" class="headerlink" title="二、修改镜像"></a>二、修改镜像</h2><p>换源可能是我们安装好需要做的第一件事了，毕竟用源镜像下载有时候是真的慢。一般修改镜像方式有两种，一种是图形界面配置，另一种是手动更改</p><h3 id="图形界面配置"><a href="#图形界面配置" class="headerlink" title="图形界面配置"></a>图形界面配置</h3><p>推荐使用图形界面配置： 系统设置 -&gt; 软件和更新 选择下载服务器 -&gt; “mirrors.aliyun.com”</p><h3 id="手动更改"><a href="#手动更改" class="headerlink" title="手动更改"></a>手动更改</h3><p>用我们熟悉的编辑器打开：</p><p><code>/etc/apt/sources.list</code></p><p>替换默认的</p><p><code>http://archive.ubuntu.com/</code></p><p>为</p><p><code>mirrors.aliyun.com</code></p><h4 id="Ubuntu-14-04-5-LTS配置如下"><a href="#Ubuntu-14-04-5-LTS配置如下" class="headerlink" title="Ubuntu 14.04.5 LTS配置如下"></a>Ubuntu 14.04.5 LTS配置如下</h4><pre class="line-numbers language-python" data-language="python"><code class="language-python">deb https<span class="token punctuation">:</span><span class="token operator">//</span>mirrors<span class="token punctuation">.</span>aliyun<span class="token punctuation">.</span>com<span class="token operator">/</span>ubuntu<span class="token operator">/</span> trusty main restricted universe multiversedeb<span class="token operator">-</span>src https<span class="token punctuation">:</span><span class="token operator">//</span>mirrors<span class="token punctuation">.</span>aliyun<span class="token punctuation">.</span>com<span class="token operator">/</span>ubuntu<span class="token operator">/</span> trusty main restricted universe multiversedeb https<span class="token punctuation">:</span><span class="token operator">//</span>mirrors<span class="token punctuation">.</span>aliyun<span class="token punctuation">.</span>com<span class="token operator">/</span>ubuntu<span class="token operator">/</span> trusty<span class="token operator">-</span>security main restricted universe multiversedeb<span class="token operator">-</span>src https<span class="token punctuation">:</span><span class="token operator">//</span>mirrors<span class="token punctuation">.</span>aliyun<span class="token punctuation">.</span>com<span class="token operator">/</span>ubuntu<span class="token operator">/</span> trusty<span class="token operator">-</span>security main restricted universe multiversedeb https<span class="token punctuation">:</span><span class="token operator">//</span>mirrors<span class="token punctuation">.</span>aliyun<span class="token punctuation">.</span>com<span class="token operator">/</span>ubuntu<span class="token operator">/</span> trusty<span class="token operator">-</span>updates main restricted universe multiversedeb<span class="token operator">-</span>src https<span class="token punctuation">:</span><span class="token operator">//</span>mirrors<span class="token punctuation">.</span>aliyun<span class="token punctuation">.</span>com<span class="token operator">/</span>ubuntu<span class="token operator">/</span> trusty<span class="token operator">-</span>updates main restricted universe multiversedeb https<span class="token punctuation">:</span><span class="token operator">//</span>mirrors<span class="token punctuation">.</span>aliyun<span class="token punctuation">.</span>com<span class="token operator">/</span>ubuntu<span class="token operator">/</span> trusty<span class="token operator">-</span>backports main restricted universe multiversedeb<span class="token operator">-</span>src https<span class="token punctuation">:</span><span class="token operator">//</span>mirrors<span class="token punctuation">.</span>aliyun<span class="token punctuation">.</span>com<span class="token operator">/</span>ubuntu<span class="token operator">/</span> trusty<span class="token operator">-</span>backports main restricted universe multiverse<span class="token comment">## Not recommended</span><span class="token comment"># deb https://mirrors.aliyun.com/ubuntu/ trusty-proposed main restricted universe multiverse</span><span class="token comment"># deb-src https://mirrors.aliyun.com/ubuntu/ trusty-proposed main restricted universe multiverse</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="ubuntu-16-04-配置如下"><a href="#ubuntu-16-04-配置如下" class="headerlink" title="ubuntu 16.04 配置如下"></a>ubuntu 16.04 配置如下</h4><pre class="line-numbers language-python" data-language="python"><code class="language-python">deb http<span class="token punctuation">:</span><span class="token operator">//</span>mirrors<span class="token punctuation">.</span>aliyun<span class="token punctuation">.</span>com<span class="token operator">/</span>ubuntu<span class="token operator">/</span> xenial maindeb<span class="token operator">-</span>src http<span class="token punctuation">:</span><span class="token operator">//</span>mirrors<span class="token punctuation">.</span>aliyun<span class="token punctuation">.</span>com<span class="token operator">/</span>ubuntu<span class="token operator">/</span> xenial maindeb http<span class="token punctuation">:</span><span class="token operator">//</span>mirrors<span class="token punctuation">.</span>aliyun<span class="token punctuation">.</span>com<span class="token operator">/</span>ubuntu<span class="token operator">/</span> xenial<span class="token operator">-</span>updates maindeb<span class="token operator">-</span>src http<span class="token punctuation">:</span><span class="token operator">//</span>mirrors<span class="token punctuation">.</span>aliyun<span class="token punctuation">.</span>com<span class="token operator">/</span>ubuntu<span class="token operator">/</span> xenial<span class="token operator">-</span>updates maindeb http<span class="token punctuation">:</span><span class="token operator">//</span>mirrors<span class="token punctuation">.</span>aliyun<span class="token punctuation">.</span>com<span class="token operator">/</span>ubuntu<span class="token operator">/</span> xenial universedeb<span class="token operator">-</span>src http<span class="token punctuation">:</span><span class="token operator">//</span>mirrors<span class="token punctuation">.</span>aliyun<span class="token punctuation">.</span>com<span class="token operator">/</span>ubuntu<span class="token operator">/</span> xenial universedeb http<span class="token punctuation">:</span><span class="token operator">//</span>mirrors<span class="token punctuation">.</span>aliyun<span class="token punctuation">.</span>com<span class="token operator">/</span>ubuntu<span class="token operator">/</span> xenial<span class="token operator">-</span>updates universedeb<span class="token operator">-</span>src http<span class="token punctuation">:</span><span class="token operator">//</span>mirrors<span class="token punctuation">.</span>aliyun<span class="token punctuation">.</span>com<span class="token operator">/</span>ubuntu<span class="token operator">/</span> xenial<span class="token operator">-</span>updates universedeb http<span class="token punctuation">:</span><span class="token operator">//</span>mirrors<span class="token punctuation">.</span>aliyun<span class="token punctuation">.</span>com<span class="token operator">/</span>ubuntu<span class="token operator">/</span> xenial<span class="token operator">-</span>security maindeb<span class="token operator">-</span>src http<span class="token punctuation">:</span><span class="token operator">//</span>mirrors<span class="token punctuation">.</span>aliyun<span class="token punctuation">.</span>com<span class="token operator">/</span>ubuntu<span class="token operator">/</span> xenial<span class="token operator">-</span>security maindeb http<span class="token punctuation">:</span><span class="token operator">//</span>mirrors<span class="token punctuation">.</span>aliyun<span class="token punctuation">.</span>com<span class="token operator">/</span>ubuntu<span class="token operator">/</span> xenial<span class="token operator">-</span>security universedeb<span class="token operator">-</span>src http<span class="token punctuation">:</span><span class="token operator">//</span>mirrors<span class="token punctuation">.</span>aliyun<span class="token punctuation">.</span>com<span class="token operator">/</span>ubuntu<span class="token operator">/</span> xenial<span class="token operator">-</span>security universe<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="ubuntu-18-04-bionic-配置如下"><a href="#ubuntu-18-04-bionic-配置如下" class="headerlink" title="ubuntu 18.04(bionic) 配置如下"></a>ubuntu 18.04(bionic) 配置如下</h4><pre class="line-numbers language-python" data-language="python"><code class="language-python">deb http<span class="token punctuation">:</span><span class="token operator">//</span>mirrors<span class="token punctuation">.</span>aliyun<span class="token punctuation">.</span>com<span class="token operator">/</span>ubuntu<span class="token operator">/</span> bionic main restricted universe multiversedeb<span class="token operator">-</span>src http<span class="token punctuation">:</span><span class="token operator">//</span>mirrors<span class="token punctuation">.</span>aliyun<span class="token punctuation">.</span>com<span class="token operator">/</span>ubuntu<span class="token operator">/</span> bionic main restricted universe multiversedeb http<span class="token punctuation">:</span><span class="token operator">//</span>mirrors<span class="token punctuation">.</span>aliyun<span class="token punctuation">.</span>com<span class="token operator">/</span>ubuntu<span class="token operator">/</span> bionic<span class="token operator">-</span>security main restricted universe multiversedeb<span class="token operator">-</span>src http<span class="token punctuation">:</span><span class="token operator">//</span>mirrors<span class="token punctuation">.</span>aliyun<span class="token punctuation">.</span>com<span class="token operator">/</span>ubuntu<span class="token operator">/</span> bionic<span class="token operator">-</span>security main restricted universe multiversedeb http<span class="token punctuation">:</span><span class="token operator">//</span>mirrors<span class="token punctuation">.</span>aliyun<span class="token punctuation">.</span>com<span class="token operator">/</span>ubuntu<span class="token operator">/</span> bionic<span class="token operator">-</span>updates main restricted universe multiversedeb<span class="token operator">-</span>src http<span class="token punctuation">:</span><span class="token operator">//</span>mirrors<span class="token punctuation">.</span>aliyun<span class="token punctuation">.</span>com<span class="token operator">/</span>ubuntu<span class="token operator">/</span> bionic<span class="token operator">-</span>updates main restricted universe multiversedeb http<span class="token punctuation">:</span><span class="token operator">//</span>mirrors<span class="token punctuation">.</span>aliyun<span class="token punctuation">.</span>com<span class="token operator">/</span>ubuntu<span class="token operator">/</span> bionic<span class="token operator">-</span>proposed main restricted universe multiversedeb<span class="token operator">-</span>src http<span class="token punctuation">:</span><span class="token operator">//</span>mirrors<span class="token punctuation">.</span>aliyun<span class="token punctuation">.</span>com<span class="token operator">/</span>ubuntu<span class="token operator">/</span> bionic<span class="token operator">-</span>proposed main restricted universe multiversedeb http<span class="token punctuation">:</span><span class="token operator">//</span>mirrors<span class="token punctuation">.</span>aliyun<span class="token punctuation">.</span>com<span class="token operator">/</span>ubuntu<span class="token operator">/</span> bionic<span class="token operator">-</span>backports main restricted universe multiversedeb<span class="token operator">-</span>src http<span class="token punctuation">:</span><span class="token operator">//</span>mirrors<span class="token punctuation">.</span>aliyun<span class="token punctuation">.</span>com<span class="token operator">/</span>ubuntu<span class="token operator">/</span> bionic<span class="token operator">-</span>backports main restricted universe multiverse<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="ubuntu-20-04-focal-配置如下"><a href="#ubuntu-20-04-focal-配置如下" class="headerlink" title="ubuntu 20.04(focal) 配置如下"></a>ubuntu 20.04(focal) 配置如下</h4><pre class="line-numbers language-python" data-language="python"><code class="language-python">deb http<span class="token punctuation">:</span><span class="token operator">//</span>mirrors<span class="token punctuation">.</span>aliyun<span class="token punctuation">.</span>com<span class="token operator">/</span>ubuntu<span class="token operator">/</span> focal main restricted universe multiversedeb<span class="token operator">-</span>src http<span class="token punctuation">:</span><span class="token operator">//</span>mirrors<span class="token punctuation">.</span>aliyun<span class="token punctuation">.</span>com<span class="token operator">/</span>ubuntu<span class="token operator">/</span> focal main restricted universe multiversedeb http<span class="token punctuation">:</span><span class="token operator">//</span>mirrors<span class="token punctuation">.</span>aliyun<span class="token punctuation">.</span>com<span class="token operator">/</span>ubuntu<span class="token operator">/</span> focal<span class="token operator">-</span>security main restricted universe multiversedeb<span class="token operator">-</span>src http<span class="token punctuation">:</span><span class="token operator">//</span>mirrors<span class="token punctuation">.</span>aliyun<span class="token punctuation">.</span>com<span class="token operator">/</span>ubuntu<span class="token operator">/</span> focal<span class="token operator">-</span>security main restricted universe multiversedeb http<span class="token punctuation">:</span><span class="token operator">//</span>mirrors<span class="token punctuation">.</span>aliyun<span class="token punctuation">.</span>com<span class="token operator">/</span>ubuntu<span class="token operator">/</span> focal<span class="token operator">-</span>updates main restricted universe multiversedeb<span class="token operator">-</span>src http<span class="token punctuation">:</span><span class="token operator">//</span>mirrors<span class="token punctuation">.</span>aliyun<span class="token punctuation">.</span>com<span class="token operator">/</span>ubuntu<span class="token operator">/</span> focal<span class="token operator">-</span>updates main restricted universe multiversedeb http<span class="token punctuation">:</span><span class="token operator">//</span>mirrors<span class="token punctuation">.</span>aliyun<span class="token punctuation">.</span>com<span class="token operator">/</span>ubuntu<span class="token operator">/</span> focal<span class="token operator">-</span>proposed main restricted universe multiversedeb<span class="token operator">-</span>src http<span class="token punctuation">:</span><span class="token operator">//</span>mirrors<span class="token punctuation">.</span>aliyun<span class="token punctuation">.</span>com<span class="token operator">/</span>ubuntu<span class="token operator">/</span> focal<span class="token operator">-</span>proposed main restricted universe multiversedeb http<span class="token punctuation">:</span><span class="token operator">//</span>mirrors<span class="token punctuation">.</span>aliyun<span class="token punctuation">.</span>com<span class="token operator">/</span>ubuntu<span class="token operator">/</span> focal<span class="token operator">-</span>backports main restricted universe multiversedeb<span class="token operator">-</span>src http<span class="token punctuation">:</span><span class="token operator">//</span>mirrors<span class="token punctuation">.</span>aliyun<span class="token punctuation">.</span>com<span class="token operator">/</span>ubuntu<span class="token operator">/</span> focal<span class="token operator">-</span>backports main restricted universe multivers<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="三、问题总结"><a href="#三、问题总结" class="headerlink" title="三、问题总结"></a>三、问题总结</h2><p>当我使用</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> <span class="token operator">&lt;</span>packagename<span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>报如下错误信息错</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">E: Unable to correct problems, you have held broken packages.<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>然后 Google 一种<a href="https://github.com/microsoft/WSL/issues/6118">解决方案</a></p><hr><p>Solved. It turned out that my <code>/etc/apt/sources.list</code> is old, so I did copy the list from here, run</p><pre class="line-numbers language-none"><code class="language-none">sudo apt updatesudo apt upgrade<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>And everything worked.</p><hr><p>备份一下 <a href="https://gist.github.com/ishad0w/788555191c7037e249a439542c53e170"><code>Ubuntu 20.04 LTS (Focal Fossa) -- Full sources.list</code></a></p><p>因为换源把原文件修改了，但是在安装库的时候，报错，怎么更新修改都没用，最后换成源文件，重新 update 好了。</p><ul><li>留个坑未填（还是没解决换源问题，我再找适合的镜像，因为现在有用，就暂且不换了，下次一定填坑 hhhhhhh）</li></ul><pre class="line-numbers language-python" data-language="python"><code class="language-python">deb http<span class="token punctuation">:</span><span class="token operator">//</span>archive<span class="token punctuation">.</span>ubuntu<span class="token punctuation">.</span>com<span class="token operator">/</span>ubuntu<span class="token operator">/</span> focal main restricted universe multiversedeb<span class="token operator">-</span>src http<span class="token punctuation">:</span><span class="token operator">//</span>archive<span class="token punctuation">.</span>ubuntu<span class="token punctuation">.</span>com<span class="token operator">/</span>ubuntu<span class="token operator">/</span> focal main restricted universe multiversedeb http<span class="token punctuation">:</span><span class="token operator">//</span>archive<span class="token punctuation">.</span>ubuntu<span class="token punctuation">.</span>com<span class="token operator">/</span>ubuntu<span class="token operator">/</span> focal<span class="token operator">-</span>updates main restricted universe multiversedeb<span class="token operator">-</span>src http<span class="token punctuation">:</span><span class="token operator">//</span>archive<span class="token punctuation">.</span>ubuntu<span class="token punctuation">.</span>com<span class="token operator">/</span>ubuntu<span class="token operator">/</span> focal<span class="token operator">-</span>updates main restricted universe multiversedeb http<span class="token punctuation">:</span><span class="token operator">//</span>archive<span class="token punctuation">.</span>ubuntu<span class="token punctuation">.</span>com<span class="token operator">/</span>ubuntu<span class="token operator">/</span> focal<span class="token operator">-</span>security main restricted universe multiversedeb<span class="token operator">-</span>src http<span class="token punctuation">:</span><span class="token operator">//</span>archive<span class="token punctuation">.</span>ubuntu<span class="token punctuation">.</span>com<span class="token operator">/</span>ubuntu<span class="token operator">/</span> focal<span class="token operator">-</span>security main restricted universe multiversedeb http<span class="token punctuation">:</span><span class="token operator">//</span>archive<span class="token punctuation">.</span>ubuntu<span class="token punctuation">.</span>com<span class="token operator">/</span>ubuntu<span class="token operator">/</span> focal<span class="token operator">-</span>backports main restricted universe multiversedeb<span class="token operator">-</span>src http<span class="token punctuation">:</span><span class="token operator">//</span>archive<span class="token punctuation">.</span>ubuntu<span class="token punctuation">.</span>com<span class="token operator">/</span>ubuntu<span class="token operator">/</span> focal<span class="token operator">-</span>backports main restricted universe multiversedeb http<span class="token punctuation">:</span><span class="token operator">//</span>archive<span class="token punctuation">.</span>canonical<span class="token punctuation">.</span>com<span class="token operator">/</span>ubuntu focal partnerdeb<span class="token operator">-</span>src http<span class="token punctuation">:</span><span class="token operator">//</span>archive<span class="token punctuation">.</span>canonical<span class="token punctuation">.</span>com<span class="token operator">/</span>ubuntu focal partner<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="Tips"><a href="#Tips" class="headerlink" title="Tips"></a>Tips</h2><p>环境变量生效</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># source /etc/profile  </span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="相关资料"><a href="#相关资料" class="headerlink" title="相关资料"></a>相关资料</h2><p><a href="https://docs.microsoft.com/en-us/windows/wsl/install-win10">Windows Subsystem for Linux Installation Guide for Windows 10</a></p><p><a href="https://zhuanlan.zhihu.com/p/144583887">WSL2来了！但是能正常使用并不简单</a></p><p><a href="https://www.bilibili.com/video/BV1aA411s7PJ">Window10开发环境搭建(1) | 详细演示WSL2的安装</a></p><p><a href="https://developer.aliyun.com/mirror/ubuntu">Ubuntu 镜像</a></p><p><a href="https://github.com/microsoft/WSL/issues/6118">Unable to correct problems, you have held broken packages.</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> WSL2 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Links Summarize</title>
      <link href="2021/01/17/links-summarize/"/>
      <url>2021/01/17/links-summarize/</url>
      
        <content type="html"><![CDATA[<h2 id="2021-01-15"><a href="#2021-01-15" class="headerlink" title="2021-01-15"></a>2021-01-15</h2><h3 id="知识点"><a href="#知识点" class="headerlink" title="知识点"></a>知识点</h3><p><a href="https://developers.google.com/machine-learning/crash-course/classification/precision-and-recall?hl=zh-cn">分类 (Classification)：精确率和召回率</a></p><h3 id="工具"><a href="#工具" class="headerlink" title="工具"></a>工具</h3><p><a href="https://blog.excalidraw.com/one-year-of-excalidraw/">Excalidraw 的一年</a>：Excalidraw 是手绘风格的一个在线作图工具，2020年1月发布。本文讲述这个项目一年来的惊人发展。</p><h3 id="资源"><a href="#资源" class="headerlink" title="资源"></a>资源</h3><p><a href="https://setosa.io/ev/">Explained Visually</a>：Explained Visually (EV) is an experiment in making hard ideas intuitive inspired the work of Bret Victor’s <a href="http://worrydream.com/ExplorableExplanations/">Explorable Explanations</a>. Sign up to hear about the latest.</p><p><a href="https://fasterthanli.me/articles/a-half-hour-to-learn-rust">半小时学习 Rust 语言</a>：一篇英语长文，详细介绍 Rust 语言的基本知识点。</p><p><a href="https://merely-useful.github.io/py-rse/">Python 软件工程</a>：一本英文的免费书籍，介绍使用 Python 来做实际的软件项目时，需要了解的各种 Linux 知识，比如命令行、Git、Make 等等。</p><h2 id="2020-1-16"><a href="#2020-1-16" class="headerlink" title="2020-1-16"></a>2020-1-16</h2><p><a href="https://www.kaggle.com/tanulsingh077/how-to-become-leaf-doctor-with-deep-learning">https://www.kaggle.com/tanulsingh077/how-to-become-leaf-doctor-with-deep-learning</a></p><h2 id="2021-1-17"><a href="#2021-1-17" class="headerlink" title="2021-1-17"></a>2021-1-17</h2><p><a href="https://hellogithub.com/periodical/statistics/click/?target=https://github.com/connorferster/handcalcs">handcalcs</a>：通过简单的 Python 代码，生成复杂公式的工具。还记得写论文推算算法的时候，被一行行公式支配的恐惧吗？该库可以将 Python 写的公式，展示为 LaTeX 格式，效果如下：</p><p><a href="https://hellogithub.com/periodical/statistics/click/?target=https://github.com/altair-viz/altair">altair</a>：强大的数据可视化 Python 库。支持多种数据展示方式、接口简单、效果炫酷，示例代码和效果如下：</p><p><a href="https://hellogithub.com/periodical/statistics/click/?target=https://github.com/Xunzhuo/Algorithm-Guide">Algorithm-Guide</a>：系统性学习算法与数据结构的资料集合</p><p><a href="https://hellogithub.com/periodical/statistics/click/?target=https://github.com/firstcontributions/first-contributions">first-contributions</a>：手把手教你如何在 GitHub 第一次贡献代码的教程。支持多种语言，<a href="https://github.com/firstcontributions/first-contributions/blob/master/translations/README.chs.md">中文</a></p><p><a href="https://hellogithub.com/periodical/statistics/click/?target=https://github.com/microsoft/PowerToys">PowerToys</a>：微软开源的 Windows 系统下强大的辅助工具。比如：窗口管理、批量图片处理、改键工具等，下图是屏幕颜色选择工具</p><p>来源：<a href="https://github.com/521xueweihan/HelloGitHub/blob/master/content/53/HelloGitHub53.md">《HelloGitHub》第 53 期</a></p><h2 id="2021-1-18"><a href="#2021-1-18" class="headerlink" title="2021-1-18"></a>2021-1-18</h2><p><a href="https://zhuanlan.zhihu.com/p/344324470?utm_oi=1031474163571118080">RepVGG：极简架构，SOTA性能，让VGG式模型再次伟大</a></p><p><a href="https://ksco.gitbooks.io/build-your-own-lisp/content/">Build Your Own Lisp</a>：在本书中，你将在学习 C 语言的同时学会编写你自己的编程语言——一个 1000 行左右代码的简单 Lisp。不过我们并不是从零开始编写的，在代码中我用到了一个外部的库来完成一些初始化的工作。但是剩下的最重要的部分都是我们一行一行编写的，而且在本书结束时，你将会拥有一个属于自己的“麻雀虽小，五脏俱全”的 Lisp。</p><p><a href="https://en.cppreference.com/w/c">C reference</a></p><p><a href="https://www.jianshu.com/p/2c4f67320fe0">c语言char []和char *的区别</a></p><p><a href="https://github.com/ohmyzsh/ohmyzsh">Oh My Zsh</a>：Oh My Zsh is an open source, community-driven framework for managing your <a href="https://www.zsh.org/">zsh</a> configuration.</p>]]></content>
      
      
      
        <tags>
            
            <tag> link </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Task3 论文代码统计</title>
      <link href="2021/01/17/task3-lun-wen-dai-ma-tong-ji/"/>
      <url>2021/01/17/task3-lun-wen-dai-ma-tong-ji/</url>
      
        <content type="html"><![CDATA[<h2 id="任务说明"><a href="#任务说明" class="headerlink" title="任务说明"></a>任务说明</h2><ul><li>任务主题：论文代码统计，统计所有论文出现代码的相关统计；</li><li>任务内容：使用正则表达式统计代码连接、页数和图表数据；</li><li>任务成果：学习正则表达式统计；</li></ul><h2 id="数据处理步骤"><a href="#数据处理步骤" class="headerlink" title="数据处理步骤"></a>数据处理步骤</h2><p>在原始arxiv数据集中作者经常会在论文的<code>comments</code>或<code>abstract</code>字段中给出具体的代码链接，所以我们需要从这些字段里面找出代码的链接。</p><ul><li>确定数据出现的位置；</li><li>使用正则表达式完成匹配；</li><li>完成相关的统计；</li></ul><h2 id="正则表达式"><a href="#正则表达式" class="headerlink" title="正则表达式"></a>正则表达式</h2><p>正则表达式(regular expression)描述了一种字符串匹配的模式（pattern），可以用来检查一个串是否含有某种子串、将匹配的子串替换或者从某个串中取出符合某个条件的子串等。</p><h4 id="普通字符：大写和小写字母、所有数字、所有标点符号和一些其他符号"><a href="#普通字符：大写和小写字母、所有数字、所有标点符号和一些其他符号" class="headerlink" title="普通字符：大写和小写字母、所有数字、所有标点符号和一些其他符号"></a>普通字符：大写和小写字母、所有数字、所有标点符号和一些其他符号</h4><div class="table-container"><table><thead><tr><th>字符</th><th>描述</th></tr></thead><tbody><tr><td><strong>[ABC]</strong></td><td>匹配 […] 中的所有字符，例如 [aeiou] 匹配字符串 “google runoob taobao” 中所有的 e o u a 字母。</td></tr><tr><td><strong><sup><a href="#fn_ABC" id="reffn_ABC">ABC</a></sup></strong></td><td>匹配除了 <strong>[…]</strong> 中字符的所有字符，例如 <strong><sup><a href="#fn_aeiou" id="reffn_aeiou">aeiou</a></sup></strong> 匹配字符串 “google runoob taobao” 中除了 e o u a 字母的所有字母。</td></tr><tr><td><strong>[A-Z]</strong></td><td>[A-Z] 表示一个区间，匹配所有大写字母，[a-z] 表示所有小写字母。</td></tr><tr><td>.</td><td>匹配除换行符（\n、\r）之外的任何单个字符，相等于 <strong><sup><a href="#fn_\n\r" id="reffn_\n\r">\n\r</a></sup></strong>。</td></tr><tr><td><strong>[\s\S]</strong></td><td>匹配所有。\s 是匹配所有空白符，包括换行，\S 非空白符，包括换行。</td></tr><tr><td><strong>\w</strong></td><td>匹配字母、数字、下划线。等价于 [A-Za-z0-9_]</td></tr></tbody></table></div><h4 id="特殊字符：有特殊含义的字符"><a href="#特殊字符：有特殊含义的字符" class="headerlink" title="特殊字符：有特殊含义的字符"></a>特殊字符：有特殊含义的字符</h4><div class="table-container"><table><thead><tr><th style="text-align:left">特别字符</th><th style="text-align:left">描述</th></tr></thead><tbody><tr><td style="text-align:left">( )</td><td style="text-align:left">标记一个子表达式的开始和结束位置。子表达式可以获取供以后使用。要匹配这些字符，请使用 ( 和 )。</td></tr><tr><td style="text-align:left">*</td><td style="text-align:left">匹配前面的子表达式零次或多次。要匹配 <em> 字符，请使用 \</em>。</td></tr><tr><td style="text-align:left">+</td><td style="text-align:left">匹配前面的子表达式一次或多次。要匹配 + 字符，请使用 +。</td></tr><tr><td style="text-align:left">.</td><td style="text-align:left">匹配除换行符 \n 之外的任何单字符。要匹配 . ，请使用 . 。</td></tr><tr><td style="text-align:left">[</td><td style="text-align:left">标记一个中括号表达式的开始。要匹配 [，请使用 [。</td></tr><tr><td style="text-align:left">?</td><td style="text-align:left">匹配前面的子表达式零次或一次，或指明一个非贪婪限定符。要匹配 ? 字符，请使用 \?。</td></tr><tr><td style="text-align:left">\</td><td style="text-align:left">将下一个字符标记为或特殊字符、或原义字符、或向后引用、或八进制转义符。例如， ‘n’ 匹配字符 ‘n’。’\n’ 匹配换行符。序列 ‘\\’ 匹配 “\”，而 ‘(‘ 则匹配 “(“。</td></tr><tr><td style="text-align:left">^</td><td style="text-align:left">匹配输入字符串的开始位置，除非在方括号表达式中使用，当该符号在方括号表达式中使用时，表示不接受该方括号表达式中的字符集合。要匹配 ^ 字符本身，请使用 \^。</td></tr><tr><td style="text-align:left">{</td><td style="text-align:left">标记限定符表达式的开始。要匹配 {，请使用 \{。</td></tr><tr><td style="text-align:left">\</td><td style="text-align:left"></td><td>指明两项之间的一个选择。要匹配 \</td><td>，请使用 \</td><td>。</td></tr></tbody></table></div><h4 id="限定符"><a href="#限定符" class="headerlink" title="限定符"></a>限定符</h4><div class="table-container"><table><thead><tr><th style="text-align:left">字符</th><th style="text-align:left">描述</th></tr></thead><tbody><tr><td style="text-align:left">*</td><td style="text-align:left">匹配前面的子表达式零次或多次。例如，zo<em> 能匹配 “z” 以及 “zoo”。</em> 等价于{0,}。</td></tr><tr><td style="text-align:left">+</td><td style="text-align:left">匹配前面的子表达式一次或多次。例如，’zo+’ 能匹配 “zo” 以及 “zoo”，但不能匹配 “z”。+ 等价于 {1,}。</td></tr><tr><td style="text-align:left">?</td><td style="text-align:left">匹配前面的子表达式零次或一次。例如，”do(es)?” 可以匹配 “do” 、 “does” 中的 “does” 、 “doxy” 中的 “do” 。? 等价于 {0,1}。</td></tr><tr><td style="text-align:left">{n}</td><td style="text-align:left">n 是一个非负整数。匹配确定的 n 次。例如，’o{2}’ 不能匹配 “Bob” 中的 ‘o’，但是能匹配 “food” 中的两个 o。</td></tr><tr><td style="text-align:left">{n,}</td><td style="text-align:left">n 是一个非负整数。至少匹配n 次。例如，’o{2,}’ 不能匹配 “Bob” 中的 ‘o’，但能匹配 “foooood” 中的所有 o。’o{1,}’ 等价于 ‘o+’。’o{0,}’ 则等价于 ‘o*’。</td></tr><tr><td style="text-align:left">{n,m}</td><td style="text-align:left">m 和 n 均为非负整数，其中n &lt;= m。最少匹配 n 次且最多匹配 m 次。例如，”o{1,3}” 将匹配 “fooooood” 中的前三个 o。’o{0,1}’ 等价于 ‘o?’。请注意在逗号和两个数之间不能有空格。</td></tr></tbody></table></div><h2 id="具体代码实现以及讲解"><a href="#具体代码实现以及讲解" class="headerlink" title="具体代码实现以及讲解"></a>具体代码实现以及讲解</h2><p>首先我们来统计论文页数，也就是在<code>comments</code>字段中抽取pages和figures和个数，首先完成字段读取。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> seaborn <span class="token keyword">as</span> sns<span class="token keyword">from</span> bs4 <span class="token keyword">import</span> BeautifulSoup<span class="token keyword">import</span> re<span class="token keyword">import</span> requests<span class="token keyword">import</span> json<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pdpd<span class="token punctuation">.</span>options<span class="token punctuation">.</span>mode<span class="token punctuation">.</span>chained_assignment <span class="token operator">=</span> <span class="token boolean">None</span>  <span class="token comment"># default='warn'</span><span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">readArxivFile</span><span class="token punctuation">(</span>path<span class="token punctuation">,</span> columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">,</span> <span class="token string">'submitter'</span><span class="token punctuation">,</span> <span class="token string">'authors'</span><span class="token punctuation">,</span> <span class="token string">'title'</span><span class="token punctuation">,</span> <span class="token string">'comments'</span><span class="token punctuation">,</span> <span class="token string">'journal-ref'</span><span class="token punctuation">,</span> <span class="token string">'doi'</span><span class="token punctuation">,</span>       <span class="token string">'report-no'</span><span class="token punctuation">,</span> <span class="token string">'categories'</span><span class="token punctuation">,</span> <span class="token string">'license'</span><span class="token punctuation">,</span> <span class="token string">'abstract'</span><span class="token punctuation">,</span> <span class="token string">'versions'</span><span class="token punctuation">,</span>       <span class="token string">'update_date'</span><span class="token punctuation">,</span> <span class="token string">'authors_parsed'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> count<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">'''    定义读取文件的函数        path: 文件路径        columns: 需要选择的列        count: 读取行数    '''</span>        data  <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>path<span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>         <span class="token keyword">for</span> idx<span class="token punctuation">,</span> line <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>f<span class="token punctuation">)</span><span class="token punctuation">:</span>             <span class="token keyword">if</span> idx <span class="token operator">==</span> count<span class="token punctuation">:</span>                <span class="token keyword">break</span>                            d <span class="token operator">=</span> json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>line<span class="token punctuation">)</span>            d <span class="token operator">=</span> <span class="token punctuation">{</span>col <span class="token punctuation">:</span> d<span class="token punctuation">[</span>col<span class="token punctuation">]</span> <span class="token keyword">for</span> col <span class="token keyword">in</span> columns<span class="token punctuation">}</span>            data<span class="token punctuation">.</span>append<span class="token punctuation">(</span>d<span class="token punctuation">)</span>    data <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>data<span class="token punctuation">)</span>    <span class="token keyword">return</span> datadata <span class="token operator">=</span> readArxivFile<span class="token punctuation">(</span><span class="token string">'../data/arxiv-metadata-oai-snapshot.json'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">,</span> <span class="token string">'abstract'</span><span class="token punctuation">,</span> <span class="token string">'categories'</span><span class="token punctuation">,</span> <span class="token string">'comments'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">data<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }    .dataframe tbody tr th {        vertical-align: top;    }    .dataframe thead th {        text-align: right;    }</style><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>id</th>      <th>abstract</th>      <th>categories</th>      <th>comments</th>    </tr>  </thead>  <tbody>    <tr>      <th>0</th>      <td>0704.0001</td>      <td>A fully differential calculation in perturba...</td>      <td>hep-ph</td>      <td>37 pages, 15 figures; published version</td>    </tr>    <tr>      <th>1</th>      <td>0704.0002</td>      <td>We describe a new algorithm, the $(k,\ell)$-...</td>      <td>math.CO cs.CG</td>      <td>To appear in Graphs and Combinatorics</td>    </tr>    <tr>      <th>2</th>      <td>0704.0003</td>      <td>The evolution of Earth-Moon system is descri...</td>      <td>physics.gen-ph</td>      <td>23 pages, 3 figures</td>    </tr>    <tr>      <th>3</th>      <td>0704.0004</td>      <td>We show that a determinant of Stirling cycle...</td>      <td>math.CO</td>      <td>11 pages</td>    </tr>    <tr>      <th>4</th>      <td>0704.0005</td>      <td>In this paper we show how to compute the $\L...</td>      <td>math.CA math.FA</td>      <td>None</td>    </tr>  </tbody></table></div><h3 id="对-pages-进行提取"><a href="#对-pages-进行提取" class="headerlink" title="对 pages 进行提取"></a>对 pages 进行提取</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 正则匹配</span>data<span class="token punctuation">[</span><span class="token string">'pages'</span><span class="token punctuation">]</span> <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token string">'comments'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> re<span class="token punctuation">.</span>findall<span class="token punctuation">(</span><span class="token string">"[1-9][0-9]* pages"</span><span class="token punctuation">,</span> <span class="token builtin">str</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>data<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }    .dataframe tbody tr th {        vertical-align: top;    }    .dataframe thead th {        text-align: right;    }</style><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>id</th>      <th>abstract</th>      <th>categories</th>      <th>comments</th>      <th>pages</th>    </tr>  </thead>  <tbody>    <tr>      <th>0</th>      <td>0704.0001</td>      <td>A fully differential calculation in perturba...</td>      <td>hep-ph</td>      <td>37 pages, 15 figures; published version</td>      <td>[37 pages]</td>    </tr>    <tr>      <th>1</th>      <td>0704.0002</td>      <td>We describe a new algorithm, the $(k,\ell)$-...</td>      <td>math.CO cs.CG</td>      <td>To appear in Graphs and Combinatorics</td>      <td>[]</td>    </tr>    <tr>      <th>2</th>      <td>0704.0003</td>      <td>The evolution of Earth-Moon system is descri...</td>      <td>physics.gen-ph</td>      <td>23 pages, 3 figures</td>      <td>[23 pages]</td>    </tr>    <tr>      <th>3</th>      <td>0704.0004</td>      <td>We show that a determinant of Stirling cycle...</td>      <td>math.CO</td>      <td>11 pages</td>      <td>[11 pages]</td>    </tr>    <tr>      <th>4</th>      <td>0704.0005</td>      <td>In this paper we show how to compute the $\L...</td>      <td>math.CA math.FA</td>      <td>None</td>      <td>[]</td>    </tr>  </tbody></table></div><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 筛选出有 len(pages) &gt; 0的数据</span>data <span class="token operator">=</span> data<span class="token punctuation">[</span>data<span class="token punctuation">[</span><span class="token string">"pages"</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> <span class="token builtin">len</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">]</span>data<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }    .dataframe tbody tr th {        vertical-align: top;    }    .dataframe thead th {        text-align: right;    }</style><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>id</th>      <th>abstract</th>      <th>categories</th>      <th>comments</th>      <th>pages</th>    </tr>  </thead>  <tbody>    <tr>      <th>0</th>      <td>0704.0001</td>      <td>A fully differential calculation in perturba...</td>      <td>hep-ph</td>      <td>37 pages, 15 figures; published version</td>      <td>[37 pages]</td>    </tr>    <tr>      <th>2</th>      <td>0704.0003</td>      <td>The evolution of Earth-Moon system is descri...</td>      <td>physics.gen-ph</td>      <td>23 pages, 3 figures</td>      <td>[23 pages]</td>    </tr>    <tr>      <th>3</th>      <td>0704.0004</td>      <td>We show that a determinant of Stirling cycle...</td>      <td>math.CO</td>      <td>11 pages</td>      <td>[11 pages]</td>    </tr>    <tr>      <th>5</th>      <td>0704.0006</td>      <td>We study the two-particle wave function of p...</td>      <td>cond-mat.mes-hall</td>      <td>6 pages, 4 figures, accepted by PRA</td>      <td>[6 pages]</td>    </tr>    <tr>      <th>6</th>      <td>0704.0007</td>      <td>A rather non-standard quantum representation...</td>      <td>gr-qc</td>      <td>16 pages, no figures. Typos corrected to match...</td>      <td>[16 pages]</td>    </tr>  </tbody></table></div><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 转换 pages 数据格式</span>data<span class="token punctuation">[</span><span class="token string">'pages'</span><span class="token punctuation">]</span> <span class="token operator">=</span> data<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token string">'pages'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> <span class="token builtin">float</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">" pages"</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>data<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }    .dataframe tbody tr th {        vertical-align: top;    }    .dataframe thead th {        text-align: right;    }</style><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>id</th>      <th>abstract</th>      <th>categories</th>      <th>comments</th>      <th>pages</th>    </tr>  </thead>  <tbody>    <tr>      <th>0</th>      <td>0704.0001</td>      <td>A fully differential calculation in perturba...</td>      <td>hep-ph</td>      <td>37 pages, 15 figures; published version</td>      <td>37.0</td>    </tr>    <tr>      <th>2</th>      <td>0704.0003</td>      <td>The evolution of Earth-Moon system is descri...</td>      <td>physics.gen-ph</td>      <td>23 pages, 3 figures</td>      <td>23.0</td>    </tr>    <tr>      <th>3</th>      <td>0704.0004</td>      <td>We show that a determinant of Stirling cycle...</td>      <td>math.CO</td>      <td>11 pages</td>      <td>11.0</td>    </tr>    <tr>      <th>5</th>      <td>0704.0006</td>      <td>We study the two-particle wave function of p...</td>      <td>cond-mat.mes-hall</td>      <td>6 pages, 4 figures, accepted by PRA</td>      <td>6.0</td>    </tr>    <tr>      <th>6</th>      <td>0704.0007</td>      <td>A rather non-standard quantum representation...</td>      <td>gr-qc</td>      <td>16 pages, no figures. Typos corrected to match...</td>      <td>16.0</td>    </tr>  </tbody></table></div><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 转换 pages 数据格式</span><span class="token comment"># data['pages'] = data['pages'].apply(lambda x: float(x[0].replace(" pages", '')))</span><span class="token comment"># data.head()</span><span class="token comment"># 这种写法会有 Warning such as: </span><span class="token comment"># SettingWithCopyWarning: A value is trying to be set on a copy of a slice from a DataFrame.</span><span class="token comment"># Try using .loc[row_index,col_indexer] = value instead</span><span class="token comment"># 附上 stackoverflow 解释：https://stackoverflow.com/questions/20625582/how-to-deal-with-settingwithcopywarning-in-pandas</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="对-pages-进行初步的数据统计"><a href="#对-pages-进行初步的数据统计" class="headerlink" title="对 pages 进行初步的数据统计"></a>对 pages 进行初步的数据统计</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python">data<span class="token punctuation">[</span><span class="token string">"pages"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>describe<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>astype<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">count    <span class="token number">1089180</span>mean          <span class="token number">17</span>std           <span class="token number">22</span><span class="token builtin">min</span>            <span class="token number">1</span><span class="token number">25</span><span class="token operator">%</span>            <span class="token number">8</span><span class="token number">50</span><span class="token operator">%</span>           <span class="token number">13</span><span class="token number">75</span><span class="token operator">%</span>           <span class="token number">22</span><span class="token builtin">max</span>        <span class="token number">11232</span>Name<span class="token punctuation">:</span> pages<span class="token punctuation">,</span> dtype<span class="token punctuation">:</span> int32<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>分类统计论文页数，选择论文第一个类别作为主要类别</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">data<span class="token punctuation">[</span><span class="token string">"categories"</span><span class="token punctuation">]</span> <span class="token operator">=</span> data<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token string">"categories"</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> x<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">' '</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>data<span class="token punctuation">[</span><span class="token string">"categories"</span><span class="token punctuation">]</span> <span class="token operator">=</span> data<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token string">"categories"</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> x<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'.'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>data<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }    .dataframe tbody tr th {        vertical-align: top;    }    .dataframe thead th {        text-align: right;    }</style><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>id</th>      <th>abstract</th>      <th>categories</th>      <th>comments</th>      <th>pages</th>    </tr>  </thead>  <tbody>    <tr>      <th>0</th>      <td>0704.0001</td>      <td>A fully differential calculation in perturba...</td>      <td>hep-ph</td>      <td>37 pages, 15 figures; published version</td>      <td>37.0</td>    </tr>    <tr>      <th>2</th>      <td>0704.0003</td>      <td>The evolution of Earth-Moon system is descri...</td>      <td>physics</td>      <td>23 pages, 3 figures</td>      <td>23.0</td>    </tr>    <tr>      <th>3</th>      <td>0704.0004</td>      <td>We show that a determinant of Stirling cycle...</td>      <td>math</td>      <td>11 pages</td>      <td>11.0</td>    </tr>    <tr>      <th>5</th>      <td>0704.0006</td>      <td>We study the two-particle wave function of p...</td>      <td>cond-mat</td>      <td>6 pages, 4 figures, accepted by PRA</td>      <td>6.0</td>    </tr>    <tr>      <th>6</th>      <td>0704.0007</td>      <td>A rather non-standard quantum representation...</td>      <td>gr-qc</td>      <td>16 pages, no figures. Typos corrected to match...</td>      <td>16.0</td>    </tr>  </tbody></table></div><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 每类论文的平均页数</span>fig<span class="token punctuation">,</span> axes <span class="token operator">=</span> plt<span class="token punctuation">.</span>subplots<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span>data<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"categories"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">"pages"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>plot<span class="token punctuation">(</span>kind<span class="token operator">=</span><span class="token string">"bar"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p><img src="/2021/01/17/task3-lun-wen-dai-ma-tong-ji/output_15_1.png" alt="png"></p><h4 id="groupby分组使用"><a href="#groupby分组使用" class="headerlink" title="groupby分组使用"></a>groupby分组使用</h4><p>分组操作在日常生活中使用极其广泛，例如：</p><ul><li>依据 性别 分组，统计全国人口 寿命 的 平均值</li><li>依据 季节 分组，对每一个季节的 温度 进行 组内标准化</li><li>依据 班级 分组，筛选出组内 数学分数 的 平均值超过80分的班级</li></ul><p>从上述的几个例子中不难看出，想要实现分组操作，必须明确三个要素：分组依据 、 数据来源 、 操作及其返回结果 。同时从充分性的角度来说，如果明确了这三方面，就能确定一个分组操作，从而分组代码的一般模式即：</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span>分组依据<span class="token punctuation">)</span><span class="token punctuation">[</span>数据来源<span class="token punctuation">]</span><span class="token punctuation">.</span>使用操作<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>例如第一个例子中的代码就应该如下：</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">'Gender'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'Longevity'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>现在返回到学生体测的数据集上，如果想要按照性别统计身高中位数，就可以如下写出：</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">In <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">:</span> df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">'data/learn_pandas.csv'</span><span class="token punctuation">)</span>In <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">:</span> df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">'Gender'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'Height'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>median<span class="token punctuation">(</span><span class="token punctuation">)</span>Out<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">:</span> GenderFemale    <span class="token number">159.6</span>Male      <span class="token number">173.4</span>Name<span class="token punctuation">:</span> Height<span class="token punctuation">,</span> dtype<span class="token punctuation">:</span> float64<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="对-figures-进行提取"><a href="#对-figures-进行提取" class="headerlink" title="对 figures 进行提取"></a>对 figures 进行提取</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python">data<span class="token punctuation">[</span><span class="token string">"figures"</span><span class="token punctuation">]</span> <span class="token operator">=</span> data<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token string">"comments"</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> re<span class="token punctuation">.</span>findall<span class="token punctuation">(</span><span class="token string">'[1-9][0-9]* figure'</span><span class="token punctuation">,</span> <span class="token builtin">str</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>data<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }    .dataframe tbody tr th {        vertical-align: top;    }    .dataframe thead th {        text-align: right;    }</style><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>id</th>      <th>abstract</th>      <th>categories</th>      <th>comments</th>      <th>pages</th>      <th>figures</th>    </tr>  </thead>  <tbody>    <tr>      <th>0</th>      <td>0704.0001</td>      <td>A fully differential calculation in perturba...</td>      <td>hep-ph</td>      <td>37 pages, 15 figures; published version</td>      <td>37.0</td>      <td>[15 figure]</td>    </tr>    <tr>      <th>2</th>      <td>0704.0003</td>      <td>The evolution of Earth-Moon system is descri...</td>      <td>physics</td>      <td>23 pages, 3 figures</td>      <td>23.0</td>      <td>[3 figure]</td>    </tr>    <tr>      <th>5</th>      <td>0704.0006</td>      <td>We study the two-particle wave function of p...</td>      <td>cond-mat</td>      <td>6 pages, 4 figures, accepted by PRA</td>      <td>6.0</td>      <td>[4 figure]</td>    </tr>    <tr>      <th>9</th>      <td>0704.0010</td>      <td>Partial cubes are isometric subgraphs of hyp...</td>      <td>math</td>      <td>36 pages, 17 figures</td>      <td>36.0</td>      <td>[17 figure]</td>    </tr>    <tr>      <th>13</th>      <td>0704.0014</td>      <td>In this article we discuss a relation betwee...</td>      <td>math</td>      <td>18 pages, 1 figure</td>      <td>18.0</td>      <td>[1 figure]</td>    </tr>  </tbody></table></div><pre class="line-numbers language-python" data-language="python"><code class="language-python">data <span class="token operator">=</span> data<span class="token punctuation">[</span>data<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token string">"figures"</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> <span class="token builtin">len</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">]</span>data<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }    .dataframe tbody tr th {        vertical-align: top;    }    .dataframe thead th {        text-align: right;    }</style><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>id</th>      <th>abstract</th>      <th>categories</th>      <th>comments</th>      <th>pages</th>      <th>figures</th>    </tr>  </thead>  <tbody>    <tr>      <th>0</th>      <td>0704.0001</td>      <td>A fully differential calculation in perturba...</td>      <td>hep-ph</td>      <td>37 pages, 15 figures; published version</td>      <td>37.0</td>      <td>[15 figure]</td>    </tr>    <tr>      <th>2</th>      <td>0704.0003</td>      <td>The evolution of Earth-Moon system is descri...</td>      <td>physics</td>      <td>23 pages, 3 figures</td>      <td>23.0</td>      <td>[3 figure]</td>    </tr>    <tr>      <th>5</th>      <td>0704.0006</td>      <td>We study the two-particle wave function of p...</td>      <td>cond-mat</td>      <td>6 pages, 4 figures, accepted by PRA</td>      <td>6.0</td>      <td>[4 figure]</td>    </tr>    <tr>      <th>9</th>      <td>0704.0010</td>      <td>Partial cubes are isometric subgraphs of hyp...</td>      <td>math</td>      <td>36 pages, 17 figures</td>      <td>36.0</td>      <td>[17 figure]</td>    </tr>    <tr>      <th>13</th>      <td>0704.0014</td>      <td>In this article we discuss a relation betwee...</td>      <td>math</td>      <td>18 pages, 1 figure</td>      <td>18.0</td>      <td>[1 figure]</td>    </tr>  </tbody></table></div><pre class="line-numbers language-python" data-language="python"><code class="language-python">data<span class="token punctuation">[</span><span class="token string">"figures"</span><span class="token punctuation">]</span> <span class="token operator">=</span> data<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token string">"figures"</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> <span class="token builtin">int</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">" figure"</span><span class="token punctuation">,</span> <span class="token string">" "</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>data<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }    .dataframe tbody tr th {        vertical-align: top;    }    .dataframe thead th {        text-align: right;    }</style><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>id</th>      <th>abstract</th>      <th>categories</th>      <th>comments</th>      <th>pages</th>      <th>figures</th>    </tr>  </thead>  <tbody>    <tr>      <th>0</th>      <td>0704.0001</td>      <td>A fully differential calculation in perturba...</td>      <td>hep-ph</td>      <td>37 pages, 15 figures; published version</td>      <td>37.0</td>      <td>15</td>    </tr>    <tr>      <th>2</th>      <td>0704.0003</td>      <td>The evolution of Earth-Moon system is descri...</td>      <td>physics</td>      <td>23 pages, 3 figures</td>      <td>23.0</td>      <td>3</td>    </tr>    <tr>      <th>5</th>      <td>0704.0006</td>      <td>We study the two-particle wave function of p...</td>      <td>cond-mat</td>      <td>6 pages, 4 figures, accepted by PRA</td>      <td>6.0</td>      <td>4</td>    </tr>    <tr>      <th>9</th>      <td>0704.0010</td>      <td>Partial cubes are isometric subgraphs of hyp...</td>      <td>math</td>      <td>36 pages, 17 figures</td>      <td>36.0</td>      <td>17</td>    </tr>    <tr>      <th>13</th>      <td>0704.0014</td>      <td>In this article we discuss a relation betwee...</td>      <td>math</td>      <td>18 pages, 1 figure</td>      <td>18.0</td>      <td>1</td>    </tr>  </tbody></table></div><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 每类论文的平均图片数</span>fig<span class="token punctuation">,</span> axes <span class="token operator">=</span> plt<span class="token punctuation">.</span>subplots<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span>data<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"categories"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">"figures"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>plot<span class="token punctuation">(</span>kind<span class="token operator">=</span><span class="token string">"bar"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p><img src="/2021/01/17/task3-lun-wen-dai-ma-tong-ji/output_20_1.png" alt="png"></p><h3 id="对代码链接进行提取"><a href="#对代码链接进行提取" class="headerlink" title="对代码链接进行提取"></a>对代码链接进行提取</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>comments<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token builtin">type</span><span class="token punctuation">(</span>data<span class="token punctuation">[</span><span class="token string">"comments"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>data<span class="token punctuation">.</span>comments <span class="token operator">==</span> data<span class="token punctuation">[</span><span class="token string">"comments"</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token string">'pandas.core.series.Series'</span><span class="token operator">&gt;</span> <span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token string">'pandas.core.series.Series'</span><span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token number">0</span>          <span class="token boolean">True</span><span class="token number">2</span>          <span class="token boolean">True</span><span class="token number">5</span>          <span class="token boolean">True</span><span class="token number">9</span>          <span class="token boolean">True</span><span class="token number">13</span>         <span class="token boolean">True</span>           <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token number">1796880</span>    <span class="token boolean">True</span><span class="token number">1796885</span>    <span class="token boolean">True</span><span class="token number">1796890</span>    <span class="token boolean">True</span><span class="token number">1796894</span>    <span class="token boolean">True</span><span class="token number">1796902</span>    <span class="token boolean">True</span>Name<span class="token punctuation">:</span> comments<span class="token punctuation">,</span> Length<span class="token punctuation">:</span> <span class="token number">670321</span><span class="token punctuation">,</span> dtype<span class="token punctuation">:</span> <span class="token builtin">bool</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># data_with_github_code = data[(data["comments"].str.contains("github") == True)|</span><span class="token comment">#                             (data["abstract"].str.contains("github") == True)</span><span class="token comment">#                             ]</span><span class="token comment"># data_with_github_code</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">data_with_github_code <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>comments<span class="token punctuation">.</span><span class="token builtin">str</span><span class="token punctuation">.</span>contains<span class="token punctuation">(</span><span class="token string">"github"</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token boolean">True</span><span class="token punctuation">)</span><span class="token operator">|</span>                            <span class="token punctuation">(</span>data<span class="token punctuation">.</span>abstract<span class="token punctuation">.</span><span class="token builtin">str</span><span class="token punctuation">.</span>contains<span class="token punctuation">(</span><span class="token string">"github"</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token boolean">True</span><span class="token punctuation">)</span>                            <span class="token punctuation">]</span>data_with_github_code<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }    .dataframe tbody tr th {        vertical-align: top;    }    .dataframe thead th {        text-align: right;    }</style><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>id</th>      <th>abstract</th>      <th>categories</th>      <th>comments</th>      <th>pages</th>      <th>figures</th>    </tr>  </thead>  <tbody>    <tr>      <th>87991</th>      <td>0810.2412</td>      <td>The Clifford algebra of a n-dimensional Eucl...</td>      <td>math-ph</td>      <td>10 pages, 1 figure</td>      <td>10.0</td>      <td>1</td>    </tr>    <tr>      <th>212359</th>      <td>1009.2203</td>      <td>Quantum error correction allows for faulty q...</td>      <td>quant-ph</td>      <td>38 pages, 15 figure, 10 tables. The algorithm ...</td>      <td>38.0</td>      <td>15</td>    </tr>    <tr>      <th>229459</th>      <td>1012.0091</td>      <td>Conan is a C++ library created for the accur...</td>      <td>q-bio</td>      <td>5 pages and 1 figure</td>      <td>5.0</td>      <td>1</td>    </tr>    <tr>      <th>253172</th>      <td>1103.5904</td>      <td>Solar tomography has progressed rapidly in r...</td>      <td>astro-ph</td>      <td>21 pages, 6 figures, 5 tables</td>      <td>21.0</td>      <td>6</td>    </tr>    <tr>      <th>254226</th>      <td>1104.0672</td>      <td>We describe a hybrid Fourier/direct space co...</td>      <td>astro-ph</td>      <td>10 pages, 6 figures. Submitted to Astronomy an...</td>      <td>10.0</td>      <td>6</td>    </tr>    <tr>      <th>...</th>      <td>...</td>      <td>...</td>      <td>...</td>      <td>...</td>      <td>...</td>      <td>...</td>    </tr>    <tr>      <th>1381310</th>      <td>2011.08562</td>      <td>The target identification in brain-computer ...</td>      <td>cs</td>      <td>12 pages, 6 figures</td>      <td>12.0</td>      <td>6</td>    </tr>    <tr>      <th>1381509</th>      <td>2011.08761</td>      <td>In this paper, we study the problem of imagi...</td>      <td>eess</td>      <td>10 pages, 2 figures, to be published in STACOM...</td>      <td>10.0</td>      <td>2</td>    </tr>    <tr>      <th>1381606</th>      <td>2011.08858</td>      <td>We derive a simple prescription for includin...</td>      <td>astro-ph</td>      <td>14 pages; 6 figures; 3 appendices</td>      <td>14.0</td>      <td>6</td>    </tr>    <tr>      <th>1381626</th>      <td>2011.08878</td>      <td>The production of numerical relativity wavef...</td>      <td>gr-qc</td>      <td>11 pages, 1 figure, 1 table. Open source softw...</td>      <td>11.0</td>      <td>1</td>    </tr>    <tr>      <th>1382418</th>      <td>2011.09670</td>      <td>Rotation detection serves as a fundamental b...</td>      <td>cs</td>      <td>12 pages, 6 figures, 8 tables</td>      <td>12.0</td>      <td>6</td>    </tr>  </tbody></table><p>2265 rows × 6 columns</p></div><pre class="line-numbers language-python" data-language="python"><code class="language-python">data_with_github_code<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token string">"text"</span><span class="token punctuation">]</span> <span class="token operator">=</span> data_with_github_code<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token string">"abstract"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>fillna<span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span> <span class="token operator">+</span> data_with_github_code<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token string">"comments"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>fillna<span class="token punctuation">(</span><span class="token string">""</span><span class="token punctuation">)</span>data_with_github_code<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }    .dataframe tbody tr th {        vertical-align: top;    }    .dataframe thead th {        text-align: right;    }</style><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>id</th>      <th>abstract</th>      <th>categories</th>      <th>comments</th>      <th>pages</th>      <th>figures</th>      <th>text</th>    </tr>  </thead>  <tbody>    <tr>      <th>87991</th>      <td>0810.2412</td>      <td>The Clifford algebra of a n-dimensional Eucl...</td>      <td>math-ph</td>      <td>10 pages, 1 figure</td>      <td>10.0</td>      <td>1</td>      <td>The Clifford algebra of a n-dimensional Eucl...</td>    </tr>    <tr>      <th>212359</th>      <td>1009.2203</td>      <td>Quantum error correction allows for faulty q...</td>      <td>quant-ph</td>      <td>38 pages, 15 figure, 10 tables. The algorithm ...</td>      <td>38.0</td>      <td>15</td>      <td>Quantum error correction allows for faulty q...</td>    </tr>    <tr>      <th>229459</th>      <td>1012.0091</td>      <td>Conan is a C++ library created for the accur...</td>      <td>q-bio</td>      <td>5 pages and 1 figure</td>      <td>5.0</td>      <td>1</td>      <td>Conan is a C++ library created for the accur...</td>    </tr>    <tr>      <th>253172</th>      <td>1103.5904</td>      <td>Solar tomography has progressed rapidly in r...</td>      <td>astro-ph</td>      <td>21 pages, 6 figures, 5 tables</td>      <td>21.0</td>      <td>6</td>      <td>Solar tomography has progressed rapidly in r...</td>    </tr>    <tr>      <th>254226</th>      <td>1104.0672</td>      <td>We describe a hybrid Fourier/direct space co...</td>      <td>astro-ph</td>      <td>10 pages, 6 figures. Submitted to Astronomy an...</td>      <td>10.0</td>      <td>6</td>      <td>We describe a hybrid Fourier/direct space co...</td>    </tr>    <tr>      <th>...</th>      <td>...</td>      <td>...</td>      <td>...</td>      <td>...</td>      <td>...</td>      <td>...</td>      <td>...</td>    </tr>    <tr>      <th>1381310</th>      <td>2011.08562</td>      <td>The target identification in brain-computer ...</td>      <td>cs</td>      <td>12 pages, 6 figures</td>      <td>12.0</td>      <td>6</td>      <td>The target identification in brain-computer ...</td>    </tr>    <tr>      <th>1381509</th>      <td>2011.08761</td>      <td>In this paper, we study the problem of imagi...</td>      <td>eess</td>      <td>10 pages, 2 figures, to be published in STACOM...</td>      <td>10.0</td>      <td>2</td>      <td>In this paper, we study the problem of imagi...</td>    </tr>    <tr>      <th>1381606</th>      <td>2011.08858</td>      <td>We derive a simple prescription for includin...</td>      <td>astro-ph</td>      <td>14 pages; 6 figures; 3 appendices</td>      <td>14.0</td>      <td>6</td>      <td>We derive a simple prescription for includin...</td>    </tr>    <tr>      <th>1381626</th>      <td>2011.08878</td>      <td>The production of numerical relativity wavef...</td>      <td>gr-qc</td>      <td>11 pages, 1 figure, 1 table. Open source softw...</td>      <td>11.0</td>      <td>1</td>      <td>The production of numerical relativity wavef...</td>    </tr>    <tr>      <th>1382418</th>      <td>2011.09670</td>      <td>Rotation detection serves as a fundamental b...</td>      <td>cs</td>      <td>12 pages, 6 figures, 8 tables</td>      <td>12.0</td>      <td>6</td>      <td>Rotation detection serves as a fundamental b...</td>    </tr>  </tbody></table><p>2265 rows × 7 columns</p></div><pre class="line-numbers language-python" data-language="python"><code class="language-python">pattern <span class="token operator">=</span> <span class="token string">"[a-z]+://github[^\s]*"</span>data_with_github_code<span class="token punctuation">[</span><span class="token string">"code_flag"</span><span class="token punctuation">]</span> <span class="token operator">=</span> data_with_github_code<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token string">"text"</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">str</span><span class="token punctuation">.</span>findall<span class="token punctuation">(</span>pattern<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> <span class="token builtin">len</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token operator">&gt;</span><span class="token number">0</span><span class="token punctuation">)</span>data_with_github_code<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }    .dataframe tbody tr th {        vertical-align: top;    }    .dataframe thead th {        text-align: right;    }</style><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>id</th>      <th>abstract</th>      <th>categories</th>      <th>comments</th>      <th>pages</th>      <th>figures</th>      <th>text</th>      <th>code_flag</th>    </tr>  </thead>  <tbody>    <tr>      <th>87991</th>      <td>0810.2412</td>      <td>The Clifford algebra of a n-dimensional Eucl...</td>      <td>math-ph</td>      <td>10 pages, 1 figure</td>      <td>10.0</td>      <td>1</td>      <td>The Clifford algebra of a n-dimensional Eucl...</td>      <td>False</td>    </tr>    <tr>      <th>212359</th>      <td>1009.2203</td>      <td>Quantum error correction allows for faulty q...</td>      <td>quant-ph</td>      <td>38 pages, 15 figure, 10 tables. The algorithm ...</td>      <td>38.0</td>      <td>15</td>      <td>Quantum error correction allows for faulty q...</td>      <td>True</td>    </tr>    <tr>      <th>229459</th>      <td>1012.0091</td>      <td>Conan is a C++ library created for the accur...</td>      <td>q-bio</td>      <td>5 pages and 1 figure</td>      <td>5.0</td>      <td>1</td>      <td>Conan is a C++ library created for the accur...</td>      <td>True</td>    </tr>    <tr>      <th>253172</th>      <td>1103.5904</td>      <td>Solar tomography has progressed rapidly in r...</td>      <td>astro-ph</td>      <td>21 pages, 6 figures, 5 tables</td>      <td>21.0</td>      <td>6</td>      <td>Solar tomography has progressed rapidly in r...</td>      <td>False</td>    </tr>    <tr>      <th>254226</th>      <td>1104.0672</td>      <td>We describe a hybrid Fourier/direct space co...</td>      <td>astro-ph</td>      <td>10 pages, 6 figures. Submitted to Astronomy an...</td>      <td>10.0</td>      <td>6</td>      <td>We describe a hybrid Fourier/direct space co...</td>      <td>True</td>    </tr>  </tbody></table></div><pre class="line-numbers language-python" data-language="python"><code class="language-python">data_with_github_code <span class="token operator">=</span> data_with_github_code<span class="token punctuation">[</span>data_with_github_code<span class="token punctuation">[</span><span class="token string">"code_flag"</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">]</span>fig<span class="token punctuation">,</span> axes <span class="token operator">=</span> plt<span class="token punctuation">.</span>subplots<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span>data_with_github_code<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"categories"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">"code_flag"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>count<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>plot<span class="token punctuation">(</span>kind<span class="token operator">=</span><span class="token string">"bar"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p><img src="/2021/01/17/task3-lun-wen-dai-ma-tong-ji/output_27_1.png" alt="png"></p>]]></content>
      
      
      
        <tags>
            
            <tag> DataWhale </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>RTX3070 安装 pytorch</title>
      <link href="2021/01/17/rtx3070-an-zhuang-pytorch/"/>
      <url>2021/01/17/rtx3070-an-zhuang-pytorch/</url>
      
        <content type="html"><![CDATA[<h1 id="RTX3070-安装-pytorch"><a href="#RTX3070-安装-pytorch" class="headerlink" title="RTX3070 安装 pytorch"></a>RTX3070 安装 pytorch</h1><p>之前在 Pycharm 创建的虚拟环境安装的 pytorch，但是今天觉得不太方便，想在 Anaconda 环境下重新安装一下，这样方便我的包管理。即使是 RTX3070，新一代 30 系显卡，之前安装主流深度学习库，不方便的原因是不支持 CUDA11，现在可以了。安装步骤是很简单的，因为官网在去年就支持了 CUDA11.0 的 pytorch 版本的安装配置（其实我本机用的是 CUDA11.1），不过可以正常使用，没有问题。</p><h2 id="安装步骤"><a href="#安装步骤" class="headerlink" title="安装步骤"></a>安装步骤</h2><ol><li><p>进入<a href="https://pytorch.org/">pytorch 官网</a></p></li><li><p>根据自己配置选择合适包，我选择的配置如下，这里使用的 pip 安装方式，并且最后换成清华源进行下载（没换之前太慢了，几次卡退，挂了梯子也不是很理想）</p></li></ol><p><img src="/2021/01/17/rtx3070-an-zhuang-pytorch/QQ截图20210117191101.png" alt=""></p><p>原 <code>Command</code>:</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">pip install torch<span class="token operator">==</span><span class="token operator">=</span><span class="token number">1.7</span><span class="token number">.1</span><span class="token operator">+</span>cu110 torchvision<span class="token operator">==</span><span class="token operator">=</span><span class="token number">0.8</span><span class="token number">.2</span><span class="token operator">+</span>cu110 torchaudio<span class="token operator">==</span><span class="token operator">=</span><span class="token number">0.7</span><span class="token number">.2</span> <span class="token operator">-</span>f https<span class="token punctuation">:</span><span class="token operator">//</span>download<span class="token punctuation">.</span>pytorch<span class="token punctuation">.</span>org<span class="token operator">/</span>whl<span class="token operator">/</span>torch_stable<span class="token punctuation">.</span>html<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>换源 <code>Command</code>：</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">pip install torch<span class="token operator">==</span><span class="token operator">=</span><span class="token number">1.7</span><span class="token number">.1</span><span class="token operator">+</span>cu110 torchvision<span class="token operator">==</span><span class="token operator">=</span><span class="token number">0.8</span><span class="token number">.2</span><span class="token operator">+</span>cu110 torchaudio<span class="token operator">==</span><span class="token operator">=</span><span class="token number">0.7</span><span class="token number">.2</span> <span class="token operator">-</span>i https<span class="token punctuation">:</span><span class="token operator">//</span>pypi<span class="token punctuation">.</span>tuna<span class="token punctuation">.</span>tsinghua<span class="token punctuation">.</span>edu<span class="token punctuation">.</span>cn<span class="token operator">/</span>simple<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/2021/01/17/rtx3070-an-zhuang-pytorch/QQ图片20210117191855.png" alt=""></p><p>如果报错 <code>zipfile.BadZipFile: File is not a zip file</code>，就是网络问题，导致的中断，换源下载就好啦</p><ol><li>测试</li></ol><p><img src="/2021/01/17/rtx3070-an-zhuang-pytorch/QQ截图20210117192518.png" alt=""></p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 测试 pytorch 是否安装成功</span><span class="token keyword">import</span> torch<span class="token keyword">print</span><span class="token punctuation">(</span>torch<span class="token punctuation">.</span>__version__<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>torch<span class="token punctuation">.</span>cuda<span class="token punctuation">.</span>is_available<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token number">1.7</span><span class="token number">.1</span><span class="token operator">+</span>cu110<span class="token boolean">True</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> time<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    start <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>    a <span class="token operator">=</span> torch<span class="token punctuation">.</span>FloatTensor<span class="token punctuation">(</span>i<span class="token operator">*</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token number">1000</span><span class="token punctuation">,</span><span class="token number">1000</span><span class="token punctuation">)</span>    a <span class="token operator">=</span> a<span class="token punctuation">.</span>cuda<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">#a = a</span>    a <span class="token operator">=</span> torch<span class="token punctuation">.</span>matmul<span class="token punctuation">(</span>a<span class="token punctuation">,</span>a<span class="token punctuation">)</span>    end <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> start    <span class="token keyword">print</span><span class="token punctuation">(</span>end<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token number">1.6777169704437256</span><span class="token number">0.2610034942626953</span><span class="token number">0.3769972324371338</span><span class="token number">0.5303194522857666</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 测试 tensorflow 是否安装成功</span><span class="token keyword">import</span> tensorflow <span class="token keyword">as</span> tfgpu_device_name <span class="token operator">=</span> tf<span class="token punctuation">.</span>config<span class="token punctuation">.</span>list_physical_devices<span class="token punctuation">(</span><span class="token string">'GPU'</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>gpu_device_name<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>tf<span class="token punctuation">.</span>test<span class="token punctuation">.</span>is_gpu_available<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token punctuation">[</span>PhysicalDevice<span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">'/physical_device:GPU:0'</span><span class="token punctuation">,</span> device_type<span class="token operator">=</span><span class="token string">'GPU'</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token boolean">True</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> tensorflow<span class="token punctuation">.</span>python<span class="token punctuation">.</span>client <span class="token keyword">import</span> device_lib<span class="token comment"># 列出所有的本地机器设备</span>local_device_protos <span class="token operator">=</span> device_lib<span class="token punctuation">.</span>list_local_devices<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token keyword">print</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token keyword">for</span> x <span class="token keyword">in</span> local_device_protos <span class="token keyword">if</span> x<span class="token punctuation">.</span>device_type <span class="token operator">==</span> <span class="token string">'GPU'</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">name<span class="token punctuation">:</span> <span class="token string">"/device:GPU:0"</span>device_type<span class="token punctuation">:</span> <span class="token string">"GPU"</span>memory_limit<span class="token punctuation">:</span> <span class="token number">3131113472</span>locality <span class="token punctuation">{</span>  bus_id<span class="token punctuation">:</span> <span class="token number">1</span>  links <span class="token punctuation">{</span>  <span class="token punctuation">}</span><span class="token punctuation">}</span>incarnation<span class="token punctuation">:</span> <span class="token number">11154920148718950164</span>physical_device_desc<span class="token punctuation">:</span> <span class="token string">"device: 0, name: GeForce RTX 3070, pci bus id: 0000:2d:00.0, compute capability: 8.6"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="相关资料"><a href="#相关资料" class="headerlink" title="相关资料"></a>相关资料</h2><p><a href="https://blog.csdn.net/WannaSeaU/article/details/102830613">通过清华镜像源加速下载pytorch——(pip版本)</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> 环境配置 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Cassava Leaf Disease - Exploratory Data Analysis</title>
      <link href="2021/01/16/cassava-leaf-disease-exploratory-data-analysis/"/>
      <url>2021/01/16/cassava-leaf-disease-exploratory-data-analysis/</url>
      
        <content type="html"><![CDATA[<h2 id="Cassava-Leaf-Disease-Exploratory-Data-Analysis"><a href="#Cassava-Leaf-Disease-Exploratory-Data-Analysis" class="headerlink" title="Cassava Leaf Disease - Exploratory Data Analysis"></a><strong>Cassava Leaf Disease - Exploratory Data Analysis</strong></h2><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> os BASE_DIR <span class="token operator">=</span> <span class="token string">"../input"</span><span class="token keyword">for</span> dirname<span class="token punctuation">,</span> _<span class="token punctuation">,</span> filenames <span class="token keyword">in</span> os<span class="token punctuation">.</span>walk<span class="token punctuation">(</span>BASE_DIR<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> filename <span class="token keyword">in</span> filenames<span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>dirname<span class="token punctuation">,</span> filename<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">dirname<span class="token punctuation">,</span>_<span class="token punctuation">,</span>filename<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token punctuation">(</span><span class="token string">'../input\\cassava-leaf-disease-classification\\train_tfrecords'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'ld_train15-1327.tfrec'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">BASE_DIR <span class="token operator">=</span> <span class="token string">"../input/cassava-leaf-disease-classification/"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> jsonlabel_map <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>BASE_DIR <span class="token operator">+</span> <span class="token string">"label_num_to_disease_map.json"</span><span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>    <span class="token keyword">for</span> line <span class="token keyword">in</span> f<span class="token punctuation">:</span>        label_map<span class="token punctuation">.</span>append<span class="token punctuation">(</span>json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>line<span class="token punctuation">)</span><span class="token punctuation">)</span>label_map <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>label_map<span class="token punctuation">)</span>label_map<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }    .dataframe tbody tr th {        vertical-align: top;    }    .dataframe thead th {        text-align: right;    }</style><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>0</th>      <th>1</th>      <th>2</th>      <th>3</th>      <th>4</th>    </tr>  </thead>  <tbody>    <tr>      <th>0</th>      <td>Cassava Bacterial Blight (CBB)</td>      <td>Cassava Brown Streak Disease (CBSD)</td>      <td>Cassava Green Mottle (CGM)</td>      <td>Cassava Mosaic Disease (CMD)</td>      <td>Healthy</td>    </tr>  </tbody></table></div><pre class="line-numbers language-python" data-language="python"><code class="language-python">df_train <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span>BASE_DIR <span class="token operator">+</span> <span class="token string">"train.csv"</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>df_train<span class="token punctuation">)</span><span class="token punctuation">)</span>df_train<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token number">21397</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }    .dataframe tbody tr th {        vertical-align: top;    }    .dataframe thead th {        text-align: right;    }</style><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>image_id</th>      <th>label</th>    </tr>  </thead>  <tbody>    <tr>      <th>0</th>      <td>1000015157.jpg</td>      <td>0</td>    </tr>    <tr>      <th>1</th>      <td>1000201771.jpg</td>      <td>3</td>    </tr>    <tr>      <th>2</th>      <td>100042118.jpg</td>      <td>1</td>    </tr>    <tr>      <th>3</th>      <td>1000723321.jpg</td>      <td>1</td>    </tr>    <tr>      <th>4</th>      <td>1000812911.jpg</td>      <td>3</td>    </tr>  </tbody></table></div><pre class="line-numbers language-python" data-language="python"><code class="language-python">df_train<span class="token punctuation">[</span><span class="token string">"label"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token number">3</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token builtin">type</span><span class="token punctuation">(</span>label_map<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token builtin">str</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 使用 for 循环实现增加一列 class_name</span><span class="token comment"># for i in range(len(df_train)):</span><span class="token comment">#     df_train["class_name"][i] = label_map.iloc[0,df_train["label"][i]]</span><span class="token comment"># df_train.head()</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">df_train<span class="token punctuation">[</span><span class="token string">"label"</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> label_map<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span>x<span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token number">0</span>             Cassava Bacterial Blight <span class="token punctuation">(</span>CBB<span class="token punctuation">)</span><span class="token number">1</span>               Cassava Mosaic Disease <span class="token punctuation">(</span>CMD<span class="token punctuation">)</span><span class="token number">2</span>        Cassava Brown Streak Disease <span class="token punctuation">(</span>CBSD<span class="token punctuation">)</span><span class="token number">3</span>        Cassava Brown Streak Disease <span class="token punctuation">(</span>CBSD<span class="token punctuation">)</span><span class="token number">4</span>               Cassava Mosaic Disease <span class="token punctuation">(</span>CMD<span class="token punctuation">)</span>                        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>                 <span class="token number">21392</span>           Cassava Mosaic Disease <span class="token punctuation">(</span>CMD<span class="token punctuation">)</span><span class="token number">21393</span>           Cassava Mosaic Disease <span class="token punctuation">(</span>CMD<span class="token punctuation">)</span><span class="token number">21394</span>    Cassava Brown Streak Disease <span class="token punctuation">(</span>CBSD<span class="token punctuation">)</span><span class="token number">21395</span>                                Healthy<span class="token number">21396</span>                                HealthyName<span class="token punctuation">:</span> label<span class="token punctuation">,</span> Length<span class="token punctuation">:</span> <span class="token number">21397</span><span class="token punctuation">,</span> dtype<span class="token punctuation">:</span> <span class="token builtin">object</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">df_train<span class="token punctuation">[</span><span class="token string">"class_name"</span><span class="token punctuation">]</span> <span class="token operator">=</span> df_train<span class="token punctuation">[</span><span class="token string">"label"</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> label_map<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span>x<span class="token punctuation">]</span><span class="token punctuation">)</span>df_train<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }    .dataframe tbody tr th {        vertical-align: top;    }    .dataframe thead th {        text-align: right;    }</style><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>image_id</th>      <th>label</th>      <th>class_name</th>    </tr>  </thead>  <tbody>    <tr>      <th>0</th>      <td>1000015157.jpg</td>      <td>0</td>      <td>Cassava Bacterial Blight (CBB)</td>    </tr>    <tr>      <th>1</th>      <td>1000201771.jpg</td>      <td>3</td>      <td>Cassava Mosaic Disease (CMD)</td>    </tr>    <tr>      <th>2</th>      <td>100042118.jpg</td>      <td>1</td>      <td>Cassava Brown Streak Disease (CBSD)</td>    </tr>    <tr>      <th>3</th>      <td>1000723321.jpg</td>      <td>1</td>      <td>Cassava Brown Streak Disease (CBSD)</td>    </tr>    <tr>      <th>4</th>      <td>1000812911.jpg</td>      <td>3</td>      <td>Cassava Mosaic Disease (CMD)</td>    </tr>  </tbody></table></div><pre class="line-numbers language-python" data-language="python"><code class="language-python">df_train<span class="token punctuation">[</span><span class="token string">"class_name_"</span><span class="token punctuation">]</span> <span class="token operator">=</span> df_train<span class="token punctuation">[</span><span class="token string">"label"</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">map</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> label_map<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span>x<span class="token punctuation">]</span><span class="token punctuation">)</span>df_train<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }    .dataframe tbody tr th {        vertical-align: top;    }    .dataframe thead th {        text-align: right;    }</style><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>image_id</th>      <th>label</th>      <th>class_name</th>      <th>class_name_</th>    </tr>  </thead>  <tbody>    <tr>      <th>0</th>      <td>1000015157.jpg</td>      <td>0</td>      <td>Cassava Bacterial Blight (CBB)</td>      <td>Cassava Bacterial Blight (CBB)</td>    </tr>    <tr>      <th>1</th>      <td>1000201771.jpg</td>      <td>3</td>      <td>Cassava Mosaic Disease (CMD)</td>      <td>Cassava Mosaic Disease (CMD)</td>    </tr>    <tr>      <th>2</th>      <td>100042118.jpg</td>      <td>1</td>      <td>Cassava Brown Streak Disease (CBSD)</td>      <td>Cassava Brown Streak Disease (CBSD)</td>    </tr>    <tr>      <th>3</th>      <td>1000723321.jpg</td>      <td>1</td>      <td>Cassava Brown Streak Disease (CBSD)</td>      <td>Cassava Brown Streak Disease (CBSD)</td>    </tr>    <tr>      <th>4</th>      <td>1000812911.jpg</td>      <td>3</td>      <td>Cassava Mosaic Disease (CMD)</td>      <td>Cassava Mosaic Disease (CMD)</td>    </tr>    <tr>      <th>...</th>      <td>...</td>      <td>...</td>      <td>...</td>      <td>...</td>    </tr>    <tr>      <th>21392</th>      <td>999068805.jpg</td>      <td>3</td>      <td>Cassava Mosaic Disease (CMD)</td>      <td>Cassava Mosaic Disease (CMD)</td>    </tr>    <tr>      <th>21393</th>      <td>999329392.jpg</td>      <td>3</td>      <td>Cassava Mosaic Disease (CMD)</td>      <td>Cassava Mosaic Disease (CMD)</td>    </tr>    <tr>      <th>21394</th>      <td>999474432.jpg</td>      <td>1</td>      <td>Cassava Brown Streak Disease (CBSD)</td>      <td>Cassava Brown Streak Disease (CBSD)</td>    </tr>    <tr>      <th>21395</th>      <td>999616605.jpg</td>      <td>4</td>      <td>Healthy</td>      <td>Healthy</td>    </tr>    <tr>      <th>21396</th>      <td>999998473.jpg</td>      <td>4</td>      <td>Healthy</td>      <td>Healthy</td>    </tr>  </tbody></table><p>21397 rows × 4 columns</p></div><ul><li><a href="https://blog.csdn.net/nuaadot/article/details/78304642">pandas的drop函数</a></li></ul><pre class="line-numbers language-python" data-language="python"><code class="language-python">df_train <span class="token operator">=</span> df_train<span class="token punctuation">.</span>drop<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'class_name_'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> axis <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span>df_train<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }    .dataframe tbody tr th {        vertical-align: top;    }    .dataframe thead th {        text-align: right;    }</style><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>image_id</th>      <th>label</th>      <th>class_name</th>    </tr>  </thead>  <tbody>    <tr>      <th>0</th>      <td>1000015157.jpg</td>      <td>0</td>      <td>Cassava Bacterial Blight (CBB)</td>    </tr>    <tr>      <th>1</th>      <td>1000201771.jpg</td>      <td>3</td>      <td>Cassava Mosaic Disease (CMD)</td>    </tr>    <tr>      <th>2</th>      <td>100042118.jpg</td>      <td>1</td>      <td>Cassava Brown Streak Disease (CBSD)</td>    </tr>    <tr>      <th>3</th>      <td>1000723321.jpg</td>      <td>1</td>      <td>Cassava Brown Streak Disease (CBSD)</td>    </tr>    <tr>      <th>4</th>      <td>1000812911.jpg</td>      <td>3</td>      <td>Cassava Mosaic Disease (CMD)</td>    </tr>  </tbody></table></div><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> cv2img_shape <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token keyword">for</span> image_name <span class="token keyword">in</span> os<span class="token punctuation">.</span>listdir<span class="token punctuation">(</span>BASE_DIR <span class="token operator">+</span> <span class="token string">"train_images"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">300</span><span class="token punctuation">]</span><span class="token punctuation">:</span>    image <span class="token operator">=</span> cv2<span class="token punctuation">.</span>imread<span class="token punctuation">(</span>BASE_DIR <span class="token operator">+</span> <span class="token string">"train_images/"</span> <span class="token operator">+</span> image_name<span class="token punctuation">)</span>    img_shape<span class="token punctuation">[</span>image<span class="token punctuation">.</span>shape<span class="token punctuation">]</span> <span class="token operator">=</span> img_shape<span class="token punctuation">.</span>get<span class="token punctuation">(</span>image<span class="token punctuation">.</span>shape<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token keyword">print</span><span class="token punctuation">(</span>img_shape<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token number">600</span><span class="token punctuation">,</span> <span class="token number">800</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token number">300</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">print</span><span class="token punctuation">(</span>image_name<span class="token punctuation">,</span> <span class="token builtin">type</span><span class="token punctuation">(</span>image<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token number">1052903541.</span>jpg <span class="token operator">&lt;</span><span class="token keyword">class</span> <span class="token string">'numpy.ndarray'</span><span class="token operator">&gt;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 使用 cv2 查看图片</span><span class="token comment"># cv2.imshow("figure",image)</span><span class="token comment"># cv2.waitKey(0)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h3 id="字典-get-函数"><a href="#字典-get-函数" class="headerlink" title="字典 get 函数"></a>字典 get 函数</h3><h4 id="描述"><a href="#描述" class="headerlink" title="描述"></a>描述</h4><p>Python 字典 get() 函数返回指定键的值，如果值不在字典中返回默认值。</p><h4 id="语法"><a href="#语法" class="headerlink" title="语法"></a>语法</h4><p>get()方法语法：</p><p>dict.get(key, default=None)</p><h4 id="参数"><a href="#参数" class="headerlink" title="参数"></a>参数</h4><p>key – 字典中要查找的键。</p><p>default – 如果指定键的值不存在时，返回该默认值值。</p><p>返回值 - 返回指定键的值，如果值不在字典中返回默认值 None。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">dict_ <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string">'Name'</span><span class="token punctuation">:</span> <span class="token string">"Terence"</span><span class="token punctuation">,</span> <span class="token string">'Age'</span><span class="token punctuation">:</span> <span class="token number">19</span><span class="token punctuation">}</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Age 的值为"</span><span class="token punctuation">,</span> dict_<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'Age'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Sex 的值为"</span><span class="token punctuation">,</span> dict_<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'Sex'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Sex 的值为"</span><span class="token punctuation">,</span> dict_<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'Sex'</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">Age 的值为 <span class="token number">19</span>Sex 的值为 <span class="token boolean">None</span>Sex 的值为 <span class="token number">0</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h3 id="seaborn-绘制类别分布比例"><a href="#seaborn-绘制类别分布比例" class="headerlink" title="seaborn 绘制类别分布比例"></a>seaborn 绘制类别分布比例</h3><h4 id="seaborn-countplot"><a href="#seaborn-countplot" class="headerlink" title="seaborn.countplot"></a><a href="http://alanpryorjr.com/visualizations/seaborn/countplot/countplot/">seaborn.countplot</a></h4><hr><p>Bar graphs are useful for displaying relationships between categorical data and at least one numerical variable. <code>seaborn.countplot</code> is a barplot where the dependent variable is the number of instances of each instance of the independent variable.</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt<span class="token keyword">import</span> seaborn <span class="token keyword">as</span> snfig<span class="token punctuation">,</span> axes <span class="token operator">=</span> plt<span class="token punctuation">.</span>subplots<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span>sn<span class="token punctuation">.</span>countplot<span class="token punctuation">(</span>y <span class="token operator">=</span> <span class="token string">"class_name"</span><span class="token punctuation">,</span> data <span class="token operator">=</span> df_train<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p><img src="/2021/01/16/cassava-leaf-disease-exploratory-data-analysis/output_19_0.png" alt="png"></p><pre class="line-numbers language-python" data-language="python"><code class="language-python">df_train<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }    .dataframe tbody tr th {        vertical-align: top;    }    .dataframe thead th {        text-align: right;    }</style><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>image_id</th>      <th>label</th>      <th>class_name</th>    </tr>  </thead>  <tbody>    <tr>      <th>0</th>      <td>1000015157.jpg</td>      <td>0</td>      <td>Cassava Bacterial Blight (CBB)</td>    </tr>    <tr>      <th>1</th>      <td>1000201771.jpg</td>      <td>3</td>      <td>Cassava Mosaic Disease (CMD)</td>    </tr>    <tr>      <th>2</th>      <td>100042118.jpg</td>      <td>1</td>      <td>Cassava Brown Streak Disease (CBSD)</td>    </tr>    <tr>      <th>3</th>      <td>1000723321.jpg</td>      <td>1</td>      <td>Cassava Brown Streak Disease (CBSD)</td>    </tr>    <tr>      <th>4</th>      <td>1000812911.jpg</td>      <td>3</td>      <td>Cassava Mosaic Disease (CMD)</td>    </tr>  </tbody></table></div><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token builtin">type</span><span class="token punctuation">(</span>df_train<span class="token punctuation">[</span><span class="token string">"image_id"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token builtin">type</span><span class="token punctuation">(</span>df_train<span class="token punctuation">[</span><span class="token string">"image_id"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>values<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token punctuation">(</span>pandas<span class="token punctuation">.</span>core<span class="token punctuation">.</span>series<span class="token punctuation">.</span>Series<span class="token punctuation">,</span> numpy<span class="token punctuation">.</span>ndarray<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">tmp_df <span class="token operator">=</span> df_train<span class="token punctuation">.</span>sample<span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span>image_ids <span class="token operator">=</span> tmp_df<span class="token punctuation">[</span><span class="token string">"image_id"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>valueslabels <span class="token operator">=</span> tmp_df<span class="token punctuation">[</span><span class="token string">"class_name"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>values<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">for</span> index<span class="token punctuation">,</span> <span class="token punctuation">(</span>image_id<span class="token punctuation">,</span> label<span class="token punctuation">)</span> <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span><span class="token builtin">zip</span><span class="token punctuation">(</span>image_ids<span class="token punctuation">,</span> labels<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>index<span class="token punctuation">,</span> image_id<span class="token punctuation">,</span> label<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token number">0</span> <span class="token number">3594707809.</span>jpg Cassava Mosaic Disease <span class="token punctuation">(</span>CMD<span class="token punctuation">)</span><span class="token number">1</span> <span class="token number">498735095.</span>jpg Cassava Mosaic Disease <span class="token punctuation">(</span>CMD<span class="token punctuation">)</span><span class="token number">2</span> <span class="token number">597389720.</span>jpg Cassava Green Mottle <span class="token punctuation">(</span>CGM<span class="token punctuation">)</span><span class="token number">3</span> <span class="token number">232417860.</span>jpg Cassava Mosaic Disease <span class="token punctuation">(</span>CMD<span class="token punctuation">)</span><span class="token number">4</span> <span class="token number">3969928849.</span>jpg Healthy<span class="token number">5</span> <span class="token number">1111878443.</span>jpg Cassava Mosaic Disease <span class="token punctuation">(</span>CMD<span class="token punctuation">)</span><span class="token number">6</span> <span class="token number">2263743432.</span>jpg Cassava Bacterial Blight <span class="token punctuation">(</span>CBB<span class="token punctuation">)</span><span class="token number">7</span> <span class="token number">965919968.</span>jpg Cassava Bacterial Blight <span class="token punctuation">(</span>CBB<span class="token punctuation">)</span><span class="token number">8</span> <span class="token number">2418850424.</span>jpg Cassava Mosaic Disease <span class="token punctuation">(</span>CMD<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># def visualize_batch_(image_ids, labels):</span><span class="token comment">#     plt.figure(figsize=(16, 12))</span>    <span class="token comment">#     for ind, (image_id, label) in enumerate(zip(image_ids, labels)):</span><span class="token comment">#         plt.subplot(3, 3, ind + 1)</span><span class="token comment">#         image = cv2.imread(os.path.join(BASE_DIR, "train_images", image_id))</span><span class="token comment">#         image = cv2.cvtColor(image, cv2.COLOR_BGR2RGB)</span><span class="token comment">#         plt.imshow(image)</span><span class="token comment">#         plt.title(f"Class: {label}", fontsize=12)</span><span class="token comment">#         plt.axis("off")</span>    <span class="token comment">#     plt.show()</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># visualize_batch_(image_ids, labels)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ax：matplotlib.axes._subplots.AxesSubplot，的基本操作</p><ul><li><code>ax.set_xticks([]), ax_set_yticks([])</code>：关闭坐标刻度</li><li><code>ax.axis('off')</code>：关闭坐标轴</li><li><code>ax.set_title()</code>：设置标题</li></ul><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">visulaize_batch</span><span class="token punctuation">(</span>image_ids<span class="token punctuation">,</span> labels<span class="token punctuation">)</span><span class="token punctuation">:</span>    fig<span class="token punctuation">,</span> axes <span class="token operator">=</span> plt<span class="token punctuation">.</span>subplots<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">for</span> index<span class="token punctuation">,</span> <span class="token punctuation">(</span>image_id<span class="token punctuation">,</span> label<span class="token punctuation">)</span> <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span><span class="token builtin">zip</span><span class="token punctuation">(</span>image_ids<span class="token punctuation">,</span> labels<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token comment"># 下面两个 image 类型一致，都是 &lt;class 'numpy.ndarray'&gt;</span>        image <span class="token operator">=</span> cv2<span class="token punctuation">.</span>imread<span class="token punctuation">(</span>BASE_DIR <span class="token operator">+</span> <span class="token string">"train_images/"</span> <span class="token operator">+</span> image_id<span class="token punctuation">)</span>        <span class="token comment"># print(type(image))</span>        image <span class="token operator">=</span> cv2<span class="token punctuation">.</span>cvtColor<span class="token punctuation">(</span>image<span class="token punctuation">,</span> cv2<span class="token punctuation">.</span>COLOR_BGR2RGB<span class="token punctuation">)</span>        <span class="token comment"># print(type(image))</span>        <span class="token comment"># 这里需要对 axes 进行索引，确定其具体位置，而且必须使用二维索引如：axes[2,1]，而不能是 axes[6]</span>        axes<span class="token punctuation">[</span>index<span class="token operator">//</span><span class="token number">3</span><span class="token punctuation">,</span>index<span class="token operator">%</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">.</span>imshow<span class="token punctuation">(</span>image<span class="token punctuation">)</span>        axes<span class="token punctuation">[</span>index<span class="token operator">//</span><span class="token number">3</span><span class="token punctuation">,</span>index<span class="token operator">%</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">.</span>set_title<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Class: </span><span class="token interpolation"><span class="token punctuation">{</span>label<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">,</span> fontsize <span class="token operator">=</span> <span class="token number">12</span><span class="token punctuation">)</span>        axes<span class="token punctuation">[</span>index<span class="token operator">//</span><span class="token number">3</span><span class="token punctuation">,</span>index<span class="token operator">%</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">.</span>axis<span class="token punctuation">(</span><span class="token string">"off"</span><span class="token punctuation">)</span> <span class="token comment">#去除坐标轴信息</span>    plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">visulaize_batch<span class="token punctuation">(</span>image_ids<span class="token punctuation">,</span> labels<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/2021/01/16/cassava-leaf-disease-exploratory-data-analysis/output_27_0.png" alt="png"></p><h3 id="0-CBB-Cassava-Bacterial-Blight"><a href="#0-CBB-Cassava-Bacterial-Blight" class="headerlink" title="0 - CBB - Cassava Bacterial Blight"></a>0 - CBB - Cassava Bacterial Blight</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python">tmp_df <span class="token operator">=</span> df_train<span class="token punctuation">[</span>df_train<span class="token punctuation">[</span><span class="token string">"label"</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Total train image for class 0(Cassava Bacterial Blight): </span><span class="token interpolation"><span class="token punctuation">{</span>tmp_df<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>tmp_df <span class="token operator">=</span> tmp_df<span class="token punctuation">.</span>sample<span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span>image_ids <span class="token operator">=</span> tmp_df<span class="token punctuation">[</span><span class="token string">"image_id"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>valueslabels <span class="token operator">=</span> tmp_df<span class="token punctuation">[</span><span class="token string">"label"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>valuesvisulaize_batch<span class="token punctuation">(</span>image_ids<span class="token punctuation">,</span> labels<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">Total train image <span class="token keyword">for</span> <span class="token keyword">class</span> <span class="token class-name">0</span><span class="token punctuation">(</span>Cassava Bacterial Blight<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token number">1087</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/2021/01/16/cassava-leaf-disease-exploratory-data-analysis/output_29_1.png" alt="png"></p><h3 id="1-CBSD-Cassava-Brown-Streak-Disease"><a href="#1-CBSD-Cassava-Brown-Streak-Disease" class="headerlink" title="1 - CBSD - Cassava Brown Streak Disease"></a>1 - CBSD - Cassava Brown Streak Disease</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python">tmp_df <span class="token operator">=</span> df_train<span class="token punctuation">[</span>df_train<span class="token punctuation">[</span><span class="token string">"label"</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Total train image for class 1(Cassava Brown Streak Disease): </span><span class="token interpolation"><span class="token punctuation">{</span>tmp_df<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>tmp_df <span class="token operator">=</span> tmp_df<span class="token punctuation">.</span>sample<span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span>image_ids <span class="token operator">=</span> tmp_df<span class="token punctuation">[</span><span class="token string">"image_id"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>valueslabels <span class="token operator">=</span> tmp_df<span class="token punctuation">[</span><span class="token string">"label"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>valuesvisulaize_batch<span class="token punctuation">(</span>image_ids<span class="token punctuation">,</span> labels<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">Total train image <span class="token keyword">for</span> <span class="token keyword">class</span> <span class="token class-name">1</span><span class="token punctuation">(</span>Cassava Brown Streak Disease<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token number">2189</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/2021/01/16/cassava-leaf-disease-exploratory-data-analysis/output_31_1.png" alt="png"></p><h3 id="2-CGM-Cassava-Green-Mottle"><a href="#2-CGM-Cassava-Green-Mottle" class="headerlink" title="2 - CGM - Cassava Green Mottle"></a>2 - CGM - Cassava Green Mottle</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python">tmp_df <span class="token operator">=</span> df_train<span class="token punctuation">[</span>df_train<span class="token punctuation">[</span><span class="token string">"label"</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Total train image for class 2(Cassava Green Mottle): </span><span class="token interpolation"><span class="token punctuation">{</span>tmp_df<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>tmp_df <span class="token operator">=</span> tmp_df<span class="token punctuation">.</span>sample<span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span>image_ids <span class="token operator">=</span> tmp_df<span class="token punctuation">[</span><span class="token string">"image_id"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>valueslabels <span class="token operator">=</span> tmp_df<span class="token punctuation">[</span><span class="token string">"label"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>valuesvisulaize_batch<span class="token punctuation">(</span>image_ids<span class="token punctuation">,</span> labels<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">Total train image <span class="token keyword">for</span> <span class="token keyword">class</span> <span class="token class-name">2</span><span class="token punctuation">(</span>Cassava Green Mottle<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token number">2386</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/2021/01/16/cassava-leaf-disease-exploratory-data-analysis/output_33_1.png" alt="png"></p><h3 id="3-CMD-Cassava-Mosaic-Disease"><a href="#3-CMD-Cassava-Mosaic-Disease" class="headerlink" title="3 - CMD - Cassava Mosaic Disease"></a>3 - CMD - Cassava Mosaic Disease</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python">tmp_df <span class="token operator">=</span> df_train<span class="token punctuation">[</span>df_train<span class="token punctuation">[</span><span class="token string">"label"</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Total train image for class 3(Cassava Mosaic Disease): </span><span class="token interpolation"><span class="token punctuation">{</span>tmp_df<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>tmp_df <span class="token operator">=</span> tmp_df<span class="token punctuation">.</span>sample<span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span>image_ids <span class="token operator">=</span> tmp_df<span class="token punctuation">[</span><span class="token string">"image_id"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>valueslabels <span class="token operator">=</span> tmp_df<span class="token punctuation">[</span><span class="token string">"label"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>valuesvisulaize_batch<span class="token punctuation">(</span>image_ids<span class="token punctuation">,</span> labels<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">Total train image <span class="token keyword">for</span> <span class="token keyword">class</span> <span class="token class-name">3</span><span class="token punctuation">(</span>Cassava Mosaic Disease<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token number">13158</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/2021/01/16/cassava-leaf-disease-exploratory-data-analysis/output_35_1.png" alt="png"></p><h3 id="4-Healthy"><a href="#4-Healthy" class="headerlink" title="4 - Healthy"></a>4 - Healthy</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python">tmp_df <span class="token operator">=</span> df_train<span class="token punctuation">[</span>df_train<span class="token punctuation">[</span><span class="token string">"label"</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">4</span><span class="token punctuation">]</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Total train image for class 4(Healthy): </span><span class="token interpolation"><span class="token punctuation">{</span>tmp_df<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>tmp_df <span class="token operator">=</span> tmp_df<span class="token punctuation">.</span>sample<span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span>image_ids <span class="token operator">=</span> tmp_df<span class="token punctuation">[</span><span class="token string">"image_id"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>valueslabels <span class="token operator">=</span> tmp_df<span class="token punctuation">[</span><span class="token string">"label"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>valuesvisulaize_batch<span class="token punctuation">(</span>image_ids<span class="token punctuation">,</span> labels<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">Total train image <span class="token keyword">for</span> <span class="token keyword">class</span> <span class="token class-name">4</span><span class="token punctuation">(</span>Healthy<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token number">2577</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/2021/01/16/cassava-leaf-disease-exploratory-data-analysis/output_37_1.png" alt="png"></p><h3 id="albumentations数据增强"><a href="#albumentations数据增强" class="headerlink" title="albumentations数据增强"></a>albumentations数据增强</h3><ul><li><a href="https://link.zhihu.com/?target=https%3A//albumentations.readthedocs.io/en/latest/">官方文档 albumentations</a></li></ul><p>albumentations 是一个给予 OpenCV的快速训练数据增强库，拥有非常简单且强大的可以用于多种任务（分割、检测）的接口，易于定制且添加其他框架非常方便。</p><p>它可以对数据集进行逐像素的转换，如模糊、下采样、高斯造点、高斯模糊、动态模糊、RGB 转换、随机雾化等；也可以进行空间转换（同时也会对目标进行转换），如裁剪、翻转、随机裁剪等。</p><p>github 及其示例地址如下：</p><ul><li>GitHub： <a href="https://link.zhihu.com/?target=https%3A//github.com/albumentations-team/albumentations">https://github.com/albumentations-team/albumentations</a></li><li>示例：<a href="https://link.zhihu.com/?target=https%3A//github.com/albumentations-team/albumentations_examples">https://github.com/albumentations-team/albumentations_examples</a></li></ul><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">plot_augmentation</span><span class="token punctuation">(</span>image_id<span class="token punctuation">,</span> transform<span class="token punctuation">)</span><span class="token punctuation">:</span>    fig<span class="token punctuation">,</span> axes <span class="token operator">=</span> plt<span class="token punctuation">.</span>subplots<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    image <span class="token operator">=</span> cv2<span class="token punctuation">.</span>imread<span class="token punctuation">(</span>BASE_DIR <span class="token operator">+</span> <span class="token string">"train_images/"</span> <span class="token operator">+</span> image_id<span class="token punctuation">)</span>    image <span class="token operator">=</span> cv2<span class="token punctuation">.</span>cvtColor<span class="token punctuation">(</span>image<span class="token punctuation">,</span> cv2<span class="token punctuation">.</span>COLOR_BGR2RGB<span class="token punctuation">)</span>    axes<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>imshow<span class="token punctuation">(</span>image<span class="token punctuation">)</span>    axes<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>axis<span class="token punctuation">(</span><span class="token string">"off"</span><span class="token punctuation">)</span>        x <span class="token operator">=</span> transform<span class="token punctuation">(</span>image <span class="token operator">=</span> image<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">"image"</span><span class="token punctuation">]</span>    axes<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>imshow<span class="token punctuation">(</span>x<span class="token punctuation">)</span>    axes<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>axis<span class="token punctuation">(</span><span class="token string">"off"</span><span class="token punctuation">)</span>        x <span class="token operator">=</span> transform<span class="token punctuation">(</span>image <span class="token operator">=</span> image<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">"image"</span><span class="token punctuation">]</span>    axes<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span>imshow<span class="token punctuation">(</span>x<span class="token punctuation">)</span>    axes<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span>axis<span class="token punctuation">(</span><span class="token string">"off"</span><span class="token punctuation">)</span>        plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> albumentations <span class="token keyword">as</span> Atransform_shift_scale_rotate <span class="token operator">=</span> A<span class="token punctuation">.</span>ShiftScaleRotate<span class="token punctuation">(</span>    p <span class="token operator">=</span> <span class="token number">1.0</span><span class="token punctuation">,</span>    shift_limit <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">0.3</span><span class="token punctuation">,</span> <span class="token number">0.3</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    scale_limit <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">0.1</span><span class="token punctuation">,</span> <span class="token number">0.1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    rotate_limit <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">180</span><span class="token punctuation">,</span> <span class="token number">180</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    interpolation <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>    border_mode <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">,</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">df_train<span class="token punctuation">[</span><span class="token string">'image_id'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token builtin">type</span><span class="token punctuation">(</span>df_train<span class="token punctuation">[</span><span class="token string">'image_id'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token punctuation">(</span><span class="token string">'1000015157.jpg'</span><span class="token punctuation">,</span> <span class="token builtin">str</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">plot_augmentation<span class="token punctuation">(</span>df_train<span class="token punctuation">[</span><span class="token string">'image_id'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> transform_shift_scale_rotate<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/2021/01/16/cassava-leaf-disease-exploratory-data-analysis/output_41_0.png" alt="png"></p><pre class="line-numbers language-python" data-language="python"><code class="language-python">transform_coarse_dropout <span class="token operator">=</span> A<span class="token punctuation">.</span>CoarseDropout<span class="token punctuation">(</span>    p<span class="token operator">=</span><span class="token number">1.0</span><span class="token punctuation">,</span>     max_holes<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">,</span>     max_height<span class="token operator">=</span><span class="token number">50</span><span class="token punctuation">,</span>     max_width<span class="token operator">=</span><span class="token number">50</span><span class="token punctuation">,</span>     min_holes<span class="token operator">=</span><span class="token number">30</span><span class="token punctuation">,</span>     min_height<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">,</span>     min_width<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">,</span><span class="token punctuation">)</span>plot_augmentation<span class="token punctuation">(</span>df_train<span class="token punctuation">[</span><span class="token string">'image_id'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> transform_coarse_dropout<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="/2021/01/16/cassava-leaf-disease-exploratory-data-analysis/output_42_0.png" alt="png"></p><pre class="line-numbers language-python" data-language="python"><code class="language-python">transform <span class="token operator">=</span> A<span class="token punctuation">.</span>Compose<span class="token punctuation">(</span>    transforms<span class="token operator">=</span><span class="token punctuation">[</span>        transform_shift_scale_rotate<span class="token punctuation">,</span>        transform_coarse_dropout<span class="token punctuation">,</span>    <span class="token punctuation">]</span><span class="token punctuation">,</span>    p<span class="token operator">=</span><span class="token number">1.0</span><span class="token punctuation">,</span><span class="token punctuation">)</span>plot_augmentation<span class="token punctuation">(</span>df_train<span class="token punctuation">[</span><span class="token string">'image_id'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> transform<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="/2021/01/16/cassava-leaf-disease-exploratory-data-analysis/output_43_0.png" alt="png"></p><h3 id="ResNet50-看聚类"><a href="#ResNet50-看聚类" class="headerlink" title="ResNet50 看聚类"></a>ResNet50 看聚类</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python">df_train<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }    .dataframe tbody tr th {        vertical-align: top;    }    .dataframe thead th {        text-align: right;    }</style><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>image_id</th>      <th>label</th>      <th>class_name</th>    </tr>  </thead>  <tbody>    <tr>      <th>0</th>      <td>1000015157.jpg</td>      <td>0</td>      <td>Cassava Bacterial Blight (CBB)</td>    </tr>    <tr>      <th>1</th>      <td>1000201771.jpg</td>      <td>3</td>      <td>Cassava Mosaic Disease (CMD)</td>    </tr>    <tr>      <th>2</th>      <td>100042118.jpg</td>      <td>1</td>      <td>Cassava Brown Streak Disease (CBSD)</td>    </tr>    <tr>      <th>3</th>      <td>1000723321.jpg</td>      <td>1</td>      <td>Cassava Brown Streak Disease (CBSD)</td>    </tr>    <tr>      <th>4</th>      <td>1000812911.jpg</td>      <td>3</td>      <td>Cassava Mosaic Disease (CMD)</td>    </tr>  </tbody></table></div><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> keras<span class="token punctuation">.</span>preprocessing<span class="token punctuation">.</span>image <span class="token keyword">import</span> load_img<span class="token keyword">from</span> keras<span class="token punctuation">.</span>applications<span class="token punctuation">.</span>resnet50 <span class="token keyword">import</span> preprocess_input<span class="token keyword">def</span> <span class="token function">extract_features</span><span class="token punctuation">(</span>image_id<span class="token punctuation">,</span> model<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token builtin">file</span> <span class="token operator">=</span> BASE_DIR <span class="token operator">+</span> <span class="token string">"train_images/"</span> <span class="token operator">+</span> image_id    <span class="token comment"># load the image as a 224*224 array</span>    img <span class="token operator">=</span> load_img<span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">,</span> target_size<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">224</span><span class="token punctuation">,</span> <span class="token number">224</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token comment"># turn to numpy.array</span>    img <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>img<span class="token punctuation">)</span>    <span class="token comment"># reshape the data for the model shape = (num_of_samples, dim1, dim2, channels)</span>    reshaped_img <span class="token operator">=</span> img<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">224</span><span class="token punctuation">,</span> <span class="token number">224</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>    <span class="token comment"># </span>    imgx <span class="token operator">=</span> preprocess_input<span class="token punctuation">(</span>reshaped_img<span class="token punctuation">)</span>    features <span class="token operator">=</span> model<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>imgx<span class="token punctuation">,</span> use_multiprocessing<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>        <span class="token keyword">return</span> features<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> keras<span class="token punctuation">.</span>applications<span class="token punctuation">.</span>resnet50 <span class="token keyword">import</span> ResNet50<span class="token keyword">from</span> keras<span class="token punctuation">.</span>models <span class="token keyword">import</span> Model<span class="token keyword">from</span> tqdm <span class="token keyword">import</span> tqdmmodel <span class="token operator">=</span> ResNet50<span class="token punctuation">(</span><span class="token punctuation">)</span>model <span class="token operator">=</span> Model<span class="token punctuation">(</span>inputs <span class="token operator">=</span> model<span class="token punctuation">.</span>inputs<span class="token punctuation">,</span> outputs <span class="token operator">=</span> model<span class="token punctuation">.</span>layers<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span>output<span class="token punctuation">)</span>healthy <span class="token operator">=</span> df_train<span class="token punctuation">[</span>df_train<span class="token punctuation">[</span><span class="token string">'label'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">4</span><span class="token punctuation">]</span>healthy<span class="token punctuation">[</span><span class="token string">'features'</span><span class="token punctuation">]</span> <span class="token operator">=</span> healthy<span class="token punctuation">[</span><span class="token string">'image_id'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> extract_features<span class="token punctuation">(</span>x<span class="token punctuation">,</span> model<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token operator">&lt;</span>ipython<span class="token operator">-</span><span class="token builtin">input</span><span class="token operator">-</span><span class="token number">51</span><span class="token operator">-</span>f5196e3b723b<span class="token operator">&gt;</span><span class="token punctuation">:</span><span class="token number">9</span><span class="token punctuation">:</span> SettingWithCopyWarning<span class="token punctuation">:</span> A value <span class="token keyword">is</span> trying to be <span class="token builtin">set</span> on a copy of a <span class="token builtin">slice</span> <span class="token keyword">from</span> a DataFrame<span class="token punctuation">.</span>Try using <span class="token punctuation">.</span>loc<span class="token punctuation">[</span>row_indexer<span class="token punctuation">,</span>col_indexer<span class="token punctuation">]</span> <span class="token operator">=</span> value insteadSee the caveats <span class="token keyword">in</span> the documentation<span class="token punctuation">:</span> https<span class="token punctuation">:</span><span class="token operator">//</span>pandas<span class="token punctuation">.</span>pydata<span class="token punctuation">.</span>org<span class="token operator">/</span>pandas<span class="token operator">-</span>docs<span class="token operator">/</span>stable<span class="token operator">/</span>user_guide<span class="token operator">/</span>indexing<span class="token punctuation">.</span>html<span class="token comment">#returning-a-view-versus-a-copy</span>  healthy<span class="token punctuation">[</span><span class="token string">'features'</span><span class="token punctuation">]</span> <span class="token operator">=</span> healthy<span class="token punctuation">[</span><span class="token string">'image_id'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> extract_features<span class="token punctuation">(</span>x<span class="token punctuation">,</span> model<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">healthy<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><div><style scoped="">    .dataframe tbody tr th:only-of-type {        vertical-align: middle;    }    .dataframe tbody tr th {        vertical-align: top;    }    .dataframe thead th {        text-align: right;    }</style><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>image_id</th>      <th>label</th>      <th>class_name</th>      <th>features</th>    </tr>  </thead>  <tbody>    <tr>      <th>8</th>      <td>1001723730.jpg</td>      <td>4</td>      <td>Healthy</td>      <td>[[0.35207286, 0.0, 1.1103351, 0.009539512, 0.0...</td>    </tr>    <tr>      <th>17</th>      <td>1003442061.jpg</td>      <td>4</td>      <td>Healthy</td>      <td>[[3.8534477, 0.0, 0.06910457, 0.23157704, 0.0,...</td>    </tr>    <tr>      <th>30</th>      <td>100560400.jpg</td>      <td>4</td>      <td>Healthy</td>      <td>[[0.23260176, 0.0028819551, 2.424273, 0.0, 0.0...</td>    </tr>    <tr>      <th>47</th>      <td>1009126931.jpg</td>      <td>4</td>      <td>Healthy</td>      <td>[[3.6958485, 0.1106378, 0.057800114, 0.1620144...</td>    </tr>    <tr>      <th>62</th>      <td>1010806468.jpg</td>      <td>4</td>      <td>Healthy</td>      <td>[[3.0952048, 0.0, 0.0, 0.017503712, 0.0, 0.020...</td>    </tr>    <tr>      <th>...</th>      <td>...</td>      <td>...</td>      <td>...</td>      <td>...</td>    </tr>    <tr>      <th>21367</th>      <td>993984792.jpg</td>      <td>4</td>      <td>Healthy</td>      <td>[[0.8686834, 0.0, 0.04545398, 0.55075073, 0.0,...</td>    </tr>    <tr>      <th>21372</th>      <td>995075067.jpg</td>      <td>4</td>      <td>Healthy</td>      <td>[[0.62431216, 0.0, 0.4463164, 0.11152529, 0.0,...</td>    </tr>    <tr>      <th>21373</th>      <td>995123333.jpg</td>      <td>4</td>      <td>Healthy</td>      <td>[[0.0, 0.0, 0.41213, 0.23793063, 0.0, 0.0, 0.1...</td>    </tr>    <tr>      <th>21395</th>      <td>999616605.jpg</td>      <td>4</td>      <td>Healthy</td>      <td>[[0.26363245, 0.0, 0.008111278, 0.348491, 0.0,...</td>    </tr>    <tr>      <th>21396</th>      <td>999998473.jpg</td>      <td>4</td>      <td>Healthy</td>      <td>[[1.8681935, 0.0, 2.4172454, 0.21481319, 0.0, ...</td>    </tr>  </tbody></table><p>2577 rows × 4 columns</p></div><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>cluster <span class="token keyword">import</span> KMeansfeatures <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>healthy<span class="token punctuation">[</span><span class="token string">'features'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>values<span class="token punctuation">.</span>tolist<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2048</span><span class="token punctuation">)</span>image_ids <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>healthy<span class="token punctuation">[</span><span class="token string">'image_id'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>values<span class="token punctuation">.</span>tolist<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># Clustering</span>kmeans <span class="token operator">=</span> KMeans<span class="token punctuation">(</span>n_clusters<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">,</span>n_jobs<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">22</span><span class="token punctuation">)</span>kmeans<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>features<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">C<span class="token punctuation">:</span>\Users\Administrator\Desktop\Competition_Data_2020\zy\Code\venv\lib\site<span class="token operator">-</span>packages\sklearn\cluster\_kmeans<span class="token punctuation">.</span>py<span class="token punctuation">:</span><span class="token number">938</span><span class="token punctuation">:</span> FutureWarning<span class="token punctuation">:</span> <span class="token string">'n_jobs'</span> was deprecated <span class="token keyword">in</span> version <span class="token number">0.23</span> <span class="token keyword">and</span> will be removed <span class="token keyword">in</span> <span class="token number">0.25</span><span class="token punctuation">.</span>  warnings<span class="token punctuation">.</span>warn<span class="token punctuation">(</span><span class="token string">"'n_jobs' was deprecated in version 0.23 and will be"</span>KMeans<span class="token punctuation">(</span>n_clusters<span class="token operator">=</span><span class="token number">5</span><span class="token punctuation">,</span> n_jobs<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> random_state<span class="token operator">=</span><span class="token number">22</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
      
      
      
        <tags>
            
            <tag> kaggle </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Good Blog Collection</title>
      <link href="2021/01/15/good-blog-collection/"/>
      <url>2021/01/15/good-blog-collection/</url>
      
        <content type="html"><![CDATA[<h1 id="2021-01-15"><a href="#2021-01-15" class="headerlink" title="2021-01-15"></a>2021-01-15</h1><h2 id="知识点"><a href="#知识点" class="headerlink" title="知识点"></a>知识点</h2><h3 id="分类-Classification-：精确率和召回率"><a href="#分类-Classification-：精确率和召回率" class="headerlink" title="分类 (Classification)：精确率和召回率"></a><a href="https://developers.google.com/machine-learning/crash-course/classification/precision-and-recall?hl=zh-cn">分类 (Classification)：精确率和召回率</a></h3><h2 id="工具"><a href="#工具" class="headerlink" title="工具"></a>工具</h2><h3 id="Excalidraw-的一年"><a href="#Excalidraw-的一年" class="headerlink" title="Excalidraw 的一年"></a><a href="https://blog.excalidraw.com/one-year-of-excalidraw/">Excalidraw 的一年</a></h3><p>Excalidraw 是手绘风格的一个在线作图工具，2020年1月发布。本文讲述这个项目一年来的惊人发展。</p><h2 id="资源"><a href="#资源" class="headerlink" title="资源"></a>资源</h2><h3 id="Explained-Visually"><a href="#Explained-Visually" class="headerlink" title="Explained Visually"></a><a href="https://setosa.io/ev/">Explained Visually</a></h3><p>Explained Visually (EV) is an experiment in making hard ideas intuitive inspired the work of Bret Victor’s <a href="http://worrydream.com/ExplorableExplanations/">Explorable Explanations</a>. Sign up to hear about the latest.</p><h3 id="半小时学习-Rust-语言"><a href="#半小时学习-Rust-语言" class="headerlink" title="半小时学习 Rust 语言"></a><a href="https://fasterthanli.me/articles/a-half-hour-to-learn-rust">半小时学习 Rust 语言</a></h3><p>一篇英语长文，详细介绍 Rust 语言的基本知识点。</p><h3 id="Python-软件工程"><a href="#Python-软件工程" class="headerlink" title="Python 软件工程"></a><a href="https://merely-useful.github.io/py-rse/">Python 软件工程</a></h3><p>一本英文的免费书籍，介绍使用 Python 来做实际的软件项目时，需要了解的各种 Linux 知识，比如命令行、Git、Make 等等。</p><p><img src="/2021/01/15/good-blog-collection/QQ截图20210115212816.png" alt=""></p>]]></content>
      
      
      
        <tags>
            
            <tag> blog </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Excalidraw绘图</title>
      <link href="2021/01/15/excalidraw-hui-tu/"/>
      <url>2021/01/15/excalidraw-hui-tu/</url>
      
        <content type="html"><![CDATA[<h1 id="Excalidraw-虚拟白板，用于素描手绘图"><a href="#Excalidraw-虚拟白板，用于素描手绘图" class="headerlink" title="Excalidraw: 虚拟白板，用于素描手绘图"></a>Excalidraw: 虚拟白板，用于素描手绘图</h1><p>Excalidraw是一款非常轻量的<strong>在线白板</strong>工具，可以直接在浏览器打开，轻松绘制具有<strong>手绘风格</strong>的图形。</p><h2 id="工具地址"><a href="#工具地址" class="headerlink" title="工具地址"></a>工具地址</h2><p><a href="https://links.jianshu.com/go?to=https%3A%2F%2Fexcalidraw.com%2F">https://excalidraw.com/</a></p><p><a href="https://github.com/excalidraw">Github</a></p><h2 id="使用样例"><a href="#使用样例" class="headerlink" title="使用样例"></a>使用样例</h2><p>无论是使用 ipad 还是鼠标网页绘制都挺舒服的</p><p><img src="/2021/01/15/excalidraw-hui-tu/QQ图片20210115204838.png" alt=""></p><p>这里给了官网的年度总结，里面有大量图表和样例可以参考，点开图片即可跳转，方便了我们在模板上面修改。</p><p><a href="https://blog.excalidraw.com/one-year-of-excalidraw/">https://blog.excalidraw.com/one-year-of-excalidraw/</a></p><h2 id="中文字体"><a href="#中文字体" class="headerlink" title="中文字体"></a>中文字体</h2><p>不过官网上暂时不支持中文字体手写风格，这里有个链接可以解决这个问题</p><p><a href="https://board.oktangle.com/">中文字体地址</a></p><h2 id="相关资料"><a href="#相关资料" class="headerlink" title="相关资料"></a>相关资料</h2><p><a href="https://www.jianshu.com/p/16d4ea4ff106">Excalidraw：超好用的在线白板</a></p><p><a href="https://zhuanlan.zhihu.com/p/146009375">Excalidraw: 虚拟白板，用于素描手绘图</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> Excalidraw </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2021_1_14 read link</title>
      <link href="2021/01/14/2021-1-14-read-link/"/>
      <url>2021/01/14/2021-1-14-read-link/</url>
      
        <content type="html"><![CDATA[<h2 id="XLA-设备上的-PyTorch"><a href="#XLA-设备上的-PyTorch" class="headerlink" title="XLA 设备上的 PyTorch"></a>XLA 设备上的 PyTorch</h2><p><a href="https://pytorch.apachecn.org/docs/1.4/69.html">https://pytorch.apachecn.org/docs/1.4/69.html</a></p><h2 id="Data-Augmentation-for-Deep-Learning"><a href="#Data-Augmentation-for-Deep-Learning" class="headerlink" title="Data Augmentation for Deep Learning"></a>Data Augmentation for Deep Learning</h2><p><a href="https://towardsdatascience.com/data-augmentation-for-deep-learning-4fe21d1a4eb9">https://towardsdatascience.com/data-augmentation-for-deep-learning-4fe21d1a4eb9</a></p><h2 id="Cassava-Leaf-Disease-Classification"><a href="#Cassava-Leaf-Disease-Classification" class="headerlink" title="Cassava Leaf Disease Classification"></a>Cassava Leaf Disease Classification</h2><p><a href="https://www.kaggle.com/c/cassava-leaf-disease-classification/data">https://www.kaggle.com/c/cassava-leaf-disease-classification/data</a></p><h2 id="Visual-Transformers-Token-based-Image-Representation-and-Processing-for-Computer-Vision"><a href="#Visual-Transformers-Token-based-Image-Representation-and-Processing-for-Computer-Vision" class="headerlink" title="Visual Transformers: Token-based Image Representation and Processing for Computer Vision"></a>Visual Transformers: Token-based Image Representation and Processing for Computer Vision</h2><p><a href="https://arxiv.org/abs/2006.03677">https://arxiv.org/abs/2006.03677</a></p><h2 id="Rock-Paper-Scissors-Programming-Competition"><a href="#Rock-Paper-Scissors-Programming-Competition" class="headerlink" title="Rock Paper Scissors Programming Competition"></a>Rock Paper Scissors Programming Competition</h2><p><a href="http://www.rpscontest.com/">http://www.rpscontest.com/</a></p><h2 id="Using-Machine-Learning-to-Win-at-Rock-Paper-Scissors-with-TensorFlow"><a href="#Using-Machine-Learning-to-Win-at-Rock-Paper-Scissors-with-TensorFlow" class="headerlink" title="Using Machine Learning to Win at Rock-Paper-Scissors with TensorFlow"></a>Using Machine Learning to Win at Rock-Paper-Scissors with TensorFlow</h2><p><a href="https://www.hackster.io/news/using-machine-learning-to-win-at-rock-paper-scissors-with-tensorflow-202dbb424b7e">https://www.hackster.io/news/using-machine-learning-to-win-at-rock-paper-scissors-with-tensorflow-202dbb424b7e</a></p><h2 id="markov-v13-ensemble"><a href="#markov-v13-ensemble" class="headerlink" title="markov_v13_ensemble"></a>markov_v13_ensemble</h2><p><a href="http://www.rpscontest.com/entry/5724402004000768">http://www.rpscontest.com/entry/5724402004000768</a></p><h2 id="如何赢得超过-70-的比赛在摇滚纸剪刀"><a href="#如何赢得超过-70-的比赛在摇滚纸剪刀" class="headerlink" title="如何赢得超过 70%的比赛在摇滚纸剪刀"></a>如何赢得超过 70%的比赛在摇滚纸剪刀</h2><p><a href="https://towardsdatascience.com/how-to-win-over-70-matches-in-rock-paper-scissors-3e17e67e0dab">https://towardsdatascience.com/how-to-win-over-70-matches-in-rock-paper-scissors-3e17e67e0dab</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> link </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Cassava Leaf Disease Classification</title>
      <link href="2021/01/14/cassava-leaf-disease-classification/"/>
      <url>2021/01/14/cassava-leaf-disease-classification/</url>
      
        <content type="html"><![CDATA[<h2 id="Description"><a href="#Description" class="headerlink" title="Description"></a>Description</h2><p>As the second-largest provider of carbohydrates in Africa, cassava is a key food security crop grown by smallholder farmers because it can withstand harsh conditions. At least 80% of household farms in Sub-Saharan Africa grow this starchy root, but viral diseases are major sources of poor yields. With the help of data science, it may be possible to identify common diseases so they can be treated.</p><p>Existing methods of disease detection require farmers to solicit the help of government-funded agricultural experts to visually inspect and diagnose the plants. This suffers from being labor-intensive, low-supply and costly. As an added challenge, effective solutions for farmers must perform well under significant constraints, since African farmers may only have access to mobile-quality cameras with low-bandwidth.</p><p>In this competition, we introduce a dataset of 21,367 labeled images collected during a regular survey in Uganda. Most images were crowdsourced from farmers taking photos of their gardens, and annotated by experts at the National Crops Resources Research Institute (NaCRRI) in collaboration with the AI lab at Makerere University, Kampala. This is in a format that most realistically represents what farmers would need to diagnose in real life.</p><p>Your task is to classify each cassava image into four disease categories or a fifth category indicating a healthy leaf. With your help, farmers may be able to quickly identify diseased plants, potentially saving their crops before they inflict irreparable damage.</p><h2 id="idea"><a href="#idea" class="headerlink" title="idea"></a>idea</h2><ol><li><p>图像分类识别方法</p></li><li><p>要做数据增强</p></li></ol>]]></content>
      
      
      
        <tags>
            
            <tag> kaggle </tag>
            
            <tag> Picture Classification </tag>
            
            <tag> data science </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>jupyter code 和 Markdown 之间切换</title>
      <link href="2021/01/14/jupyter-code-he-markdown-zhi-jian-qie-huan/"/>
      <url>2021/01/14/jupyter-code-he-markdown-zhi-jian-qie-huan/</url>
      
        <content type="html"><![CDATA[<h1 id="jupyter-code-和-Markdown-之间切换"><a href="#jupyter-code-和-Markdown-之间切换" class="headerlink" title="jupyter code 和 Markdown 之间切换"></a>jupyter code 和 Markdown 之间切换</h1><p>今天使用 jupyter 完成代码任务时，想着写好直接导出成 md 格式，然后发布到自己的博客上。最开始使用鼠标不断切换 code 和 markdown 格式，效率低下，于是寻找和总结两者切换快捷键和 jupyter 内置的其他快捷键。</p><h2 id="Command-mode-使用"><a href="#Command-mode-使用" class="headerlink" title="Command mode 使用"></a>Command mode 使用</h2><h3 id="两种模式"><a href="#两种模式" class="headerlink" title="两种模式"></a>两种模式</h3><p>jupyter notebook 编辑器每个cell是有两种模式的，分别是 <code>Command mode</code> 和 <code>Edit mode</code> ，我们可以使用快捷键切换</p><pre class="line-numbers language-none"><code class="language-none">Command mode 和 Edit mode。 在一个cell中，按下Enter,进入Edit模式，按下Esc,进入Command 模式<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>也可以使用cell颜色区分，蓝色处于命令模式，绿色处于编辑模式</p><ul><li>蓝色（Command mode)</li></ul><p><img src="/2021/01/14/jupyter-code-he-markdown-zhi-jian-qie-huan/QQ截图20210114193534.png" alt=""></p><ul><li>绿色（Edit mode)</li></ul><p><img src="/2021/01/14/jupyter-code-he-markdown-zhi-jian-qie-huan/QQ截图20210114193614.png" alt=""></p><p>很多快捷键也都是在 Command mode 下操作，因为都进入编辑模式了就只能专心写文档和 code 了。</p><h3 id="运行当前cell，并移动到下一个Cell"><a href="#运行当前cell，并移动到下一个Cell" class="headerlink" title="运行当前cell，并移动到下一个Cell"></a>运行当前cell，并移动到下一个Cell</h3><pre class="line-numbers language-none"><code class="language-none">在一个cell中（在command模式下）,  Shift + Enter  <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="创建Cell"><a href="#创建Cell" class="headerlink" title="创建Cell"></a>创建Cell</h3><pre class="line-numbers language-none"><code class="language-none">在一个cell中（在command模式下）1. 按下 a ,即可在这个cell之前创建一个新的cell；2. 按下 b,即可在这个cell之后创建一个新的cell;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h3 id="Cell中-Code-和-Markdown的切换"><a href="#Cell中-Code-和-Markdown的切换" class="headerlink" title="Cell中 Code 和 Markdown的切换"></a>Cell中 Code 和 Markdown的切换</h3><pre class="line-numbers language-none"><code class="language-none">在一个cell中（在command模式下）1. 按下 y, 进入Code;2. 按下m, 进入Markdown;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h3 id="显示Cell中的行数"><a href="#显示Cell中的行数" class="headerlink" title="显示Cell中的行数"></a>显示Cell中的行数</h3><pre class="line-numbers language-none"><code class="language-none">在一个cell中（在command模式下），按下 l<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="删除Cell"><a href="#删除Cell" class="headerlink" title="删除Cell"></a>删除Cell</h3><pre class="line-numbers language-none"><code class="language-none">在一个cell中（在command模式下）, 按两次 d<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="保存Notebook"><a href="#保存Notebook" class="headerlink" title="保存Notebook"></a>保存Notebook</h3><pre class="line-numbers language-none"><code class="language-none">在一个cell中（在command模式下）, 按下 s<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="启动命令面板"><a href="#启动命令面板" class="headerlink" title="启动命令面板"></a>启动命令面板</h3><pre class="line-numbers language-none"><code class="language-none">在一个cell中（在command模式下）, 按下 Ctrl + Shift + P 界面中的小键盘也可以启动：<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p><img src="/2021/01/14/jupyter-code-he-markdown-zhi-jian-qie-huan/QQ图片20210114194502.png" alt=""></p><h2 id="Markdown简单操作记录"><a href="#Markdown简单操作记录" class="headerlink" title="Markdown简单操作记录"></a>Markdown简单操作记录</h2><h3 id="笔记模式"><a href="#笔记模式" class="headerlink" title="笔记模式"></a><strong>笔记模式</strong></h3><p>按m键进入</p><h3 id="markdown笔记换行"><a href="#markdown笔记换行" class="headerlink" title="markdown笔记换行"></a><strong>markdown笔记换行</strong></h3><p>两个 <code>enter</code></p><h3 id="引用："><a href="#引用：" class="headerlink" title="引用："></a><strong>引用：</strong></h3><p>&gt;（开头有一个灰色竖杠 ）</p><blockquote><p>我是引用</p></blockquote><h3 id="代码块"><a href="#代码块" class="headerlink" title="代码块"></a>代码块</h3><p>```</p><p>int a = 0 ;</p><p>System.out.println(“Hello”) ;</p><p>```</p><h3 id="标题"><a href="#标题" class="headerlink" title="标题"></a><strong>标题</strong></h3><p># 这是一级标题</p><p>## 这是二级标题</p><p>### 这是三级标题</p><h3 id="分割线"><a href="#分割线" class="headerlink" title="分割线"></a><strong>分割线</strong></h3><p>三个或者三个以上的 - 或者 * 都可以</p><h3 id="超链接"><a href="#超链接" class="headerlink" title="超链接"></a><strong>超链接</strong></h3><p>[超链接名] (超链接地址 “超链接title”)</p><p>[百度] (<a href="https://link.zhihu.com/?target=http%3A//baidu.com/">http://baidu.com</a>) （注意！[]与()之间没有空格）</p><h3 id="相关资料"><a href="#相关资料" class="headerlink" title="相关资料"></a>相关资料</h3><p><a href="https://blog.csdn.net/qq_35423500/article/details/79565146">jupyter code和markdown转换</a></p><p><a href="https://zhuanlan.zhihu.com/p/248829147">jupyter notebook常用markdown小技巧</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> jupyter </tag>
            
            <tag> markdown </tag>
            
            <tag> trick </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Task2 论文作者统计</title>
      <link href="2021/01/14/task2-lun-wen-zuo-zhe-tong-ji/"/>
      <url>2021/01/14/task2-lun-wen-zuo-zhe-tong-ji/</url>
      
        <content type="html"><![CDATA[<h2 id="任务说明"><a href="#任务说明" class="headerlink" title="任务说明"></a>任务说明</h2><ul><li>任务主题：论文作者统计，统计所有论文作者出现评率Top10的姓名；</li><li>任务内容：论文作者的统计、使用 <strong>Pandas</strong> 读取数据并使用字符串操作；</li><li>任务成果：学习 <strong>Pandas</strong> 的字符串操作；</li></ul><h2 id="数据处理步骤"><a href="#数据处理步骤" class="headerlink" title="数据处理步骤"></a>数据处理步骤</h2><p>在原始arxiv数据集中论文作者<code>authors</code>字段是一个字符串格式，其中每个作者使用逗号进行分隔分，所以我们我们首先需要完成以下步骤：</p><ul><li>使用逗号对作者进行切分；</li><li>剔除单个作者中非常规的字符；</li></ul><p>具体操作可以参考以下例子：</p><pre class="line-numbers language-none"><code class="language-none">C. Bal\\'azs, E. L. Berger, P. M. Nadolsky, C.-P. Yuan# 切分为，其中\\为转义符C. Ba'lazsE. L. BergerP. M. NadolskyC.-P. Yuan<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>当然在原始数据集中<code>authors_parsed</code>字段已经帮我们处理好了作者信息，可以直接使用该字段完成后续统计。</p><h2 id="具体代码实现"><a href="#具体代码实现" class="headerlink" title="具体代码实现"></a>具体代码实现</h2><h3 id="一、数据读取"><a href="#一、数据读取" class="headerlink" title="一、数据读取"></a>一、数据读取</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 导入所需的package</span><span class="token keyword">import</span> seaborn <span class="token keyword">as</span> sns <span class="token comment">#用于画图</span><span class="token keyword">from</span> bs4 <span class="token keyword">import</span> BeautifulSoup <span class="token comment">#用于爬取arxiv的数据</span><span class="token keyword">import</span> re <span class="token comment">#用于正则表达式，匹配字符串的模式</span><span class="token keyword">import</span> requests <span class="token comment">#用于网络连接，发送网络请求，使用域名获取对应信息</span><span class="token keyword">import</span> json <span class="token comment">#读取数据，我们的数据为json格式的</span><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd <span class="token comment">#数据处理，数据分析</span><span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt <span class="token comment">#画图工具</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">readArxivFile</span><span class="token punctuation">(</span>path<span class="token punctuation">,</span> columns<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">,</span> <span class="token string">'submitter'</span><span class="token punctuation">,</span> <span class="token string">'authors'</span><span class="token punctuation">,</span> <span class="token string">'title'</span><span class="token punctuation">,</span> <span class="token string">'comments'</span><span class="token punctuation">,</span> <span class="token string">'journal-ref'</span><span class="token punctuation">,</span> <span class="token string">'doi'</span><span class="token punctuation">,</span>       <span class="token string">'report-no'</span><span class="token punctuation">,</span> <span class="token string">'categories'</span><span class="token punctuation">,</span> <span class="token string">'license'</span><span class="token punctuation">,</span> <span class="token string">'abstract'</span><span class="token punctuation">,</span> <span class="token string">'versions'</span><span class="token punctuation">,</span>       <span class="token string">'update_date'</span><span class="token punctuation">,</span> <span class="token string">'authors_parsed'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> count<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">'''    定义读取文件的函数        path: 文件路径        columns: 需要选择的列        count: 读取行数    '''</span>        data  <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>path<span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>         <span class="token keyword">for</span> idx<span class="token punctuation">,</span> line <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>f<span class="token punctuation">)</span><span class="token punctuation">:</span>             <span class="token keyword">if</span> idx <span class="token operator">==</span> count<span class="token punctuation">:</span>                <span class="token keyword">break</span>                            d <span class="token operator">=</span> json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>line<span class="token punctuation">)</span>            d <span class="token operator">=</span> <span class="token punctuation">{</span>col <span class="token punctuation">:</span> d<span class="token punctuation">[</span>col<span class="token punctuation">]</span> <span class="token keyword">for</span> col <span class="token keyword">in</span> columns<span class="token punctuation">}</span>            data<span class="token punctuation">.</span>append<span class="token punctuation">(</span>d<span class="token punctuation">)</span>    data <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>data<span class="token punctuation">)</span>    <span class="token keyword">return</span> datadata <span class="token operator">=</span> readArxivFile<span class="token punctuation">(</span><span class="token string">'../data/arxiv-metadata-oai-snapshot.json'</span><span class="token punctuation">,</span>                      <span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">,</span> <span class="token string">'authors'</span><span class="token punctuation">,</span> <span class="token string">'categories'</span><span class="token punctuation">,</span> <span class="token string">'authors_parsed'</span><span class="token punctuation">]</span>                    <span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="二、数据统计"><a href="#二、数据统计" class="headerlink" title="二、数据统计"></a>二、数据统计</h3><p>接下来我们将对CV领域的论文完成以下统计操作：</p><ul><li>统计所有作者姓名出现频率的Top10；</li><li>统计所有作者姓（姓名最后一个单词）的出现频率的Top10；</li><li>统计所有作者姓第一个字符的评率；</li></ul><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token string">'cs.CV'</span> <span class="token keyword">in</span> data<span class="token punctuation">[</span><span class="token string">'categories'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token boolean">False</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 选择类别为cs.CV下面的论文</span>data_cv <span class="token operator">=</span> data<span class="token punctuation">[</span>data<span class="token punctuation">[</span><span class="token string">'categories'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> <span class="token string">'cs.CV'</span> <span class="token keyword">in</span> x<span class="token punctuation">)</span><span class="token punctuation">]</span>data_cv<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>id</th>      <th>authors</th>      <th>categories</th>      <th>authors_parsed</th>    </tr>  </thead>  <tbody>    <tr>      <th>1266</th>      <td>0704.1267</td>      <td>Laurence Likforman-Sulem, Abderrazak Zahour, B...</td>      <td>cs.CV</td>      <td>[[Likforman-Sulem, Laurence, ], [Zahour, Abder...</td>    </tr>    <tr>      <th>3634</th>      <td>0704.3635</td>      <td>Fulufhelo Vincent Nelwamondo and Tshilidzi Mar...</td>      <td>cs.CV cs.IR</td>      <td>[[Nelwamondo, Fulufhelo Vincent, ], [Marwala, ...</td>    </tr>    <tr>      <th>4201</th>      <td>0705.0199</td>      <td>Erik Berglund, Joaquin Sitte</td>      <td>cs.NE cs.AI cs.CV</td>      <td>[[Berglund, Erik, ], [Sitte, Joaquin, ]]</td>    </tr>    <tr>      <th>4216</th>      <td>0705.0214</td>      <td>Mourad Zerai, Maher Moakher</td>      <td>cs.CV</td>      <td>[[Zerai, Mourad, ], [Moakher, Maher, ]]</td>    </tr>    <tr>      <th>4451</th>      <td>0705.0449</td>      <td>Pierre-Fran\c{c}ois Marteau (VALORIA), Gilbas ...</td>      <td>cs.CV</td>      <td>[[Marteau, Pierre-François, , VALORIA], [Ménie...</td>    </tr>  </tbody></table><h4 id="补充：apply-函数使用"><a href="#补充：apply-函数使用" class="headerlink" title="补充：apply 函数使用"></a>补充：apply 函数使用</h4><p><code>apply</code> 方法常用于 <code>DataFrame</code> 的行迭代或者列迭代，它的 <code>axis</code> 含义与第2小节中的统计聚合函数一致， <code>apply</code> 的参数往往是一个以序列为输入的函数。例如对于 <code>.mean()</code> ，使用 <code>apply</code> 可以如下地写出：</p><pre class="line-numbers language-none"><code class="language-none">In [88]: df_demo = df[['Height', 'Weight']]In [89]: def my_mean(x):   ....:     res = x.mean()   ....:     return res   ....: In [90]: df_demo.apply(my_mean)Out[90]: Height    163.218033Weight     55.015873dtype: float64<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>同样的，可以利用 <code>lambda</code> 表达式使得书写简洁，这里的 <code>x</code> 就指代被调用的 <code>df_demo</code> 表中逐个输入的序列：</p><pre class="line-numbers language-none"><code class="language-none">In [91]: df_demo.apply(lambda x:x.mean())Out[91]: Height    163.218033Weight     55.015873dtype: float64<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>若指定 <code>axis=1</code> ，那么每次传入函数的就是行元素组成的 <code>Series</code> ，其结果与之前的逐行均值结果一致。</p><pre class="line-numbers language-none"><code class="language-none">In [92]: df_demo.apply(lambda x:x.mean(), axis=1).head()Out[92]: 0    102.451    118.252    138.953     41.004    124.00dtype: float64<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>这里再举一个例子： <code>mad</code> 函数返回的是一个序列中偏离该序列均值的绝对值大小的均值，例如序列1,3,7,10中，均值为5.25，每一个元素偏离的绝对值为4.25,2.25,1.75,4.75，这个偏离序列的均值为3.25。现在利用 <code>apply</code> 计算升高和体重的 <code>mad</code> 指标：</p><pre class="line-numbers language-none"><code class="language-none">In [93]: df_demo.apply(lambda x:(x-x.mean()).abs().mean())Out[93]: Height     6.707229Weight    10.391870dtype: float64<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>这与使用内置的 <code>mad</code> 函数计算结果一致：</p><pre class="line-numbers language-none"><code class="language-none">In [94]: df_demo.mad()Out[94]: Height     6.707229Weight    10.391870dtype: float64<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>谨慎使用 <code>apply</code></p><blockquote><p>得益于传入自定义函数的处理， <code>apply</code> 的自由度很高，但这是以性能为代价的。一般而言，使用 <code>pandas</code> 的内置函数处理和 <code>apply</code> 来处理同一个任务，其速度会相差较多，因此只有在确实存在自定义需求的情境下才考虑使用 <code>apply</code> 。</p></blockquote><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 查看数据信息type</span>data_cv<span class="token punctuation">[</span><span class="token string">'authors_parsed'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1266</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'Likforman-Sulem'</span><span class="token punctuation">,</span> <span class="token string">'Laurence'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'Zahour'</span><span class="token punctuation">,</span> <span class="token string">'Abderrazak'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'Taconet'</span><span class="token punctuation">,</span> <span class="token string">'Bruno'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">data_cv<span class="token punctuation">[</span><span class="token string">'authors_parsed'</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token number">1266</span>       <span class="token punctuation">[</span><span class="token punctuation">[</span>Likforman<span class="token operator">-</span>Sulem<span class="token punctuation">,</span> Laurence<span class="token punctuation">,</span> <span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>Zahour<span class="token punctuation">,</span> Abder<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token number">3634</span>       <span class="token punctuation">[</span><span class="token punctuation">[</span>Nelwamondo<span class="token punctuation">,</span> Fulufhelo Vincent<span class="token punctuation">,</span> <span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>Marwala<span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token number">4201</span>                <span class="token punctuation">[</span><span class="token punctuation">[</span>Berglund<span class="token punctuation">,</span> Erik<span class="token punctuation">,</span> <span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>Sitte<span class="token punctuation">,</span> Joaquin<span class="token punctuation">,</span> <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token number">4216</span>                 <span class="token punctuation">[</span><span class="token punctuation">[</span>Zerai<span class="token punctuation">,</span> Mourad<span class="token punctuation">,</span> <span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>Moakher<span class="token punctuation">,</span> Maher<span class="token punctuation">,</span> <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token number">4451</span>       <span class="token punctuation">[</span><span class="token punctuation">[</span>Marteau<span class="token punctuation">,</span> Pierre<span class="token operator">-</span>François<span class="token punctuation">,</span> <span class="token punctuation">,</span> VALORIA<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>Ménie<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>                                 <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>                        <span class="token number">1766277</span>    <span class="token punctuation">[</span><span class="token punctuation">[</span>Napoletani<span class="token punctuation">,</span> D<span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>Struppa<span class="token punctuation">,</span> D<span class="token punctuation">.</span> C<span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>Saue<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token number">1769100</span>                                 <span class="token punctuation">[</span><span class="token punctuation">[</span>Kouzaev<span class="token punctuation">,</span> G<span class="token punctuation">.</span> A<span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token number">1773553</span>    <span class="token punctuation">[</span><span class="token punctuation">[</span>Costa<span class="token punctuation">,</span> Luciano da Fontoura<span class="token punctuation">,</span> <span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>Rocha<span class="token punctuation">,</span> Ferna<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token number">1774727</span>    <span class="token punctuation">[</span><span class="token punctuation">[</span>Santos<span class="token punctuation">,</span> C<span class="token punctuation">.</span> Costa<span class="token punctuation">,</span> <span class="token punctuation">,</span> Univ<span class="token punctuation">.</span> Porto<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>Bernardes<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token number">1793806</span>    <span class="token punctuation">[</span><span class="token punctuation">[</span>Vlasov<span class="token punctuation">,</span> Alexander Yu<span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token punctuation">,</span> FCR<span class="token operator">/</span>IRH<span class="token punctuation">,</span> St<span class="token punctuation">.</span><span class="token operator">-</span>Peters<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>Name<span class="token punctuation">:</span> authors_parsed<span class="token punctuation">,</span> Length<span class="token punctuation">:</span> <span class="token number">48909</span><span class="token punctuation">,</span> dtype<span class="token punctuation">:</span> <span class="token builtin">object</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 拼接所有作者</span>all_cv_authors <span class="token operator">=</span> <span class="token builtin">sum</span><span class="token punctuation">(</span>data_cv<span class="token punctuation">[</span><span class="token string">'authors_parsed'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>all_cv_authors<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'Likforman-Sulem'</span><span class="token punctuation">,</span> <span class="token string">'Laurence'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'Zahour'</span><span class="token punctuation">,</span> <span class="token string">'Abderrazak'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'Taconet'</span><span class="token punctuation">,</span> <span class="token string">'Bruno'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'Nelwamondo'</span><span class="token punctuation">,</span> <span class="token string">'Fulufhelo Vincent'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'Marwala'</span><span class="token punctuation">,</span> <span class="token string">'Tshilidzi'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="补充：sum-函数使用"><a href="#补充：sum-函数使用" class="headerlink" title="补充：sum 函数使用"></a>补充：sum 函数使用</h4><p>python内置函数sum(iterable[, start])，当参数iterable为一个二维list，参数start为’[]’，可以达成类似numpy.chararray.flatten的效果。这时候该如何理解sum函数的运行过程呢？</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">d <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token builtin">sum</span><span class="token punctuation">(</span>d<span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h5 id="理解思路一"><a href="#理解思路一" class="headerlink" title="理解思路一"></a>理解思路一</h5><p>sum(iterable[, start]) 就是求一个可迭代对象（iterable）的和，start 参数是可选的，start 就是求这个和之前的初值。比如，对于一个列表（可迭代对象） li = [1, 2, 3, 4]，sum(li) 就等于 10；如果指定一个初值，比如 5，那么 sum(li, 5) 就等于 5 + sum(li)，就是 15。对于你的例子，列表 d = [[1, 2], [3, 4], [5, 6]]，那么 sum(d) 就是 [1, 2] + [3, 4] + [5, 6]，也就是 [1, 2, 3, 4, 5, 6]；sum(d, []) 显然就是 [] + [1, 2] + [3, 4] + [5, 6]，结果还是 [1, 2, 3, 4, 5, 6]；如果你修改第二个参数，变为 sum(d, [9])，那么结果就是 [9, 1, 2, 3, 4, 5, 6]</p><h5 id="理解思路二"><a href="#理解思路二" class="headerlink" title="理解思路二"></a>理解思路二</h5><p>思路一讲得很对，这边举例详细说明一下。<br>如下为help(sum)解释</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token builtin">help</span><span class="token punctuation">(</span><span class="token builtin">sum</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">Help on built<span class="token operator">-</span><span class="token keyword">in</span> function <span class="token builtin">sum</span> <span class="token keyword">in</span> module builtins<span class="token punctuation">:</span><span class="token builtin">sum</span><span class="token punctuation">(</span>iterable<span class="token punctuation">,</span> <span class="token operator">/</span><span class="token punctuation">,</span> start<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span>    Return the <span class="token builtin">sum</span> of a <span class="token string">'start'</span> value <span class="token punctuation">(</span>default<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">)</span> plus an iterable of numbers        When the iterable <span class="token keyword">is</span> empty<span class="token punctuation">,</span> <span class="token keyword">return</span> the start value<span class="token punctuation">.</span>    This function <span class="token keyword">is</span> intended specifically <span class="token keyword">for</span> use <span class="token keyword">with</span> numeric values <span class="token keyword">and</span> may    reject non<span class="token operator">-</span>numeric types<span class="token punctuation">.</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>​    </p><p>主要这句话Return the sum of a ‘start’ value (default: 0) plus an iterable of numbers，简单就是返回起始值start和迭代器每个元素累加的结果，而起始值默认为0。<br>举例说明：</p><blockquote><p>a=[1,2,3]<br>sum(a) # 计算结果是sum(a) = 0 + 1 + 2 + 3， 起始start默认为0，是整数，加法没问题<br>sum(a, start=100) # sum(a, start=100) = 100 + 1 + 2 + 3， start变量也可以人为设置，此时为100，运算没问题</p></blockquote><p>如果是二维list，如[[1,2,3],[4,5,6]], 这时迭代器每个元素均为list，这些元素作加法时start不能再使用默认整数类型值0了，因为整数和list无法做加法运算,即1+[1,2,3]+[4,5,6]运算是错误的，此时需要设置起始变量也为list类型，如start=[],如下：</p><blockquote><p>a=[[1,2,3], [4, 5, 6]]<br>sum(a) # 这样写是错误的，sum(a) = 0 + [1,2,3] + [4, 5, 6] ,0无法和列表做加法运算<br>sum(a, start=[]) # 正确, sum(a, []) = [] + [1,2,3] + [4,5,6] = [1,2,3,4,5,6] ,这样才对<br>sum(a, start=[1,2,3]) # 正确, sum(a, [1,2,3]) = [1,2,3] + [1,2,3] + [4,5,6] = [1,2,3,1,2,3,4,5,6] ,也可以这样</p></blockquote><pre class="line-numbers language-python" data-language="python"><code class="language-python">all_cv_authors_ <span class="token operator">=</span> <span class="token builtin">sum</span><span class="token punctuation">(</span>data_cv<span class="token punctuation">[</span><span class="token string">'authors_parsed'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>all_cv_authors_<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span>TypeError                                 Traceback <span class="token punctuation">(</span>most recent call last<span class="token punctuation">)</span><span class="token operator">&lt;</span>ipython<span class="token operator">-</span><span class="token builtin">input</span><span class="token operator">-</span><span class="token number">11</span><span class="token operator">-</span><span class="token number">40c6e30daeee</span><span class="token operator">&gt;</span> <span class="token keyword">in</span> <span class="token operator">&lt;</span>module<span class="token operator">&gt;</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token number">1</span> all_cv_authors_ <span class="token operator">=</span> <span class="token builtin">sum</span><span class="token punctuation">(</span>data_cv<span class="token punctuation">[</span><span class="token string">'authors_parsed'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>      <span class="token number">2</span> all_cv_authors_<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">TypeError<span class="token punctuation">:</span> unsupported operand <span class="token builtin">type</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token keyword">for</span> <span class="token operator">+</span><span class="token punctuation">:</span> <span class="token string">'int'</span> <span class="token keyword">and</span> <span class="token string">'list'</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">a <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">]</span>b <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token builtin">sum</span><span class="token punctuation">(</span>a<span class="token operator">+</span>b<span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h5 id="结论"><a href="#结论" class="headerlink" title="结论"></a>结论</h5><p>使用sum做加法运算，start的值和迭代器中元素做加法运算，需要满足加法运算要求。按照上面的示例，二维list使用sum可以实现多个list的拼接(其实使用numpy也很方便)。如果遇到其他各种类型迭代器，只要按照定义展开就能轻松搞定内部机理，同时要记得设置start变量的值和迭代器元素类型相同哟！！！，不相同也可以，必须可以做加法运算，C++叫重载。</p><h3 id="三、数据可视化"><a href="#三、数据可视化" class="headerlink" title="三、数据可视化"></a>三、数据可视化</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token builtin">len</span><span class="token punctuation">(</span>cv_authors_names<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token number">205345</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 拼接所有的作者</span>cv_authors_names <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">' '</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token keyword">for</span> x <span class="token keyword">in</span> all_cv_authors<span class="token punctuation">]</span>cv_authors_names <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>cv_authors_names<span class="token punctuation">)</span>cv_authors_names<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>0</th>    </tr>  </thead>  <tbody>    <tr>      <th>0</th>      <td>Likforman-Sulem Laurence</td>    </tr>    <tr>      <th>1</th>      <td>Zahour Abderrazak</td>    </tr>    <tr>      <th>2</th>      <td>Taconet Bruno</td>    </tr>    <tr>      <th>3</th>      <td>Nelwamondo Fulufhelo Vincent</td>    </tr>    <tr>      <th>4</th>      <td>Marwala Tshilidzi</td>    </tr>  </tbody></table><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 展示排名前十的数据</span>cv_authors_names<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>value_counts<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">Shen Chunhua        <span class="token number">239</span>Van Gool Luc        <span class="token number">207</span>Tao Dacheng         <span class="token number">168</span>Zhang Lei           <span class="token number">161</span>Navab Nassir        <span class="token number">152</span>Lin Liang           <span class="token number">143</span>Darrell Trevor      <span class="token number">143</span>Wang Xiaogang       <span class="token number">138</span>Yang Ming<span class="token operator">-</span>Hsuan     <span class="token number">137</span>Feng Jiashi         <span class="token number">134</span>Name<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span> dtype<span class="token punctuation">:</span> int64<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 根据作者频率绘制直方图</span>fig<span class="token punctuation">,</span> axes <span class="token operator">=</span> plt<span class="token punctuation">.</span>subplots<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span>cv_authors_names<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>value_counts<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">.</span>plot<span class="token punctuation">(</span>kind<span class="token operator">=</span><span class="token string">'barh'</span><span class="token punctuation">)</span><span class="token comment"># 修改图的配置</span>plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">'Author'</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">'Count'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="/2021/01/14/task2-lun-wen-zuo-zhe-tong-ji/output_33_1.png" alt="png"></p><p>给出几位的巨巨巨巨巨佬的Google Scholar链接</p><ul><li>Chunhua Shen：<a href="https://scholar.google.com/citations?user=Ljk2BvIAAAAJ&amp;hl=zh-CN">https://scholar.google.com/citations?user=Ljk2BvIAAAAJ&amp;hl=zh-CN</a></li><li>Luc Van Gool：<a href="https://scholar.google.com/citations?user=TwMib_QAAAAJ&amp;hl=zh-CN">https://scholar.google.com/citations?user=TwMib_QAAAAJ&amp;hl=zh-CN</a></li><li>Dacheng Tao：<a href="https://scholar.google.com/citations?user=RwlJNLcAAAAJ&amp;hl=zh-CN">https://scholar.google.com/citations?user=RwlJNLcAAAAJ&amp;hl=zh-CN</a></li><li>Lei Zhang：<a href="https://scholar.google.com/citations?user=tAK5l1IAAAAJ&amp;hl=zh-CN">https://scholar.google.com/citations?user=tAK5l1IAAAAJ&amp;hl=zh-CN</a></li><li>Nassir Navab：<a href="https://scholar.google.de/citations?user=kzoVUPYAAAAJ&amp;hl=zh-CN">https://scholar.google.de/citations?user=kzoVUPYAAAAJ&amp;hl=zh-CN</a></li><li>Liang Lin：<a href="https://scholar.google.com.hk/citations?user=Nav8m8gAAAAJ&amp;hl=zh-CN">https://scholar.google.com.hk/citations?user=Nav8m8gAAAAJ&amp;hl=zh-CN</a></li><li>Trevor Darrell：<a href="https://scholar.google.com/citations?user=bh-uRFMAAAAJ&amp;hl=zh-CN">https://scholar.google.com/citations?user=bh-uRFMAAAAJ&amp;hl=zh-CN</a></li></ul><pre class="line-numbers language-python" data-language="python"><code class="language-python">cv_authors_lastnames <span class="token operator">=</span> <span class="token punctuation">[</span>x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token keyword">for</span> x <span class="token keyword">in</span> all_cv_authors<span class="token punctuation">]</span>cv_authors_lastnames <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>cv_authors_lastnames<span class="token punctuation">)</span>cv_authors_lastnames<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>0</th>    </tr>  </thead>  <tbody>    <tr>      <th>0</th>      <td>Likforman-Sulem</td>    </tr>    <tr>      <th>1</th>      <td>Zahour</td>    </tr>    <tr>      <th>2</th>      <td>Taconet</td>    </tr>    <tr>      <th>3</th>      <td>Nelwamondo</td>    </tr>    <tr>      <th>4</th>      <td>Marwala</td>    </tr>  </tbody></table><pre class="line-numbers language-python" data-language="python"><code class="language-python">fig<span class="token punctuation">,</span> axes <span class="token operator">=</span> plt<span class="token punctuation">.</span>subplots<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span>cv_authors_lastnames<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>value_counts<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">.</span>plot<span class="token punctuation">(</span>kind<span class="token operator">=</span><span class="token string">'barh'</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>ylabel<span class="token punctuation">(</span><span class="token string">'Author'</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>xlabel<span class="token punctuation">(</span><span class="token string">'Count'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="/2021/01/14/task2-lun-wen-zuo-zhe-tong-ji/output_36_1.png" alt="png"></p><p>Wang、Zhang、Li 排名前三，这与这三个姓基数多有一定原因</p><h3 id="相关资料"><a href="#相关资料" class="headerlink" title="相关资料"></a>相关资料</h3><p><a href="https://segmentfault.com/q/1010000010514370">python sum 函数 iterable 参数为二维 list, start 参数为”[]”该如何理解</a></p><p><a href="https://blog.csdn.net/Jerry_1126/article/details/79937454">python 中的 sum 函数一个妙用</a></p><p><a href="http://inter.joyfulpandas.datawhale.club/Content/ch2.html">apply 函数的使用</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> Datawhale </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>函数式编程初探</title>
      <link href="2021/01/13/han-shu-shi-bian-cheng-chu-tan/"/>
      <url>2021/01/13/han-shu-shi-bian-cheng-chu-tan/</url>
      
        <content type="html"><![CDATA[<h1 id="函数式编程初探"><a href="#函数式编程初探" class="headerlink" title="函数式编程初探"></a>函数式编程初探</h1><p><a href="http://www.bshare.cn/share">分享按钮</a></p><p>作者： <a href="http://www.ruanyifeng.com/">阮一峰</a></p><p>日期： <a href="http://www.ruanyifeng.com/blog/2012/04/">2012 年 4 月 6 日</a></p><p>诞生 50 多年之后，<a href="http://en.wikipedia.org/wiki/Functional_programming">函数式编程</a>（functional programming）开始获得越来越多的关注。</p><p>不仅最古老的函数式语言 Lisp 重获青春，而且新的函数式语言层出不穷，比如 Erlang、clojure、Scala、F#等等。目前最当红的 Python、Ruby、Javascript，对函数式编程的支持都很强，就连老牌的面向对象的 Java、面向过程的 PHP，都忙不迭地加入对匿名函数的支持。越来越多的迹象表明，函数式编程已经不再是学术界的最爱，开始大踏步地在业界投入实用。</p><p>也许继”面向对象编程”之后，”函数式编程”会成为下一个编程的主流范式（paradigm）。未来的程序员恐怕或多或少都必须懂一点。</p><p><img src="https://www.ruanyifeng.com/blogimg/asset/201204/bg2012040601.png" alt="img"></p><p>但是，”函数式编程”看上去比较难，缺乏通俗的入门教程，各种介绍文章都充斥着数学符号和专用术语，让人读了如坠云雾。就连最基本的问题”什么是函数式编程”，网上都搜不到易懂的回答。</p><p>下面是我的”函数式编程”学习笔记，分享出来，与大家一起探讨。内容不涉及数学（我也不懂<a href="http://en.wikipedia.org/wiki/Lambda_calculus">Lambda Calculus</a>），也不涉及高级特性（比如<a href="http://en.wikipedia.org/wiki/Lazy_evaluation">lazy evaluation</a>和<a href="http://en.wikipedia.org/wiki/Currying">currying</a>），只求尽量简单通俗地整理和表达，我现在所理解的”函数式编程”以及它的意义。</p><p>我主要参考了 Slava Akhmechet 的<em><a href="http://www.defmacro.org/ramblings/fp.html">“Functional Programming For The Rest of Us”</a></em>。</p><h2 id="一、定义"><a href="#一、定义" class="headerlink" title="一、定义"></a><strong>一、定义</strong></h2><p>简单说，”函数式编程”是一种<a href="http://en.wikipedia.org/wiki/Programming_paradigm">“编程范式”</a>（programming paradigm），也就是如何编写程序的方法论。</p><p>它属于<a href="http://en.wikipedia.org/wiki/Structured_programming">“结构化编程”</a>的一种，主要思想是把运算过程尽量写成一系列嵌套的函数调用。举例来说，现在有这样一个数学表达式：</p><blockquote><p>　　(1 + 2) * 3 - 4</p></blockquote><p>传统的过程式编程，可能这样写：</p><blockquote><p>　　var a = 1 + 2;</p><p>　　var b = a * 3;</p><p>　　var c = b - 4;</p></blockquote><p>函数式编程要求使用函数，我们可以把运算过程<a href="http://lostechies.com/derickbailey/2012/01/24/some-thoughts-on-functional-javascript/">定义</a>为不同的函数，然后写成下面这样：</p><blockquote><p>　　var result = subtract(multiply(add(1,2), 3), 4);</p></blockquote><p>这就是函数式编程。</p><h2 id="二、特点"><a href="#二、特点" class="headerlink" title="二、特点"></a><strong>二、特点</strong></h2><p>函数式编程具有五个鲜明的特点。</p><h3 id="1-函数是”第一等公民”"><a href="#1-函数是”第一等公民”" class="headerlink" title="1. 函数是”第一等公民”"></a><strong>1. 函数是”第一等公民”</strong></h3><p>所谓<a href="http://en.wikipedia.org/wiki/First-class_function">“第一等公民”</a>（first class），指的是函数与其他数据类型一样，处于平等地位，可以赋值给其他变量，也可以作为参数，传入另一个函数，或者作为别的函数的返回值。</p><p>举例来说，下面代码中的 print 变量就是一个函数，可以作为另一个函数的参数。</p><blockquote><p>　　var print = function(i){ console.log(i);};</p><p>　　[1,2,3].forEach(print);</p></blockquote><h3 id="2-只用”表达式”，不用”语句”"><a href="#2-只用”表达式”，不用”语句”" class="headerlink" title="2. 只用”表达式”，不用”语句”"></a><strong>2. 只用”表达式”，不用”语句”</strong></h3><p>“表达式”（expression）是一个单纯的运算过程，总是有返回值；”语句”（statement）是执行某种操作，没有返回值。函数式编程要求，只使用表达式，不使用语句。也就是说，每一步都是单纯的运算，而且都有返回值。</p><p>原因是函数式编程的开发动机，一开始就是为了处理运算（computation），不考虑系统的读写（I/O）。”语句”属于对系统的读写操作，所以就被排斥在外。</p><p>当然，实际应用中，不做 I/O 是不可能的。因此，编程过程中，函数式编程只要求把 I/O 限制到最小，不要有不必要的读写行为，保持计算过程的单纯性。</p><h3 id="3-没有”副作用”"><a href="#3-没有”副作用”" class="headerlink" title="3. 没有”副作用”"></a><strong>3. 没有”副作用”</strong></h3><p>所谓<a href="http://en.wikipedia.org/wiki/Side_effect_(computer_science">“副作用”</a>)（side effect），指的是函数内部与外部互动（最典型的情况，就是修改全局变量的值），产生运算以外的其他结果。</p><p>函数式编程强调没有”副作用”，意味着函数要保持独立，所有功能就是返回一个新的值，没有其他行为，尤其是不得修改外部变量的值。</p><h3 id="4-不修改状态"><a href="#4-不修改状态" class="headerlink" title="4. 不修改状态"></a><strong>4. 不修改状态</strong></h3><p>上一点已经提到，函数式编程只是返回新的值，不修改系统变量。因此，不修改变量，也是它的一个重要特点。</p><p>在其他类型的语言中，变量往往用来保存”状态”（state）。不修改变量，意味着状态不能保存在变量中。函数式编程使用参数保存状态，最好的例子就是递归。下面的代码是一个将字符串逆序排列的函数，它演示了不同的参数如何决定了运算所处的”状态”。</p><blockquote><p>　　function reverse(string) {</p><p>　　　　if(string.length == 0) {</p><p>　　　　　　return string;</p><p>　　　　} else {</p><p>　　　　　　return reverse(string.substring(1, string.length)) + string.substring(0, 1);</p><p>　　　　}</p><p>　　}</p></blockquote><p>由于使用了递归，函数式语言的运行速度比较慢，这是它长期不能在业界推广的主要原因。</p><h3 id="5-引用透明"><a href="#5-引用透明" class="headerlink" title="5. 引用透明"></a><strong>5. 引用透明</strong></h3><p>引用透明（Referential transparency），指的是函数的运行不依赖于外部变量或”状态”，只依赖于输入的参数，任何时候只要参数相同，引用函数所得到的返回值总是相同的。</p><p>有了前面的第三点和第四点，这点是很显然的。其他类型的语言，函数的返回值往往与系统状态有关，不同的状态之下，返回值是不一样的。这就叫”引用不透明”，很不利于观察和理解程序的行为。</p><h2 id="三、意义"><a href="#三、意义" class="headerlink" title="三、意义"></a><strong>三、意义</strong></h2><p>函数式编程到底有什么好处，为什么会变得越来越流行？</p><h3 id="1-代码简洁，开发快速"><a href="#1-代码简洁，开发快速" class="headerlink" title="1. 代码简洁，开发快速"></a><strong>1. 代码简洁，开发快速</strong></h3><p>函数式编程大量使用函数，减少了代码的重复，因此程序比较短，开发速度较快。</p><p>Paul Graham 在<a href="http://www.ruanyifeng.com/docs/pg/">《黑客与画家》</a>一书中<a href="http://www.ruanyifeng.com/blog/2010/10/why_lisp_is_superior.html">写道</a>：同样功能的程序，极端情况下，Lisp 代码的长度可能是 C 代码的二十分之一。</p><p>如果程序员每天所写的代码行数基本相同，这就意味着，”C 语言需要一年时间完成开发某个功能，Lisp 语言只需要不到三星期。反过来说，如果某个新功能，Lisp 语言完成开发需要三个月，C 语言需要写五年。”当然，这样的对比故意夸大了差异，但是”在一个高度竞争的市场中，即使开发速度只相差两三倍，也足以使得你永远处在落后的位置。”</p><h3 id="2-接近自然语言，易于理解"><a href="#2-接近自然语言，易于理解" class="headerlink" title="2. 接近自然语言，易于理解"></a><strong>2. 接近自然语言，易于理解</strong></h3><p>函数式编程的自由度很高，可以写出很接近自然语言的代码。</p><p>前文曾经将表达式(1 + 2) * 3 - 4，写成函数式语言：</p><blockquote><p>　　subtract(multiply(add(1,2), 3), 4)</p></blockquote><p>对它进行变形，不难得到另一种写法：</p><blockquote><p>　　add(1,2).multiply(3).subtract(4)</p></blockquote><p>这基本就是自然语言的表达了。再看下面的代码，大家应该一眼就能明白它的意思吧：</p><blockquote><p>　　merge([1,2],[3,4]).sort().search(“2”)</p></blockquote><p>因此，函数式编程的代码更容易理解。</p><h3 id="3-更方便的代码管理"><a href="#3-更方便的代码管理" class="headerlink" title="3. 更方便的代码管理"></a><strong>3. 更方便的代码管理</strong></h3><p>函数式编程不依赖、也不会改变外界的状态，只要给定输入参数，返回的结果必定相同。因此，每一个函数都可以被看做独立单元，很有利于进行单元测试（unit testing）和除错（debugging），以及模块化组合。</p><h3 id="4-易于”并发编程”"><a href="#4-易于”并发编程”" class="headerlink" title="4. 易于”并发编程”"></a><strong>4. 易于”并发编程”</strong></h3><p>函数式编程不需要考虑”死锁”（deadlock），因为它不修改变量，所以根本不存在”锁”线程的问题。不必担心一个线程的数据，被另一个线程修改，所以可以很放心地把工作分摊到多个线程，部署”并发编程”（concurrency）。</p><p>请看下面的代码：</p><blockquote><p>　　var s1 = Op1();</p><p>　　var s2 = Op2();</p><p>　　var s3 = concat(s1, s2);</p></blockquote><p>由于 s1 和 s2 互不干扰，不会修改变量，谁先执行是无所谓的，所以可以放心地增加线程，把它们分配在两个线程上完成。其他类型的语言就做不到这一点，因为 s1 可能会修改系统状态，而 s2 可能会用到这些状态，所以必须保证 s2 在 s1 之后运行，自然也就不能部署到其他线程上了。</p><p>多核 CPU 是将来的潮流，所以函数式编程的这个特性非常重要。</p><h3 id="5-代码的热升级"><a href="#5-代码的热升级" class="headerlink" title="5. 代码的热升级"></a><strong>5. 代码的热升级</strong></h3><p>函数式编程没有副作用，只要保证接口不变，内部实现是外部无关的。所以，可以在运行状态下直接升级代码，不需要重启，也不需要停机。<a href="http://en.wikipedia.org/wiki/Erlang_(programming_language">Erlang</a>)语言早就证明了这一点，它是瑞典爱立信公司为了管理电话系统而开发的，电话系统的升级当然是不能停机的。</p><p>（完）</p>]]></content>
      
      
      
        <tags>
            
            <tag> 函数式编程 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>函数式编程</title>
      <link href="2021/01/13/han-shu-shi-bian-cheng/"/>
      <url>2021/01/13/han-shu-shi-bian-cheng/</url>
      
        <content type="html"><![CDATA[<h1 id="函数式编程"><a href="#函数式编程" class="headerlink" title="函数式编程"></a>函数式编程</h1><p>本文记录笔者函数式编程学习记录，是原文《<a href="http://www.defmacro.org/ramblings/fp.html">Functional Programming For The Rest of Us</a>》的中文翻译的部分内容，只是记录下自己可以稍微明白的一点内容，主要是函数式编程的优点和函数式编程的一个实例（高阶函数），这个实例的思想可以仔细体会。还有更多内容需要继续研读，原文链接会附在相关资料，由于是 Github 上找到的资料，并未发现译者信息，以后得知会补上。</p><h2 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h2><p>函数式编程是阿隆佐思想在现实世界中的实现。不过不是全部的 lambda 演算思想都可以运用到实际中，因 lambda 演算在设计的时候就不是为了在各种现实世界中的限制下工作的。所以，就像面向对象的编程思想一样，函数式编程只是一系列想法，而不是一套严苛的规定。有很多支持函数式编程的程序语言，它们之间的具体设计都不完全一样。在这里我将用 Java 写的例子介绍那些被广泛应用的函数式编程思想（没错，如果你是受虐狂你可以用 Java 写出函数式程序）。在下面的章节中我会在 Java 语言的基础上，做一些修改让它变成实际可用的函数式编程语言。那么现在就开始吧。</p><p>Lambda 演算在最初设计的时候就是为了研究计算相关的问题。所以函数式编程主要解决的也是计算问题，而出乎意料的是，是用函数来解决的！（译者：请理解原作者的苦心，我想他是希望加入一点调皮的风格以免读者在中途睡着或是转台……）。函数就是函数式编程中的基础元素，可以完成几乎所有的操作，哪怕最简单的计算，也是用函数完成的。我们通常理解的变量在函数式编程中也被函数代替了：在函数式编程中变量仅仅代表某个表达式（这样我们就不用把所有的代码都写在同一行里了）。所以我们这里所说的‘变量’是不能被修改的。所有的变量只能被赋一次初值。在 Java 中就意味着每一个变量都将被声明为 final（如果你用 C++，就是 const ）。在 FP 中，没有非 final 的变量。</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">final</span> <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span><span class="token keyword">final</span> <span class="token keyword">int</span> j <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>既然 FP 中所有的变量都是 final 的，可以引出两个规定：一是变量前面就没有必要再加上 final 这个关键字了，二是变量就不能再叫做‘变量’了……于是现在开始对 Java 做两个改动：所有 Java 中声明的变量默认为 final ，而且我们把所谓的‘变量’称为‘符号’。</p><p>到现在可能会有人有疑问：这个新创造出来的语言可以用来写什么有用的复杂一些的程序吗？毕竟，如果每个符号的值都是不能修改的，那么我们就什么东西都不能改变了！别紧张，这样的说法不完全正确。阿隆佐在设计 lambda 演算的时候他并不想要保留状态的值以便稍后修改这些值。他更关心的是基于数据之上的操作（也就是更容易理解的“计算”）。而且，lambda 演算和图灵机已经被证明了是具有同样能力的系统，因此指令式编程能做到的函数式编程也同样可以做到。那么，怎样才能做到呢？</p><p>事实上函数式程序是可以保存状态的，只不过它们用的不是变量，而是函数。状态保存在函数的参数中，也就是说在栈上。如果你需要保存一个状态一段时间并且时不时的修改它，那么你可以编写一个递归函数。举个例子，试着写一个函数，用来反转一个 Java 的字符串。记住咯，这个程序里的变量都是默认为 final 的<a href="https://github.com/justinyhuang/Functional-Programming-For-The-Rest-of-Us-Cn/blob/master/FunctionalProgrammingForTheRestOfUs.cn.md#f5">5</a>。</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">String</span> <span class="token function">reverse</span><span class="token punctuation">(</span><span class="token class-name">String</span> arg<span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>arg<span class="token punctuation">.</span>length <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> arg<span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">else</span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> <span class="token function">reverse</span><span class="token punctuation">(</span>arg<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> arg<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> arg<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>这个方程运行起来会相对慢一些，因为它重复调用自己<a href="https://github.com/justinyhuang/Functional-Programming-For-The-Rest-of-Us-Cn/blob/master/FunctionalProgrammingForTheRestOfUs.cn.md#f6">6</a>。同时它也会大量的消耗内存，因为它会不断的分配创建内存对象。无论如何，它是用函数式编程思想写出来的。这时候可能有人要问了，为什么要用这种奇怪的方式编写程序呢？嘿，我正准备告诉你。</p><h3 id="FP-之优点"><a href="#FP-之优点" class="headerlink" title="FP 之优点"></a>FP 之优点</h3><p>你大概已经在想：上面这种怪胎函数怎么也不合理嘛。在我刚开始学习 FP 的时候我也这样想的。不过后来我知道我是错的。使用这种方式编程有很多好处。其中一些是主观的。比如说有人认为函数式程序更容易理解。这个我就不说了，哪怕街上随便找个小孩都知道‘容易理解’是多么主观的事情。幸运的是，客观方面的好处还有很多。</p><h4 id="单元测试"><a href="#单元测试" class="headerlink" title="单元测试"></a>单元测试</h4><p>因为 FP 中的每个符号都是 final 的，于是没有什么函数会有副作用。谁也不能在运行时修改任何东西，也没有函数可以修改在它作用域之外的值给其他函数继续使用（在指令式编程中可以用类成员或是全局变量做到）。这意味着决定函数执行结果的唯一因素就是它的返回值，而影响其返回值的唯一因素就是它的参数。</p><p>这正是单元测试工程师梦寐以求的啊。现在测试程序中的函数时只需要关注它的参数就可以了。完全不需要担心函数调用的顺序，也不用费心设置外部某些状态值。唯一需要做的就是传递一些可以代表边界条件的参数给这些函数。相对于指令式编程，如果 FP 程序中的每一个函数都能通过单元测试，那么我们对这个软件的质量必将信心百倍。反观 Java 或者 C++，仅仅检查函数的返回值是不够的：代码可能修改外部状态值，因此我们还需要验证这些外部的状态值的正确性。在 FP 语言中呢，就完全不需要。</p><h4 id="调试查错"><a href="#调试查错" class="headerlink" title="调试查错"></a>调试查错</h4><p>如果一段 FP 程序没有按照预期设计那样运行，调试的工作几乎不费吹灰之力。这些错误是百分之一百可以重现的，因为 FP 程序中的错误不依赖于之前运行过的不相关的代码。而在一个指令式程序中，一个 bug 可能有时能重现而有些时候又不能。因为这些函数的运行依赖于某些外部状态， 而这些外部状态又需要由某些与这个 bug 完全不相关的代码通过某个特别的执行流程才能修改。在 FP 中这种情况完全不存在：如果一个函数的返回值出错了，它一直都会出错，无论你之前运行了什么代码。</p><p>一旦问题可以重现，解决它就变得非常简单，几乎就是一段愉悦的旅程。中断程序的运行，检查一下栈，就可以看到每一个函数调用时使用的每一个参数，这一点和指令式代码一样。不同的是指令式程序中这些数据还不足够，因为函数的运行还可能依赖于成员变量，全局变量，还有其他类的状态（而这些状态又依赖于类似的变量）。FP 中的函数只依赖于传给它的参数，而这些参数就在眼前！还有，对指令式程序中函数返回值的检查并不能保证这个函数是正确运行的。还要逐一检查若干作用域以外的对象以确保这个函数没有对这些牵连的对象做出什么越轨的行为（译者：好吧，翻译到这里我自己已经有点激动了）。对于一个 FP 程序，你要做的仅仅是看一下函数的返回值。</p><p>把栈上的数据过一遍就可以得知有哪些参数传给了什么函数，这些函数又返回了什么值。当一个返回值看起来不对头的那一刻，跳进这个函数看看里面发生了什么。一直重复跟进下去就可以找到 bug 的源头！</p><h4 id="并发执行"><a href="#并发执行" class="headerlink" title="并发执行"></a>并发执行</h4><p>不需要任何改动，所有 FP 程序都是可以并发执行的。由于根本不需要采用锁机制，因此完全不需要担心死锁或是并发竞争的发生。在 FP 程序中没有哪个线程可以修改任何数据，更不用说多线程之间了。这使得我们可以轻松的添加线程，至于那些祸害并发程序的老问题，想都不用想！</p><p>既然是这样，为什么没有人在那些高度并行的那些应用程序中采用 FP 编程呢？事实上，这样的例子并不少见。爱立信开发了一种 FP 语言，名叫 Erlang，并应用在他们的电信交换机上，而这些交换机不仅容错度高而且拓展性强。许多人看到了 Erlang 的这些优势也纷纷开始使用这一语言。在这里提到的电信交换控制系统远远要比华尔街上使用的系统具有更好的扩展性也更可靠。事实上，用 Erlang 搭建的系统并不具备可扩展性和可靠性，而 Java 可以提供这些特性。Erlang 只是像岩石一样结实不容易出错而已。</p><p>FP 关于并行的优势不仅于此。就算某个 FP 程序本身只是单线程的，编译器也可以将其优化成可以在多 CPU 上运行的并发程序。以下面的程序为例：</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">String</span> s1 <span class="token operator">=</span> <span class="token function">somewhatLongOperation1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">String</span> s2 <span class="token operator">=</span> <span class="token function">somewhatLongOperation2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token class-name">String</span> s3 <span class="token operator">=</span> <span class="token function">concatenate</span><span class="token punctuation">(</span>s1<span class="token punctuation">,</span> s2<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>如果是函数式程序，编译器就可以对代码进行分析，然后可能分析出生成字符串 s1 和 s2 的两个函数可能会比较耗时，进而安排它们并行运行。这在指令式编程中是无法做到的，因为每一个函数都有可能修改其外部状态，然后接下来的函数又可能依赖于这些状态的值。在函数式编程中，自动分析代码并找到适合并行执行的函数十分简单，和分析 C 的内联函数没什么两样。从这个角度来说用 FP 风格编写的程序是“永不过时”的（虽然我一般不喜欢说大话空话，不过这次就算个例外吧）。硬件厂商已经没办法让 CPU 运行得再快了。他们只能靠增加 CPU 核的数量然后用并行来提高运算的速度。这些厂商故意忽略一个事实：只有可以并行的软件才能让你花大价钱买来的这些硬件物有所值。指令式的软件中只有很小一部分能做到跨核运行，而所有的函数式软件都能实现这一目标，因为 FP 的程序从一开始就是可以并行运行的。</p><h4 id="热部署"><a href="#热部署" class="headerlink" title="热部署"></a>热部署</h4><p>在 Windows 早期，如果要更新系统那可是要重启电脑的，而且还要重启很多次。哪怕只是安装一个新版本的播放器。到了 XP 的时代这种情况得到比较大的改善，尽管还是不理想（我工作的时候用的就是 Windows，就在现在，我的系统托盘上就有个讨厌的图标，我不重启机子就不消失）。这一方面 Unix 好一些，曾经。只需要暂停一些相关的部件而不是整个操作系统，就可以安装更新了。虽然是要好一些了，对很多服务器应用来说这也还是不能接受的。电信系统要求的是 100%的在线率，如果一个救急电话因为系统升级而无法拨通，成千上万的人就会因此丧命。同样的，华尔街的那些公司怎么也不能说要安装软件而在整个周末停止他们系统的服务。</p><p>最理想的情况是更新相关的代码而不用暂停系统的其他部件。对指令性程序来说是不可能的。想想看，试着在系统运行时卸载掉一个 Java 的类然后再载入这个类的新的实现，这样做的话系统中所有该类的实例都会立刻不能运行，因为该类的相关状态已经丢失了。这种情况下可能需绞尽脑汁设计复杂的版本控制代码，需要将所有这种类正在运行的实例<a href="http://zh.wikipedia.org/wiki/序列化">序列化</a>，逐一销毁它们，然后创建新类的实例，将现有数据也序列化后装载到这些新的实例中，最后希望负责装载的程序可以正确的把这些数据移植到新实例中并正常的工作。这种事很麻烦，每次有新的改动都需要手工编写装载程序来完成更新，而且这些装载程序还要很小心，以免破坏了现有对象之间的联系。理论上是没问题，可是实际上完全行不通。</p><p>FP 的程序中所有状态就是传给函数的参数，而参数都是储存在栈上的。这一特性让软件的热部署变得十分简单。只要比较一下正在运行的代码以及新的代码获得一个 diff，然后用这个 diff 更新现有的代码，新代码的热部署就完成了。其它的事情有 FP 的语言工具自动完成！如果还有人认为这只存在于科幻小说中，他需要再想想：多年来 Erlang 工程师已经使用这种技术对它们的系统进行升级而完全不用暂停运行了。</p><h4 id="机器辅助证明及优化"><a href="#机器辅助证明及优化" class="headerlink" title="机器辅助证明及优化"></a>机器辅助证明及优化</h4><p>FP 语言有一个特性很有意思，那就是它们是可以用数学方法来分析的。FP 语言本身就是形式系统的实现，只要是能在纸上写出来的数学运算就可以用这种语言表述出来。于是只要能够用数学方法证明两段代码是一致的，编译器就可以把某段代码解析成在数学上等同的但效率又更高的另外一段代码<a href="https://github.com/justinyhuang/Functional-Programming-For-The-Rest-of-Us-Cn/blob/master/FunctionalProgrammingForTheRestOfUs.cn.md#f7">7</a>。 关系数据库已经用这种方法进行优化很多年了。没有理由在常规的软件行业就不能应用这种技术。</p><p>另外，还可以用这种方法来证明代码的正确性，甚至可以设计出能够自动分析代码并为单元测试自动生成边缘测试用例的工具出来！对于那些对缺陷零容忍的系统来说，这一功能简直就是无价之宝。例如心脏起搏器，例如飞行管控系统，这几乎就是必须满足的需求。哪怕你正在开发的程序不是为了完成什么重要核心任务，这些工具也可以帮助你写出更健壮的程序，直接甩竞争对手 n 条大街。</p><h3 id="高阶函数"><a href="#高阶函数" class="headerlink" title="高阶函数"></a>高阶函数</h3><p>我还记得在了解到 FP 以上的各种好处后想到：“这些优势都很吸引人，可是，如果必须非要用这种所有变量都是 final 的蹩脚语言，估计还是不怎么实用吧”。其实这样的想法是不对的。对于 Java 这样的指令式语言来说，如果所有的变量都是必须是 final 的，那么确实很束手束脚。然而对函数式语言来说，情况就不一样了。函数式语言提供了一种特别的抽象工具，这种工具将帮助使用者编写 FP 代码，让他们甚至都没想到要修改变量的值。高阶函数就是这种工具之一。</p><p>FP 语言中的函数有别于 Java 或是 C。可以说这种函数是一个<a href="http://zh.wikipedia.org/wiki/全集">全集</a>：Java 函数可以做到的它都能做，同时它还有更多的能力。首先，像在 C 里写程序那样创建一个函数：</p><pre class="line-numbers language-C" data-language="C"><code class="language-C">int add(int i, int j) {    return i + j;}<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>看起来和 C 程序没什么区别，但是很快你就可以看出区别来。接下来我们扩展 Java 的编译器以便支持这种代码，也就是说，当我们写下以上的程序编译器会把它转化成下面的 Java 程序（别忘了，所有的变量都是 final 的）：</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">class</span> add_function_t <span class="token punctuation">{</span>    <span class="token keyword">int</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token punctuation">,</span> <span class="token keyword">int</span> j<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> i <span class="token operator">+</span> j<span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span>add_function_t add <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">add_function_t</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>在这里，符号 add 并不是一个函数，它是只有一个函数作为其成员的简单的类。这样做有很多好处，可以在程序中把 add 当成参数传给其他的函数，也可以把 add 赋给另外一个符号，还可以在运行时创建 add_function_t 的实例然后在不再需要这些实例的时候由系统回收机制处理掉。这样做使得函数成为和 integer 或是 string 这样的<a href="http://zh.wikipedia.org/zh/第一類物件">第一类对象</a>。对其他函数进行操作（比如说把这些函数当成参数）的函数，就是所谓的高阶函数。别让这个看似高深的名字吓倒你（译者：好死不死起个这个名字，初一看还准备搬出已经尘封的高数教材……），它和 Java 中操作其他类（也就是把一个类实例传给另外的类）的类没有什么区别。可以称这样的类为“高阶类”，但是没人会在意，因为 Java 圈里就没有什么很强的学术社团。（译者：这是高级黑吗？）</p><p>那么什么时候该用高阶函数，又怎样用呢？我很高兴有人问这个问题。设想一下，你写了一大堆程序而不考虑什么类结构设计，然后发现有一部分代码重复了几次，于是你就会把这部分代码独立出来作为一个函数以便多次调用（所幸学校里至少会教这个）。如果你发现这个函数里有一部分逻辑需要在不同的情况下实现不同的行为，那么你可以把这部分逻辑独立出来作为一个高阶函数。搞晕了？下面来看看我工作中的一个真实的例子。</p><p>假设有一段 Java 的客户端程序用来接收消息，用各种方式对消息做转换，然后发给一个服务器。</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">class</span> <span class="token class-name">MessageHandler</span> <span class="token punctuation">{</span>    <span class="token keyword">void</span> <span class="token function">handleMessage</span><span class="token punctuation">(</span><span class="token class-name">Message</span> msg<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token comment">// ...</span>        msg<span class="token punctuation">.</span><span class="token function">setClientCode</span><span class="token punctuation">(</span><span class="token string">"ABCD_123"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// ...</span>        <span class="token function">sendMessage</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment">// ...</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>再进一步假设，整个系统改变了，现在需要发给两个服务器而不再是一个了。系统其他部分都不变，唯独客户端的代码需要改变：额外的那个服务器需要用另外一种格式发送消息。应该如何处理这种情况呢？我们可以先检查一下消息要发送到哪里，然后选择相应的格式把这个消息发出去：</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">class</span> <span class="token class-name">MessageHandler</span> <span class="token punctuation">{</span>    <span class="token keyword">void</span> <span class="token function">handleMessage</span><span class="token punctuation">(</span><span class="token class-name">Message</span> msg<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token comment">// ...</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>msg<span class="token punctuation">.</span><span class="token function">getDestination</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">"server1"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>            msg<span class="token punctuation">.</span><span class="token function">setClientCode</span><span class="token punctuation">(</span><span class="token string">"ABCD_123"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>            msg<span class="token punctuation">.</span><span class="token function">setClientCode</span><span class="token punctuation">(</span><span class="token string">"123_ABC"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">}</span>        <span class="token comment">// ...</span>        <span class="token function">sendMessage</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment">// ...</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>可是这样的实现是不具备扩展性的。如果将来需要增加更多的服务器，上面函数的大小将呈线性增长，使得维护这个函数最终变成一场噩梦。面向对象的编程方法告诉我们，可以把 MessageHandler 变成一个基类，然后将针对不同格式的消息编写相应的子类。</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name">MessageHandler</span> <span class="token punctuation">{</span>    <span class="token keyword">void</span> <span class="token function">handleMessage</span><span class="token punctuation">(</span><span class="token class-name">Message</span> msg<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token comment">// ...</span>        msg<span class="token punctuation">.</span><span class="token function">setClientCode</span><span class="token punctuation">(</span><span class="token function">getClientCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// ...</span>        <span class="token function">sendMessage</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token keyword">abstract</span> <span class="token class-name">String</span> <span class="token function">getClientCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// ...</span><span class="token punctuation">}</span><span class="token keyword">class</span> <span class="token class-name">MessageHandlerOne</span> <span class="token keyword">extends</span> <span class="token class-name">MessageHandler</span> <span class="token punctuation">{</span>    <span class="token class-name">String</span> <span class="token function">getClientCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> <span class="token string">"ABCD_123"</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token keyword">class</span> <span class="token class-name">MessageHandlerTwo</span> <span class="token keyword">extends</span> <span class="token class-name">MessageHandler</span> <span class="token punctuation">{</span>    <span class="token class-name">String</span> <span class="token function">getClientCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token keyword">return</span> <span class="token string">"123_ABCD"</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>这样一来就可以为每一个接收消息的服务器生成一个相应的类对象，添加服务器就变得更加容易维护了。可是，这一个简单的改动引出了很多的代码。仅仅是为了支持不同的客户端行为代码，就要定义两种新的类型！现在来试试用我们刚才改造的语言来做同样的事情，注意，这种语言支持高阶函数：</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">class</span> <span class="token class-name">MessageHandler</span> <span class="token punctuation">{</span>    <span class="token keyword">void</span> <span class="token function">handleMessage</span><span class="token punctuation">(</span><span class="token class-name">Message</span> msg<span class="token punctuation">,</span> <span class="token class-name">Function</span> getClientCode<span class="token punctuation">)</span> <span class="token punctuation">{</span>        <span class="token comment">// ...</span>        <span class="token class-name">Message</span> msg1 <span class="token operator">=</span> msg<span class="token punctuation">.</span><span class="token function">setClientCode</span><span class="token punctuation">(</span><span class="token function">getClientCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// ...</span>        <span class="token function">sendMessage</span><span class="token punctuation">(</span>msg1<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">}</span>    <span class="token comment">// ...</span><span class="token punctuation">}</span><span class="token class-name">String</span> <span class="token function">getClientCodeOne</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">return</span> <span class="token string">"ABCD_123"</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token class-name">String</span> <span class="token function">getClientCodeTwo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>    <span class="token keyword">return</span> <span class="token string">"123_ABCD"</span><span class="token punctuation">;</span><span class="token punctuation">}</span><span class="token class-name">MessageHandler</span> handler <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MessageHandler</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>handler<span class="token punctuation">.</span><span class="token function">handleMessage</span><span class="token punctuation">(</span>someMsg<span class="token punctuation">,</span> getClientCodeOne<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>在上面的程序里，我们没有创建任何新的类型或是多层类的结构。仅仅是把相应的函数作为参数进行传递，就做到了和用面向对象编程一样的事情，而且还有额外的好处：一是不再受限于多层类的结构。这样做可以做运行时传递新的函数，可以在任何时候改变这些函数，而且这些改变不仅更加精准而且触碰的代码更少。这种情况下编译器其实就是在替我们编写面向对象的“粘合”代码（译者：又称胶水代码，粘接代码）！除此之外我们还可以享用 FP 编程的其他所有优势。函数式编程能提供的抽象服务还远不止于此。高阶函数只不过是个开始。</p><h3 id="相关资料"><a href="#相关资料" class="headerlink" title="相关资料"></a>相关资料</h3><p><a href="http://www.defmacro.org/2006/06/19/fp.html">Functional Programming For The Rest of Us</a></p><p><a href="https://github.com/justinyhuang/Functional-Programming-For-The-Rest-of-Us-Cn/blob/master/FunctionalProgrammingForTheRestOfUs.cn.md#%E5%87%BD%E6%95%B0%E5%BC%8F%E7%BC%96%E7%A8%8B">傻瓜函数式编程</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> 函数式编程 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Docker 使用记录</title>
      <link href="2021/01/11/docker-shi-yong-ji-lu/"/>
      <url>2021/01/11/docker-shi-yong-ji-lu/</url>
      
        <content type="html"><![CDATA[<h1 id="Docker-使用记录"><a href="#Docker-使用记录" class="headerlink" title="Docker 使用记录"></a>Docker 使用记录</h1><p>Docker 之前就尝试安装过，最初是在自己的笔记本安装的，但是因为 Windows 并不是专业版，导致不能成功安装 docker，然后就逐渐搁置。2020年双十一组装了自己的第一台主机，系统也是 Windows 专业版，因此就把 docker 安装上了。当时对 docker 的印象就是它可以很好地迁移、很好配置环境（指的是不会将本机环境弄混），今天才将 Docker 借助项目实践对其有了基础的操作和认识，使用记录如下。</p><h3 id="一、Docker-是什么"><a href="#一、Docker-是什么" class="headerlink" title="一、Docker 是什么"></a>一、Docker 是什么</h3><p>Docker 属于 Linux 容器的一种封装，提供简单易用的容器使用接口。它是目前最流行的 Linux 容器解决方案。</p><h3 id="二、Docker-的用途"><a href="#二、Docker-的用途" class="headerlink" title="二、Docker 的用途"></a>二、Docker 的用途</h3><p>Docker 的主要用途，目前有三大类。</p><p><strong>（1）提供一次性的环境。</strong>比如，本地测试他人的软件、持续集成的时候提供单元测试和构建的环境。</p><p><strong>（2）提供弹性的云服务。</strong>因为 Docker 容器可以随开随关，很适合动态扩容和缩容。</p><p><strong>（3）组建微服务架构。</strong>通过多个容器，一台机器可以跑多个服务，因此在本机就可以模拟出微服务架构。</p><h3 id="三、Docker安装"><a href="#三、Docker安装" class="headerlink" title="三、Docker安装"></a>三、Docker安装</h3><p>根据官网链接和指引安装即可</p><ul><li><p><a href="https://docs.docker.com/docker-for-mac/install/">Mac</a></p></li><li><p><a href="https://docs.docker.com/docker-for-windows/install/">Windows</a></p></li><li><p><a href="https://docs.docker.com/install/linux/docker-ce/ubuntu/">Ubuntu</a></p></li><li><p><a href="https://docs.docker.com/install/linux/docker-ce/debian/">Debian</a></p></li><li><p><a href="https://docs.docker.com/install/linux/docker-ce/centos/">CentOS</a></p></li><li><p><a href="https://docs.docker.com/install/linux/docker-ce/fedora/">Fedora</a></p></li><li><p><a href="https://docs.docker.com/install/linux/docker-ce/binaries/">其他 Linux 发行版</a></p></li></ul><p>因为我是 Windows 系统，安装完成，打开 CMD 运行</p><pre class="line-numbers language-none"><code class="language-none">docker version<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h3 id="四、Images-and-Containers"><a href="#四、Images-and-Containers" class="headerlink" title="四、Images and Containers"></a>四、Images and Containers</h3><p><strong>Docker 把应用程序及其依赖，打包在 image 文件里面。</strong>只有通过这个文件，才能生成 Docker 容器。image 文件可以看作是容器的模板。Docker 根据 image 文件生成容器的实例。同一个 image 文件，可以生成多个同时运行的容器实例。</p><p>Images 可以独立存在没有 Containers，但是 Containers 不能脱离 Images 独立存在。</p><ul><li>Images</li></ul><p><img src="/2021/01/11/docker-shi-yong-ji-lu/QQ图片20210111214659.png" alt=""></p><ul><li>Containers</li></ul><p><img src="/2021/01/11/docker-shi-yong-ji-lu/QQ图片20210111214715.png" alt=""></p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># 列出本机的所有 image 文件。</span>docker image <span class="token function">ls</span><span class="token comment"># 删除 image 文件</span>docker image <span class="token function">rm</span> <span class="token punctuation">[</span>imageName<span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>image 文件是通用的，一台机器的 image 文件拷贝到另一台机器，照样可以使用。一般来说，为了节省时间，我们应该尽量使用别人制作好的 image 文件，而不是自己制作。即使要定制，也应该基于别人的 image 文件进行加工，而不是从零开始制作。</p><p>为了方便共享，image 文件制作完成后，可以上传到网上的仓库。Docker 的官方仓库 <a href="https://hub.docker.com/">Docker Hub</a> 是最重要、最常用的 image 仓库。此外，出售自己制作的 image 文件也是可以的。（这段描述来自阮一峰老师，相关资料会附上原文链接）</p><p>下面是两者的图像表示</p><p><img src="/2021/01/11/docker-shi-yong-ji-lu/crating-a-docker-container.png" alt=""></p><h3 id="五、项目实践"><a href="#五、项目实践" class="headerlink" title="五、项目实践"></a>五、项目实践</h3><h4 id="实例：官网引导"><a href="#实例：官网引导" class="headerlink" title="实例：官网引导"></a>实例：官网引导</h4><p>类似于新手指引的简单项目：<a href="https://hub.docker.com/">https://hub.docker.com/</a></p><h4 id="实例：hello-world"><a href="#实例：hello-world" class="headerlink" title="实例：hello world"></a>实例：hello world</h4><p>因为这个实例是跟这阮一峰老师的博客学习的，这里就转载一下了</p><p>下面，我们通过最简单的 image 文件”<a href="https://hub.docker.com/r/library/hello-world/">hello world”</a>，感受一下 Docker。</p><p>需要说明的是，国内连接 Docker 的官方仓库很慢，还会断线，需要将默认仓库改成国内的镜像网站，具体的修改方法在<a href="http://www.ruanyifeng.com/blog/2018/02/docker-wordpress-tutorial.html">下一篇文章</a>的第一节。有需要的朋友，可以先看一下。</p><p>首先，运行下面的命令，将 image 文件从仓库抓取到本地。</p><blockquote><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ docker image pull library/hello-world<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>上面代码中，<code>docker image pull</code>是抓取 image 文件的命令。<code>library/hello-world</code>是 image 文件在仓库里面的位置，其中<code>library</code>是 image 文件所在的组，<code>hello-world</code>是 image 文件的名字。</p></blockquote><p>由于 Docker 官方提供的 image 文件，都放在<a href="https://hub.docker.com/r/library/"><code>library</code></a>组里面，所以它的是默认组，可以省略。因此，上面的命令可以写成下面这样。</p><blockquote><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ docker image pull hello-world<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>抓取成功以后，就可以在本机看到这个 image 文件了。</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ docker image <span class="token function">ls</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>现在，运行这个 image 文件。</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ docker container run hello-world<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><code>docker container run</code>命令会从 image 文件，生成一个正在运行的容器实例。</p></blockquote><p>注意，<code>docker container run</code>命令具有自动抓取 image 文件的功能。如果发现本地没有指定的 image 文件，就会从仓库自动抓取。因此，前面的<code>docker image pull</code>命令并不是必需的步骤。</p><p>如果运行成功，你会在屏幕上读到下面的输出。</p><blockquote><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ docker container run hello-worldHello from Docker<span class="token operator">!</span>This message shows that your installation appears to be working correctly.<span class="token punctuation">..</span>. <span class="token punctuation">..</span>.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>输出这段提示以后，<code>hello world</code>就会停止运行，容器自动终止。</p></blockquote><p>有些容器不会自动终止，因为提供的是服务。比如，安装运行 Ubuntu 的 image，就可以在命令行体验 Ubuntu 系统。</p><blockquote><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ docker container run -it ubuntu <span class="token function">bash</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>对于那些不会自动终止的容器，必须使用<a href="https://docs.docker.com/engine/reference/commandline/container_kill/"><code>docker container kill</code></a> 命令手动终止。</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ docker container <span class="token function">kill</span> <span class="token punctuation">[</span>containID<span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></blockquote><h4 id="实例：koa-demos——使用-docker-run-生成-Docker-容器"><a href="#实例：koa-demos——使用-docker-run-生成-Docker-容器" class="headerlink" title="实例：koa-demos——使用 docker run 生成 Docker 容器"></a>实例：koa-demos——使用 docker run 生成 Docker 容器</h4><p>下面我以 <a href="http://www.ruanyifeng.com/blog/2017/08/koa.html">koa-demos</a> 项目为例，介绍怎么写 Dockerfile 文件，实现让用户在 Docker 容器里面运行 Koa 框架。</p><p>作为准备工作，请先<a href="https://github.com/ruanyf/koa-demos/archive/master.zip">下载源码</a>。</p><blockquote><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ <span class="token function">git</span> clone https://github.com/ruanyf/koa-demos.git$ <span class="token builtin class-name">cd</span> koa-demos<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h5 id="编写-Dockerfile-文件"><a href="#编写-Dockerfile-文件" class="headerlink" title="编写 Dockerfile 文件"></a>编写 Dockerfile 文件</h5></blockquote><p>首先，在项目的根目录下，新建一个文本文件<code>.dockerignore</code>，写入下面的<a href="https://github.com/ruanyf/koa-demos/blob/master/.dockerignore">内容</a>。</p><blockquote><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">.gitnode_modulesnpm-debug.log<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>上面代码表示，这三个路径要排除，不要打包进入 image 文件。如果你没有路径要排除，这个文件可以不新建。</p></blockquote><p>然后，在项目的根目录下，新建一个文本文件 Dockerfile，写入下面的<a href="https://github.com/ruanyf/koa-demos/blob/master/Dockerfile">内容</a>。</p><blockquote><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">FROM node:8.4COPY <span class="token builtin class-name">.</span> /appWORKDIR /appRUN <span class="token function">npm</span> <span class="token function">install</span> --registry<span class="token operator">=</span>https://registry.npm.taobao.orgEXPOSE <span class="token number">3000</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>上面代码一共五行，含义如下。</p><ul><li><code>FROM node:8.4</code>：该 image 文件继承官方的 node image，冒号表示标签，这里标签是<code>8.4</code>，即8.4版本的 node。</li><li><code>COPY . /app</code>：将当前目录下的所有文件（除了<code>.dockerignore</code>排除的路径），都拷贝进入 image 文件的<code>/app</code>目录。</li><li><code>WORKDIR /app</code>：指定接下来的工作路径为<code>/app</code>。</li><li><code>RUN npm install</code>：在<code>/app</code>目录下，运行<code>npm install</code>命令安装依赖。注意，安装后所有的依赖，都将打包进入 image 文件。</li><li><code>EXPOSE 3000</code>：将容器 3000 端口暴露出来， 允许外部连接这个端口。</li></ul></blockquote><h5 id="创建-image-文件"><a href="#创建-image-文件" class="headerlink" title="创建 image 文件"></a>创建 image 文件</h5><p>有了 Dockerfile 文件以后，就可以使用<code>docker image build</code>命令创建 image 文件了。</p><blockquote><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ docker image build -t koa-demo <span class="token builtin class-name">.</span><span class="token comment"># 或者</span>$ docker image build -t koa-demo:0.0.1 <span class="token builtin class-name">.</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>上面代码中，<code>-t</code>参数用来指定 image 文件的名字，后面还可以用冒号指定标签。如果不指定，默认的标签就是<code>latest</code>。最后的那个点表示 Dockerfile 文件所在的路径，上例是当前路径，所以是一个点。</p></blockquote><p>如果运行成功，就可以看到新生成的 image 文件<code>koa-demo</code>了。</p><blockquote><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ docker image <span class="token function">ls</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h5 id="生成容器"><a href="#生成容器" class="headerlink" title="生成容器"></a>生成容器</h5></blockquote><p><code>docker container run</code>命令会从 image 文件生成容器。</p><blockquote><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ docker container run -p <span class="token number">8000</span>:3000 -it koa-demo /bin/bash<span class="token comment"># 或者</span>$ docker container run -p <span class="token number">8000</span>:3000 -it koa-demo:0.0.1 /bin/bash<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>上面命令的各个参数含义如下：</p><ul><li><code>-p</code>参数：容器的 3000 端口映射到本机的 8000 端口。</li><li><code>-it</code>参数：容器的 Shell 映射到当前的 Shell，然后你在本机窗口输入的命令，就会传入容器。</li><li><code>koa-demo:0.0.1</code>：image 文件的名字（如果有标签，还需要提供标签，默认是 latest 标签）。</li><li><code>/bin/bash</code>：容器启动以后，内部第一个执行的命令。这里是启动 Bash，保证用户可以使用 Shell。</li></ul></blockquote><p>如果一切正常，运行上面的命令以后，就会返回一个命令行提示符。</p><blockquote><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">root@66d80f4aaf1e:/app<span class="token comment">#</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>这表示你已经在容器里面了，返回的提示符就是容器内部的 Shell 提示符。执行下面的命令。</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">root@66d80f4aaf1e:/app<span class="token comment"># node demos/01.js</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>这时，Koa 框架已经运行起来了。打开本机的浏览器，访问 <a href="http://127.0.0.1:8000，网页显示&quot;Not">http://127.0.0.1:8000，网页显示"Not</a> Found”，这是因为这个 <a href="https://github.com/ruanyf/koa-demos/blob/master/demos/01.js">demo</a> 没有写路由。</p></blockquote><p>这个例子中，Node 进程运行在 Docker 容器的虚拟环境里面，进程接触到的文件系统和网络接口都是虚拟的，与本机的文件系统和网络接口是隔离的，因此需要定义容器与物理机的端口映射（map）。</p><p>现在，在容器的命令行，按下 Ctrl + c 停止 Node 进程，然后按下 Ctrl + d （或者输入 exit）退出容器。此外，也可以用<code>docker container kill</code>终止容器运行。</p><blockquote><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># 在本机的另一个终端窗口，查出容器的 ID</span>$ docker container <span class="token function">ls</span><span class="token comment"># 停止指定的容器运行</span>$ docker container <span class="token function">kill</span> <span class="token punctuation">[</span>containerID<span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>容器停止运行之后，并不会消失，用下面的命令删除容器文件。</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># 查出容器的 ID</span>$ docker container <span class="token function">ls</span> --all<span class="token comment"># 删除指定的容器文件</span>$ docker container <span class="token function">rm</span> <span class="token punctuation">[</span>containerID<span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>也可以使用<code>docker container run</code>命令的<code>--rm</code>参数，在容器终止运行后自动删除容器文件。</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ docker container run --rm -p <span class="token number">8000</span>:3000 -it koa-demo /bin/bash<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></blockquote><h5 id="CMD-命令"><a href="#CMD-命令" class="headerlink" title="CMD 命令"></a>CMD 命令</h5><p>上一节的例子里面，容器启动以后，需要手动输入命令<code>node demos/01.js</code>。我们可以把这个命令写在 Dockerfile 里面，这样容器启动以后，这个命令就已经执行了，不用再手动输入了。</p><blockquote><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">FROM node:8.4COPY <span class="token builtin class-name">.</span> /appWORKDIR /appRUN <span class="token function">npm</span> <span class="token function">install</span> --registry<span class="token operator">=</span>https://registry.npm.taobao.orgEXPOSE <span class="token number">3000</span>CMD node demos/01.js<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>上面的 Dockerfile 里面，多了最后一行<code>CMD node demos/01.js</code>，它表示容器启动后自动执行<code>node demos/01.js</code>。</p></blockquote><p>你可能会问，<code>RUN</code>命令与<code>CMD</code>命令的区别在哪里？简单说，<code>RUN</code>命令在 image 文件的构建阶段执行，执行结果都会打包进入 image 文件；<code>CMD</code>命令则是在容器启动后执行。另外，一个 Dockerfile 可以包含多个<code>RUN</code>命令，但是只能有一个<code>CMD</code>命令。</p><p>注意，指定了<code>CMD</code>命令以后，<code>docker container run</code>命令就不能附加命令了（比如前面的<code>/bin/bash</code>），否则它会覆盖<code>CMD</code>命令。现在，启动容器可以使用下面的命令。</p><blockquote><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ docker container run --rm -p <span class="token number">8000</span>:3000 -it koa-demo:0.0.1<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></blockquote><h5 id="发布-image-文件"><a href="#发布-image-文件" class="headerlink" title="发布 image 文件"></a>发布 image 文件</h5><p>容器运行成功后，就确认了 image 文件的有效性。这时，我们就可以考虑把 image 文件分享到网上，让其他人使用。</p><p>首先，去 <a href="https://hub.docker.com/">hub.docker.com</a> 或 <a href="https://cloud.docker.com/">cloud.docker.com</a> 注册一个账户。然后，用下面的命令登录。</p><blockquote><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ docker login<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>接着，为本地的 image 标注用户名和版本。</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ docker image tag <span class="token punctuation">[</span>imageName<span class="token punctuation">]</span> <span class="token punctuation">[</span>username<span class="token punctuation">]</span>/<span class="token punctuation">[</span>repository<span class="token punctuation">]</span>:<span class="token punctuation">[</span>tag<span class="token punctuation">]</span><span class="token comment"># 实例</span>$ docker image tag koa-demos:0.0.1 ruanyf/koa-demos:0.0.1<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>也可以不标注用户名，重新构建一下 image 文件。</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ docker image build -t <span class="token punctuation">[</span>username<span class="token punctuation">]</span>/<span class="token punctuation">[</span>repository<span class="token punctuation">]</span>:<span class="token punctuation">[</span>tag<span class="token punctuation">]</span> <span class="token builtin class-name">.</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>最后，发布 image 文件。</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ docker image push <span class="token punctuation">[</span>username<span class="token punctuation">]</span>/<span class="token punctuation">[</span>repository<span class="token punctuation">]</span>:<span class="token punctuation">[</span>tag<span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>发布成功以后，登录 hub.docker.com，就可以看到已经发布的 image 文件。</p></blockquote><h4 id="实例-：artipub——使用-docker-compose-代替-docker-run"><a href="#实例-：artipub——使用-docker-compose-代替-docker-run" class="headerlink" title="实例 ：artipub——使用 docker-compose 代替 docker run"></a>实例 ：artipub——使用 docker-compose 代替 docker run</h4><p>项目链接：<a href="https://github.com/crawlab-team/artipub">https://github.com/crawlab-team/artipub</a></p><ul><li><p>通过创建 <code>docker-compose.yaml</code> 文件，内容配置见下文</p></li><li><p>然后在命令行中输入如下命令</p><pre class="line-numbers language-none"><code class="language-none">docker-compose up<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li><li>然后在浏览器中输入 <code>http://localhost:8000</code> 可以看到界面。</li></ul><p><img src="/2021/01/11/docker-shi-yong-ji-lu/QQ截图20210111222839.png" alt=""></p><h5 id="Docker-Compose"><a href="#Docker-Compose" class="headerlink" title="Docker Compose"></a>Docker Compose</h5><h6 id="Compose-简介"><a href="#Compose-简介" class="headerlink" title="Compose 简介"></a>Compose 简介</h6><p>Compose 是用于定义和运行多容器 Docker 应用程序的工具。通过 Compose，我们可以使用 YML 文件来配置应用程序需要的所有服务。然后，使用一个命令，就可以从 YML 文件配置中创建并启动所有服务。如果还不了解 YML 文件配置，可以先阅读<a href="https://www.runoob.com/w3cnote/yaml-intro.html"> YAML 入门教程</a>。</p><p>Compose 使用的三个步骤：</p><ul><li>使用 Dockerfile 定义应用程序的环境。</li><li>使用 docker-compose.yml 定义构成应用程序的服务，这样它们可以在隔离环境中一起运行。</li><li>最后，执行 docker-compose up 命令来启动并运行整个应用程序。</li></ul><h6 id="Compose-安装"><a href="#Compose-安装" class="headerlink" title="Compose 安装"></a>Compose 安装</h6><p>Windows 的 Docker 桌面版和 Docker Toolbox 已经包括 Compose 和其他 Docker 应用程序，因此 Windows 用户不需要单独安装 Compose。Docker 安装说明可以参阅<a href="https://www.runoob.com/docker/windows-docker-install.html"> Windows Docker 安装</a>。</p><p>该项目的 docker-compose.yml 文件</p><pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"><span class="token key atrule">version</span><span class="token punctuation">:</span> <span class="token string">'3.3'</span><span class="token key atrule">services</span><span class="token punctuation">:</span>  <span class="token key atrule">app</span><span class="token punctuation">:</span>    <span class="token key atrule">image</span><span class="token punctuation">:</span> <span class="token string">"tikazyq/artipub:latest"</span>    <span class="token key atrule">environment</span><span class="token punctuation">:</span>      <span class="token key atrule">MONGO_HOST</span><span class="token punctuation">:</span> <span class="token string">"mongo"</span>      <span class="token key atrule">ARTIPUB_API_ADDRESS</span><span class="token punctuation">:</span> <span class="token string">"http://localhost:3000"</span> <span class="token comment"># 后端 API 地址，如果安装地址不在本机，请修改为协议 + 服务器 IP 地址 + 端口号（默认为 3000）</span>    <span class="token key atrule">ports</span><span class="token punctuation">:</span>      <span class="token punctuation">-</span> <span class="token string">"8000:8000"</span> <span class="token comment"># frontend</span>      <span class="token punctuation">-</span> <span class="token string">"3000:3000"</span> <span class="token comment"># backend</span>    <span class="token key atrule">depends_on</span><span class="token punctuation">:</span>      <span class="token punctuation">-</span> mongo  <span class="token key atrule">mongo</span><span class="token punctuation">:</span>    <span class="token key atrule">image</span><span class="token punctuation">:</span> mongo<span class="token punctuation">:</span>latest    <span class="token key atrule">restart</span><span class="token punctuation">:</span> always    <span class="token key atrule">ports</span><span class="token punctuation">:</span>      <span class="token punctuation">-</span> <span class="token string">"27017:27017"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>这里需要格外注意 yml 文件的格式、缩进、是否有空置、数据格式是否符合等问题，如果出现报错（因为已经遇到错误了，源文件是有个值为空），根据报错信息检查对应的问题。</p><p>打开 120.0.0.1:8000</p><p><img src="/2021/01/11/docker-shi-yong-ji-lu/QQ截图20210111221618.png" alt=""></p><h3 id="相关资料"><a href="#相关资料" class="headerlink" title="相关资料"></a>相关资料</h3><p><a href="https://www.ruanyifeng.com/blog/2018/02/docker-tutorial.html">阮一峰 Docker 入门教程</a></p><p><a href="http://www.ruanyifeng.com/blog/2018/02/docker-wordpress-tutorial.html">阮一峰 Docker 微服务教程</a></p><p><a href="https://phoenixnap.com/kb/docker-image-vs-container">Docker Image Vs Container: The Major Differences</a></p><p><a href="https://www.runoob.com/docker/docker-compose.html">Docker Compose</a></p><p><a href="https://github.com/crawlab-team/artipub">artipub</a></p><p><a href="https://beginor.github.io/2017/06/08/use-compose-instead-of-run.html">使用 docker-compose 替代 docker run</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> Docker </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Task1 论文数据统计</title>
      <link href="2021/01/11/task1-lun-wen-shu-ju-tong-ji/"/>
      <url>2021/01/11/task1-lun-wen-shu-ju-tong-ji/</url>
      
        <content type="html"><![CDATA[<h1 id="Task1-论文数据统计"><a href="#Task1-论文数据统计" class="headerlink" title="Task1 论文数据统计"></a>Task1 论文数据统计</h1><h2 id="任务说明"><a href="#任务说明" class="headerlink" title="任务说明"></a>任务说明</h2><ul><li>任务主题：论文数量统计，即统计2019年全年计算机各个方向论文数量；</li><li>任务内容：赛题的理解、使用 <strong>Pandas</strong> 读取数据并进行统计；</li><li>任务成果：学习 <strong>Pandas</strong> 的基础操作；</li><li>可参考的学习资料：<a href="https://github.com/datawhalechina/joyful-pandas">开源组织Datawhale joyful-pandas项目</a></li></ul><h2 id="数据集介绍"><a href="#数据集介绍" class="headerlink" title="数据集介绍"></a>数据集介绍</h2><ul><li>数据集来源：<a href="https://www.kaggle.com/Cornell-University/arxiv">数据集链接</a>；</li><li>数据集的格式如下：<ul><li><code>id</code>：arXiv ID，可用于访问论文；</li><li><code>submitter</code>：论文提交者；</li><li><code>authors</code>：论文作者；</li><li><code>title</code>：论文标题；</li><li><code>comments</code>：论文页数和图表等其他信息；</li><li><code>journal-ref</code>：论文发表的期刊的信息；</li><li><code>doi</code>：数字对象标识符，<a href="https://www.doi.org/">https://www.doi.org</a>；</li><li><code>report-no</code>：报告编号；</li><li><code>categories</code>：论文在 arXiv 系统的所属类别或标签；</li><li><code>license</code>：文章的许可证；</li><li><code>abstract</code>：论文摘要；</li><li><code>versions</code>：论文版本；</li><li><code>authors_parsed</code>：作者的信息。</li></ul></li></ul><h2 id="一、加载数据"><a href="#一、加载数据" class="headerlink" title="一、加载数据"></a>一、加载数据</h2><h3 id="导入-package"><a href="#导入-package" class="headerlink" title="导入 package"></a>导入 package</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># 导入所需的package</span><span class="token keyword">import</span> seaborn <span class="token keyword">as</span> sns <span class="token comment">#用于画图</span><span class="token keyword">from</span> bs4 <span class="token keyword">import</span> BeautifulSoup <span class="token comment">#用于爬取arxiv的数据</span><span class="token keyword">import</span> re <span class="token comment">#用于正则表达式，匹配字符串的模式</span><span class="token keyword">import</span> requests <span class="token comment">#用于网络连接，发送网络请求，使用域名获取对应信息</span><span class="token keyword">import</span> json <span class="token comment">#读取数据，我们的数据为json格式的</span><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd <span class="token comment">#数据处理，数据分析</span><span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt <span class="token comment">#画图工具</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="读取-json-文件"><a href="#读取-json-文件" class="headerlink" title="读取 json 文件"></a>读取 json 文件</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python">data <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"../data/arxiv-metadata-oai-snapshot.json"</span><span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>    <span class="token keyword">for</span> line <span class="token keyword">in</span> f<span class="token punctuation">:</span>        data<span class="token punctuation">.</span>append<span class="token punctuation">(</span>json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>line<span class="token punctuation">)</span><span class="token punctuation">)</span>data <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>data<span class="token punctuation">)</span>data<span class="token punctuation">.</span>shape<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-none"><code class="language-none">(1796911, 14)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h2 id="二、数据预处理"><a href="#二、数据预处理" class="headerlink" title="二、数据预处理"></a>二、数据预处理</h2><h3 id="筛选出指定的列和2019年后的数据"><a href="#筛选出指定的列和2019年后的数据" class="headerlink" title="筛选出指定的列和2019年后的数据"></a>筛选出指定的列和2019年后的数据</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python">data <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'id'</span><span class="token punctuation">,</span> <span class="token string">'categories'</span><span class="token punctuation">,</span> <span class="token string">'update_date'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token keyword">print</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>shape<span class="token punctuation">)</span>data<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><pre><code>(1796911, 3)</code></pre><pre class="line-numbers language-python" data-language="python"><code class="language-python">data<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"categories"</span><span class="token punctuation">,</span> <span class="token string">"year"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>data<span class="token punctuation">.</span>reset_index<span class="token punctuation">(</span>drop<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> inplace<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>data<span class="token punctuation">.</span>shape<span class="token punctuation">)</span>data<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>id</th>      <th>categories</th>      <th>year</th>    </tr>  </thead>  <tbody>    <tr>      <th>0</th>      <td>0704.0297</td>      <td>astro-ph</td>      <td>2019</td>    </tr>    <tr>      <th>1</th>      <td>0704.0342</td>      <td>math.AT</td>      <td>2019</td>    </tr>    <tr>      <th>2</th>      <td>0704.0360</td>      <td>astro-ph</td>      <td>2019</td>    </tr>    <tr>      <th>3</th>      <td>0704.0525</td>      <td>gr-qc</td>      <td>2019</td>    </tr>    <tr>      <th>4</th>      <td>0704.0535</td>      <td>astro-ph</td>      <td>2019</td>    </tr>  </tbody></table><h3 id="Describe-粗略描述"><a href="#Describe-粗略描述" class="headerlink" title="Describe 粗略描述"></a>Describe 粗略描述</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python">data<span class="token punctuation">.</span>describe<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th></th>      <th>id</th>      <th>categories</th>      <th>update_date</th>    </tr>  </thead>  <tbody>    <tr>      <th>count</th>      <td>1796911</td>      <td>1796911</td>      <td>1796911</td>    </tr>    <tr>      <th>unique</th>      <td>1796907</td>      <td>62055</td>      <td>4095</td>    </tr>    <tr>      <th>top</th>      <td>math-ph/0408005</td>      <td>astro-ph</td>      <td>2007-05-23</td>    </tr>    <tr>      <th>freq</th>      <td>2</td>      <td>86914</td>      <td>130748</td>    </tr>  </tbody></table><br>以上的结果表明：共有1796911个数据，有62055个子类（因为有论文的类别是多个，例如一篇paper的类别是CS.AI &amp; CS.MM和一篇paper的类别是CS.AI &amp; CS.OS属于不同的子类别，这里仅仅是粗略统计），其中最多的种类是astro-ph，即Astrophysics（天体物理学），共出现了86914次。</p><p>由于部分论文的类别不止一种，所以下面我们判断在本数据集中共出现了多少种独立的数据集。</p><h3 id="列表推导式"><a href="#列表推导式" class="headerlink" title="列表推导式"></a>列表推导式</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python">unique_categories <span class="token operator">=</span> <span class="token builtin">set</span><span class="token punctuation">(</span><span class="token punctuation">[</span>i <span class="token keyword">for</span> l <span class="token keyword">in</span> <span class="token punctuation">[</span>x<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">' '</span><span class="token punctuation">)</span> <span class="token keyword">for</span> x <span class="token keyword">in</span> data<span class="token punctuation">[</span><span class="token string">"categories"</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> l<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token builtin">len</span><span class="token punctuation">(</span>unique_categories<span class="token punctuation">)</span>unique_categories<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>这里最开始没有理解是因为 <code>[x.split(' ') for x in data["categories"]]</code> 这一块作为了迭代的对象，把它看作一个整体就是一个双层标准的列表推导式了。</p><p><img src="/2021/01/11/task1-lun-wen-shu-ju-tong-ji/微信图片_20210111224447.png" alt=""></p><p>就常见的三种普通循环、列表推导式、map()函数效率来说，列表推导式的效率最高，其次是map()函数，正常的for循环效率是最低的，这一点尤其在解决大循环量问题时较为明显。</p><h4 id="补充"><a href="#补充" class="headerlink" title="补充"></a>补充</h4><p>在生成一个数字序列的时候，在 <code>Python</code> 中可以如下写出：</p><pre class="line-numbers language-none"><code class="language-none">In [1]: L = []In [2]: def my_func(x):   ...:     return 2*x   ...: In [3]: for i in range(5):   ...:     L.append(my_func(i))   ...: In [4]: LOut[4]: [0, 2, 4, 6, 8]<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>事实上可以利用列表推导式进行写法上的简化： <code>[* for i in *]</code> 。其中，第一个 <code>*</code> 为映射函数，其输入为后面 <code>i</code> 指代的内容，第二个 <code>*</code> 表示迭代的对象。</p><pre class="line-numbers language-none"><code class="language-none">In [5]: [my_func(i) for i in range(5)]Out[5]: [0, 2, 4, 6, 8]<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>列表表达式还支持多层嵌套，如下面的例子中第一个 <code>for</code> 为外层循环，第二个为内层循环：</p><pre class="line-numbers language-none"><code class="language-none">In [6]: [m+'_'+n for m in ['a', 'b'] for n in ['c', 'd']]Out[6]: ['a_c', 'a_d', 'b_c', 'b_d']<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h2 id="三、数据可视化"><a href="#三、数据可视化" class="headerlink" title="三、数据可视化"></a>三、数据可视化</h2><h3 id="Pandas-数据处理"><a href="#Pandas-数据处理" class="headerlink" title="Pandas 数据处理"></a>Pandas 数据处理</h3><p>使用merge函数，以两个dataframe共同的属性 “categories” 进行合并，并以 “group_name” 作为类别进行统计，统计结果放入 “id” 列中并排序。</p><p>agg 用于自定义分组的聚合方法，可以通过 agg 对内置函数名进行修改，但是不能去修改列名，修改后会变成多维。如果需要修改列名，使用 rename 就好了。</p><p><img src="/2021/01/11/task1-lun-wen-shu-ju-tong-ji/微信图片_20210111224129.png" alt=""></p><p>df.rename()</p><p><img src="/2021/01/11/task1-lun-wen-shu-ju-tong-ji/微信图片_20210111224220.png" alt=""></p><h3 id="figure-axes-subplot-axis的区别"><a href="#figure-axes-subplot-axis的区别" class="headerlink" title="figure,axes(subplot),axis的区别"></a>figure,axes(subplot),axis的区别</h3><p><code>figure/fig</code> 空白画布</p><ul><li>figure</li></ul><blockquote><p>figure是图像的载体,使用 <code>plt.figure()</code> 创建，一个程序可以创建多个画布，画图操作作用于最近创建的画布上, 多个画布顺序显示。</p></blockquote><p><code>ax</code>单个坐标系 / <code>axes</code> 复数坐标系</p><ul><li>axes (subplot)</li></ul><blockquote><p>坐标系,可理解为画布上的一个区域, 一个 figure 上可以有多个 axes ，被分成多个区域， 可用 <code>plt.axes</code> 和<code>plt.subplots/plt.subplot</code> 来创建， <code>plt</code> 画图操作本质就是操作 axes 对象，。</p></blockquote><p><code>axis</code> 坐标轴</p><ul><li>axis</li></ul><blockquote><p>坐标轴，画的图都是基于坐标轴的</p></blockquote><p>确定一种风格就可以，我比较习惯可常用的是 <code>fig, ax = plt.subplots()</code>，好处是，我可以任意添加子图，通过调整子图个数参数，方便将多个图画在一张画布上。</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">fig<span class="token punctuation">,</span> ax <span class="token operator">=</span> plt<span class="token punctuation">.</span>subplots<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">)</span>explode <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0.2</span><span class="token punctuation">,</span> <span class="token number">0.3</span><span class="token punctuation">,</span> <span class="token number">0.3</span><span class="token punctuation">,</span> <span class="token number">0.2</span><span class="token punctuation">,</span> <span class="token number">0.1</span><span class="token punctuation">)</span> ax<span class="token punctuation">.</span>pie<span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">"count"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> labels<span class="token operator">=</span>df<span class="token punctuation">[</span><span class="token string">"group_name"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> autopct<span class="token operator">=</span><span class="token string">'%1.2f%%'</span><span class="token punctuation">,</span> startangle<span class="token operator">=</span><span class="token number">160</span><span class="token punctuation">,</span> shadow<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> explode<span class="token operator">=</span>explode<span class="token punctuation">)</span>ax<span class="token punctuation">.</span>axis<span class="token punctuation">(</span><span class="token string">'equal'</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>tight_layout<span class="token punctuation">(</span><span class="token punctuation">)</span>plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="/2021/01/11/task1-lun-wen-shu-ju-tong-ji/下载.png" alt=""></p><h3 id="统计各领域-paper-数量"><a href="#统计各领域-paper-数量" class="headerlink" title="统计各领域 paper 数量"></a>统计各领域 paper 数量</h3><p>下面统计在计算机各个子领域2019年后的paper数量，我们同样使用 merge 函数，对于两个dataframe 共同的特征 categories 进行合并并且进行查询。然后我们再对于数据进行统计和排序从而得到以下的结果：</p><pre class="line-numbers language-none"><code class="language-none">cat = cats.groupby(["year","category_name"]).count().reset_index().pivot(index="category_name", columns="year", values="id")cat.sort_values([2020, 2019],ascending=False)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><table border="1" class="dataframe">  <thead>    <tr style="text-align: right;">      <th>year</th>      <th>2019</th>      <th>2020</th>    </tr>    <tr>      <th>category_name</th>      <th></th>      <th></th>    </tr>  </thead>  <tbody>    <tr>      <th>Computer Vision and Pattern Recognition</th>      <td>5559</td>      <td>6517</td>    </tr>    <tr>      <th>Computation and Language</th>      <td>2153</td>      <td>2906</td>    </tr>    <tr>      <th>Robotics</th>      <td>917</td>      <td>1298</td>    </tr>    <tr>      <th>Cryptography and Security</th>      <td>1067</td>      <td>1238</td>    </tr>    <tr>      <th>Data Structures and Algorithms</th>      <td>711</td>      <td>902</td>    </tr>    <tr>      <th>Software Engineering</th>      <td>659</td>      <td>804</td>    </tr>    <tr>      <th>Networking and Internet Architecture</th>      <td>864</td>      <td>783</td>    </tr>    <tr>      <th>Distributed, Parallel, and Cluster Computing</th>      <td>715</td>      <td>774</td>    </tr>    <tr>      <th>Artificial Intelligence</th>      <td>558</td>      <td>757</td>    </tr>    <tr>      <th>Human-Computer Interaction</th>      <td>420</td>      <td>580</td>    </tr>    <tr>      <th>Computers and Society</th>      <td>346</td>      <td>564</td>    </tr>    <tr>      <th>Machine Learning</th>      <td>177</td>      <td>538</td>    </tr>    <tr>      <th>Logic in Computer Science</th>      <td>470</td>      <td>504</td>    </tr>    <tr>      <th>Databases</th>      <td>282</td>      <td>342</td>    </tr>    <tr>      <th>Information Retrieval</th>      <td>245</td>      <td>331</td>    </tr>    <tr>      <th>Social and Information Networks</th>      <td>202</td>      <td>325</td>    </tr>    <tr>      <th>Computer Science and Game Theory</th>      <td>281</td>      <td>323</td>    </tr>    <tr>      <th>Programming Languages</th>      <td>268</td>      <td>294</td>    </tr>    <tr>      <th>Neural and Evolutionary Computing</th>      <td>235</td>      <td>279</td>    </tr>    <tr>      <th>Computational Geometry</th>      <td>199</td>      <td>216</td>    </tr>    <tr>      <th>Computational Engineering, Finance, and Science</th>      <td>108</td>      <td>205</td>    </tr>    <tr>      <th>Computational Complexity</th>      <td>131</td>      <td>188</td>    </tr>    <tr>      <th>Hardware Architecture</th>      <td>95</td>      <td>159</td>    </tr>    <tr>      <th>Digital Libraries</th>      <td>125</td>      <td>157</td>    </tr>    <tr>      <th>Graphics</th>      <td>116</td>      <td>151</td>    </tr>    <tr>      <th>Formal Languages and Automata Theory</th>      <td>152</td>      <td>137</td>    </tr>    <tr>      <th>Systems and Control</th>      <td>415</td>      <td>133</td>    </tr>    <tr>      <th>Multiagent Systems</th>      <td>85</td>      <td>90</td>    </tr>    <tr>      <th>Emerging Technologies</th>      <td>101</td>      <td>84</td>    </tr>    <tr>      <th>Discrete Mathematics</th>      <td>84</td>      <td>81</td>    </tr>    <tr>      <th>Other Computer Science</th>      <td>67</td>      <td>69</td>    </tr>    <tr>      <th>Multimedia</th>      <td>76</td>      <td>66</td>    </tr>    <tr>      <th>Performance</th>      <td>45</td>      <td>51</td>    </tr>    <tr>      <th>Mathematical Software</th>      <td>27</td>      <td>45</td>    </tr>    <tr>      <th>Symbolic Computation</th>      <td>44</td>      <td>36</td>    </tr>    <tr>      <th>Operating Systems</th>      <td>36</td>      <td>33</td>    </tr>    <tr>      <th>Numerical Analysis</th>      <td>40</td>      <td>11</td>    </tr>    <tr>      <th>General Literature</th>      <td>5</td>      <td>5</td>    </tr>    <tr>      <th>Sound</th>      <td>7</td>      <td>4</td>    </tr>  </tbody></table><br>我们可以从结果看出，Computer Vision and Pattern Recognition（计算机视觉与模式识别）类是CS中paper数量最多的子类，遥遥领先于其他的CS子类，并且paper的数量还在逐年增加；另外，Computer Vision and Pattern Recognition（计算机视觉与模式识别）、Computation and Language（计算与语言）、Robotics（机器人学）以及Cryptography and Security（密码学与安全）四个领域排名前四，并且 Paper 数量都超过1000，这与我们的认知是一致的。</p><h2 id="相关资料"><a href="#相关资料" class="headerlink" title="相关资料"></a>相关资料</h2><p><a href="http://inter.joyfulpandas.datawhale.club/Content/ch1.html">列表推导式：第一章 预备知识 — Joyful Pandas 1.0 documentation (datawhale.club)</a></p><p><a href="https://blog.csdn.net/weixin_43483381/article/details/93380914">python 普通循环、列表推导式、map()函数三者效率的对比</a></p><p><a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.agg.html">pandas.DataFrame.agg — pandas 1.2.0 documentation (pydata.org)</a></p><p><a href="http://inter.joyfulpandas.datawhale.club/Content/ch2.html">第二章 pandas基础 — Joyful Pandas 1.0 documentation (datawhale.club)</a></p><p><a href="http://inter.joyfulpandas.datawhale.club/Content/ch4.html">第四章 分组 — Joyful Pandas 1.0 documentation (datawhale.club)</a></p><p><a href="https://matplotlib.org/gallery/pie_and_polar_charts/pie_features.html#sphx-glr-gallery-pie-and-polar-charts-pie-features-py">Basic pie chart — Matplotlib 3.3.3 documentation</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> Datawhale </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Typora快捷键和排版格式使用</title>
      <link href="2021/01/10/typora-kuai-jie-jian-he-pai-ban-ge-shi-shi-yong/"/>
      <url>2021/01/10/typora-kuai-jie-jian-he-pai-ban-ge-shi-shi-yong/</url>
      
        <content type="html"><![CDATA[<h1 id="Typora快捷键和排版格式使用"><a href="#Typora快捷键和排版格式使用" class="headerlink" title="Typora快捷键和排版格式使用"></a>Typora快捷键和排版格式使用</h1><h2 id="windows快捷键：转载"><a href="#windows快捷键：转载" class="headerlink" title="windows快捷键：转载"></a>windows快捷键：<a href="https://www.cnblogs.com/hongdada/p/9776547.html#windows快捷键：">转载</a></h2><ul><li>无序列表：输入-之后输入空格</li><li>有序列表：输入数字+“.”之后输入空格</li><li>任务列表：-[空格]空格 文字</li><li>标题：ctrl+数字</li><li>表格：ctrl+t</li><li>生成目录：<code>[TOC]</code>按回车</li><li>选中一整行：ctrl+l</li><li>选中单词：ctrl+d</li><li>选中相同格式的文字：ctrl+e</li><li>跳转到文章开头：ctrl+home</li><li>跳转到文章结尾：ctrl+end</li><li>搜索：ctrl+f</li><li>替换：ctrl+h</li><li>引用：输入&gt;之后输入空格</li><li>代码块：ctrl+alt+f</li><li>加粗：ctrl+b</li><li>倾斜：ctrl+i</li><li>下划线：ctrl+u</li><li>删除线：alt+shift+5</li><li>插入图片：直接拖动到指定位置即可或者ctrl+shift+i</li><li>插入链接：ctrl + k</li></ul><h2 id="相关资料"><a href="#相关资料" class="headerlink" title="相关资料"></a>相关资料</h2><p><a href="https://sspai.com/post/54912">Typora 完全使用详解 - 少数派 (sspai.com)</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> typora </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>hexo中插入本地图片</title>
      <link href="2021/01/10/hexo-zhong-cha-ru-ben-di-tu-pian/"/>
      <url>2021/01/10/hexo-zhong-cha-ru-ben-di-tu-pian/</url>
      
        <content type="html"><![CDATA[<h1 id="hexo中完美插入本地图片"><a href="#hexo中完美插入本地图片" class="headerlink" title="hexo中完美插入本地图片"></a>hexo中完美插入本地图片</h1><p>刚入手hexo写博客就遇到了在博客中插入图片这一问题，总结一下解决方法</p><h3 id="本地引用"><a href="#本地引用" class="headerlink" title="本地引用"></a>本地引用</h3><h4 id="绝对路径"><a href="#绝对路径" class="headerlink" title="绝对路径"></a>绝对路径</h4><p>当Hexo项目中只用到少量图片时，可以将图片统一放在<code>source/images</code>文件夹中，通过markdown语法访问它们。</p><pre class="line-numbers language-none"><code class="language-none">![](/images/image.jpg)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="相对路径"><a href="#相对路径" class="headerlink" title="相对路径"></a>相对路径</h4><h5 id="Hexo配置文件的设置"><a href="#Hexo配置文件的设置" class="headerlink" title="Hexo配置文件的设置"></a>Hexo配置文件的设置</h5><p>修改Hexo的配置文件_config.yml里面的post_asset_folder，并将其置为true</p><pre class="line-numbers language-none"><code class="language-none">post_asset_folder: true<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>将<code>_config.yml</code>文件中的配置项<code>post_asset_folder</code>设为<code>true</code>后，执行命令<code>$ hexo new post_name</code>，在<code>source/_posts</code>中会生成文章<code>post_name.md</code>和同名文件夹<code>post_name</code>。将图片资源放在<code>post_name</code>中，文章就可以使用相对路径引用图片资源了。</p><p><img src="/2021/01/10/hexo-zhong-cha-ru-ben-di-tu-pian/QQ图片20210110211009.png" alt=""></p><h5 id="修改Typora插入图片为相对路径"><a href="#修改Typora插入图片为相对路径" class="headerlink" title="修改Typora插入图片为相对路径"></a>修改Typora插入图片为相对路径</h5><p>我是使用Typora来写md文档，因为其所见即所得，但是Typora默认插入图片使用的绝对路径，这就需要我们去修改前缀，并替换反斜杠，这样并不是很方便，因此我们可以通过修改Typora的默认配置，使用相对路径插入图片。</p><ul><li><p>使用<code>Ctrl+逗号</code>打开Typora的偏好设置</p></li><li><p>选择图像，<code>勾选优先使用相对路径</code></p></li></ul><p><img src="/2021/01/10/hexo-zhong-cha-ru-ben-di-tu-pian/QQ图片20210110205504.png" alt=""></p><h5 id="安装hexo-asset-image"><a href="#安装hexo-asset-image" class="headerlink" title="安装hexo-asset-image"></a>安装hexo-asset-image</h5><p>这个地方我也不是很清楚，如果不安装hexo-asset-image，只要安装上述内容，也是可以完成图片显示的。在<a href="[hexo中完美插入本地图片 | ETRD博客](http://etrd.org/2017/01/23/hexo中完美插入本地图片/">ETRD</a>)的博客中找到了相关解释。</p><p>你需要安装一个图片路径转换的插件，这个插件名字是<strong><a href="https://github.com/CodeFalling/hexo-asset-image">hexo-asset-image</a></strong>，我目前安装的是最新的0.03版本，使用如下命令安装插件</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">npm install https<span class="token punctuation">:</span><span class="token operator">//</span>github<span class="token punctuation">.</span>com<span class="token operator">/</span>CodeFalling<span class="token operator">/</span>hexo<span class="token operator">-</span>asset<span class="token operator">-</span>image <span class="token operator">-</span><span class="token operator">-</span>save<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>插件安装完以后，实际上是存放在下面的目录文件夹下</p><pre class="line-numbers language-none"><code class="language-none">\blog\node_modules\hexo-asset-image<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>想要卸载这个插件怎么处理，我听说直接删掉这个文件夹，反正我这么试过了。</p><h5 id="md文件的时间标签"><a href="#md文件的时间标签" class="headerlink" title="md文件的时间标签"></a>md文件的时间标签</h5><p>hexo-asset-image的原理应该是根据Hexo生成html后以时间的为目录的规则，将我们图片的相对地址转换成了生成后与时间对应目录的绝对地址，因此我认为md文件中应该要有时间标签，一来是为了让Hexo根据md的时间标签来确定文章的新旧排序，如果没有时间标签，Hexo会把md文件的修改时间作为发布时间，这显然是不合理的，再者这个时间标签，我想hexo-asset-image也会引用到，在一篇实际的博文中，我的md文件完整的开头是这样的：</p><pre class="line-numbers language-none"><code class="language-none">---title: hexo中完美插入本地图片date: 2017-01-23 11:00:55categories: hexo使用tags: - hexo- 本地图片- hexo-asset-image---<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>除了使用本地引用，也可以使用CDN引用，参考yanyinhong博客解读</p><h3 id="CDN引用"><a href="#CDN引用" class="headerlink" title="CDN引用"></a><a href="https://yanyinhong.github.io/2017/05/02/How-to-insert-image-in-hexo-post/">CDN引用</a></h3><p>除了在本地存储图片，还可以将图片上传到一些免费的CDN服务中。比如<a href="http://cloudinary.com/">Cloudinary</a>提供的图片CDN服务，在Cloudinary中上传图片后，会生成对应的url地址，将地址直接拿来引用即可。</p><h5 id="相关资料"><a href="#相关资料" class="headerlink" title="相关资料"></a>相关资料</h5><p><a href="http://etrd.org/2017/01/23/hexo中完美插入本地图片/">hexo中完美插入本地图片 | ETRD博客</a></p><p><a href="https://yanyinhong.github.io/2017/05/02/How-to-insert-image-in-hexo-post/">Hexo博客搭建之在文章中插入图片</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> hexo </tag>
            
            <tag> 本地图片 </tag>
            
            <tag> hexo-asset-image </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>jupyter notebook打开其他盘方法</title>
      <link href="2021/01/10/jupyter-notebook-da-kai-qi-ta-pan-fang-fa/"/>
      <url>2021/01/10/jupyter-notebook-da-kai-qi-ta-pan-fang-fa/</url>
      
        <content type="html"><![CDATA[<h1 id="jupyter-notebook打开其他盘方法"><a href="#jupyter-notebook打开其他盘方法" class="headerlink" title="jupyter notebook打开其他盘方法"></a>jupyter notebook打开其他盘方法</h1><p>正常打开jupyter，只能看到C盘路径下的文件，大致如下</p><p><img src="/2021/01/10/jupyter-notebook-da-kai-qi-ta-pan-fang-fa/image-20210110195024371.png" alt=""></p><p>如果需要运行的文件在别的盘，仅仅是这个页面是切换不了盘的</p><h3 id="解决办法"><a href="#解决办法" class="headerlink" title="解决办法"></a>解决办法</h3><p>（Windows用户）打开cmd，切盘，运行jupyter notebook</p><p><img src="/2021/01/10/jupyter-notebook-da-kai-qi-ta-pan-fang-fa/image-20210110200008261.png" alt=""></p><h3 id="换盘结果"><a href="#换盘结果" class="headerlink" title="换盘结果"></a>换盘结果</h3><p><img src="/2021/01/10/jupyter-notebook-da-kai-qi-ta-pan-fang-fa/QQ截图20210110204045.png" alt=""></p>]]></content>
      
      
      
        <tags>
            
            <tag> hexo </tag>
            
            <tag> 本地图片 </tag>
            
            <tag> hexo-asset-image </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>机器学习和数据科学网站</title>
      <link href="2021/01/09/ji-qi-xue-xi-he-shu-ju-ke-xue-wang-zhan/"/>
      <url>2021/01/09/ji-qi-xue-xi-he-shu-ju-ke-xue-wang-zhan/</url>
      
        <content type="html"><![CDATA[<h1 id="机器学习和数据科学网站-转载"><a href="#机器学习和数据科学网站-转载" class="headerlink" title="机器学习和数据科学网站(转载)"></a>机器学习和数据科学网站(转载)</h1><p><strong>以下为译文：</strong></p><p>如今，科技界最热门的话题莫过于最先进、最前沿、最令人兴奋的数据科学和机器学习了。然而，要想紧跟该领域的进步和发展，你需要付出大量努力来研究、阅读和查看信息、新闻、指南以及其他内容。</p><p>这项任务并没有简单的解决方案。你会发现很多地方都涌现出了大量标题党，但仅靠这些文章是否就足够？每天我都会看到海量的信息，但不幸的是，大多数都是虚假或毫无价值的东西，尤其是关于数据科学和机器学习的东西。我们究竟应该从哪里寻找有用的资料呢？让本文来为你解答。</p><p>我想通过本文与你分享我最喜欢和最信得过的资源。</p><p><strong>1. r/datascience 和 r/MachineLearning</strong></p><p>链接：</p><ul><li><p><a href="https://www.reddit.com/r/datascience/">https://www.reddit.com/r/datascience/</a></p></li><li><p><a href="https://www.reddit.com/r/MachineLearning/">https://www.reddit.com/r/MachineLearning/</a></p></li></ul><p>无论你是专业人士还是业余爱好者，Reddit 都是不同经验水平的科学家和机器学习工程师共享信息的理想之地。你可以在上面讨论问题和热门话题，还可以看到所有最新的成果，Reddit 可以为你带来各种各样有趣的新闻。就我个人而言，我选择了最热门和最受欢迎的主题，很多时候都能收到很多重要的信息。</p><p><strong>2. DataCamp</strong></p><p>链接：<a href="https://www.datacamp.com/community/blog">https://www.datacamp.com/community/blog</a></p><p>如果没有 DataCamp，我甚至无法想象如何发展数据科学职业。为什么？当然，对于新手来说，这是一个完美的选择，但绝非唯一。我发现，如果你有兴趣学习一种新语言，那么这是一个非常棒的资源。但是，仅靠这些资源还不足以帮助你成为数据科学家。我觉得他们的程序缺少一个实际项目，无法给你带来实际需要解决的挑战。以我的经验来看，学习数据科学的最好方法就是参与一些实际的项目。</p><p><strong>3. KDnuggets</strong></p><p>链接：<a href="https://www.kdnuggets.com/">https://www.kdnuggets.com/</a></p><p>这是最受欢迎的资源之一。上面的文章涵盖了方方面面的问题和案例，以及新闻、招聘、软件、事件等等。因此，这是一个面向数据科学爱好者的完美资源。你可以获得有关数据科学领域中发生的新变化，以及需要上什么课程等各种信息。但是，KDnuggets 的组织方式有所不同，它侧重于行业新闻、观点和访谈、公开可用的数据集以及数据科学软件。</p><p><strong>4. Datafloq</strong></p><p>链接：<a href="https://datafloq.com/">https://datafloq.com/</a></p><p>Datafloq 提供了推动大数据、区块链、人工智能和其他新兴技术（例如数据科学）创新方面的信息、见解和机遇。该网站的目标成为提供高质量文章，寻找大数据和技术供应商，人才招聘以及发布活动的中心。Datafloq 还提供在线培训。这个网站的对象不仅包括数据科学工作者，还包括安全和物联网。</p><p><strong>5. CodeMentor.io</strong></p><p>链接：<a href="https://www.codementor.io/community/topic/data-science">https://www.codementor.io/community/topic/data-science</a></p><p>这是一个学习编程的在线指导平台，我个人非常喜欢这个网站。该网站主要侧重于为所有努力学习编程的业余爱好者提供教程，而对于机器和数据科学的工作者来说，编程是必不可少的技能。该网站提供了高级开发人员的见解、定制的阅读清单，还可以与世界各地的开发人员取得联系。网站上的热门主题包括 Angular、JavaScript、Node.js，Ruby 和 Python。我最喜欢这个网站的一点是，工作人员的反应非常迅速（由于我们处于不同的时区），他们很专业，而且他们关心客户和导师。以我的经验来看，找到一个优秀的导师实属不易。很多人花了钱，得到的结果却是自己搜 Google，显然没有太大帮助性。</p><p><strong>6. Distill</strong></p><p>链接：<a href="https://distill.pub/about/">https://distill.pub/about/</a></p><p>Distill 声称可以提供清晰、动态和生动的机器学习研究。尽管这个网站在科学家中并不那么受欢迎，但确实提供了很多实用的内容。绝大多数文章都有有趣的研究和发现，但最重要的是，所有文章都是由在 Open AI、苹果和特斯拉等公司工作的顶尖专家编写和编辑的。</p><p><strong>7. DATAVERSITY</strong></p><p>链接：<a href="https://www.dataversity.net/">https://www.dataversity.net/</a></p><p>DATAVERSITY Education 为业务和信息技术专业人员提供有关数据使用和管理的内容。这个团队为全球的工作者、专家和开发人员社区提供内容，还通过面对面主持的会议、实时网络研讨会、白皮书、在线培训每日新闻和文章以及博客等各个方面帮助他们。此外，这个网站还提供免费的每周新闻。</p><p><strong>8. Data Science Central</strong></p><p>链接：<a href="https://www.datasciencecentral.com/">https://www.datasciencecentral.com/</a></p><p>Data Science Central 可能是网上最优秀的独立数据科学博客。该网站专门面向大数据工作者，为他们提供社区体验，其中包括广阔的编辑平台、社交互动、基于论坛的技术支持及最新的技术、工具和趋势，以及针对行业的求职信息。Data Science Central 还提供网络研讨会，该网站的会员套餐还可免费访问该网站上的所有内容。</p><p><strong>9. Machine Learning Mastery</strong></p><p>链接：<a href="https://machinelearningmastery.com/">https://machinelearningmastery.com/</a></p><p>首先声明这个网站并非向你介绍机器学习。它不会向你介绍神经网络是什么，单词嵌入背后的数学原理以及所有其他机器学习的知识。你需要在其他地方学习这些理论。不要妄想借助这个网站攻克机器学习。在学习器学习之前，首先你需要具备基础的数学知识和编程命令。</p><p>如果你已精通矩阵，了解支持向量机以及卷积神经网络等各种 AI 理论，而且准备开始实验和构建模型，那么这个网站是一个很不错的选择，它可以为你提供所有的示例。</p><p><strong>10. Data Science Dojo</strong></p><p>链接：<a href="https://blog.datasciencedojo.com/">https://blog.datasciencedojo.com/</a></p><p>Data Science Dojo 提供为期五天的公共和私有数据科学训练班。该网站有一个特色的社区，由该领域的导师、学生和专业人士组成，已有来自 700 个国家的 3600 多名用户从该网站的学习计划中毕业。Dojo 的博客提供了广泛的内容，涵盖了数据科学的基础知识，以及道德、安全和访问控制更高级的主题。</p><p><strong>11. DataRobot Blog</strong></p><p>链接：<a href="https://blog.datarobot.com/">https://blog.datarobot.com/</a></p><p>这家公司通过自动机器学习来实现 DataRobot 的转换，并加速预测分析。他们不仅出色地完成了这项任务，而且还提供有关自动机器学习和数据科学领域的最新新闻。</p><p><strong>12. FiveThirtyEight</strong></p><p>链接：<a href="https://fivethirtyeight.com/">https://fivethirtyeight.com/</a></p><p>这是 Nate Silver 的数据科学博客，是分析数据领域最新、最出色的数据科学博客之一。该博客的文章通常以互动示例为特色，而且文章详细介绍了如何将数据应用于政治、文化、经济和日常生活等其他方面。</p><p><strong>13. Data Science 101</strong></p><p>链接：<a href="https://101.datascience.community/">https://101.datascience.community/</a></p><p>Data Science 101 为有抱负的数据科学家提供了学习所需的所有资源。该博客由 Ryan Swanstrom 负责运营，提供了源源不断的内容，主题涉及从在顶级公司任职数据科学家到工作的面试技巧等。Data Science 101 还有一个活跃的用户社区，如果你想与他们交谈，还可以加入一个开放的 Facebook 群。</p><p><strong>14. Towards Data Science</strong></p><p>链接：<a href="https://towardsdatascience.com/">https://towardsdatascience.com/</a></p><p>Towards Data Science 在扎实的机器学习知识和实例之间取得了很好的平衡。网站上包含由实践中的数据科学家撰写的大量高质量文章。很多数据科学家和其他机器学习从业人员都通过这个网站记录他们正在从事的工作。你不仅可以通过这个网站提高实践能力，而且还可以在需要时复习理论。尽管这个网站有点侧重于深度学习，但对于积极尝试解决数据驱动挑战的现实世界数据科学家来说，这是一个非常实用的网站。</p><p><strong>15. insideBIGDATA</strong></p><p>链接：<a href="https://insidebigdata.com/">https://insidebigdata.com/</a></p><p>insideBIGDATA 是一个新闻媒体，可为数据科学家以及 IT 和业务专业人士提供大数据相关的新闻、策略、产品和服务。他们的社论专注于大数据、数据科学、人工智能、机器学习和深度学习。该网站的内容制作团队由该领域非常聪明的专业人士组成，并且真正迎合了希望密切关注机器学习和 AI 最前沿动向的技术专业人士。</p><p><strong>16. Cloudera</strong></p><p>链接：<a href="https://www.cloudera.com/">https://www.cloudera.com/</a></p><p>这是一家大型软件公司，他们创建了这个了不起的博客，其中包含有关 Hadoop、Apache 等各种软件的大量文章和指南，非常实用。</p><p><strong>17. OpenAI blog</strong></p><p>链接：<a href="https://openai.com/blog/">https://openai.com/blog/</a></p><p>这是一家位于美国加利福尼亚州旧金山的研究实验室。他们提供有关 AI 的综合资源，其中包括博客、研究论文和有趣的文章。一切内容都是该领域专家提供的最新资讯。</p><p><strong>18. Tombone’s Computer Vision Blog</strong></p><p>链接：<a href="http://www.computervisionblog.com/">http://www.computervisionblog.com/</a></p><p>该网站提供深度学习、计算机视觉以及塑造人工智能未来的算法。</p><p><strong>19. Data Elixir</strong></p><p>链接：<a href="https://dataelixir.com/">https://dataelixir.com/</a></p><p>这个网站提供免费的每周新闻，其中包含来自网络的顶级数据科学精选。涵盖内容包括机器学习、数据可视化、分析和策略。绝对值得订阅！</p><p><strong>20. Stack Overflow</strong></p><p>链接：<a href="https://stackoverflow.com/">https://stackoverflow.com/</a></p><p>我无法想象没有 StackOverflow 的生活。这是一个开放的社区，面向所有从事编程工作、寻找所有类型问题的答案或只是喜欢寻找有趣话题的人们。这是一个绝佳的分享知识和发现新事物的平台。</p>]]></content>
      
      
      
        <tags>
            
            <tag> 数据科学 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>国外 20 个机器学习相关博客推荐</title>
      <link href="2021/01/09/guo-wai-20-ge-ji-qi-xue-xi-xiang-guan-bo-ke-tui-jian/"/>
      <url>2021/01/09/guo-wai-20-ge-ji-qi-xue-xi-xiang-guan-bo-ke-tui-jian/</url>
      
        <content type="html"><![CDATA[<h1 id="国外-20-个机器学习相关博客推荐（转载）"><a href="#国外-20-个机器学习相关博客推荐（转载）" class="headerlink" title="国外 20 个机器学习相关博客推荐（转载）"></a><a href="https://segmentfault.com/a/1190000012869933">国外 20 个机器学习相关博客推荐</a>（转载）</h1><h3 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h3><p>  最近一直在学习机器学习相关的知识，前面相继边学习边翻译了四篇机器学习相关的国外文章</p><ul><li><a href="http://www.bugcode.cn/break_captcha.html">15 分钟破解网站验证码</a></li><li><a href="http://www.bugcode.cn/mlweatherpart01.html">使用机器学习预测天气(第一部分)</a></li><li><a href="http://www.bugcode.cn/mlweatherpart02.html">使用机器学习预测天气(第二部分)</a></li><li><a href="http://www.bugcode.cn/mlweatherpart03.html">使用机器学习预测天气(第三部分)</a></li></ul><p>  今天我就把我平时看到的一些国外的关于机器学习的博客和新闻站，分享给大家。</p><h3 id="Machine-Learning-Reddit"><a href="#Machine-Learning-Reddit" class="headerlink" title="Machine Learning - Reddit"></a>Machine Learning - Reddit</h3><ul><li>网址：<a href="https://www.reddit.com/r/MachineLearning/">点击前往</a></li><li>介绍：关于大名鼎鼎的 Reddit，相信我不用多说，你已经知道了或者听说了很多关于 Reddit 的传闻。Reddit 中包含了很多关于机器学习的讨论、文章、项目。</li><li>更新频率：84 篇/周</li></ul><h3 id="Machine-Learning-Google-News"><a href="#Machine-Learning-Google-News" class="headerlink" title="Machine Learning - Google News"></a>Machine Learning - Google News</h3><ul><li>网址: <a href="https://news.google.com/news/section?q=Machine Learning">点击前往</a></li><li>介绍：Google 官方的新闻站，爬取了世界上各种关于机器学习的文章，功能上，和国内的推酷很像</li><li>更新频率：大约 42 篇/周</li></ul><h3 id="Machine-Learning-Mastery"><a href="#Machine-Learning-Mastery" class="headerlink" title="Machine Learning Mastery"></a>Machine Learning Mastery</h3><ul><li>网址：<a href="http://machinelearningmastery.com/blog/">点击前往</a></li><li>介绍：这是个个人博客，作者来自于澳大利亚，作者建立该博客的目的是帮人开发人员使用机器学习的知识解决复杂的问题。</li><li>更新频率：大约 4 篇/周</li></ul><h3 id="Machine-Learning-Weekly"><a href="#Machine-Learning-Weekly" class="headerlink" title="Machine Learning Weekly"></a>Machine Learning Weekly</h3><ul><li>网址：<a href="http://mlweekly.com/">点击前往</a></li><li>介绍：这是一个关于机器学习和深度学习的网站</li><li>更新频率：大约每月 2 篇文章</li></ul><h3 id="Google-Blog-on-Machine-Learning"><a href="#Google-Blog-on-Machine-Learning" class="headerlink" title="Google Blog on Machine Learning"></a>Google Blog on Machine Learning</h3><ul><li>网址：<a href="https://blog.google/topics/machine-learning/">点击前往</a></li><li>介绍：不解释</li><li>更新频率：大约每周 2 篇文章</li></ul><h3 id="MIT-News-Machine-learning"><a href="#MIT-News-Machine-learning" class="headerlink" title="MIT News - Machine learning"></a>MIT News - Machine learning</h3><ul><li>网址：<a href="http://news.mit.edu/topic/machine-learning">点击前往</a></li><li>介绍：麻省理工学院新闻站，MIT 的机器学习课程相信很多人都或多或少听过，质量很高，而官方的新闻站，也会传达出很多 MIT 在机器学习方面的研究和使用。</li><li>更新频率：大约每月 2 篇</li></ul><h3 id="Cortana-Intelligence-and-Machine-Learning-Blog"><a href="#Cortana-Intelligence-and-Machine-Learning-Blog" class="headerlink" title="Cortana Intelligence and Machine Learning Blog"></a>Cortana Intelligence and Machine Learning Blog</h3><ul><li>网址：<a href="https://blogs.technet.microsoft.com/machinelearning/">点击前往</a></li><li>介绍：Cortana(小娜)是微软的语音助理，作为官方的博客，干货多少，可想而知</li><li>更新频率：大约每周两篇</li></ul><h3 id="Stats-and-Bots-Medium"><a href="#Stats-and-Bots-Medium" class="headerlink" title="Stats and Bots - Medium"></a>Stats and Bots - Medium</h3><ul><li>网址：<a href="https://blog.statsbot.co/">点击前往</a></li><li>介绍：机器学习应用程序和代码的实用指南</li><li>更新频率：大约一周一篇</li></ul><h3 id="indico-io-Powerful-Developer-Friendly-Machine-Learning"><a href="#indico-io-Powerful-Developer-Friendly-Machine-Learning" class="headerlink" title="indico.io | Powerful Developer-Friendly Machine Learning"></a>indico.io | Powerful Developer-Friendly Machine Learning</h3><ul><li>网址：<a href="https://indico.io/blog/">点击前往</a></li><li>介绍：机器学习相关的资源站</li><li>更新频率：一个月一篇</li></ul><h3 id="FastML"><a href="#FastML" class="headerlink" title="FastML"></a>FastML</h3><ul><li>网址：<a href="http://fastml.com/">点击前往</a></li><li>介绍：机器学习和数据挖掘相关的一切。文章的风格幽默，易于阅读和理解。</li><li>更新频率：一个月一篇</li></ul><h3 id="Machine-Learning-Theory"><a href="#Machine-Learning-Theory" class="headerlink" title="Machine Learning (Theory)"></a>Machine Learning (Theory)</h3><ul><li>网址：<a href="http://hunch.net/">点击前往</a></li><li>介绍：这是一个研究机器学习相关理论的博客站</li><li>更新频率：大约一个月一篇</li></ul><h3 id="BigML-com-Machine-Learning-Made-Simple"><a href="#BigML-com-Machine-Learning-Made-Simple" class="headerlink" title="BigML.com | Machine Learning Made Simple"></a>BigML.com | Machine Learning Made Simple</h3><ul><li>网址：<a href="https://blog.bigml.com/">点击前往</a></li><li>介绍：这个网站提供了很多很棒的机器学习例子来供你学习使用。</li><li>更新频率：大约每周一篇</li></ul><h3 id="DatumBox-Blog-on-Machine-Learning-Statistics-amp-Software-Development"><a href="#DatumBox-Blog-on-Machine-Learning-Statistics-amp-Software-Development" class="headerlink" title="DatumBox - Blog on Machine Learning, Statistics &amp; Software Development"></a>DatumBox - Blog on Machine Learning, Statistics &amp; Software Development</h3><ul><li>网址：<a href="http://blog.datumbox.com/">点击前往</a></li><li>介绍：Datumbox 博客专注于机器学习，统计，人工智能及其在软件开发和在线营销上的应用。</li><li>更新频率：大约一个月一篇</li></ul><h3 id="Machine-Learning-Blog"><a href="#Machine-Learning-Blog" class="headerlink" title="Machine Learning Blog"></a>Machine Learning Blog</h3><ul><li>网址：<a href="https://blogs.city.ac.uk/ml/">点击前往</a></li><li>介绍：伦敦大学的机器学习博客站。</li><li>更新频率：大约一个月一篇</li></ul><h3 id="Ayasdi-Artificial-Intelligence-Machine-Intelligence-amp-Machine-Learning"><a href="#Ayasdi-Artificial-Intelligence-Machine-Intelligence-amp-Machine-Learning" class="headerlink" title="Ayasdi - Artificial Intelligence, Machine Intelligence &amp; Machine Learning"></a>Ayasdi - Artificial Intelligence, Machine Intelligence &amp; Machine Learning</h3><ul><li>网址：<a href="https://www.ayasdi.com/blog/">点击前往</a></li><li>介绍：一个商业机器学习公司的博客，里面有好多质量较高的机器学习文章。</li><li>更新频率：大约一个月一篇</li></ul><h3 id="Diving-into-data-A-blog-on-machine-learning-data-mining-and-visualization"><a href="#Diving-into-data-A-blog-on-machine-learning-data-mining-and-visualization" class="headerlink" title="Diving into data | A blog on machine learning, data mining and visualization"></a>Diving into data | A blog on machine learning, data mining and visualization</h3><ul><li>网址：<a href="http://blog.datadive.net/">点击前往</a></li><li>介绍：来自微软 Skype 团队技术大牛 Ando Saabas 的个人博客</li><li>更新频率：大约一个月一篇</li></ul><h3 id="The-Spectator"><a href="#The-Spectator" class="headerlink" title="The Spectator"></a>The Spectator</h3><ul><li>网址：<a href="http://blog.shakirm.com/">点击前往</a></li><li>介绍：一个机器学习科学家的个人博客</li><li>更新频率：大约一个月一篇</li></ul><h3 id="mierobot"><a href="#mierobot" class="headerlink" title="mierobot"></a>mierobot</h3><ul><li>网址：<a href="https://www.mierobot.com/">点击前往</a></li><li>介绍：机器学习、深度学习、机器人相关的技术博客</li><li>更新频率：大约每周两篇</li></ul><h3 id="CALCULATED-CONTENT"><a href="#CALCULATED-CONTENT" class="headerlink" title="CALCULATED CONTENT"></a>CALCULATED CONTENT</h3><ul><li>网址：<a href="https://calculatedcontent.com/">点击前往</a></li><li>介绍：AI 和机器学习应用的相关</li><li>更新频率：大约一个月一篇</li></ul><h3 id="Machined-Learnings"><a href="#Machined-Learnings" class="headerlink" title="Machined Learnings"></a>Machined Learnings</h3><ul><li>网址：<a href="http://www.machinedlearnings.com/">点击前往</a></li><li>介绍：微软的技术大牛 Paul Mineiro 的个人博客</li><li>更新频率：大约一个月一篇</li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> 机器学习 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>categories</title>
      <link href="2021/01/09/categories/"/>
      <url>2021/01/09/categories/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Hello World</title>
      <link href="2021/01/09/hello-world/"/>
      <url>2021/01/09/hello-world/</url>
      
        <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ hexo new <span class="token string">"My New Post"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ hexo server<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ hexo generate<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ hexo deploy<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>]]></content>
      
      
      
    </entry>
    
    
  
  
</search>
